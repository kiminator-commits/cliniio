const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/quizService-ykesnD9-.js","assets/js/login-em2Hs6UG.js","assets/js/utils-DSBVV_PW.js","assets/js/vendor-DoALFvsH.js","assets/js/data-73RVSc-N.js","assets/js/ui-CbhfWbfq.js","assets/js/main-FsBT3Y_8.js","assets/js/errors-CsB9ZK3e.js","assets/css/main-DtMVykw2.css"])))=>i.map(i=>d[i]);
import{j as a}from"./utils-DSBVV_PW.js";import{a as j}from"./vendor-DoALFvsH.js";import{s as be,A as Me,n as Qe,S as Ye}from"./main-FsBT3Y_8.js";import{I as x,l as Fe,aG as Be,L as Ne,Q as je,aD as Ve,b2 as He,aF as we,aS as We,ac as Je,b3 as Ie,n as R,b4 as Xe,c as Ue,ao as Ze,b5 as $e,b6 as Ge,u as et,b7 as tt}from"./errors-CsB9ZK3e.js";import{s as y,_ as M}from"./login-em2Hs6UG.js";import"./data-73RVSc-N.js";import"./ui-CbhfWbfq.js";const rt=({loading:l,lastUpdated:t,onRefresh:e})=>a.jsx("div",{className:"mb-8",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-600",children:"Cliniio Intelligence"}),a.jsx("p",{className:"mt-2 text-gray-500",children:"Predictive analytics and strategic insights for clinical operations"})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:e,disabled:l,className:`px-4 py-2 rounded-lg transition-colors flex items-center ${l?"bg-gray-400 cursor-not-allowed":"bg-[#4ECDC4] hover:bg-[#3DB8B0] text-white"}`,children:[a.jsx(x,{path:Fe,size:1.2,className:`mr-2 ${l?"animate-spin":""}`}),l?"Refreshing...":"Refresh"]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Last updated:"," ",t?new Date(t).toLocaleString():"Never"]})]})]})});function at({activeTab:l,onTabChange:t}){const e=[{id:"overview",label:"Overview",icon:Be},{id:"forecasting",label:"Forecasting",icon:Ne},{id:"risks",label:"Risk Analysis",icon:je},{id:"actions",label:"Actions",icon:Ve},{id:"insights",label:"Insights",icon:He},{id:"integrations",label:"Integrations",icon:we}];return a.jsx("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:e.map(r=>a.jsxs("button",{onClick:()=>t(r.id),style:{padding:"0.5rem 1rem",border:"none",borderRadius:"0.5rem",background:l===r.id?"#eee":"white",cursor:"pointer",boxShadow:l===r.id?"0 2px 4px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:"0.5rem",color:"#374151"},children:[a.jsx(x,{path:r.icon,size:1}),r.label]},r.id))})}function st(){const[l,t]=j.useState(()=>Date.now());return j.useEffect(()=>{const e=setInterval(()=>{t(Date.now())},6e4);return()=>clearInterval(e)},[]),l}function it({summary:l}){var t,e,r,s,o,d,n;const i=st(),c=l;function u(){var m;return(m=c==null?void 0:c.risks)==null?void 0:m.some(v=>v.level==="high")}function h(){var m,v;return(v=(m=c==null?void 0:c.actions)==null?void 0:m.filter(_=>_.urgency==="high"))!=null?v:[]}function p(m){switch(m.toLowerCase()){case"critical":return"border-red-500 bg-red-50";case"high":return"border-orange-500 bg-orange-50";case"medium":return"border-yellow-500 bg-yellow-50";case"low":return"border-green-500 bg-green-50";default:return"border-gray-500 bg-gray-50"}}function g(m){switch(m.toLowerCase()){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}function f(m){}return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(x,{path:Ne,size:1.5,className:"text-blue-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Forecasts Active"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(((t=c==null?void 0:c.toolReplacement)==null?void 0:t.length)||0)+(((e=c==null?void 0:c.autoclaveCapacity)==null?void 0:e.length)||0)+(((r=c==null?void 0:c.supplyDepletion)==null?void 0:r.length)||0)})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(x,{path:je,size:1.5,className:"text-orange-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Risk Level"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 capitalize",children:((s=c==null?void 0:c.auditRisk)==null?void 0:s.riskLevel)||"No data"})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(x,{path:We,size:1.5,className:"text-green-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Monthly Savings"}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",(((o=c==null?void 0:c.efficiencyROI)==null?void 0:o.estimatedLaborSavings)||0).toLocaleString()]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(x,{path:Je,size:1.5,className:"text-purple-600"})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Training Gaps"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((n=(d=c==null?void 0:c.trainingGaps)==null?void 0:d.usersWithGaps)==null?void 0:n.length)||0})]})]})})]}),u()&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(x,{path:Ie,size:1.5,className:"text-red-600 mr-3"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"High Priority Alerts"}),a.jsxs("p",{className:"text-sm text-red-700 mt-1",children:[h().length," urgent actions require immediate attention"]})]}),a.jsx("button",{onClick:()=>void 0,className:"ml-auto bg-red-100 text-red-800 px-3 py-2 rounded-md text-sm font-medium hover:bg-red-200",children:"View Actions"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Forecasts"}),c!=null&&c.supplyDepletion&&c.supplyDepletion.length>0?a.jsx("div",{className:"space-y-3",children:c.supplyDepletion.slice(0,3).map((m,v)=>a.jsx("div",{className:`p-3 rounded-lg border-l-4 ${p(m.reorderUrgency)}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:m.itemName}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Depletes in"," ",Math.ceil((new Date(m.depletionDate).getTime()-i)/(1e3*60*60*24))," ","days"]})]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${g(m.reorderUrgency)}`,children:m.reorderUrgency})]})},v))}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No supply depletion forecasts available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once inventory items are added"})]})]}),c!=null&&c.toolTurnoverUtilization&&c.toolTurnoverUtilization.length>0?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Fe,size:1.5,className:"text-blue-600 mr-2"}),"Tool Turnover & Utilization"]}),a.jsx("div",{className:"space-y-4",children:c.toolTurnoverUtilization.slice(0,3).map((m,v)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:m.toolName}),a.jsxs("p",{className:"text-sm text-gray-600",children:["Batch: ",m.toolBatchId]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${m.performanceScore>=90?"bg-green-100 text-green-800":m.performanceScore>=80?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:["Score: ",m.performanceScore]})})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Daily Cycles:"}),a.jsx("div",{className:"text-gray-900",children:m.dailyCycleCount})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Turnover Rate:"}),a.jsxs("div",{className:"text-gray-900",children:[m.turnoverRate.toFixed(1),"x/day"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Efficiency:"}),a.jsxs("div",{className:"text-gray-900",children:[m.utilizationEfficiency,"%"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Idle Time:"}),a.jsxs("div",{className:"text-gray-900",children:[m.idleTimePercentage,"%"]})]})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[a.jsxs("div",{className:"text-sm",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Peak Hours:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:m.peakUsageHours.join(", ")})]}),a.jsxs("div",{className:"text-sm mt-1",children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Optimization:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:m.recommendedOptimization})]})]})]},v))})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No tool utilization data available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once sterilization cycles are completed"})]})})]})}function nt({summary:l}){const t=r=>{switch(r){case"low":return"border-green-500 bg-green-50";case"medium":return"border-yellow-500 bg-yellow-50";case"high":return"border-orange-500 bg-orange-50";case"critical":return"border-red-500 bg-red-50";default:return"border-gray-500 bg-gray-50"}},e=r=>{switch(r){case"low":return"border-green-500 bg-green-50";case"medium":return"border-yellow-500 bg-yellow-50";case"high":return"border-orange-500 bg-orange-50";case"critical":return"border-red-500 bg-red-50";default:return"border-gray-500 bg-gray-50"}};return l?a.jsxs("div",{className:"space-y-6",children:[l.toolReplacement&&l.toolReplacement.length>0?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ne,size:1.5,className:"text-blue-600 mr-2"}),"Tool Replacement Forecasts"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.toolReplacement.map((r,s)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:r.toolName}),a.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",r.toolBatchId]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Current Lifecycle:"}),a.jsxs("span",{className:"text-sm font-medium",children:[r.currentLifecycle,"%"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"End of Life:"}),a.jsx("span",{className:"text-sm font-medium",children:new Date(r.predictedEndOfLife).toLocaleDateString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Reorder Date:"}),a.jsx("span",{className:"text-sm font-medium",children:new Date(r.recommendedReorderDate).toLocaleDateString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Confidence:"}),a.jsxs("span",{className:"text-sm font-medium",children:[Math.round(r.confidence*100),"%"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Estimated Cost:"}),a.jsxs("span",{className:"text-sm font-medium",children:["$",(r.estimatedCost||0).toLocaleString()]})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:a.jsxs("p",{className:"text-xs text-gray-600",children:["Supplier: ",r.supplierSuggestion]})})]},s))})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No tool replacement forecasts available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once sterilization cycles are completed"})]})}),l.autoclaveCapacity&&l.autoclaveCapacity.length>0?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Xe,size:1.5,className:"text-orange-600 mr-2"}),"Autoclave Capacity Planning"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.autoclaveCapacity.map((r,s)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h4",{className:"font-medium text-gray-900",children:["Autoclave ",r.autoclaveId]}),a.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.currentLoadPercentage>90?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:[r.currentLoadPercentage,"% Load"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Queue Length:"}),a.jsxs("span",{className:"text-sm font-medium",children:[r.queueLength," items"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Overload Date:"}),a.jsx("span",{className:"text-sm font-medium",children:new Date(r.predictedOverloadDate).toLocaleDateString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Recommended Action:"}),a.jsx("span",{className:"text-sm font-medium capitalize",children:r.recommendedAction.replace("_"," ")})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Timeline:"}),a.jsx("span",{className:"text-sm font-medium",children:r.timeline})]})]})]},s))})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No autoclave capacity data available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once autoclave cycles are completed"})]})}),l.supplyDepletion&&l.supplyDepletion.length>0?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ue,size:1.5,className:"text-red-600 mr-2"}),"Supply Depletion Forecasts"]}),a.jsx("div",{className:"space-y-3",children:l.supplyDepletion.map((r,s)=>a.jsx("div",{className:`p-4 rounded-lg border-l-4 ${e(r.reorderUrgency)}`,children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:r.itemName}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t(r.reorderUrgency)}`,children:r.reorderUrgency})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Current Stock:"}),a.jsx("span",{className:"ml-2 font-medium",children:r.currentStock})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Depletion Date:"}),a.jsx("span",{className:"ml-2 font-medium",children:new Date(r.depletionDate).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Reorder Date:"}),a.jsx("span",{className:"ml-2 font-medium",children:new Date(r.recommendedReorderDate).toLocaleDateString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600",children:"Cost Trend:"}),a.jsx("span",{className:"ml-2 font-medium capitalize",children:r.costTrend})]})]})]})})},s))})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No supply depletion forecasts available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once inventory items are added"})]})})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No forecasting data available"})]})})}function ct({summary:l}){var t,e,r,s,o,d,n,i,c,u,h,p,g,f,m,v,_;const I=w=>{switch(w){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return l?a.jsxs("div",{className:"space-y-6",children:[l.auditRisk?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:je,size:1.5,className:"text-red-600 mr-2"}),"Audit Risk Assessment"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`inline-flex items-center justify-center w-20 h-20 rounded-full ${I(((t=l.auditRisk)==null?void 0:t.riskLevel)||"medium")} mb-3`,children:a.jsx("span",{className:"text-2xl font-bold",children:((e=l.auditRisk)==null?void 0:e.overallRiskScore)||85})}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Overall Risk Score"}),a.jsxs("p",{className:`text-sm font-medium capitalize ${I(((r=l.auditRisk)==null?void 0:r.riskLevel)||"medium")}`,children:[((s=l.auditRisk)==null?void 0:s.riskLevel)||"medium"," Risk"]})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-orange-100 text-orange-600 mb-3",children:a.jsx("span",{className:"text-2xl font-bold",children:((o=l.auditRisk)==null?void 0:o.incompleteCycles)||2})}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Incomplete Cycles"}),a.jsx("p",{className:"text-sm text-orange-600",children:"This Week"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-yellow-100 text-yellow-600 mb-3",children:a.jsx("span",{className:"text-2xl font-bold",children:((n=(d=l.auditRisk)==null?void 0:d.riskFactors)==null?void 0:n.length)||2})}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Risk Factors"}),a.jsx("p",{className:"text-sm text-yellow-600",children:"Identified"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Risk Factors"}),a.jsx("div",{className:"space-y-3",children:(i=l.auditRisk)!=null&&i.riskFactors&&l.auditRisk.riskFactors.length>0?l.auditRisk.riskFactors.map((w,C)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:w.factor}),a.jsx("p",{className:"text-sm text-gray-600",children:w.description})]}),a.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-orange-100 text-orange-800",children:["Severity: ",w.severity]})]},C)):a.jsx("div",{className:"text-center py-4 text-gray-500",children:"No risk factors identified"})})]})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No audit risk data available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once sterilization cycles are completed"})]})}),l.theftLoss?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ue,size:1.5,className:"text-orange-600 mr-2"}),"Theft & Loss Analysis"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-orange-100 text-orange-600 mb-2",children:a.jsxs("span",{className:"text-xl font-bold",children:[l.theftLoss.estimatedLossPercentage||0,"%"]})}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Estimated Loss"}),a.jsxs("p",{className:"text-lg font-bold text-orange-600",children:["$",((c=l.theftLoss.estimatedLossValue)==null?void 0:c.toLocaleString())||"0"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Flagged Items:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:(u=l.theftLoss)!=null&&u.flaggedItems&&l.theftLoss.flaggedItems.length>0?l.theftLoss.flaggedItems.map((w,C)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(x,{path:Ie,size:.8,className:"text-orange-500 mr-2"}),w]},C)):a.jsx("li",{className:"text-gray-500",children:"No flagged items"})})]})]}),a.jsx("div",{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Risk Factors:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:(h=l.theftLoss)!=null&&h.riskFactors&&l.theftLoss.riskFactors.length>0?l.theftLoss.riskFactors.map((w,C)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(x,{path:R,size:.8,className:"text-blue-500 mr-2"}),w]},C)):a.jsx("li",{className:"text-gray-500",children:"No risk factors identified"})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Incident Summary:"}),a.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[a.jsxs("p",{children:["Flagged Items:"," ",((g=(p=l.theftLoss)==null?void 0:p.flaggedItems)==null?void 0:g.length)||0]}),a.jsxs("p",{children:["Risk Factors:"," ",((m=(f=l.theftLoss)==null?void 0:f.riskFactors)==null?void 0:m.length)||0]}),a.jsxs("p",{children:["Recommended Actions:"," ",((_=(v=l.theftLoss)==null?void 0:v.recommendedActions)==null?void 0:_.length)||0]})]})]})]})})]})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No theft/loss data available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once inventory tracking is implemented"})]})})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No risk analysis data available"})]})})}function lt({summary:l,optimizationTips:t=[]}){var e,r,s;const o=()=>l!=null&&l.actions?l.actions.filter(n=>n.urgency==="high"):[],d=t||[];return l?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ie,size:1.5,className:"text-red-600 mr-2"}),"Urgent Actions Required"]}),a.jsxs("div",{className:"space-y-4",children:[o().map((n,i)=>a.jsx("div",{className:"border-l-4 border-red-500 bg-red-50 p-4 rounded-r-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-900",children:n.title}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:n.description})]}),a.jsx("button",{className:"bg-red-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-red-700",children:"Take Action"})]})},i)),o().length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No urgent actions required at this time"})]})]}),l.trainingGaps?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[a.jsx(x,{path:Ze,size:1.5,className:"text-blue-600 mr-2"}),"Training & Knowledge Gaps"]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((r=(e=l.trainingGaps)==null?void 0:e.usersWithGaps)==null?void 0:r.length)||0}),a.jsx("div",{className:"text-sm text-gray-500",children:"Total Gaps"})]})]}),(s=l.trainingGaps)!=null&&s.usersWithGaps&&l.trainingGaps.usersWithGaps.length>0?a.jsx("div",{className:"space-y-4",children:l.trainingGaps.usersWithGaps.map((n,i)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:n.userName||"Unknown User"}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[a.jsxs("span",{className:"text-gray-500",children:["ID: ",n.userId]}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Training Required"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h5",{className:"font-medium text-gray-700",children:"Knowledge Gaps:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:n.recommendedTraining&&n.recommendedTraining.length>0?n.recommendedTraining.map((c,u)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(x,{path:$e,size:.8,className:"mr-2"}),c]},u)):a.jsx("li",{className:"text-gray-500",children:"No specific gaps identified"})})]})]},i))}):a.jsx("div",{className:"text-center py-4 text-gray-500",children:"No training gaps identified"})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No training data available"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Data will appear here once staff assessments are completed"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ge,size:1.5,className:"text-purple-600 mr-2"}),"Optimization Tips"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((n,i)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:n.title}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.difficulty==="easy"?"bg-green-100 text-green-800":n.difficulty==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:n.difficulty})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:n.description}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Current:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:n.currentState})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Action:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:n.recommendedAction})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Expected:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:n.expectedOutcome})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Effort:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:n.estimatedEffort})]})]})]},i))})]})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No action items data available"})]})})}function ot({summary:l,recommendations:t=[],optimizationTips:e=[],insightsSummary:r}){const s=c=>{switch(c.toLowerCase()){case"high":return"border-red-500 bg-red-50";case"medium":return"border-yellow-500 bg-yellow-50";case"low":return"border-green-500 bg-green-50";default:return"border-gray-500 bg-gray-50"}},o=r||{totalRecommendations:0,criticalItems:0,estimatedSavings:0,estimatedTimeSavings:0},d=c=>typeof c=="number"?c:typeof c=="string"&&parseFloat(c)||0,n=t||[],i=e||[];return l?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(x,{path:He,size:2,className:"text-blue-600 mr-3"}),a.jsx("h3",{className:"text-xl font-bold text-blue-900",children:"Actionable Insights Summary"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-900",children:d(o.totalRecommendations)}),a.jsx("div",{className:"text-sm text-blue-700",children:"Total Recommendations"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-red-600",children:d(o.criticalItems)}),a.jsx("div",{className:"text-sm text-red-700",children:"Critical Items"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",d(o.estimatedSavings).toLocaleString()]}),a.jsx("div",{className:"text-sm text-green-700",children:"Estimated Savings"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[d(o.estimatedTimeSavings),"h"]}),a.jsx("div",{className:"text-sm text-purple-700",children:"Time Savings"})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:et,size:1.5,className:"text-green-600 mr-2"}),"Smart Recommendations"]}),a.jsx("div",{className:"space-y-4",children:n.slice(0,5).map((c,u)=>a.jsxs("div",{className:`p-4 rounded-lg border ${s(c.priority)}`,children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:c.title}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:c.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[a.jsxs("span",{className:"text-gray-500",children:["Timeline: ",c.timeline]}),a.jsxs("span",{className:"text-gray-500",children:["Confidence: ",Math.round(c.confidence*100),"%"]}),a.jsxs("span",{className:"text-gray-500",children:["Category: ",c.category]})]}),c.costSavings&&a.jsx("div",{className:"mt-2 text-sm",children:a.jsxs("span",{className:"text-green-600 font-medium",children:["💰 Potential savings: $",c.costSavings.toLocaleString()]})})]}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${s(c.priority)}`,children:c.priority})]}),a.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[a.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Action Items:"}),a.jsx("ul",{className:"text-sm text-gray-600 space-y-1",children:c.actionItems.slice(0,3).map((h,p)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(x,{path:$e,size:.8,className:"text-blue-500 mr-2"}),h]},p))})]})]},u))})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:Ge,size:1.5,className:"text-purple-600 mr-2"}),"Optimization Tips"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((c,u)=>a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:c.title}),a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${c.difficulty==="easy"?"bg-green-100 text-green-800":c.difficulty==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:c.difficulty})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:c.description}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Current:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:c.currentState})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Action:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:c.recommendedAction})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Expected:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:c.expectedOutcome})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-gray-700",children:"Effort:"}),a.jsx("span",{className:"text-gray-600 ml-2",children:c.estimatedEffort})]})]})]},u))})]})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No insights data available"})]})})}function dt({summary:l,integrationMetrics:t}){const e={knowledgeHubArticles:24,activeSuppliers:8,recentAuditActions:12,integrationHealth:87,lastSync:new Date().toISOString()},r=t||e;return l?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[a.jsx(x,{path:we,size:1.5,className:"text-blue-600 mr-2"}),"Integration Health"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-900",children:r.knowledgeHubArticles}),a.jsx("div",{className:"text-sm text-blue-700",children:"Knowledge Hub Articles"})]}),a.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-900",children:r.activeSuppliers}),a.jsx("div",{className:"text-sm text-green-700",children:"Active Suppliers"})]}),a.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-900",children:r.recentAuditActions}),a.jsx("div",{className:"text-sm text-purple-700",children:"Recent Audit Actions"})]}),a.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[a.jsxs("div",{className:"text-2xl font-bold text-orange-900",children:[r.integrationHealth,"%"]}),a.jsx("div",{className:"text-sm text-orange-700",children:"Integration Health"})]})]}),a.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Last sync:"," ",r.lastSync?new Date(r.lastSync).toLocaleString():"Never"]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Integration Actions"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center justify-center",children:[a.jsx(x,{path:tt,size:1.2,className:"mr-2"}),"Sync Knowledge Hub"]}),a.jsxs("button",{className:"bg-gray-400 text-gray-600 px-4 py-2 rounded-lg cursor-not-allowed flex items-center justify-center opacity-60",disabled:!0,children:[a.jsx(x,{path:we,size:1.2,className:"mr-2"}),"Supplier Database Sync",a.jsx("span",{className:"ml-2 text-xs bg-gray-500 text-white px-2 py-1 rounded-full",children:"Coming Soon"})]})]})]})]}):a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx(x,{path:R,size:2,className:"text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-600",children:"No integration data available"})]})})}const ut=600*1e3,z={MAX_LIFECYCLE:95,MIN_LIFECYCLE:10,LIFECYCLE_MULTIPLIER:2.5,ANALYSIS_DAYS:90,MAX_CYCLES_PER_DAY:.1,MIN_CONFIDENCE:.6,MAX_CONFIDENCE:.95,CONFIDENCE_BASE:.75,REORDER_DAYS_BEFORE_EOL:30,MIN_REORDER_DAYS:7},T={ANALYSIS_DAYS:30,RECENT_ANALYSIS_DAYS:7,MAX_CAPACITY_PER_DAY:24,MIN_LOAD_PERCENTAGE:10,MAX_LOAD_PERCENTAGE:100,HIGH_USAGE_THRESHOLD:20,MEDIUM_USAGE_THRESHOLD:15,HIGH_OVERLOAD_DAYS:15,MEDIUM_OVERLOAD_DAYS:45,LOW_OVERLOAD_DAYS:90,HIGH_LOAD_THRESHOLD:90,MEDIUM_LOAD_THRESHOLD:75,LOW_LOAD_THRESHOLD:60,HIGH_QUEUE_THRESHOLD:5,HIGH_FAILURE_RATE:.1,PATIENT_LOAD_MULTIPLIER:1.2},Se={ANALYSIS_DAYS:365,PROJECTION_MONTHS:.5},Y={ANALYSIS_DAYS:30,DEFAULT_FTE:8.5,WORKLOAD_INCREASE_THRESHOLD:20,FTE_INCREASE:.5,COST_PER_FTE:5e4},B={ANALYSIS_DAYS:30,GROWTH_RATE:1.1,INCIDENT_RATE:.3,HIGH_WORKLOAD_THRESHOLD:20,MEDIUM_WORKLOAD_THRESHOLD:10,HIGH_COVERAGE_THRESHOLD:15},X={IMMEDIATE:"Immediate",Q1_2025:"Q1 2025",Q2_2025:"Q2 2025",Q3_2025:"Q3 2025",NEXT_QUARTER:"Next quarter",MONITOR_3_MONTHS:"Monitor for 3 months"},de={ADD_AUTOCLAVE:"add_autoclave",EXTEND_HOURS:"extend_hours",OPTIMIZE_SCHEDULE:"optimize_schedule"},fe={LOW:"low",MEDIUM:"medium",HIGH:"high"};var mt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class Z{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}getToolReplacementForecast(){return mt(this,arguments,function*(t={}){try{const e=`tool_replacement_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for tool replacement forecast"),[];const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-z.ANALYSIS_DAYS*24*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for tool replacement forecast"),[];const d=s.slice(0,5).map((n,i)=>{var c;const u=s.filter(I=>I.tool_batch_id===n.tool_batch_id).length,h=Math.min(z.MAX_LIFECYCLE,Math.max(z.MIN_LIFECYCLE,Math.floor(u*z.LIFECYCLE_MULTIPLIER))),p=u/z.ANALYSIS_DAYS,f=Math.max(0,100-h)/Math.max(z.MAX_CYCLES_PER_DAY,p),m=new Date(Date.now()+f*24*60*60*1e3).toISOString().split("T")[0],v=Math.min(z.MAX_CONFIDENCE,Math.max(z.MIN_CONFIDENCE,z.CONFIDENCE_BASE+u/100)),_=new Date(Date.now()+Math.max(z.MIN_REORDER_DAYS,f-z.REORDER_DAYS_BEFORE_EOL)*24*60*60*1e3).toISOString().split("T")[0];return{toolBatchId:(c=n.tool_batch_id)!=null?c:`TB${String(i+1).padStart(3,"0")}`,toolName:`Tool Set ${String.fromCharCode(65+i)}`,currentLifecycle:h,predictedEndOfLife:m,confidence:v,recommendedReorderDate:_,supplierSuggestion:"Contact procurement for supplier information",estimatedCost:0}});return this.setCachedData(e,d),d}catch(e){return console.error("Error forecasting tool replacement:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var gt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ee{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}getAutoclaveCapacityForecast(){return gt(this,arguments,function*(t={}){try{const e=`autoclave_capacity_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for autoclave capacity forecast"),[];const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).not("autoclave_id","is",null).gte("created_at",new Date(Date.now()-T.ANALYSIS_DAYS*24*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No autoclave data found for capacity forecast"),[];const{data:d,error:n}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-T.RECENT_ANALYSIS_DAYS*24*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(n)return console.warn("Failed to fetch recent cycles for autoclave capacity forecast"),[];const i=s.reduce((u,h)=>{var p;const g=(p=h.autoclave_id)!=null?p:"";return g&&(u[g]||(u[g]=[]),u[g].push(h)),u},{}),c=Object.entries(i).map(([u,h])=>{const p=h.length,g=h.filter(L=>L.status==="clean").length,f=h.filter(L=>L.status==="problem").length,m=p/T.ANALYSIS_DAYS,v=T.MAX_CAPACITY_PER_DAY,_=Math.min(T.MAX_LOAD_PERCENTAGE,Math.max(T.MIN_LOAD_PERCENTAGE,Math.round(m/v*100))),w=((d==null?void 0:d.filter(L=>L.autoclave_id===u&&L.status==="pending"||L.status==="in_progress"))||[]).length,C=m>T.HIGH_USAGE_THRESHOLD?"high":m>T.MEDIUM_USAGE_THRESHOLD?"medium":"low",b=C==="high"?T.HIGH_OVERLOAD_DAYS:C==="medium"?T.MEDIUM_OVERLOAD_DAYS:T.LOW_OVERLOAD_DAYS,S=new Date(Date.now()+b*24*60*60*1e3).toISOString().split("T")[0];let E,k;return _>T.HIGH_LOAD_THRESHOLD||f>p*T.HIGH_FAILURE_RATE?(E=de.ADD_AUTOCLAVE,k=X.IMMEDIATE):_>T.MEDIUM_LOAD_THRESHOLD||w>T.HIGH_QUEUE_THRESHOLD?(E=de.EXTEND_HOURS,k=X.Q1_2025):_>T.LOW_LOAD_THRESHOLD?(E=de.OPTIMIZE_SCHEDULE,k=X.Q2_2025):(E=de.OPTIMIZE_SCHEDULE,k=X.Q3_2025),{autoclaveId:u,currentLoadPercentage:_,queueLength:w,predictedOverloadDate:S,recommendedAction:E,timeline:k,projectedPatientLoad:Math.round(g*T.PATIENT_LOAD_MULTIPLIER)}});return this.setCachedData(e,c),c}catch(e){return console.error("Error forecasting autoclave capacity:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var ht=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class te{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return te.instance||(te.instance=new te),te.instance}getInventoryInflationForecast(){return ht(this,arguments,function*(t={}){try{const e=`inventory_inflation_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for inventory inflation forecast"),[];const s=yield be.getItems();let o=s;t.facilityId&&(o=s.filter(c=>c.facility_id===t.facilityId));const d=new Date(Date.now()-Se.ANALYSIS_DAYS*24*60*60*1e3);if(o=o.filter(c=>c.created_at&&new Date(c.created_at)>=d),o.sort((c,u)=>new Date(u.created_at||"").getTime()-new Date(c.created_at||"").getTime()),!o||o.length===0)return console.warn("No inventory data found for inflation forecast"),[];const n=o.reduce((c,u)=>{var h,p;const g=(p=(h=u.data)==null?void 0:h.category)!=null?p:"Uncategorized";return c[g]||(c[g]=[]),c[g].push(u),c},{}),i=Object.entries(n).map(([c,u])=>{var h,p;const g=u.map(I=>{var w;return((w=I.data)==null?void 0:w.unit_cost)||0}).filter(I=>I>0);if(g.length===0)return null;const f=(h=g[g.length-1])!=null?h:0,m=(p=g[0])!=null?p:0,v=f-m,_=m>0?v/m*100:0;return{category:c,currentPrice:f,priceIncrease:v,inflationRate:_,projectedYearEndPrice:f*(1+_/100*Se.PROJECTION_MONTHS),cheaperSupplierExists:!1,alternativeSupplier:void 0,costSavings:0}}).filter(Boolean);return this.setCachedData(e,i),i}catch(e){return console.error("Error forecasting inventory inflation:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var pt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class re{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return re.instance||(re.instance=new re),re.instance}getClinicalStaffingForecast(){return pt(this,arguments,function*(t={}){try{const e=`clinical_staffing_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for clinical staffing forecast"),[];const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-Y.ANALYSIS_DAYS*24*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for clinical staffing forecast"),[];const d=s.length,n=s.filter(p=>p.status!=="clean"&&p.status!=="problem").length,i=Y.DEFAULT_FTE,c=Math.max(0,n/d*100),u=c>Y.WORKLOAD_INCREASE_THRESHOLD?i+Y.FTE_INCREASE:i,h=[{currentFTE:i,recommendedFTE:u,timeline:c>Y.WORKLOAD_INCREASE_THRESHOLD?X.NEXT_QUARTER:X.MONITOR_3_MONTHS,workloadIncrease:c,skillsetGaps:[],trainingRecommendations:[],estimatedCost:Math.round((u-i)*Y.COST_PER_FTE)}];return this.setCachedData(e,h),h}catch(e){return console.error("Error forecasting clinical staffing:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var ft=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ae{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return ae.instance||(ae.instance=new ae),ae.instance}getAdminStaffingForecast(){return ft(this,arguments,function*(t={}){try{const e=`admin_staffing_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for admin staffing forecast"),[];const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-B.ANALYSIS_DAYS*24*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for admin staffing forecast"),[];const d=s.length,n=s.filter(m=>m.status!=="clean"&&m.status!=="problem").length,i=d,c=Math.round(d*B.GROWTH_RATE),u=Math.max(0,c-i),h=Math.floor(n*B.INCIDENT_RATE),p=n>0?Math.max(1,Math.floor(n/2)):0;let g;u>B.HIGH_WORKLOAD_THRESHOLD?g=fe.HIGH:u>B.MEDIUM_WORKLOAD_THRESHOLD?g=fe.MEDIUM:g=fe.LOW;const f=[{currentWorkload:i,projectedWorkload:c,workloadExcess:u,recommendedCoverage:u>B.HIGH_COVERAGE_THRESHOLD?"Additional 0.5 FTE admin support":"Current staffing adequate",qualityIncidents:h,resolutionLag:p,priority:g}];return this.setCachedData(e,f),f}catch(e){return console.error("Error forecasting admin staffing:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var yt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class se{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return se.instance||(se.instance=new se),se.instance}getTheftLossEstimate(){return yt(this,arguments,function*(t={}){try{const e=`theft_loss_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for theft/loss estimation"),{estimatedLossPercentage:0,estimatedLossValue:0,flaggedItems:[],repeatOffenders:[],riskFactors:[],recommendedActions:[],confidence:0};const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for theft/loss estimation"),{estimatedLossPercentage:0,estimatedLossValue:0,flaggedItems:[],repeatOffenders:[],riskFactors:[],recommendedActions:[],confidence:0};const d=s.length,n=s.filter(p=>p.status!=="clean"&&p.status!=="problem").length,i=Math.min(10,Math.max(0,n/d*100)),c=Math.round(i*1e3),u=s.filter(p=>p.status!=="clean").map(p=>`Tool ${p.id}`).slice(0,3),h={estimatedLossPercentage:Math.round(i*10)/10,estimatedLossValue:c,flaggedItems:u.length>0?u:["No specific items flagged"],repeatOffenders:[],riskFactors:n>0?["Incomplete sterilization cycles","Missing cycle documentation","Protocol non-compliance"]:["Minimal risk factors detected"],recommendedActions:["Complete incomplete sterilization cycles","Review cycle documentation procedures","Monitor compliance metrics"],confidence:Math.max(.5,1-i/100)};return this.setCachedData(e,h),h}catch(e){return console.error("Error estimating theft/loss:",e),{estimatedLossPercentage:0,estimatedLossValue:0,flaggedItems:[],repeatOffenders:[],riskFactors:[],recommendedActions:[],confidence:0}}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var xt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ie{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return ie.instance||(ie.instance=new ie),ie.instance}getSupplyDepletionForecast(){return xt(this,arguments,function*(t={}){try{const e=`supply_depletion_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for supply depletion forecast"),[];const s=yield be.getItems();let o=s;if(t.facilityId&&(o=s.filter(n=>n.facility_id===t.facilityId)),o.sort((n,i)=>(n.quantity||0)-(i.quantity||0)),!o||o.length===0)return console.warn("No inventory data found for supply depletion forecast"),[];const d=o.slice(0,8).map((n,i)=>{var c,u,h,p,g,f,m;const v=(c=n.quantity)!=null?c:0,_=(h=(u=n.data)==null?void 0:u.reorder_point)!=null?h:100,I=(g=(p=n.data)==null?void 0:p.unit_cost)!=null?g:50;let w;v<=_*.5?w="critical":v<=_*.8?w="high":v<=_*1.2?w="medium":w="low";const C=Math.ceil(v/(_/30)),b=new Date(Date.now()+C*24*60*60*1e3),S=new Date(b.getTime()-10080*60*1e3);return{itemName:(f=n.name)!=null?f:`Item ${i+1}`,currentStock:v,depletionDate:b.toISOString().split("T")[0],reorderUrgency:w,recommendedReorderDate:S.toISOString().split("T")[0],currentCost:I,historicalCosts:[I*.95,I*.98,I],costTrend:I>(((m=n.data)==null?void 0:m.last_restocked_cost)||I)?"increasing":"stable"}});return this.setCachedData(e,d),d}catch(e){return console.error("Error forecasting supply depletion:",e),[]}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var vt=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ne{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return ne.instance||(ne.instance=new ne),ne.instance}getEfficiencyROITracker(){return vt(this,arguments,function*(t={}){try{const e=`efficiency_roi_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for efficiency ROI tracking"),null;const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for efficiency ROI tracking"),null;const d=s.length,n=s.filter(g=>g.status==="clean").length,i=d>0?n/d*100:0,c=Math.round(i/100*40),u=c*42,h=u*12,p={timeSavedHours:c,estimatedLaborSavings:u,aiFeatureUsage:[{feature:"Automated scheduling",usageCount:Math.floor(d*.8),timeSaved:Math.round(c*.3)},{feature:"Smart inventory alerts",usageCount:Math.floor(d*.6),timeSaved:Math.round(c*.2)},{feature:"Predictive maintenance",usageCount:Math.floor(d*.4),timeSaved:Math.round(c*.1)}],automationEfficiency:Math.round(i),moduleContributions:[{module:"Sterilization",timeSaved:Math.round(c*.5),costSavings:Math.round(u*.5),efficiency:Math.round(i)},{module:"Inventory",timeSaved:Math.round(c*.3),costSavings:Math.round(u*.3),efficiency:Math.round(i*.9)},{module:"Environmental",timeSaved:Math.round(c*.2),costSavings:Math.round(u*.2),efficiency:Math.round(i*.8)}],projectedAnnualSavings:h};return this.setCachedData(e,p),p}catch(e){return console.error("Error tracking efficiency ROI:",e),null}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}function _t(l){const t=new Array(24).fill(0);l.forEach(s=>{if(s.created_at){const o=new Date(s.created_at).getHours();t[o]++}});const e=Math.max(...t),r=t.map((s,o)=>({count:s,hour:o})).filter(({count:s})=>s>=e*.8).map(({hour:s})=>`${s.toString().padStart(2,"0")}:00`).slice(0,4);return r.length>0?r:["09:00","12:00","15:00"]}function wt(l){return l>=90?"Excellent utilization - maintain current practices":l>=80?"Good utilization - minor optimizations possible":l>=70?"Moderate utilization - consider schedule optimization":"Low utilization - review tool allocation and scheduling"}function bt(l){const t=[];return l<80&&t.push("Low utilization efficiency"),l<70&&t.push("Significant idle time detected"),t.length>0?t:["Minimal bottlenecks detected"]}var ye=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ${constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return $.instance||($.instance=new $),$.instance}getToolTurnoverUtilization(){return ye(this,arguments,function*(t={}){try{const e=`tool_turnover_utilization_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for tool turnover utilization"),[];const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for tool turnover utilization"),[];const d=s.reduce((i,c)=>{var u;const h=(u=c.tool_batch_id)!=null?u:"";return h&&(i[h]||(i[h]=[]),i[h].push(c)),i},{}),n=Object.entries(d).map(([i,c])=>{const u=c.length,h=Math.min(100,u/7*100),p=u/7,g=_t(c),f=Math.min(100,Math.max(50,h)),m=p,v=Math.max(0,100-f);return{toolBatchId:i,toolName:`Tool ${i}`,dailyCycleCount:u,weeklyUtilization:h,averageCyclesPerDay:p,peakUsageHours:g,utilizationEfficiency:f,turnoverRate:m,idleTimePercentage:v,recommendedOptimization:wt(f),bottleneckIndicators:bt(f),performanceScore:Math.round(f)}});return this.setCachedData(e,n),n}catch(e){return console.error("Error analyzing tool turnover utilization:",e),[]}})}getSterilizationMetrics(){return ye(this,arguments,function*(t={}){try{if(!t.facilityId)return{biPassRate:0,cycleEfficiency:0,qualityScore:0};const{data:e}=yield y.from("bi_test_results").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString()),{data:r}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString());let s=100;if(e&&e.length>0){const n=Array.isArray(e)?e.filter(i=>i.result==="pass").length:0;s=Math.round(n/e.length*100)}let o=100;if(r&&r.length>0){const n=r.filter(i=>i.status==="clean").length;o=Math.round(n/r.length*100)}const d=Math.round((s+o)/2);return{biPassRate:s,cycleEfficiency:o,qualityScore:d}}catch(e){return console.error("Error getting sterilization metrics:",e),{biPassRate:0,cycleEfficiency:0,qualityScore:0}}})}getInventoryMetrics(){return ye(this,arguments,function*(t={}){try{if(!t.facilityId)return{turnoverRate:0,stockLevel:0,reorderEfficiency:0};const e=yield be.getItems();let r=e;t.facilityId&&(r=e.filter(n=>n.facility_id===t.facilityId));let s=80;if(r&&r.length>0){const n=r.filter(c=>{var u;return((u=c.status)!=null?u:"")==="active"}).length,i=r.length;i>0&&(s=Math.round(n/i*100))}let o=100;if(r&&r.length>0){const n=r.filter(i=>{var c;return i.quantity>((c=i.reorder_point)!=null?c:0)}).length;o=Math.round(n/r.length*100)}const d=Math.round((s+o)/2);return{turnoverRate:s,stockLevel:o,reorderEfficiency:d}}catch(e){return console.error("Error getting inventory metrics:",e),{turnoverRate:0,stockLevel:0,reorderEfficiency:0}}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var Ce=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class Q{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=3e5}static getInstance(){return Q.instance||(Q.instance=new Q),Q.instance}getAuditRiskScore(){return Ce(this,arguments,function*(t={}){try{const e=`audit_risk_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for audit risk score"),null;const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-10080*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s)return console.warn("Failed to fetch sterilization data for audit risk assessment"),null;const d=s.length,n=s.filter(m=>m.status!=="clean"&&m.status!=="problem").length,{data:i,error:c}=yield y.from("biological_indicators").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-10080*60*1e3).toISOString()),u=c||!i?0:Array.isArray(i)?i.filter(m=>m.status==="skipped"||m.status==="pending").length:0,h=Math.max(0,n/d*100),p=Math.min(100,Math.max(0,n/d*40+u*15+h*.4));let g;p>=80?g="critical":p>=60?g="high":p>=40?g="medium":g="low";const f={overallRiskScore:Math.round(p),riskLevel:g,riskFactors:[{factor:"Incomplete cycles",severity:Math.min(10,Math.max(1,Math.round(n/d*10))),description:`${n} sterilization cycles incomplete this week`},{factor:"Policy adherence",severity:Math.min(10,Math.max(1,Math.round((100-h)/10))),description:`Protocol adherence at ${Math.round(100-h)}%`}],skippedIndicators:u,incompleteCycles:n,policyDrift:h,recommendedActions:["Complete incomplete sterilization cycles","Review and reinforce protocol training","Monitor BI/CI test completion rates"]};return this.setCachedData(e,f),f}catch(e){return console.error("Error assessing audit risk:",e),null}})}getTrainingKnowledgeGaps(){return Ce(this,arguments,function*(t={}){try{const e=`training_gaps_${JSON.stringify(t)}`,r=this.getCachedData(e);if(r)return r;if(!t.facilityId)return console.warn("No facility ID provided for training knowledge gaps"),null;const{data:s,error:o}=yield y.from("sterilization_cycles").select("*").eq("facility_id",t.facilityId).gte("created_at",new Date(Date.now()-720*60*60*1e3).toISOString()).order("created_at",{ascending:!1});if(o||!s||s.length===0)return console.warn("No sterilization data found for training gap analysis"),null;const d=s.reduce((g,f)=>{var m,v,_,I,w,C;const b=(v=(m=f.operator_id)!=null?m:f.user_id)!=null?v:"";return b&&(g[b]||(g[b]={cycles:[],failedSteps:[],performanceMetrics:[]}),g[b].cycles.push(f),f.status!=="clean"&&g[b].failedSteps.push(`Cycle ${f.id} - ${f.status}`),f.status==="clean"&&g[b].performanceMetrics.push({cycleId:(_=f.id)!=null?_:"",duration:(I=f.duration_minutes)!=null?I:0,temperature:(w=f.temperature_celsius)!=null?w:0,pressure:(C=f.pressure_psi)!=null?C:0})),g},{}),n=Object.entries(d).map(([g,f])=>{const m=f.failedSteps.length>0,v=f.performanceMetrics.length>0?f.performanceMetrics.reduce((I,w)=>I+w.duration,0)/f.performanceMetrics.length:0;let _=[];return m?_=["Review sterilization protocols","Complete cycle documentation training","Practice emergency shutdown procedures"]:v>60?_=["Optimize cycle timing procedures","Review load preparation best practices","Efficiency improvement training"]:_=["Maintain current training standards","Advanced sterilization techniques","Quality assurance best practices"],{userId:g,userName:`User ${g}`,failedSteps:f.failedSteps.slice(0,3),skippedContent:[],recommendedTraining:_,performanceMetrics:{totalCycles:f.cycles.length,successRate:f.cycles.length>0?(f.cycles.length-f.failedSteps.length)/f.cycles.length*100:100,averageDuration:Math.round(v)}}}),i=n.length,c=n.filter(g=>g.failedSteps.length>0).length,u=i>0?n.reduce((g,f)=>g+f.performanceMetrics.successRate,0)/i:100,h=Math.min(100,Math.max(0,c/i*40+(100-u)/100*30+(i<3?20:0)+(n.some(g=>g.performanceMetrics.averageDuration>60)?10:0))),p={usersWithGaps:n,overallGapScore:Math.round(h),criticalGaps:n.filter(g=>g.failedSteps.length>2||g.performanceMetrics.successRate<80).map(()=>"Sterilization protocol adherence"),knowledgeHubRecommendations:["Review sterilization SOPs","Complete cycle documentation training","Monitor user performance metrics","Efficiency optimization training","Quality assurance procedures"]};return this.setCachedData(e,p),p}catch(e){return console.error("Error analyzing training gaps:",e),null}})}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var O=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ce{constructor(){this.cache=new Map,this.DEFAULT_CACHE_TTL=ut}static getInstance(){return ce.instance||(ce.instance=new ce),ce.instance}getToolReplacementForecast(){return O(this,arguments,function*(t={}){return Z.getInstance().getToolReplacementForecast(t)})}getAutoclaveCapacityForecast(){return O(this,arguments,function*(t={}){return ee.getInstance().getAutoclaveCapacityForecast(t)})}getInventoryInflationForecast(){return O(this,arguments,function*(t={}){return te.getInstance().getInventoryInflationForecast(t)})}getClinicalStaffingForecast(){return O(this,arguments,function*(t={}){return re.getInstance().getClinicalStaffingForecast(t)})}getAdminStaffingForecast(){return O(this,arguments,function*(t={}){return ae.getInstance().getAdminStaffingForecast(t)})}getTheftLossEstimate(){return O(this,arguments,function*(t={}){return se.getInstance().getTheftLossEstimate(t)})}getSupplyDepletionForecast(){return O(this,arguments,function*(t={}){return ie.getInstance().getSupplyDepletionForecast(t)})}getToolTurnoverUtilization(){return O(this,arguments,function*(t={}){return $.getInstance().getToolTurnoverUtilization(t)})}getAuditRiskScore(){return O(this,arguments,function*(t={}){return Q.getInstance().getAuditRiskScore(t)})}getTrainingKnowledgeGaps(){return O(this,arguments,function*(t={}){return Q.getInstance().getTrainingKnowledgeGaps(t)})}getEfficiencyROITracker(){return O(this,arguments,function*(t={}){return ne.getInstance().getEfficiencyROITracker(t)})}getIntelligenceSummary(){return O(this,arguments,function*(t={},e=!1){try{const r=`intelligence_summary_${JSON.stringify(t)}`;e&&this.clearCache("intelligence_summary");const s=this.getCachedData(r);if(s&&!e)return s;const[o,d,n,i,c,u,h,p,g,f,m,v,_]=yield Promise.all([this.getToolReplacementForecast(t),this.getAutoclaveCapacityForecast(t),this.getInventoryInflationForecast(t),this.getClinicalStaffingForecast(t),this.getAdminStaffingForecast(t),this.getTheftLossEstimate(t),this.getSupplyDepletionForecast(t),this.getToolTurnoverUtilization(t),this.getAuditRiskScore(t),this.getTrainingKnowledgeGaps(t),this.getEfficiencyROITracker(t),$.getInstance().getSterilizationMetrics(t),$.getInstance().getInventoryMetrics(t)]),I=i[0]||null,w=c[0]||null,C={toolReplacement:o,autoclaveCapacity:d,inventoryInflation:n,clinicalStaffing:I,adminStaffing:w,theftLoss:u,supplyDepletion:h,toolTurnoverUtilization:p,auditRisk:g||{overallRiskScore:0,riskLevel:"low",riskFactors:[],skippedIndicators:0,incompleteCycles:0,policyDrift:0,recommendedActions:[]},trainingGaps:f||{usersWithGaps:[],overallGapScore:0,criticalGaps:[],knowledgeHubRecommendations:[]},efficiencyROI:m||{timeSavedHours:0,estimatedLaborSavings:0,aiFeatureUsage:[],automationEfficiency:0,moduleContributions:[],projectedAnnualSavings:0},sterilization:v,inventory:_,lastUpdated:new Date().toISOString(),confidence:.89};return this.setCachedData(r,C),C}catch(r){throw console.error("Error generating intelligence summary:",r),r}})}clearCache(t){t?Array.from(this.cache.keys()).filter(r=>r.startsWith(t)).forEach(r=>this.cache.delete(r)):this.cache.clear()}getCachedData(t){const e=this.cache.get(t);return e&&Date.now()-e.timestamp<e.ttl?e.data:(this.cache.delete(t),null)}setCachedData(t,e,r=this.DEFAULT_CACHE_TTL){this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r})}}var Nt=Object.defineProperty,jt=Object.defineProperties,It=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,St=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,Ae=(l,t,e)=>t in l?Nt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,V=(l,t)=>{for(var e in t||(t={}))St.call(t,e)&&Ae(l,e,t[e]);if(De)for(var e of De(t))Ct.call(t,e)&&Ae(l,e,t[e]);return l},ue=(l,t)=>jt(l,It(t)),F=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});const qe={ttl:300*1e3,maxSize:50};class Dt{constructor(t=qe){this.cache=new Map,this.config=t}set(t,e,r){if(this.cleanup(),this.cache.size>=this.config.maxSize){const s=this.cache.keys().next().value;s&&this.cache.delete(s)}this.cache.set(t,{data:e,timestamp:Date.now(),ttl:r||this.config.ttl})}get(t){const e=this.cache.get(t);return e?Date.now()-e.timestamp>e.ttl?(this.cache.delete(t),null):e.data:null}has(t){const e=this.cache.get(t);return e?Date.now()-e.timestamp>e.ttl?(this.cache.delete(t),!1):!0:!1}clear(){this.cache.clear()}cleanup(){const t=Date.now();for(const[e,r]of this.cache.entries())t-r.timestamp>r.ttl&&this.cache.delete(e)}}const At=(l={},t)=>{const r=j.useRef(new Dt(V(V({},qe),t))).current,[s,o]=j.useState({summary:null,loading:!1,error:null,updated_at:null,confidence:0}),d=j.useMemo(()=>`forecasting_${JSON.stringify(l||{})}`,[l]),n=j.useMemo(()=>ce.getInstance(),[]),i=j.useMemo(()=>r.has(d),[r,d]),c=j.useMemo(()=>s.summary?{toolReplacement:s.summary.toolReplacement||[],autoclaveCapacity:s.summary.autoclaveCapacity||[],inventoryInflation:s.summary.inventoryInflation||[],clinicalStaffing:s.summary.clinicalStaffing||null,adminStaffing:s.summary.adminStaffing||null,theftLoss:s.summary.theftLoss||null,supplyDepletion:s.summary.supplyDepletion||[],toolTurnoverUtilization:s.summary.toolTurnoverUtilization||[],auditRisk:s.summary.auditRisk||null,trainingGaps:s.summary.trainingGaps||null,efficiencyROI:s.summary.efficiencyROI||null}:null,[s.summary]),u=j.useCallback((b=!1)=>F(null,null,function*(){if(!b&&i){const S=r.get(d);if(S){o({summary:S,loading:!1,error:null,updated_at:S.lastUpdated,confidence:S.confidence});return}}o(S=>ue(V({},S),{loading:!0,error:null}));try{const S=yield n.getIntelligenceSummary(l,b);r.set(d,S),o({summary:S,loading:!1,error:null,updated_at:S.lastUpdated,confidence:S.confidence})}catch(S){o(E=>ue(V({},E),{loading:!1,error:S instanceof Error?S.message:"Failed to fetch intelligence data"}))}}),[l,n,r,d,i]),h=j.useCallback((b,S,E)=>F(null,null,function*(){const k=`${d}_${E}`;if(r.has(k))return r.get(k);try{const L=yield S();return r.set(k,L),L}catch(L){throw console.error(`Error fetching ${b}:`,L),L}}),[r,d]),p=j.useCallback(()=>F(null,null,function*(){return h("tool replacement forecast",()=>n.getToolReplacementForecast(l),"tool_replacement")}),[h,n,l]),g=j.useCallback(()=>F(null,null,function*(){return h("autoclave capacity forecast",()=>n.getAutoclaveCapacityForecast(l),"autoclave_capacity")}),[h,n,l]),f=j.useCallback(()=>F(null,null,function*(){return h("tool turnover utilization",()=>n.getToolTurnoverUtilization(l),"tool_turnover")}),[h,n,l]),m=j.useCallback(()=>F(null,null,function*(){return h("audit risk score",()=>n.getAuditRiskScore(l),"audit_risk")}),[h,n,l]),v=j.useCallback(()=>F(null,null,function*(){return h("supply depletion forecast",()=>n.getSupplyDepletionForecast(l),"supply_depletion")}),[h,n,l]),_=j.useMemo(()=>{if(!c)return!1;const{auditRisk:b,supplyDepletion:S}=c;return(b==null?void 0:b.riskLevel)==="high"||(b==null?void 0:b.riskLevel)==="critical"||S.some(E=>E.reorderUrgency==="critical")},[c]),I=j.useMemo(()=>{var b,S;if(!c)return[];const E=[],k=c.supplyDepletion.filter(L=>L.reorderUrgency==="critical");return k.length>0&&E.push({type:"critical_supply",message:`${k.length} critical supplies need immediate reorder`,items:k}),(((b=c.auditRisk)==null?void 0:b.riskLevel)==="high"||((S=c.auditRisk)==null?void 0:S.riskLevel)==="critical")&&E.push({type:"audit_risk",message:"High audit risk detected - immediate action required",riskScore:c.auditRisk}),E},[c]),w=j.useCallback(()=>{r.clear(),o(b=>ue(V({},b),{updated_at:null}))},[r]),C=j.useCallback(()=>F(null,null,function*(){r.clear(),yield u(!0)}),[u,r]);return j.useEffect(()=>{l.facilityId&&u()},[l.facilityId,u]),ue(V({},s),{lastUpdated:s.updated_at,individualForecasts:c,isCached:i,cacheKey:d,refreshData:C,clearCache:w,fetchIntelligenceSummary:u,getToolReplacementForecast:p,getAutoclaveCapacityForecast:g,getToolTurnoverUtilization:f,getAuditRiskScore:m,getSupplyDepletionForecast:v,hasHighRiskItems:_,getUrgentActions:I})};function Et(l){return l.sort((t,e)=>{const r={critical:4,high:3,medium:2,low:1},s=r[e.priority]-r[t.priority];return s!==0?s:e.confidence-t.confidence})}function Lt(l){return l.sort((t,e)=>e.priority-t.priority)}function Tt(l){return l.sort((t,e)=>{const r={critical:3,high:2,medium:1,low:0};return r[e.severity]-r[t.severity]})}function kt(l){return{cost_optimization:"cost_savings",risk_mitigation:"risk_mitigation",efficiency_improvement:"efficiency",training_needed:"training",capacity_planning:"capacity",compliance_issue:"compliance"}[l]||"efficiency"}function Rt(l,t){const e=(l+t)/2;return e>.9?"critical":e>.8?"high":e>.7?"medium":"low"}function Ot(l){var t;return l.recommendation_reason||`AI analysis suggests ${((t=l.content_context)==null?void 0:t.category)||"optimization"} opportunities based on your usage patterns.`}function Pt(l){const t=Number(l.recommendation_score)||.5;return{costSavings:t*1e3,timeSavings:t*2,riskReduction:t*50,efficiencyGain:t*30}}function zt(l){return l.recommendation_type&&console.debug("AI recommendation type available for action items"),["Review AI-generated insights","Implement suggested optimizations","Monitor performance improvements","Provide feedback for learning"]}function Mt(l){const t=l.recommendation_score||.5;return t>.9?"Immediate":t>.8?"1-2 weeks":t>.7?"2-4 weeks":"1-2 months"}function Ft(l){return l.feature_vector&&console.debug("Feature vector available for metrics extraction"),["ai_confidence","user_behavior","performance_patterns"]}function Ht(l){return l>.9?"critical":l>.8?"high":l>.7?"medium":"low"}var xe=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class G{static generateHybridRecommendations(t,e,r){return xe(this,null,function*(){var s,o;const d=[];return r&&console.debug("User insights available for recommendations"),e.forEach(n=>{var i;n.recommendation_score>.7&&d.push({id:`ai_${n.id}`,type:kt(n.recommendation_type),priority:Rt(n.recommendation_score,n.confidence_level),title:n.recommendation_reason||"AI-Generated Recommendation",description:Ot(n),impact:Pt(n),actionItems:zt(n),timeline:Mt(n),confidence:n.confidence_level||.8,category:((i=n.content_context)==null?void 0:i.category)||"general",relatedMetrics:Ft(n)})}),((s=t.auditRisk)==null?void 0:s.riskLevel)==="critical"&&d.push(this.createCriticalAuditRecommendation(t)),(o=t.supplyDepletion)!=null&&o.some(n=>n.reorderUrgency==="critical")&&d.push(this.createCriticalSupplyRecommendation(t)),d})}static generateAIOptimizationTips(t,e,r){return xe(this,null,function*(){const s=[];return e&&(e.skill_gaps||[]).forEach((d,n)=>{s.push({id:`ai_skill_gap_${n}`,category:"compliance",title:`Address Skill Gap: ${d}`,description:`AI analysis indicates a skill gap in ${d} that may impact performance.`,currentState:`Current skill level: ${e.learning_efficiency_score||70}%`,recommendedAction:"Complete targeted training modules and practice exercises",expectedOutcome:`Improve ${d} proficiency by 25%`,difficulty:"medium",estimatedEffort:"2-3 weeks",priority:8})}),r!=null&&r.efficiency_score&&r.efficiency_score<80&&s.push({id:"ai_efficiency_optimization",category:"sterilization",title:"Optimize Workflow Efficiency",description:"AI analysis shows workflow efficiency below optimal levels.",currentState:`Current efficiency: ${(r==null?void 0:r.efficiency_score)||70}%`,recommendedAction:"Review and optimize high-frequency workflows",expectedOutcome:"Increase efficiency by 15-20%",difficulty:"medium",estimatedEffort:"3-4 weeks",priority:7}),s})}static generateIntelligentRiskAlerts(t,e,r){return xe(this,null,function*(){var s;const o=[];return r&&console.debug("Risk patterns available for analysis"),e.forEach(d=>{d.risk_score>.8&&o.push({id:`ai_risk_${d.id}`,severity:Ht(d.risk_score),title:d.risk_title||"AI-Detected Risk",description:d.risk_description||"AI analysis has identified a potential risk.",riskFactors:d.risk_factors||[],immediateActions:d.immediate_actions||[],longTermSolutions:d.long_term_solutions||[],escalationPath:d.escalation_path||"Notify supervisor",deadline:d.deadline||"48 hours",status:"open"})}),((s=t.auditRisk)==null?void 0:s.riskLevel)==="critical"&&o.push(this.createCriticalAuditAlert(t)),o})}static generateFallbackRecommendations(t){var e;const r=[];return((e=t.auditRisk)==null?void 0:e.riskLevel)==="critical"&&r.push({id:"fallback_audit_risk",type:"compliance",priority:"critical",title:"Critical Audit Risk Mitigation Required",description:`Overall audit risk score: ${t.auditRisk.overallRiskScore}/100.`,impact:{riskReduction:60,costSavings:5e3},actionItems:["Complete missing BI logs immediately","Review incomplete cycles"],timeline:"1 week",confidence:.88,category:"compliance",relatedMetrics:["audit_scores","compliance_rates"]}),r}static generateFallbackOptimizationTips(t){var e;const r=[];return((e=t.sterilization)==null?void 0:e.biPassRate)<95&&r.push({id:"fallback_sterilization_optimization",category:"sterilization",title:"Improve BI Test Pass Rates",description:"BI test pass rates below optimal levels indicate potential issues.",currentState:`Current BI pass rate: ${t.sterilization.biPassRate}%`,recommendedAction:"Review sterilization parameters and implement quality checks",expectedOutcome:"Increase BI pass rate to 95%+",difficulty:"medium",estimatedEffort:"2-3 weeks",priority:8}),r}static generateFallbackRiskAlerts(t){var e;const r=[];return((e=t.auditRisk)==null?void 0:e.riskLevel)==="critical"&&r.push({id:"fallback_high_audit_risk",severity:"critical",title:"High Audit Risk Alert",description:`Audit risk score: ${t.auditRisk.overallRiskScore}/100.`,riskFactors:["Skipped BI indicators","Incomplete cycles"],immediateActions:["Complete missing documentation","Review procedures"],longTermSolutions:["Implement monitoring","Enhance training"],escalationPath:"Notify quality assurance team",deadline:"48 hours",status:"open"}),r}static createCriticalAuditRecommendation(t){var e,r,s;return{id:"critical_audit_risk_mitigation",type:"compliance",priority:"critical",title:"Critical Audit Risk Mitigation Required",description:`Overall audit risk score: ${(e=t.auditRisk)==null?void 0:e.overallRiskScore}/100. ${(r=t.auditRisk)==null?void 0:r.skippedIndicators} skipped indicators and ${(s=t.auditRisk)==null?void 0:s.incompleteCycles} incomplete cycles detected.`,impact:{riskReduction:60,costSavings:5e3},actionItems:["Complete missing BI logs immediately","Review incomplete cycle procedures","Reinforce protocol training","Implement daily compliance checks"],timeline:"1 week",confidence:.88,category:"compliance",relatedMetrics:["audit_scores","compliance_rates","protocol_adherence"]}}static createCriticalSupplyRecommendation(t){var e;const r=((e=t.supplyDepletion)==null?void 0:e.filter(s=>s.reorderUrgency==="critical"))||[];return{id:"critical_supply_alert",type:"risk_mitigation",priority:"critical",title:`Critical Supply Alert: ${r.length} Items`,description:`${r.length} critical supplies will deplete within 7 days, risking operational disruption.`,impact:{costSavings:r.reduce((s,o)=>s+Number(o.currentCost||0)*.2,0),riskReduction:95},actionItems:["Place emergency orders immediately","Contact alternative suppliers","Implement usage restrictions","Notify clinical staff"],timeline:"Immediate",confidence:.95,category:"inventory_management",relatedMetrics:["stock_levels","usage_rates","supplier_performance"]}}static createCriticalAuditAlert(t){var e;return{id:"critical_audit_risk_alert",severity:"critical",title:"Critical Audit Risk Alert",description:`Audit risk score: ${(e=t.auditRisk)==null?void 0:e.overallRiskScore}/100. Multiple compliance issues detected requiring immediate attention.`,riskFactors:["Skipped BI indicators","Incomplete sterilization cycles","Policy drift detected"],immediateActions:["Complete missing documentation immediately","Review and complete incomplete cycles","Reinforce protocol adherence","Schedule compliance review meeting"],longTermSolutions:["Implement automated compliance monitoring","Enhance staff training programs","Establish quality assurance processes","Create compliance dashboard"],escalationPath:"Notify quality assurance team and department director",deadline:"24 hours",status:"open"}}}G.aiLearningService=new Me;var Ke=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});function Ut(){return Ke(this,null,function*(){try{return[]}catch(l){return console.error("Error getting AI risk predictions:",l),[]}})}function $t(){return Ke(this,null,function*(){try{return null}catch(l){return console.error("Error getting historical risk patterns:",l),null}})}function Ee(){return{efficiency_score:85,time_saved:120,points:150,difficulty:"medium",category:"general"}}var oe=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});function Gt(){return oe(this,null,function*(){try{const{data:l,error:t}=yield y.from("ai_content_recommendations").select("*").eq("is_displayed",!0).order("recommendation_score",{ascending:!1}).limit(20);return t?(console.error("Error fetching AI recommendations:",t),[]):l||[]}catch(l){return console.error("Error getting AI recommendations:",l),[]}})}function qt(){return oe(this,null,function*(){try{const{data:{user:l}}=yield y.auth.getUser();if(!l)return null;const{data:t,error:e}=yield y.from("ai_learning_insights").select("*").eq("user_id",l.id).single();return e&&e.code!=="PGRST116"?(console.error("Error fetching user insights:",e),null):t}catch(l){return console.error("Error getting user behavior insights:",l),null}})}function Kt(){return oe(this,null,function*(){try{const{data:{user:l}}=yield y.auth.getUser();if(!l)return null;const{data:t,error:e}=yield y.from("ai_task_performance").select("*").eq("user_id",l.id).order("completed_at",{ascending:!1}).limit(10);return e&&e.code!=="PGRST116"?(console.error("Error fetching performance patterns:",e),Ee()):(t==null?void 0:t[0])||Ee()}catch(l){return console.error("Error getting user performance patterns:",l),null}})}function Qt(){return oe(this,null,function*(){try{const{data:{user:l}}=yield y.auth.getUser();if(!l)return .5;const{data:t,error:e}=yield y.from("ai_learning_insights").select("ai_confidence_score").eq("user_id",l.id).single();return e&&e.code!=="PGRST116"?(console.error("Error fetching AI confidence score:",e),.5):Number(t==null?void 0:t.ai_confidence_score)||.5}catch(l){return console.error("Error getting AI confidence score:",l),.5}})}function Yt(){return oe(this,null,function*(){try{const{data:{user:l}}=yield y.auth.getUser();if(!l)return null;const{data:t,error:e}=yield y.from("knowledge_hub_user_progress").select("*").eq("user_id",l.id);return e&&e.code!=="PGRST116"?(console.error("Error fetching learning progress:",e),null):{totalCompleted:((t==null?void 0:t.filter(r=>r.status==="completed"))||[]).length,totalInProgress:((t==null?void 0:t.filter(r=>r.status==="in_progress"))||[]).length,averageScore:(t||[]).reduce((r,s)=>r+(Number(s.score)||0),0)/((t==null?void 0:t.length)||1)||0}}catch(l){return console.error("Error getting learning progress metrics:",l),null}})}var me=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class le{static generateRecommendations(t){return me(this,null,function*(){try{const e=yield Gt(),r=yield qt(),s=yield G.generateHybridRecommendations(t,e,r);return Et(s)}catch(e){return console.error("Error generating AI recommendations:",e),G.generateFallbackRecommendations(t)}})}static generateOptimizationTips(t){return me(this,null,function*(){try{const e=yield this.aiLearningService.getLearningInsights(),r=yield Kt(),s=yield G.generateAIOptimizationTips(t,e,r);return Lt(s)}catch(e){return console.error("Error generating AI optimization tips:",e),G.generateFallbackOptimizationTips(t)}})}static generateRiskAlerts(t){return me(this,null,function*(){try{const e=yield Ut(),r=yield $t(),s=yield G.generateIntelligentRiskAlerts(t,e,r);return Tt(s)}catch(e){return console.error("Error generating AI risk alerts:",e),G.generateFallbackRiskAlerts(t)}})}static getActionableInsights(t){return me(this,null,function*(){const e=yield this.generateRecommendations(t),r=yield this.generateOptimizationTips(t),s=yield this.generateRiskAlerts(t),o=yield Qt();return{totalRecommendations:e.length,criticalItems:e.filter(d=>d.priority==="critical").length,highPriorityItems:e.filter(d=>d.priority==="high").length,totalTips:r.length,totalAlerts:s.length,criticalAlerts:s.filter(d=>d.severity==="critical").length,estimatedSavings:e.reduce((d,n)=>d+(n.impact.costSavings||0),0),estimatedTimeSavings:e.reduce((d,n)=>d+(n.impact.timeSavings||0),0),aiConfidence:o,learningProgress:yield Yt()}})}}le.aiLearningService=new Me;var Bt=Object.defineProperty,Vt=Object.defineProperties,Wt=Object.getOwnPropertyDescriptors,Le=Object.getOwnPropertySymbols,Jt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,Te=(l,t,e)=>t in l?Bt(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e,ke=(l,t)=>{for(var e in t||(t={}))Jt.call(t,e)&&Te(l,e,t[e]);if(Le)for(var e of Le(t))Xt.call(t,e)&&Te(l,e,t[e]);return l},Re=(l,t)=>Vt(l,Wt(t)),D=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class A{getKnowledgeArticles(){return D(this,null,function*(){const{data:t,error:e}=yield y.from("knowledge_articles").select("*").eq("status","published").order("published_at",{ascending:!1});if(e)throw console.error("Error fetching knowledge articles:",e),new Error(`Failed to fetch knowledge articles: ${e.message}`);return(t||[]).map(s=>({id:s.id,title:s.title,content:s.content,category:s.category_id,status:s.status,created_at:s.created_at,updated_at:s.updated_at,published_at:s.published_at,summary:s.summary,tags:s.tags}))})}updateArticleStatus(t,e){return D(this,null,function*(){const{error:r}=yield y.from("knowledge_articles").update({status:e,updated_at:new Date().toISOString()}).eq("id",t);return{error:r==null?void 0:r.message}})}bulkUpdateArticlesStatus(t,e){return D(this,null,function*(){if(!t||t.length===0)return{success:!1,updatedCount:0,processedCount:0,errors:["No articles provided"]};const{error:r,count:s}=yield y.from("knowledge_articles").update({status:e,updated_at:new Date().toISOString()}).in("id",t).select("id");return r?{success:!1,updatedCount:0,processedCount:t.length,errors:[r.message]}:{success:!0,updatedCount:s||0,processedCount:t.length,errors:[]}})}deleteArticles(t){return D(this,null,function*(){if(!t||t.length===0)return{success:!1,deletedCount:0,processedCount:0,errors:["No articles provided"]};const{error:e,count:r}=yield y.from("knowledge_articles").update({status:"archived",updated_at:new Date().toISOString()}).in("id",t).select("id");return e?{success:!1,deletedCount:0,processedCount:t.length,errors:[e.message]}:{success:!0,deletedCount:r||0,processedCount:t.length,errors:[]}})}getLearningPathways(){return D(this,null,function*(){const{data:t,error:e}=yield y.from("knowledge_learning_paths").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(e)throw console.error("Error fetching learning pathways:",e),new Error(`Failed to fetch learning pathways: ${e.message}`);return(t||[]).map(s=>({id:s.id,title:s.title,description:s.description,steps:[],status:s.is_active?"active":"inactive",created_at:s.created_at,updated_at:s.updated_at,difficulty_level:s.difficulty,estimated_time:parseInt(s.estimated_time)||0}))})}updateLearningPathStatus(t,e){return D(this,null,function*(){const{error:r}=yield y.from("knowledge_learning_paths").update({is_active:e,updated_at:new Date().toISOString()}).eq("id",t);return{error:r==null?void 0:r.message}})}bulkUpdateLearningPathsStatus(t,e){return D(this,null,function*(){if(!t||t.length===0)return{success:!1,updatedCount:0,processedCount:0,errors:["No pathways provided"]};const{error:r,count:s}=yield y.from("knowledge_learning_paths").update({is_active:e,updated_at:new Date().toISOString()}).in("id",t).select("id");return r?{success:!1,updatedCount:0,processedCount:t.length,errors:[r.message]}:{success:!0,updatedCount:s||0,processedCount:t.length,errors:[]}})}deleteLearningPaths(t){return D(this,null,function*(){if(!t||t.length===0)return{success:!1,deletedCount:0,processedCount:0,errors:["No pathways provided"]};const{error:e,count:r}=yield y.from("knowledge_learning_paths").update({is_active:!1,updated_at:new Date().toISOString()}).in("id",t).select("id");return e?{success:!1,deletedCount:0,processedCount:t.length,errors:[e.message]}:{success:!0,deletedCount:r||0,processedCount:t.length,errors:[]}})}getArticleById(t){return D(this,null,function*(){const{data:e,error:r}=yield y.from("knowledge_articles").select("*").eq("id",t).single();if(r)return{error:r.message};if(!e)return{error:"Article not found"};const s=e;return{data:{id:s.id,title:s.title,content:s.content,category:s.category_id,status:s.status,created_at:s.created_at,updated_at:s.updated_at,published_at:s.published_at,summary:s.summary,tags:s.tags}}})}getLearningPathById(t){return D(this,null,function*(){const{data:e,error:r}=yield y.from("knowledge_learning_paths").select("*").eq("id",t).single();if(r)return{error:r.message};if(!e)return{error:"Learning path not found"};const s=e;return{data:{id:s.id,title:s.title,description:s.description,steps:[],status:s.is_active?"active":"inactive",created_at:s.created_at,updated_at:s.updated_at,difficulty_level:s.difficulty,estimated_time:parseInt(s.estimated_time)||0}}})}getKnowledgeCategories(){return D(this,null,function*(){const{data:t,error:e}=yield y.from("knowledge_categories").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(e)throw console.error("Error fetching knowledge categories:",e),new Error(`Failed to fetch knowledge categories: ${e.message}`);return t||[]})}createArticle(t){return D(this,null,function*(){try{const{data:e,error:r}=yield y.from("knowledge_articles").insert([{title:t.title,content:t.content,summary:t.summary,category_id:t.category,tags:t.tags,status:t.status,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();return r?{error:r.message}:{article:e}}catch(e){return{error:e instanceof Error?e.message:"Failed to create article"}}})}updateArticle(t,e){return D(this,null,function*(){try{const{data:r,error:s}=yield y.from("knowledge_articles").update(Re(ke({},e),{updated_at:new Date().toISOString()})).eq("id",t).select().single();return s?{error:s.message}:{article:r}}catch(r){return{error:r instanceof Error?r.message:"Failed to update article"}}})}deleteArticle(t){return D(this,null,function*(){try{const{error:e}=yield y.from("knowledge_articles").update({status:"archived",updated_at:new Date().toISOString()}).eq("id",t);return{error:e==null?void 0:e.message}}catch(e){return{error:e instanceof Error?e.message:"Failed to delete article"}}})}createLearningPath(t){return D(this,null,function*(){try{const{data:e,error:r}=yield y.from("knowledge_learning_paths").insert([{title:t.title,description:t.description,category:t.category,difficulty:t.difficulty,estimated_time:t.estimated_time,is_active:t.is_active,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();return r?{error:r.message}:{pathway:e}}catch(e){return{error:e instanceof Error?e.message:"Failed to create learning path"}}})}updateLearningPath(t,e){return D(this,null,function*(){try{const{data:r,error:s}=yield y.from("knowledge_learning_paths").update(Re(ke({},e),{updated_at:new Date().toISOString()})).eq("id",t).select().single();return s?{error:s.message}:{pathway:r}}catch(r){return{error:r instanceof Error?r.message:"Failed to update learning path"}}})}deleteLearningPath(t){return D(this,null,function*(){try{const{error:e}=yield y.from("knowledge_learning_paths").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",t);return{error:e==null?void 0:e.message}}catch(e){return{error:e instanceof Error?e.message:"Failed to delete learning path"}}})}addCategory(t){return D(this,null,function*(){try{const{data:e,error:r}=yield y.from("knowledge_categories").insert([{name:t,is_active:!0,sort_order:999,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();return r?{error:r.message}:{category:e}}catch(e){return{error:e instanceof Error?e.message:"Failed to add category"}}})}deleteCategory(t){return D(this,null,function*(){try{const{error:e}=yield y.from("knowledge_categories").update({is_active:!1,updated_at:new Date().toISOString()}).eq("name",t);return{error:e==null?void 0:e.message}}catch(e){return{error:e instanceof Error?e.message:"Failed to delete category"}}})}getRecentUserActivity(t,e){return D(this,null,function*(){try{let r=y.from("activity_feed").select("*").order("created_at",{ascending:!1});t&&(r=r.eq("user_id",t)),e?r=r.limit(e):r=r.limit(50);const{data:s,error:o}=yield r;return o?(console.error("Error fetching recent user activity:",o),[]):s||[]}catch(r){return console.error("Failed to get recent user activity:",r),[]}})}}const ge=l=>["Courses","Procedures","Policies","Learning Pathways","Advanced"].includes(l)?l:"Courses";var W=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class q{static getKnowledgeArticles(){return W(this,null,function*(){try{return(yield new A().getKnowledgeArticles()).map(r=>({id:r.id,title:r.title,category:ge(r.category||"Courses"),status:"draft",dueDate:r.published_at||new Date().toISOString(),progress:0,lastUpdated:r.updated_at||new Date().toISOString(),description:r.summary||"",tags:r.tags||[],createdAt:r.created_at||new Date().toISOString()}))}catch(t){throw console.error("Failed to get knowledge articles:",t),t}})}static getKnowledgeArticleById(t){return W(this,null,function*(){try{const r=yield new A().getArticleById(t);if(r.error||!r.data)return null;const s=r.data;return{id:s.id,title:s.title,category:ge(s.category||"Courses"),status:"draft",dueDate:s.published_at||new Date().toISOString(),progress:0,lastUpdated:s.updated_at||new Date().toISOString(),description:s.summary||"",tags:s.tags||[],createdAt:s.created_at||new Date().toISOString()}}catch(e){throw console.error("Failed to get knowledge article by ID:",e),e}})}static createKnowledgeArticle(t){return W(this,null,function*(){try{const r=yield new A().createArticle({title:t.title,content:t.description||"",summary:t.description||"",category:t.category,tags:t.tags||[],status:"draft"});if(r.error)throw new Error(r.error);if(!r.article)throw new Error("Failed to create article");return{id:r.article.id,title:r.article.title,category:ge(r.article.category||"Courses"),status:r.article.status,dueDate:r.article.published_at||new Date().toISOString(),progress:0,lastUpdated:r.article.updated_at,description:r.article.summary,tags:r.article.tags,createdAt:r.article.created_at}}catch(e){throw console.error("Failed to create knowledge article:",e),e}})}static updateKnowledgeArticle(t,e){return W(this,null,function*(){try{const r=new A,s={};e.title&&(s.title=e.title),e.description&&(s.summary=e.description),e.category&&(s.category_id=e.category),e.tags&&(s.tags=e.tags),e.status&&(s.status=e.status==="review"?"published":"draft");const o=yield r.updateArticle(t,s);if(o.error)throw new Error(o.error);if(!o.article)throw new Error("No article returned from update");return{id:o.article.id,title:o.article.title,category:ge(o.article.category),status:o.article.status,dueDate:o.article.published_at||new Date().toISOString(),progress:0,description:o.article.summary,tags:o.article.tags,createdAt:o.article.created_at,lastUpdated:o.article.updated_at}}catch(r){throw console.error("Failed to update knowledge article:",r),r}})}static deleteKnowledgeArticle(t){return W(this,null,function*(){try{const r=yield new A().deleteArticle(t);if(r.error)throw new Error(r.error)}catch(e){throw console.error("Failed to delete knowledge article:",e),e}})}static updateContentStatus(t,e){return W(this,null,function*(){try{const r=new A;let s;switch(e){case"review":s="review";break;case"published":s="published";break;default:s="draft"}const o=yield r.updateArticleStatus(t,s);if(o.error)throw new Error(o.error)}catch(r){throw console.error("Failed to update content status:",r),r}})}}var he=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class pe{static bulkUpdateContentStatus(t,e){return he(this,null,function*(){var r;try{const s=new A;let o;switch(e){case"review":o="review";break;case"published":o="published";break;default:o="draft"}const d=yield s.bulkUpdateArticlesStatus(t,o);return{success:d.success,processedCount:d.processedCount,successCount:d.updatedCount||0,errorCount:((r=d.errors)==null?void 0:r.length)||0,errors:d.errors||[]}}catch(s){throw console.error("Failed to bulk update content status:",s),s}})}static bulkDeleteContent(t){return he(this,null,function*(){var e;try{const s=yield new A().deleteArticles(t);return{success:s.success,processedCount:s.processedCount,successCount:s.deletedCount||0,errorCount:((e=s.errors)==null?void 0:e.length)||0,errors:s.errors||[]}}catch(r){throw console.error("Failed to bulk delete content:",r),r}})}static bulkUpdateLearningPathStatus(t,e){return he(this,null,function*(){var r;try{const o=yield new A().bulkUpdateLearningPathsStatus(t,e);return{success:o.success,processedCount:o.processedCount,successCount:o.updatedCount||0,errorCount:((r=o.errors)==null?void 0:r.length)||0,errors:o.errors||[]}}catch(s){throw console.error("Failed to bulk update learning path status:",s),s}})}static bulkDeleteLearningPathways(t){return he(this,null,function*(){var e;try{const s=yield new A().deleteLearningPaths(t);return{success:s.success,processedCount:s.processedCount,successCount:s.deletedCount||0,errorCount:((e=s.errors)==null?void 0:e.length)||0,errors:s.errors||[]}}catch(r){throw console.error("Failed to bulk delete learning pathways:",r),r}})}}var J=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class K{static getLearningPathways(){return J(this,null,function*(){try{return(yield new A().getLearningPathways()).map(r=>({id:r.id,title:r.title,category:"Learning Pathways",status:"draft",dueDate:r.created_at||new Date().toISOString(),progress:0,lastUpdated:r.updated_at,description:r.description,createdAt:r.created_at}))}catch(t){throw console.error("Failed to get learning pathways:",t),t}})}static getLearningPathwayById(t){return J(this,null,function*(){try{const r=yield new A().getLearningPathById(t);if(r.error||!r.data)return null;const s=r.data;return{id:s.id,title:s.title,category:"Learning Pathways",status:"draft",dueDate:s.created_at||new Date().toISOString(),progress:0,lastUpdated:s.updated_at,description:s.description,createdAt:s.created_at}}catch(e){throw console.error("Failed to get learning pathway by ID:",e),e}})}static createLearningPathway(t){return J(this,null,function*(){try{const e=new A,r={title:t.title,description:t.description||"",category:t.category,difficulty:"beginner",estimated_time:"30 minutes",is_active:!0},s=yield e.createLearningPath(r);if(s.error)throw new Error(s.error);if(!s.pathway)throw new Error("No pathway returned from creation");return{id:s.pathway.id,title:s.pathway.title,category:s.pathway.category,status:"draft",dueDate:new Date().toISOString(),progress:0,description:s.pathway.description,createdAt:s.pathway.created_at,lastUpdated:s.pathway.updated_at}}catch(e){throw console.error("Failed to create learning pathway:",e),e}})}static updateLearningPathway(t,e){return J(this,null,function*(){try{const r=new A,s={};e.title&&(s.title=e.title),e.description&&(s.description=e.description),e.category&&(s.category=e.category);const o=yield r.updateLearningPath(t,s);if(o.error)throw new Error(o.error);if(!o.pathway)throw new Error("No pathway returned from update");return{id:o.pathway.id,title:o.pathway.title,category:o.pathway.category,status:"draft",dueDate:new Date().toISOString(),progress:0,description:o.pathway.description,createdAt:o.pathway.created_at,lastUpdated:o.pathway.updated_at}}catch(r){throw console.error("Failed to update learning pathway:",r),r}})}static deleteLearningPathway(t){return J(this,null,function*(){try{const r=yield new A().deleteLearningPath(t);if(r.error)throw new Error(r.error)}catch(e){throw console.error("Failed to delete learning pathway:",e),e}})}static updateLearningPathStatus(t,e){return J(this,null,function*(){try{const s=yield new A().updateLearningPathStatus(t,e);if(s.error)throw new Error(s.error)}catch(r){throw console.error("Failed to update learning path status:",r),r}})}}var ve=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class _e{static getKnowledgeCategories(){return ve(this,null,function*(){try{return(yield new A().getKnowledgeCategories()).map(r=>r.name)}catch(t){throw console.error("Failed to get knowledge categories:",t),t}})}static addCategory(t){return ve(this,null,function*(){try{const r=yield new A().addCategory(t);if(r.error)throw new Error(r.error);if(!r.category)throw new Error("No category returned from creation");return r.category.name}catch(e){throw console.error("Failed to add category:",e),e}})}static deleteCategory(t){return ve(this,null,function*(){try{const r=yield new A().deleteCategory(t);if(r.error)throw new Error(r.error)}catch(e){throw console.error("Failed to delete category:",e),e}})}}var H=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class U{static getQuizzes(){return H(this,null,function*(){try{const{QuizService:t}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return(yield t.getAllQuizzes()).map(r=>({id:r.id,title:r.title,category:"Courses",status:r.is_active?"published":"draft",dueDate:r.created_at,progress:0,lastUpdated:r.updated_at,description:r.description||"Interactive quiz to test knowledge",tags:["quiz","assessment","knowledge-test"],createdAt:r.created_at,type:"quiz",contentType:"quiz",domain:"knowledge-assessment",isActive:r.is_active,estimatedDuration:r.time_limit_minutes||15,difficultyLevel:"medium",mandatoryRepeat:!1,passingScore:r.passing_score}))}catch(t){return console.error("Failed to get quizzes:",t),[]}})}static getQuizById(t){return H(this,null,function*(){try{const{QuizService:e}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield e.getQuizWithQuestions(t)}catch(e){return console.error("Failed to get quiz by ID:",e),null}})}static startQuizAttempt(t){return H(this,null,function*(){try{const{QuizService:e}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield e.startQuizAttempt(t)}catch(e){return console.error("Failed to start quiz attempt:",e),null}})}static submitQuizAnswers(t,e){return H(this,null,function*(){try{const{QuizService:r}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield r.submitQuizAttempt(t,e)}catch(r){return console.error("Failed to submit quiz answers:",r),{success:!1,score:0,passed:!1}}})}static getUserQuizAttempts(){return H(this,null,function*(){try{const{QuizService:t}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield t.getUserQuizAttempts()}catch(t){return console.error("Failed to get user quiz attempts:",t),[]}})}static createQuiz(t){return H(this,null,function*(){try{const{QuizService:e}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield e.createQuiz(t)}catch(e){return console.error("Failed to create quiz:",e),null}})}static updateQuiz(t,e){return H(this,null,function*(){try{const{QuizService:r}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield r.updateQuiz(t,e)}catch(r){return console.error("Failed to update quiz:",r),null}})}static deleteQuiz(t){return H(this,null,function*(){try{const{QuizService:e}=yield M(()=>import("./quizService-ykesnD9-.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]));return yield e.deleteQuiz(t)}catch(e){return console.error("Failed to delete quiz:",e),!1}})}}var Oe=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class Pe{static getRecentUserActivity(t,e){return Oe(this,null,function*(){try{return yield new A().getRecentUserActivity(t,e)}catch(r){throw console.error("Failed to get recent user activity:",r),r}})}static getAllContent(){return Oe(this,null,function*(){try{const[t,e]=yield Promise.all([q.getKnowledgeArticles(),K.getLearningPathways()]);return[...t,...e]}catch(t){throw console.error("Failed to get all content:",t),t}})}}var N=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class ze{static getKnowledgeArticles(){return N(this,null,function*(){return q.getKnowledgeArticles()})}static getKnowledgeArticleById(t){return N(this,null,function*(){return q.getKnowledgeArticleById(t)})}static createKnowledgeArticle(t){return N(this,null,function*(){return q.createKnowledgeArticle(t)})}static updateKnowledgeArticle(t,e){return N(this,null,function*(){return q.updateKnowledgeArticle(t,e)})}static deleteKnowledgeArticle(t){return N(this,null,function*(){return q.deleteKnowledgeArticle(t)})}static updateContentStatus(t,e){return N(this,null,function*(){return q.updateContentStatus(t,e)})}static bulkUpdateContentStatus(t,e){return N(this,null,function*(){return pe.bulkUpdateContentStatus(t,e)})}static bulkDeleteContent(t){return N(this,null,function*(){return pe.bulkDeleteContent(t)})}static getLearningPathways(){return N(this,null,function*(){return K.getLearningPathways()})}static getLearningPathwayById(t){return N(this,null,function*(){return K.getLearningPathwayById(t)})}static createLearningPathway(t){return N(this,null,function*(){return K.createLearningPathway(t)})}static updateLearningPathway(t,e){return N(this,null,function*(){return K.updateLearningPathway(t,e)})}static deleteLearningPathway(t){return N(this,null,function*(){return K.deleteLearningPathway(t)})}static updateLearningPathStatus(t,e){return N(this,null,function*(){return K.updateLearningPathStatus(t,e)})}static bulkUpdateLearningPathStatus(t,e){return N(this,null,function*(){return pe.bulkUpdateLearningPathStatus(t,e)})}static bulkDeleteLearningPathways(t){return N(this,null,function*(){return pe.bulkDeleteLearningPathways(t)})}static getKnowledgeCategories(){return N(this,null,function*(){return _e.getKnowledgeCategories()})}static addCategory(t){return N(this,null,function*(){return _e.addCategory(t)})}static deleteCategory(t){return N(this,null,function*(){return _e.deleteCategory(t)})}static getAllContent(){return N(this,null,function*(){return Pe.getAllContent()})}static getRecentUserActivity(t,e){return N(this,null,function*(){return Pe.getRecentUserActivity(t,e)})}static getQuizzes(){return N(this,null,function*(){return U.getQuizzes()})}static getQuizById(t){return N(this,null,function*(){return U.getQuizById(t)})}static startQuizAttempt(t){return N(this,null,function*(){return U.startQuizAttempt(t)})}static submitQuizAnswers(t,e){return N(this,null,function*(){return U.submitQuizAnswers(t,e)})}static getUserQuizAttempts(){return N(this,null,function*(){return U.getUserQuizAttempts()})}static createQuiz(t){return N(this,null,function*(){return U.createQuiz(t)})}static updateQuiz(t,e){return N(this,null,function*(){return U.updateQuiz(t,e)})}static deleteQuiz(t){return N(this,null,function*(){return U.deleteQuiz(t)})}}var P=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});class Zt{static getKnowledgeHubContent(t,e,r=10){return P(this,null,function*(){try{return(yield ze.getKnowledgeArticles()).filter(n=>t.includes(n.category.toLowerCase())&&e.some(i=>n.title.toLowerCase().includes(i.toLowerCase())||n.category.toLowerCase().includes(i.toLowerCase()))).map(n=>({contentId:n.id,title:n.title,category:n.category.toLowerCase(),relevance:this.calculateRelevance(n,e),lastUpdated:n.lastUpdated||new Date().toISOString(),url:`/knowledge-hub/${n.category.toLowerCase()}/${n.id}`})).sort((n,i)=>i.relevance-n.relevance).slice(0,r)}catch(s){return console.error("Error fetching Knowledge Hub content:",s),[]}})}static getAuditTrail(t,e,r,s=50){return P(this,null,function*(){try{const{data:{user:o}}=yield y.auth.getUser();if(!o)throw new Error("User not authenticated");const{data:d}=yield y.from("users").select("facility_id").eq("id",o.id).single(),n=(d==null?void 0:d.facility_id)||"550e8400-e29b-41d4-a716-446655440000";let i=y.from("audit_logs").select("*").eq("facility_id",n).order("timestamp",{ascending:!1}).limit(s);t&&(i=i.eq("user_id",t)),e&&(i=i.ilike("action",`%${e}%`)),r&&(i=i.gte("timestamp",r.startDate).lte("timestamp",r.endDate));const{data:c,error:u}=yield i;return u?(console.error("Error fetching audit trail:",u),[]):!c||c.length===0?[]:c.map(p=>{var g,f;return{actionId:String(p.id),timestamp:p.timestamp,userId:p.user_id,userName:(g=p.user_name)!=null?g:"Unknown User",action:p.action,details:p.metadata?JSON.stringify(p.metadata):"",impact:this.determineImpact(p.action),status:(f=p.status)!=null?f:"completed"}})}catch(o){return console.error("Error fetching audit trail:",o),[]}})}static pushKnowledgeHubNotification(t,e,r){return P(this,null,function*(){try{const{data:s}=yield y.from("users").select("facility_id").eq("id",t).single(),o=(s==null?void 0:s.facility_id)||"550e8400-e29b-41d4-a716-446655440000",{error:d}=yield y.from("audit_logs").insert({user_id:t,facility_id:o,action:"Knowledge Hub Notification",details:`Notification for content ${e}: ${r}`,timestamp:new Date().toISOString(),module:"knowledge_hub"});return d?(console.error("Error logging notification:",d),!1):!0}catch(s){return console.error("Error pushing Knowledge Hub notification:",s),!1}})}static scheduleSupplierContact(t,e,r){return P(this,null,function*(){try{const{data:{user:s}}=yield y.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:o}=yield y.from("users").select("facility_id").eq("id",s.id).single(),d=(o==null?void 0:o.facility_id)||"550e8400-e29b-41d4-a716-446655440000",{error:n}=yield y.from("audit_logs").insert({user_id:s.id,facility_id:d,action:"Supplier Contact Scheduled",details:`${e} contact with supplier ${t}, priority: ${r}`,timestamp:new Date().toISOString(),module:"supplier_management"});return n?(console.error("Error logging supplier contact:",n),!1):!0}catch(s){return console.error("Error scheduling supplier contact:",s),!1}})}static getIntegrationMetrics(){return P(this,null,function*(){try{const[t,e,r]=yield Promise.all([this.getKnowledgeHubCount(),this.getActiveSupplierCount(),this.getRecentAuditCount()]);return{knowledgeHubArticles:t,activeSuppliers:e,recentAuditActions:r,integrationHealth:this.calculateIntegrationHealth(t,e,r),lastSync:new Date().toISOString()}}catch(t){return console.error("Error fetching integration metrics:",t),{knowledgeHubArticles:0,activeSuppliers:0,recentAuditActions:0,integrationHealth:0,lastSync:new Date().toISOString()}}})}static syncAllIntegrations(){return P(this,null,function*(){try{return yield Promise.all([this.syncKnowledgeHub(),this.syncSupplierDatabase(),this.syncAuditTrail()]),!0}catch(t){return console.error("Error during integration sync:",t),!1}})}static calculateRelevance(t,e){let r=50;return e.forEach(s=>{var o,d,n;(o=t.title)!=null&&o.toLowerCase().includes(s.toLowerCase())&&(r+=20),(d=t.category)!=null&&d.toLowerCase().includes(s.toLowerCase())&&(r+=15),t.tags&&((n=t.tags)!=null&&n.some(i=>i.toLowerCase().includes(s.toLowerCase())))&&(r+=10)}),Math.min(r,100)}static calculateCostCompetitiveness(t,e){const s=Math.min(e/1e3,2);return Math.min(7*s,10)}static determineImpact(t){const e=["sterilization","bi test","critical","emergency"],r=["inventory","training","maintenance"],s=t.toLowerCase();return e.some(o=>s.includes(o))?"high":r.some(o=>s.includes(o))?"medium":"low"}static getKnowledgeHubCount(){return P(this,null,function*(){try{return(yield ze.getKnowledgeArticles()).length}catch(t){return console.error(t),0}})}static getActiveSupplierCount(){return P(this,null,function*(){try{const{data:t,error:e}=yield y.from("information_schema.tables").select("table_name").eq("table_name","inventory_suppliers").single();return(e||!t)&&console.log("📊 inventory_suppliers table not found, using default count"),5}catch(t){return console.log("📊 Exception fetching supplier count:",t),5}})}static getRecentAuditCount(){return P(this,null,function*(){try{const{data:{user:t}}=yield y.auth.getUser();if(!t)return 0;const{data:e}=yield y.from("users").select("facility_id").eq("id",t.id).single(),r=(e==null?void 0:e.facility_id)||"550e8400-e29b-41d4-a716-446655440000",s=new Date;s.setDate(s.getDate()-30);const{count:o,error:d}=yield y.from("audit_logs").select("*",{count:"exact",head:!0}).eq("facility_id",r).gte("created_at",s.toISOString());return d?0:o!=null?o:0}catch(t){return console.error(t),0}})}static calculateIntegrationHealth(t,e,r){const s=Math.min(t/10,1)*30,o=Math.min(e/20,1)*30,d=Math.min(r/50,1)*40;return Math.round(s+o+d)}static syncKnowledgeHub(){return P(this,null,function*(){yield new Promise(t=>setTimeout(t,500))})}static syncSupplierDatabase(){return P(this,null,function*(){yield new Promise(t=>setTimeout(t,500))})}static syncAuditTrail(){return P(this,null,function*(){yield new Promise(t=>setTimeout(t,500))})}static getFallbackSuppliers(t,e){return[{supplierId:"fallback-1",name:"Medical Supply Co.",category:t,rating:4.5,deliveryTime:3,costCompetitiveness:8,reliability:9,contactInfo:{email:"contact@medsupply.com",phone:"+1-555-0123",website:"https://medsupply.com"}},{supplierId:"fallback-2",name:"Clinical Equipment Ltd.",category:t,rating:4.2,deliveryTime:5,costCompetitiveness:7.5,reliability:8.5,contactInfo:{email:"sales@clinicalequip.com",phone:"+1-555-0456",website:"https://clinicalequip.com"}}].slice(0,e)}}var er=(l,t,e)=>new Promise((r,s)=>{var o=i=>{try{n(e.next(i))}catch(c){s(c)}},d=i=>{try{n(e.throw(i))}catch(c){s(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(o,d);n((e=e.apply(l,t)).next())});function lr(){const[l,t]=j.useState("overview"),[e,r]=j.useState([]),[s,o]=j.useState([]),[d,n]=j.useState(null),[i,c]=j.useState([]),[u,h]=j.useState(null),{getCurrentFacilityId:p}=Qe(),g=p(),f=j.useMemo(()=>({facilityId:g||""}),[g]),{summary:m,loading:v,lastUpdated:_,refreshData:I}=At(f);j.useEffect(()=>{m&&er(null,null,function*(){try{const b=yield le.generateRecommendations(m),S=yield le.generateOptimizationTips(m),E=yield le.generateRiskAlerts(m),k=yield le.getActionableInsights(m);r(b||[]),o(S||[]),c(E||[]),h(k||null),Zt.getIntegrationMetrics().then(L=>n(L))}catch(b){console.error("Error generating insights:",b)}})},[m]);function w(C){switch(C){case"forecasting":return a.jsx(nt,{summary:m});case"risks":return a.jsx(ct,{summary:m});case"actions":return a.jsx(lt,{summary:m,recommendations:e,optimizationTips:s});case"insights":return a.jsx(ot,{summary:m,recommendations:e,optimizationTips:s,insightsSummary:u});case"integrations":return a.jsx(dt,{summary:m,integrationMetrics:d});case"overview":return a.jsx(it,{summary:m,actionableInsights:i});default:return null}}return a.jsx(Ye,{children:a.jsxs("div",{style:{padding:"2rem"},children:[a.jsx(rt,{loading:v,lastUpdated:_,onRefresh:I}),a.jsx(at,{activeTab:l,onTabChange:t}),a.jsx("div",{style:{marginTop:"1rem"},children:w(l)})]})})}export{lr as default};
