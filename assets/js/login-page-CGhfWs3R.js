const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/components-CI6m6L5v.js","assets/js/react-vendor-BgCjxHGT.js","assets/js/data-vendor-C88t-X3A.js","assets/js/vendor-jNhfZCZ0.js","assets/js/services-CE_LtFqr.js","assets/js/inventory-pages-Dx6mSDHp.js","assets/js/ui-vendor-mgcSnJSc.js","assets/css/ui-vendor-DJSy8M6b.css","assets/js/utils-vendor-CxPd0XhF.js","assets/js/knowledgehub-pages-w63GWyRJ.js","assets/css/components-B4OH_j2L.css"])))=>i.map(i=>d[i]);
import{b as q,r as h,j as e,k as Z,S as V,w as y,T as J}from"./react-vendor-BgCjxHGT.js";import{g as K,h as L,i as Q,E as X,_ as ee,L as re,j,k as A,l as se,m as H,n as U}from"./components-CI6m6L5v.js";import{ab as G,S as te,ac as M,ad as ne,ae}from"./services-CE_LtFqr.js";import"./data-vendor-C88t-X3A.js";import"./vendor-jNhfZCZ0.js";import"./ui-vendor-mgcSnJSc.js";import"./utils-vendor-CxPd0XhF.js";import"./inventory-pages-Dx6mSDHp.js";import"./knowledgehub-pages-w63GWyRJ.js";const O={rememberMe:"Remember me",rememberDevice:"Remember device"},g={PROGRESS_STEPS:{IDLE:"idle",CONNECTING:"connecting",AUTHENTICATING:"authenticating",VERIFYING:"verifying",SUCCESS:"success"},REDIRECT_DELAY_MS:1e3,MIN_PASSWORD_LENGTH:6,OTP_LENGTH:6},Y={unexpectedError:"An unexpected error occurred. Please try again.",offline:"You are currently offline. Please check your internet connection."};var le=Object.defineProperty,oe=Object.defineProperties,ie=Object.getOwnPropertyDescriptors,W=Object.getOwnPropertySymbols,ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable,B=(r,t,s)=>t in r?le(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ue=(r,t)=>{for(var s in t||(t={}))ce.call(t,s)&&B(r,s,t[s]);if(W)for(var s of W(t))de.call(t,s)&&B(r,s,t[s]);return r},me=(r,t)=>oe(r,ie(t)),xe=(r,t,s)=>new Promise((o,l)=>{var a=n=>{try{u(s.next(n))}catch(m){l(m)}},i=n=>{try{u(s.throw(n))}catch(m){l(m)}},u=n=>n.done?o(n.value):Promise.resolve(n.value).then(a,i);u((s=s.apply(r,t)).next())});const he=()=>{const r=q(),{refreshUserData:t}=K(),{formData:s,errors:o,loading:l,setField:a,setErrors:i,setLoading:u,setAuthToken:n,setSessionExpiry:m,csrfToken:S,incrementFailedAttempts:w,resetFailedAttempts:E,isSecureMode:k}=L(),[T,b]=h.useState(""),P=h.useCallback(d=>f=>{const p=d==="rememberMe"||d==="rememberDevice"?f.target.checked:f.target.value;a(d,p),o[d]&&i(me(ue({},o),{[d]:""}))},[o,a,i]),x=(d,f,p,_,F=!1,v=!1)=>xe(null,null,function*(){var z;if(!l){if(i({}),u(!0),k&&!p()){i({submit:"Security validation failed. Please refresh the page and try again."}),u(!1);return}try{G("attempt",{email:d,timestamp:new Date().toISOString()});const R=!1;if(v)try{console.log("ðŸ” Checking if device is already trusted...")}catch(D){console.warn("Failed to check trusted device:",D)}const N=yield new te().secureLogin({email:d,password:f,rememberMe:F});if(N.success&&N.data){b(g.PROGRESS_STEPS.VERIFYING);const D=new Date(Date.now()+N.data.expiresIn*1e3).toISOString();n(N.data.accessToken),m(D);try{yield t()}catch(C){console.warn("Failed to refresh user data:",C)}if(v)try{const C=M.generateDeviceFingerprint(),$=(z=N.data.user)==null?void 0:z.id;$&&((yield M.isDeviceTrusted($))?console.log("âœ… Device already trusted"):(yield M.storeTrustedDevice($,C),console.log("âœ… Device marked as trusted")))}catch(C){console.warn("Failed to store trusted device:",C)}G("success",{email:d,timestamp:new Date().toISOString()}),_("login_success",d),E(),b(g.PROGRESS_STEPS.SUCCESS),setTimeout(()=>{r("/home")},g.REDIRECT_DELAY_MS)}else throw new Error(N.error||"Authentication failed")}catch(R){console.error("Secure login error:",R),w();const I=R instanceof Error?R.message:Y.unexpectedError;i({submit:I}),G("failure",{email:d,error:I,timestamp:new Date().toISOString()}),_("login_failure",d,I)}finally{u(!1),b("")}}}),c=h.useCallback(()=>{console.log("Forgot password clicked")},[]);return{formData:s,errors:o,loading:l,loadingStep:T,handleChange:P,handleSubmit:x,handleForgotPassword:c}},fe=()=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mt-6 text-center text-3xl font-extrabold text-gray-500",children:"Welcome to Cliniio"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),ge=()=>e.jsx(Q,{}),pe=({formData:r,handleChange:t,disabled:s=!1})=>{const o=h.useRef(null),[l,a]=h.useState(!1);h.useEffect(()=>{o.current&&!s&&o.current.focus()},[s]);const i=m=>m.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.trim())?null:"Please enter a valid email address":"Email is required",u=m=>{t("email")(m),a(!0)},n=l?i(r.email):null;return e.jsxs("div",{children:[e.jsx("span",{id:"emailHelp",className:"sr-only",children:"Enter your email address."}),e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Z,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,disabled:s,"aria-label":"Email address","aria-describedby":"emailHelp",className:`appearance-none rounded-lg relative block w-full px-3 py-3 pl-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 focus:z-10 sm:text-sm transition-colors duration-200 ${n?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${s?"opacity-50 cursor-not-allowed bg-gray-100":""}`,placeholder:"Email address",value:r.email,onChange:u,onBlur:()=>a(!0),ref:o})]}),n&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:n})]})]})},be=({password:r})=>{const s=(l=>{let a=0;const i={length:l.length>=8,lowercase:/[a-z]/.test(l),uppercase:/[A-Z]/.test(l),numbers:/\d/.test(l),symbols:/[!@#$%^&*(),.?":{}|<>]/.test(l),noRepeating:!/(.)\1{2,}/.test(l),noSequential:!/(?:abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz|012|123|234|345|456|567|678|789)/i.test(l)};return i.length&&(a+=2),i.lowercase&&(a+=1),i.uppercase&&(a+=1),i.numbers&&(a+=1),i.symbols&&(a+=1),i.noRepeating&&(a+=1),i.noSequential&&(a+=1),l.length>=12&&(a+=1),l.length>=16&&(a+=1),a>=8?{level:"Excellent",score:a,color:"text-emerald-600",bgColor:"bg-emerald-500",barColor:"bg-emerald-500"}:a>=6?{level:"Strong",score:a,color:"text-green-600",bgColor:"bg-green-500",barColor:"bg-green-500"}:a>=4?{level:"Good",score:a,color:"text-yellow-600",bgColor:"bg-yellow-500",barColor:"bg-yellow-500"}:a>=2?{level:"Fair",score:a,color:"text-orange-600",bgColor:"bg-orange-500",barColor:"bg-orange-500"}:{level:"Weak",score:a,color:"text-red-600",bgColor:"bg-red-500",barColor:"bg-red-500"}})(r),o=10;return r.length===0?null:e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Password Strength"}),e.jsx("span",{className:`text-sm font-semibold ${s.color}`,children:s.level})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ease-out ${s.barColor}`,style:{width:`${s.score/o*100}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-3",children:[e.jsxs("span",{children:["Score: ",s.score,"/",o]}),e.jsxs("span",{className:s.color,children:[Math.round(s.score/o*100),"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[r.length>=8?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${r.length>=8?"text-green-700":"text-gray-500"}`,children:"At least 8 characters"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[a-z]/.test(r)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[a-z]/.test(r)?"text-green-700":"text-gray-500"}`,children:"Lowercase letter"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[A-Z]/.test(r)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[A-Z]/.test(r)?"text-green-700":"text-gray-500"}`,children:"Uppercase letter"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/\d/.test(r)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/\d/.test(r)?"text-green-700":"text-gray-500"}`,children:"Number"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[!@#$%^&*(),.?":{}|<>]/.test(r)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[!@#$%^&*(),.?":{}|<>]/.test(r)?"text-green-700":"text-gray-500"}`,children:"Special character"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[r.length>=12?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${r.length>=12?"text-green-700":"text-gray-500"}`,children:"At least 12 characters (bonus)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/(.)\1{2,}/.test(r)?e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}):e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}),e.jsx("span",{className:`text-xs ${/(.)\1{2,}/.test(r)?"text-gray-500":"text-green-700"}`,children:"No repeating characters"})]})]}),s.score<6&&e.jsx("div",{className:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded text-xs text-amber-800",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-500 mt-0.5 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tip:"})," Try adding uppercase letters, numbers, and special characters to make your password stronger."]})]})})]})},ve=({formData:r,handleChange:t,disabled:s=!1,showStrengthIndicator:o=!1})=>{const[l,a]=h.useState(!1),i=m=>m?m.length<8?"Password must be at least 8 characters long":null:"Password is required",u=m=>{t("password")(m),a(!0)},n=l?i(r.password):null;return e.jsxs("div",{children:[e.jsx("span",{id:"passwordHelp",className:"sr-only",children:"Enter your account password."}),e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(J,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,disabled:s,"aria-label":"Password","aria-describedby":"passwordHelp",className:`appearance-none rounded-lg relative block w-full px-3 py-3 pl-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 focus:z-10 sm:text-sm transition-colors duration-200 ${n?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${s?"opacity-50 cursor-not-allowed bg-gray-100":""}`,placeholder:"Password",value:r.password,onChange:u,onBlur:()=>a(!0)})]}),o&&e.jsx(be,{password:r.password}),n&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:n})]})]})},ye=({formData:r,handleChange:t,disabled:s=!1})=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",disabled:s,"aria-label":O.rememberMe,checked:r.rememberMe,onChange:t("rememberMe"),className:`h-4 w-4 text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 rounded transition-colors duration-200 ${s?"opacity-50 cursor-not-allowed":""}`}),e.jsx("label",{htmlFor:"remember-me",className:`ml-2 block text-sm transition-colors duration-200 ${s?"text-gray-500":"text-gray-900"}`,children:O.rememberMe})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-device",name:"remember-device",type:"checkbox",disabled:s,"aria-label":O.rememberDevice,checked:r.rememberDevice,onChange:t("rememberDevice"),className:`h-4 w-4 text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 rounded transition-colors duration-200 ${s?"opacity-50 cursor-not-allowed":""}`}),e.jsx("label",{htmlFor:"remember-device",className:`ml-2 block text-sm transition-colors duration-200 ${s?"text-gray-500":"text-gray-900"}`,children:O.rememberDevice})]})]})}),je=({formData:r,handleChange:t,disabled:s=!1})=>{const[o,l]=h.useState(!1),a=n=>n?n.length!==6?"Verification code must be 6 digits":/^\d{6}$/.test(n)?null:"Verification code must contain only numbers":"Verification code is required",i=n=>{t("otp")(n),l(!0)},u=o?a(r.otp||""):null;return r.stage!=="otp"?null:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"sr-only",children:"One-time code"}),e.jsx("input",{id:"otp",name:"otp",type:"text",maxLength:6,disabled:s,placeholder:"Enter 6-digit code",value:r.otp||"",onChange:i,onBlur:()=>l(!0),className:`appearance-none rounded-lg relative block w-full px-3 py-3 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 sm:text-sm transition-colors duration-200 ${u?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${s?"opacity-50 cursor-not-allowed bg-gray-100":""}`}),u&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:u})]})]})},Ne=({warnings:r=[]})=>h.useMemo(()=>!r||r.length===0?null:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Warning"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.map((s,o)=>e.jsx("li",{children:s},o))})})]})]})}),[r]),Se=({isOnline:r=!0})=>r?null:e.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-amber-800 font-medium",children:Y.offline})})]})});var we=(r,t,s)=>new Promise((o,l)=>{var a=n=>{try{u(s.next(n))}catch(m){l(m)}},i=n=>{try{u(s.throw(n))}catch(m){l(m)}},u=n=>n.done?o(n.value):Promise.resolve(n.value).then(a,i);u((s=s.apply(r,t)).next())});const Ee=h.lazy(()=>ee(()=>import("./components-CI6m6L5v.js").then(r=>r.aA),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ke=()=>e.jsx("div",{className:"rounded-lg border p-4 bg-red-50 border-red-200",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-sm text-red-800",children:"Loading error handler..."})})}),Ge=()=>{const{formData:r,errors:t,loading:s,handleChange:o,handleSubmit:l,handleForgotPassword:a}=he(),{csrfToken:i,isSecureMode:u,isOffline:n,clearError:m,setError:S}=L(),w=E=>we(null,null,function*(){if(E.preventDefault(),m(),n){S("You are offline. Please reconnect before logging in.");return}if(!r.email.trim()||!r.password.trim())return;const k=r.email.trim().toLowerCase(),T=r.password,b=()=>u?!!i&&i.length>0:!0,P=(x,c,d)=>{console.log(`[SECURITY] ${x} for user: ${c}`,d?`Reason: ${d}`:"")};try{yield l(k,T,b,P,r.rememberMe,r.rememberDevice)}catch(x){S(x instanceof Error?x.message:"Unknown login error.")}});return e.jsx(X,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsx(fe,{}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:w,children:[u&&i&&e.jsx("input",{type:"hidden",name:"csrfToken",value:i}),e.jsxs("fieldset",{disabled:n,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(pe,{formData:r,handleChange:o,disabled:s}),e.jsx(ve,{formData:r,handleChange:o,disabled:s,showStrengthIndicator:!1}),e.jsx(ye,{formData:r,handleChange:o,disabled:s})]}),r.stage==="otp"&&e.jsx(je,{formData:r,handleChange:o,disabled:s}),e.jsx(Ne,{}),e.jsx(Se,{}),t.submit&&e.jsx(h.Suspense,{fallback:e.jsx(ke,{}),children:e.jsx(Ee,{error:t.submit,context:"login",onRetry:()=>{L.getState().setErrors({})},onDismiss:()=>{L.getState().setErrors({})}})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:s,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Sign in"})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:a,className:"text-sm text-blue-600 hover:text-blue-500 focus:outline-none focus:underline",children:"Forgot your password?"})}),!1]})]}),e.jsx(ge,{})]})})})},Me=()=>e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"mt-4 inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx("svg",{className:"w-3 h-3 mr-1.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Login Enabled"]})}),Ve=({loading:r,loadingStep:t})=>{const s=o=>{switch(o){case g.PROGRESS_STEPS.CONNECTING:return"progress-bar-25";case g.PROGRESS_STEPS.AUTHENTICATING:return"progress-bar-50";case g.PROGRESS_STEPS.VERIFYING:return"progress-bar-75";case g.PROGRESS_STEPS.SUCCESS:return"progress-bar-100";default:return"progress-bar-0"}};return!r||t===g.PROGRESS_STEPS.IDLE?null:e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:[t===g.PROGRESS_STEPS.CONNECTING&&"Connecting to server...",t===g.PROGRESS_STEPS.AUTHENTICATING&&"Authenticating credentials...",t===g.PROGRESS_STEPS.VERIFYING&&"Verifying session...",t===g.PROGRESS_STEPS.SUCCESS&&"Login successful! Redirecting..."]}),e.jsx("div",{className:"mt-2 w-full bg-blue-200 rounded-full h-2",children:e.jsx("div",{className:`bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out ${s(t)}`})})]})]})})},ze=({loading:r,loadingStep:t})=>r?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-600",children:[e.jsx(re,{size:"sm"}),e.jsx("span",{children:t||"Processing..."})]}):null;function Te(r,t){const s=h.useRef();return h.useCallback((...l)=>{s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{r(...l)},t)},[r,t])}var Pe=(r,t,s)=>new Promise((o,l)=>{var a=n=>{try{u(s.next(n))}catch(m){l(m)}},i=n=>{try{u(s.throw(n))}catch(m){l(m)}},u=n=>n.done?o(n.value):Promise.resolve(n.value).then(a,i);u((s=s.apply(r,t)).next())});const He=()=>{const[r,t]=h.useState(""),[s,o]=h.useState([]),[l,a]=h.useState(null),[i,u]=h.useState(!1);h.useEffect(()=>{const c=setTimeout(()=>{const d=j.getStoredToken();if(d)t(d);else{const f=j.generateToken();t(f),j.storeToken(f)}},0);return()=>clearTimeout(c)},[]);const n=(x,c)=>{A()&&console.warn(`[SECURITY] ${x}:`,c);const d=A()?c:{event_type:x,timestamp:new Date().toISOString(),has_details:Object.keys(c).length>0};ne({event:"security_event",timestamp:new Date().toISOString(),metadata:d})};h.useEffect(()=>{(()=>{const c=window.location.protocol==="https:"||window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";u(c),!c&&!A()&&n("non_https_connection",{protocol:window.location.protocol,hostname:window.location.hostname})})()},[]);const m=(x,c)=>{const d=[];if(x.trim()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x.trim())||d.push("Please enter a valid email address."),c?c.length<6&&d.push("Password must be at least 6 characters long."):d.push("Password must be at least 6 characters long."),d.length>0)return{isValid:!1,email:x.trim(),password:c,errors:d};const f=H(x,"email"),p=H(c,"password");if(!f||!p)return{isValid:!1,email:f,password:p,errors:["Invalid email or password format"]};const _=U(f),F=U(p),v=[..._.threats,...F.threats];return v.length>0?(o(v),n("suspicious_input_detected",{email:f,threats:v}),{isValid:!1,email:f,password:p,errors:v}):(o([]),{isValid:!0,email:f,password:p,errors:[]})},S=Te(((x,c)=>m(x,c)),se.VALIDATION.DEBOUNCE_MS),w=(x,c)=>m(x,c),E=x=>{const c=j.getStoredToken(),d=j.validateToken(x,c||"");if(!d){n("csrf_validation_failed",{providedToken:x,storedToken:c});const f=j.refreshToken();t(f)}return d},k=x=>Pe(null,null,function*(){try{const c=yield ae.checkRateLimit(x);return a(c),c.isLocked&&n("rate_limit_exceeded",{email:x,lockoutTime:c.lockoutTime}),c}catch(c){return console.error("Rate limit check failed:",c),{isLocked:!1,remainingAttempts:5}}}),T=()=>{o([])},b=()=>{j.clearToken(),t("")},P=h.useMemo(()=>{const x=s.length>0;return(l==null?void 0:l.isLocked)||!1?"locked":x?"warning":"secure"},[s,l]);return{csrfToken:r,securityWarnings:s,rateLimitInfo:l,isHttps:i,validateInputs:w,debouncedValidateInputs:S,validateCsrfToken:E,checkRateLimit:k,clearSecurityWarnings:T,clearCsrfToken:b,logSecurityEvent:n,getSecurityStatus:P}};export{ye as CheckboxFields,pe as EmailField,ze as LoadingIndicator,Ge as LoginPage,Ve as LoginProgressIndicator,Se as OfflineWarning,je as OtpField,ve as PasswordField,be as PasswordStrengthIndicator,Me as SecurityStatusIndicator,Ne as SecurityWarnings,Ge as default,he as useLoginForm,He as useLoginSecurity};
