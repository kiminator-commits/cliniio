var d=Object.defineProperty,h=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,p=(n,e,t)=>e in n?d(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,m=(n,e)=>{for(var t in e||(e={}))f.call(e,t)&&p(n,t,e[t]);if(h)for(var t of h(e))y.call(e,t)&&p(n,t,e[t]);return n},r=(n,e,t)=>new Promise((a,u)=>{var l=s=>{try{o(t.next(s))}catch(i){u(i)}},c=s=>{try{o(t.throw(s))}catch(i){u(i)}},o=s=>s.done?a(s.value):Promise.resolve(s.value).then(l,c);o((t=t.apply(n,e)).next())});function v(n){return n.type==="api"&&"baseUrl"in n}class I{constructor(e){this.isInitialized=!1,this.config=m({timeout:1e4,retryAttempts:3},e)}initialize(){return r(this,null,function*(){try{const e=yield this.makeRequest("GET","/health");if(!e.ok)throw new Error(`API health check failed: ${e.statusText}`);this.isInitialized=!0}catch(e){throw console.error("Failed to initialize API adapter:",e),e}})}isConnected(){return this.isInitialized}disconnect(){return r(this,null,function*(){this.isInitialized=!1})}fetchAllInventoryData(){return r(this,null,function*(){const t=yield(yield this.makeRequest("GET","/inventory")).json();return{data:t.items||[],error:null,count:t.totalCount||0}})}fetchInventoryItems(){return r(this,null,function*(){return(yield this.makeRequest("GET","/inventory/items")).json()})}fetchCategories(){return r(this,null,function*(){return(yield this.makeRequest("GET","/inventory/categories")).json()})}addInventoryItem(e){return r(this,null,function*(){return(yield this.makeRequest("POST","/inventory/items",e)).json()})}updateInventoryItem(e,t){return r(this,null,function*(){return(yield this.makeRequest("PUT",`/inventory/items/${e}`,t)).json()})}deleteInventoryItem(e){return r(this,null,function*(){yield this.makeRequest("DELETE",`/inventory/items/${e}`)})}addCategory(e){return r(this,null,function*(){return(yield(yield this.makeRequest("POST","/inventory/categories",{name:e})).json()).id||e})}deleteCategory(e){return r(this,null,function*(){yield this.makeRequest("DELETE",`/inventory/categories/${e}`)})}batchAddItems(e){return r(this,null,function*(){return(yield this.makeRequest("POST","/inventory/items/batch",{items:e})).json()})}batchUpdateItems(e){return r(this,null,function*(){return(yield this.makeRequest("PUT","/inventory/items/batch",{updates:e})).json()})}batchDeleteItems(e){return r(this,null,function*(){yield this.makeRequest("DELETE","/inventory/items/batch",{ids:e})})}sync(){return r(this,null,function*(){return Promise.resolve()})}getLastSyncTime(){return new Date}hasPendingChanges(){return!1}getLastError(){return null}clearError(){}searchItems(e){return r(this,null,function*(){return(yield this.makeRequest("GET",`/inventory/search?q=${encodeURIComponent(e)}`)).json()})}getMetadata(){return{name:"API Adapter",version:"1.0.0",description:"Adapter for external API data sources",capabilities:{supportsRead:!0,supportsWrite:!0,supportsDelete:!0,supportsBatch:!0,supportsRealTime:!1,supportsOffline:!1},config:this.config}}makeRequest(e,t,a){return r(this,null,function*(){if(!this.isInitialized)throw new Error("API adapter not initialized");const u=`${this.config.baseUrl}${t}`,l={"Content-Type":"application/json"};this.config.apiKey&&(l.Authorization=`Bearer ${this.config.apiKey}`);const c={method:e,headers:l,signal:AbortSignal.timeout(this.config.timeout)};a&&(c.body=JSON.stringify(a));let o=null;for(let s=1;s<=this.config.retryAttempts;s++)try{const i=yield fetch(u,c);if(!i.ok)throw new Error(`API request failed: ${i.status} ${i.statusText}`);return i}catch(i){o=i instanceof Error?i:new Error("Unknown error"),s<this.config.retryAttempts&&(console.warn(`API request attempt ${s} failed, retrying...`,o.message),yield this.delay(Math.pow(2,s)*1e3))}throw o||new Error("API request failed after all retry attempts")})}delay(e){return new Promise(t=>setTimeout(t,e))}}export{I as ApiAdapter,v as isApiAdapterConfig};
