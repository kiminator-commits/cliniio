import{D as d}from"./main-FsBT3Y_8.js";import{t as o,l as r}from"./login-em2Hs6UG.js";import"./utils-DSBVV_PW.js";import"./vendor-DoALFvsH.js";import"./data-73RVSc-N.js";import"./errors-CsB9ZK3e.js";import"./ui-CbhfWbfq.js";var l=(s,e,t)=>new Promise((i,a)=>{var u=c=>{try{n(t.next(c))}catch(h){a(h)}},y=c=>{try{n(t.throw(c))}catch(h){a(h)}},n=c=>c.done?i(c.value):Promise.resolve(c.value).then(u,y);n((t=t.apply(s,e)).next())});class f{constructor(){this.CACHE_DURATION=300,this.FACILITY_KEY_PREFIX="facility",this.cache=new d("facility")}getFacility(e){return l(this,null,function*(){try{const t=`${this.FACILITY_KEY_PREFIX}:${e}`,i=yield this.cache.get(t);return i&&this.isCacheValid(i)?(o()&&Math.random()<.1&&r.debug(`Facility cache hit for ID: ${e}`),i.facility):(i&&(yield this.cache.del(t)),null)}catch(t){return r.error("Error getting facility from cache:",t),null}})}setFacility(e,t){return l(this,null,function*(){try{const i=`${this.FACILITY_KEY_PREFIX}:${e}`,a={facility:t,timestamp:Date.now()};yield this.cache.set(i,a,{ttl:this.CACHE_DURATION}),o()&&Math.random()<.1&&r.debug(`Facility cached for ID: ${e}`)}catch(i){r.error("Error setting facility in cache:",i)}})}invalidateFacility(e){return l(this,null,function*(){try{const t=`${this.FACILITY_KEY_PREFIX}:${e}`;yield this.cache.del(t),r.debug(`Facility cache invalidated for ID: ${e}`)}catch(t){r.error("Error invalidating facility cache:",t)}})}clearAll(){return l(this,null,function*(){try{yield this.cache.clear(),r.info("All facility cache cleared")}catch(e){r.error("Error clearing facility cache:",e)}})}isCacheValid(e){return Date.now()-e.timestamp<this.CACHE_DURATION*1e3}getStats(){return this.cache.getStats()}cleanup(){this.cache.cleanup()}}const _=new f;export{f as DistributedFacilityCache,_ as distributedFacilityCache};
