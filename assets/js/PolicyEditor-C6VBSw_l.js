import{j as c}from"./utils-DSBVV_PW.js";import{a as t}from"./vendor-DoALFvsH.js";import{p as ae,a as ve,s as Te,b as je,t as Ce,c as Fe,m as Pe,d as _e,Z as Q,u as Ne,C as Ee,T as De,M as Ie,e as Oe,f as Re}from"./index-CfgcXfYE.js";import{I as U,c as q,r as Be}from"./errors-CsB9ZK3e.js";import"./main-FsBT3Y_8.js";import"./login-em2Hs6UG.js";import"./data-73RVSc-N.js";import"./ui-CbhfWbfq.js";function $e(s){const[r,e]=t.useState("Inter"),[m,f]=t.useState("text-base"),[l,h]=t.useState("text-gray-900"),w=t.useCallback(()=>{e("Inter"),f("text-base"),h("text-gray-900")},[s]),u=t.useCallback(()=>document.getElementById("content-main-tab"),[]),x=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=a.selectionEnd,P=o.substring(n,g),T=o.substring(0,n)+`**${P}**`+o.substring(g);b(T),setTimeout(()=>{a.focus(),a.setSelectionRange(n+2,g+2)},0)}},[u]),y=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=a.selectionEnd,P=o.substring(n,g),T=o.substring(0,n)+`*${P}*`+o.substring(g);b(T),setTimeout(()=>{a.focus(),a.setSelectionRange(n+1,g+1)},0)}},[u]),S=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
## `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+5,n+5)},0)}},[u]),j=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
### `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+5,n+5)},0)}},[u]),C=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
- `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+3,n+3)},0)}},[u]),F=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
1. `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+4,n+4)},0)}},[u]),k=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
> **Note:** `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+12,n+12)},0)}},[u]),i=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
⚠️ **Warning:** `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+15,n+15)},0)}},[u]),p=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=o.substring(0,n)+`
✅ **Check:** `+o.substring(n);b(g),setTimeout(()=>{a.focus(),a.setSelectionRange(n+13,n+13)},0)}},[u]),d=t.useCallback((o,b)=>{const a=u();if(a){const n=a.selectionStart,g=a.selectionEnd,P=o.substring(n,g);let T=P,_="";if(P?_=prompt(`Enter URL for "${P}":`,"https://")||"":(T=prompt("Enter link text:","Link")||"",T&&(_=prompt("Enter URL:","https://")||"")),_&&_.trim()&&T){const D=o.substring(0,n)+`[${T}](${_})`+o.substring(g);b(D),setTimeout(()=>{a.focus(),a.setSelectionRange(n+T.length+3,n+T.length+3)},0)}}},[u]);return{fontFamily:r,fontSize:m,textColor:l,setFontFamily:e,setFontSize:f,setTextColor:h,resetFormatting:w,formatBold:x,formatItalic:y,formatHeading2:S,formatHeading3:j,formatBulletList:C,formatNumberedList:F,addNote:k,addWarning:i,addCheck:p,insertLink:d}}function Ve(s){const[r,e]=t.useState(!1),[m,f]=t.useState([["","",""],["","",""],["","",""]]),[l,h]=t.useState(["Column 1","Column 2","Column 3"]),w=t.useCallback(()=>{const k=[...l,`Column ${l.length+1}`];h(k);const i=m.map(p=>[...p,""]);f(i)},[l,m]),u=t.useCallback(k=>{if(l.length>1){const i=l.filter((d,o)=>o!==k);h(i);const p=m.map(d=>d.filter((o,b)=>b!==k));f(p)}},[l,m]),x=t.useCallback(()=>{const k=[...m,new Array(l.length).fill("")];f(k)},[m,l.length]),y=t.useCallback(k=>{if(m.length>1){const i=m.filter((p,d)=>d!==k);f(i)}},[m]),S=t.useCallback((k,i,p)=>{const d=[...m];d[k][i]=p,f(d)},[m]),j=t.useCallback((k,i)=>{const p=[...l];p[k]=i,h(p)},[l]),C=t.useCallback((k,i)=>{const p=document.getElementById("content-main-tab");if(p){const d=p.selectionStart;let o=`

`;o+="| "+l.join(" | ")+` |
`,o+="|"+l.map(()=>"---").join("|")+`|
`,m.forEach(a=>{o+="| "+a.map(n=>n||" ").join(" | ")+` |
`}),o+=`
`;const b=k.substring(0,d)+o+k.substring(d);i(b),e(!1),setTimeout(()=>{p.focus(),p.setSelectionRange(d+o.length,d+o.length)},0)}},[l,m]),F=t.useCallback(()=>{f([["","",""],["","",""],["","",""]]),h(["Column 1","Column 2","Column 3"]),e(!1)},[]);return{showTableBuilder:r,tableData:m,tableHeaders:l,setShowTableBuilder:e,setTableData:f,setTableHeaders:h,addTableColumn:w,removeTableColumn:u,addTableRow:x,removeTableRow:y,updateTableCell:S,updateTableHeader:j,insertTableIntoContent:C,resetTable:F}}var Ae=(s,r,e)=>new Promise((m,f)=>{var l=u=>{try{w(e.next(u))}catch(x){f(x)}},h=u=>{try{w(e.throw(u))}catch(x){f(x)}},w=u=>u.done?m(u.value):Promise.resolve(u.value).then(l,h);w((e=e.apply(s,r)).next())});function Le(s){const[r,e]=t.useState(null),[m,f]=t.useState(!1),[l,h]=t.useState(!1),w=t.useCallback(()=>Ae(null,null,function*(){if(r){f(!0);try{yield new Promise(S=>setTimeout(S,2e3)),console.log("PDF uploaded successfully:",r.name)}catch(S){console.error("PDF upload failed:",S)}finally{f(!1)}}}),[r]),u=t.useCallback(()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){alert("Speech recognition is not supported in this browser. Please use Chrome or Edge.");return}h(!l)},[l]),x=t.useCallback(()=>{e(null)},[]),y=t.useCallback(()=>{e(null),f(!1),h(!1)},[]);return{pdfFile:r,pdfUploading:m,isRecording:l,setPdfFile:e,setPdfUploading:f,setIsRecording:h,handlePdfUpload:w,handleVoiceToggle:u,removePdfFile:x,resetMedia:y}}var He=Object.defineProperty,Ue=Object.defineProperties,qe=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,Y=(s,r,e)=>r in s?He(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,O=(s,r)=>{for(var e in r||(r={}))ze.call(r,e)&&Y(s,e,r[e]);if(X)for(var e of X(r))Me.call(r,e)&&Y(s,e,r[e]);return s},ee=(s,r)=>Ue(s,qe(r));function We(s,r){const[e,m]=t.useState(s),f=t.useCallback((x,y)=>{m(S=>ee(O({},S),{[x]:y}))},[]),l=t.useCallback(x=>{m(y=>O(O({},y),x))},[]),h=t.useCallback(()=>{m(s)},[r,s]),w=t.useCallback(x=>e[x],[e]),u=t.useCallback(()=>O({},e),[e]);return ee(O({},e),{updateField:f,updateMultipleFields:l,resetFields:h,getFieldValue:w,getAllFields:u})}function Ze(){return We({policyVersion:"1.0",requiresSignature:!1,signatureDeadline:30,acknowledgmentStatement:"I have read, understood, and agree to comply with this policy.",policyType:"general"})}var Ge=Object.defineProperty,Je=Object.defineProperties,Ke=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,se=(s,r,e)=>r in s?Ge(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,Ye=(s,r)=>{for(var e in r||(r={}))Qe.call(r,e)&&se(s,e,r[e]);if(te)for(var e of te(r))Xe.call(r,e)&&se(s,e,r[e]);return s},et=(s,r)=>Je(s,Ke(r));function tt(){const[s,r]=t.useState([]),[e,m]=t.useState(new Set),[f,l]=t.useState(!1),h=t.useMemo(()=>s.length===0,[s]),w=t.useCallback((i,p)=>{let d;i.includes("policy")?d=ae.pick({[i]:!0}):i.includes("procedure")?d=ve.pick({[i]:!0}):i.includes("sms")||i.includes("chemical")||i.includes("cas")?d=Te.pick({[i]:!0}):i.includes("pathway")||i.includes("quiz")?d=je.pick({[i]:!0}):i.includes("font")||i.includes("color")?d=Ce.pick({[i]:!0}):i.includes("table")?d=Fe.pick({[i]:!0}):i.includes("pdf")||i.includes("recording")?d=Pe.pick({[i]:!0}):d=_e.pick({[i]:!0});try{return d.parse({[i]:p}),null}catch(o){if(o instanceof Q){const b=o.errors.find(a=>a.path.includes(i));if(b)return{field:i,message:b.message,path:b.path.map(String)}}return null}},[]),u=t.useCallback((i,p)=>{try{return p.parse(i),[]}catch(d){return d instanceof Q?d.errors.map(o=>({field:o.path.join("."),message:o.message,path:o.path.map(String)})):[]}},[]),x=t.useCallback(i=>{m(p=>new Set(p).add(i)),l(!0)},[]),y=t.useCallback(()=>{l(!0)},[]),S=t.useCallback(()=>{r([])},[]),j=t.useCallback(i=>{r(p=>p.filter(d=>d.field!==i))},[]),C=t.useCallback(i=>!s.some(p=>p.field===i),[s]),F=t.useCallback(i=>{const p=s.find(d=>d.field===i);return p?p.message:null},[s]),k=t.useCallback(()=>s.length>0,[s]);return{isValid:h,errors:s,touched:e,isDirty:f,validateField:w,validateForm:u,markFieldAsTouched:x,markAllFieldsAsTouched:y,clearErrors:S,clearFieldError:j,isFieldValid:C,getFieldError:F,hasErrors:k}}function st(){const s=tt(),r=t.useCallback(e=>s.validateForm(e,ae),[s]);return et(Ye({},s),{validatePolicy:r})}const H=({field:s,errors:r,touched:e,className:m=""})=>{const f=r.find(h=>h.field===s);return!e.has(s)||!f?null:c.jsxs("div",{className:`flex items-center space-x-2 text-red-600 text-sm mt-1 ${m}`,children:[c.jsx(U,{path:q,size:.75}),c.jsx("span",{children:f.message})]})},at=({errors:s,className:r=""})=>s.length===0?null:c.jsxs("div",{className:`bg-red-50 border border-red-200 rounded-md p-4 ${r}`,children:[c.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[c.jsx(U,{path:q,size:1.25,className:"text-red-500"}),c.jsx("h4",{className:"text-sm font-medium text-red-800",children:"Please fix the following errors:"})]}),c.jsx("ul",{className:"list-disc list-inside space-y-1",children:s.map((e,m)=>c.jsxs("li",{className:"text-sm text-red-700",children:[c.jsxs("span",{className:"font-medium",children:[e.field,":"]})," ",e.message]},m))})]}),rt=({isValid:s,isDirty:r})=>r?c.jsxs("div",{className:`flex items-center space-x-2 text-sm ${s?"text-green-600":"text-red-600"}`,children:[c.jsx(U,{path:s?Be:q,size:1}),c.jsx("span",{children:s?"Form is valid":"Form has validation errors"})]}):null,pt=({title:s,description:r,content:e,onTitleChange:m,onDescriptionChange:f,onContentChange:l,onSave:h,onPublish:w,onAIAssistant:u})=>{const{policyVersion:x,requiresSignature:y,signatureDeadline:S,acknowledgmentStatement:j,policyType:C,updateField:F}=Ze(),{fontFamily:k,fontSize:i,textColor:p,setFontFamily:d,setFontSize:o,setTextColor:b,resetFormatting:a,formatBold:n,formatItalic:g,formatHeading2:P,formatHeading3:T,formatBulletList:_,formatNumberedList:D,addNote:L,addWarning:z,addCheck:M,insertLink:W}=$e(),{showTableBuilder:re,setShowTableBuilder:Z,insertTableIntoContent:G}=Ve(),{pdfFile:le,pdfUploading:oe,isRecording:ne,setPdfFile:ie,handlePdfUpload:ce,handleVoiceToggle:ue}=Le(),{isValid:J,errors:R,touched:E,validateField:B,validatePolicy:$,markFieldAsTouched:N,markAllFieldsAsTouched:V,getFieldError:A}=st(),{state:de}=Ne(),{isDirty:K}=de,me=t.useCallback(()=>n(e,l),[n,e,l]),pe=t.useCallback(()=>g(e,l),[g,e,l]),be=t.useCallback(()=>P(e,l),[P,e,l]),fe=t.useCallback(()=>T(e,l),[T,e,l]),ge=t.useCallback(()=>_(e,l),[_,e,l]),he=t.useCallback(()=>D(e,l),[D,e,l]),xe=t.useCallback(()=>L(e,l),[L,e,l]),ye=t.useCallback(()=>z(e,l),[z,e,l]),ke=t.useCallback(()=>M(e,l),[M,e,l]),Se=t.useCallback(()=>W(e,l),[W,e,l]),we=t.useCallback(()=>G(e,l),[G,e,l]);return c.jsxs("div",{className:"space-y-6",children:[c.jsx(at,{errors:R}),c.jsx(rt,{isValid:J,isDirty:K}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:[c.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-4",children:"Policy Configuration"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"policy-version",className:"block text-sm font-medium text-blue-700 mb-2",children:"Policy Version"}),c.jsx("input",{id:"policy-version",type:"text",value:x,onChange:v=>{F("policyVersion",v.target.value),B("policyVersion",v.target.value)&&N("policyVersion")},onBlur:()=>N("policyVersion"),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${E.has("policyVersion")&&A("policyVersion")?"border-red-300 focus:ring-red-500":"border-blue-300 focus:ring-blue-500"}`,placeholder:"e.g., 1.0"}),c.jsx(H,{field:"policyVersion",errors:R,touched:E})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"policy-type",className:"block text-sm font-medium text-blue-700 mb-2",children:"Policy Type"}),c.jsxs("select",{id:"policy-type",value:C,onChange:v=>{F("policyType",v.target.value),B("policyType",v.target.value)&&N("policyType")},onBlur:()=>N("policyType"),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${E.has("policyType")&&A("policyType")?"border-red-300 focus:ring-red-500":"border-blue-300 focus:ring-blue-500"}`,children:[c.jsx("option",{value:"general",children:"General Policy"}),c.jsx("option",{value:"safety",children:"Safety Policy"}),c.jsx("option",{value:"compliance",children:"Compliance Policy"}),c.jsx("option",{value:"operational",children:"Operational Policy"})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"requires-signature",className:"block text-sm font-medium text-blue-700 mb-2",children:"Signature Required"}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("input",{type:"checkbox",id:"requires-signature",checked:y,onChange:v=>F("requiresSignature",v.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"requires-signature",className:"text-sm text-blue-700",children:"Require employee acknowledgment"})]})]}),y&&c.jsxs("div",{children:[c.jsx("label",{htmlFor:"days-to-sign",className:"block text-sm font-medium text-blue-700 mb-2",children:"Days to Sign"}),c.jsx("input",{id:"days-to-sign",type:"number",value:S,onChange:v=>{F("signatureDeadline",Number(v.target.value)),B("signatureDeadline",Number(v.target.value))&&N("signatureDeadline")},onBlur:()=>N("signatureDeadline"),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${E.has("signatureDeadline")&&A("signatureDeadline")?"border-red-300 focus:ring-red-500":"border-blue-300 focus:ring-blue-500"}`,min:"1",max:"365"}),c.jsx(H,{field:"signatureDeadline",errors:R,touched:E})]})]}),y&&c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{htmlFor:"acknowledgment-statement",className:"block text-sm font-medium text-blue-700 mb-2",children:"Acknowledgment Statement"}),c.jsx("textarea",{id:"acknowledgment-statement",value:j,onChange:v=>{F("acknowledgmentStatement",v.target.value),B("acknowledgmentStatement",v.target.value)&&N("acknowledgmentStatement")},onBlur:()=>N("acknowledgmentStatement"),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${E.has("acknowledgmentStatement")&&A("acknowledgmentStatement")?"border-red-300 focus:ring-red-500":"border-blue-300 focus:ring-blue-500"}`,rows:2,placeholder:"Enter the statement employees must acknowledge..."}),c.jsx(H,{field:"acknowledgmentStatement",errors:R,touched:E})]})]}),c.jsx(Ee,{title:s,description:r,content:e,onTitleChange:m,onDescriptionChange:f,onContentChange:l}),c.jsx(De,{fontFamily:k,fontSize:i,textColor:p,onFontFamilyChange:d,onFontSizeChange:o,onTextColorChange:b,onReset:a,onBold:me,onItalic:pe,onHeading2:be,onHeading3:fe,onBulletList:ge,onNumberedList:he,onAddNote:xe,onAddWarning:ye,onAddCheck:ke,onInsertLink:Se,onAISuggestions:()=>{},onShowTableBuilder:()=>Z(!0)}),c.jsx(Ie,{pdfFile:le,isRecording:ne,onPdfFileChange:ie,onPdfUpload:ce,onVoiceToggle:ue,pdfUploading:oe,showVoiceRecording:!0,showPdfUpload:!0}),re&&c.jsx(Oe,{onClose:()=>Z(!1),onInsertTable:we}),c.jsx(Re,{onSave:t.useCallback(()=>{if($({title:s,description:r,content:e,policyVersion:x,policyType:C,requiresSignature:y,signatureDeadline:y?S:void 0,acknowledgmentStatement:y?j:void 0}).length>0){V();return}h()},[s,r,e,x,C,y,S,j,$,V,h]),onPublish:t.useCallback(()=>{if($({title:s,description:r,content:e,policyVersion:x,policyType:C,requiresSignature:y,signatureDeadline:y?S:void 0,acknowledgmentStatement:y?j:void 0}).length>0){V();return}w()},[s,r,e,x,C,y,S,j,$,V,w]),onAIAssistant:u,canPublish:J&&K})]})};export{pt as default};
