import{r as g,j as e,I as S,u as ga,U as ka,V as We,W as La,X as $a,Y as At,Z as Ma,_ as Ot,$ as Fa,a0 as Le,c as Ct,R as Se,P as ie,b as xa,a1 as ha,B as Dt}from"./react-vendor-DBfrHuQ-.js";import{s as O,g as te,y as Ga,z as Ua,x as V,A as za,U as Ba,B as _t,F as Te,G as Rt,H as Ha,J as kt,K as qa,M as Va,R as Ya,S as Wa,E as ae}from"./components-BtXJbSH9.js";import{ag as pa,F as St,ah as Ka,ai as Za,aj as Ja,ak as Qa,al as wt,am as Xa,an as Lt,ao as er,ap as tr,aq as sr,ar as Ke,T as $t,as as Mt,at as K,au as Ft,av as ar,aw as rr,ax as nr,ay as ir,az as lr,aA as or,aB as cr}from"./services-JA4N6ZXe.js";import{I as fa,a6 as X,aF as dr,aG as ba,a0 as ur,N as Gt,c as z,i as mr,e as gr,R as Ut,a5 as ya,a as xr,ae as Ze,aH as Ve,a8 as va,aa as zt,S as Bt,b as hr,aI as pr,v as _e,aJ as ja,a9 as Na,aK as fr,r as be,K as Ht,F as qt,D as Vt,aL as we,l as yt,aM as ke,aN as Et,aO as ye,aP as br,a7 as yr,aQ as vr,ag as jr,aR as Nr,aS as Ca,u as Re,aT as _a,aj as Tt,X as Cr,aU as _r,aV as Sr,_ as wr,M as Er,av as Tr}from"./ui-vendor-BmV1twT8.js";import{g as Yt,a as Wt}from"./knowledgehub-pages-DX_b2YG9.js";const Sa=()=>{const t=pa.getInstance();return g.useMemo(()=>{const s=t.getBudgetData(),r=t.isTokenLimitExceeded(),i=t.shouldShowTokenLimitWarning();return{hasIssues:r||i,isExceeded:r,shouldWarn:i,usagePercentage:s.percentage,remainingTokens:s.remaining,usedTokens:s.used,limitTokens:s.limit}},[t])},Ir=({activeTab:t,onTabChange:a})=>{const s=[{id:"basic-info",label:"Basic Information",icon:fa},{id:"preferences",label:"Preferences",icon:X},{id:"mobile",label:"Mobile Scanner Shortcuts",icon:dr},{id:"account",label:"Account Management",icon:ba}];return e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:s.map(r=>e.jsxs("button",{onClick:()=>a(r.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${t===r.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(S,{path:r.icon,size:1}),e.jsx("span",{children:r.label})]},r.id))})})})};var Pr=Object.defineProperty,Ar=Object.defineProperties,Or=Object.getOwnPropertyDescriptors,Kt=Object.getOwnPropertySymbols,Dr=Object.prototype.hasOwnProperty,Rr=Object.prototype.propertyIsEnumerable,Zt=(t,a,s)=>a in t?Pr(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Z=(t,a)=>{for(var s in a||(a={}))Dr.call(a,s)&&Zt(t,s,a[s]);if(Kt)for(var s of Kt(a))Rr.call(a,s)&&Zt(t,s,a[s]);return t},J=(t,a)=>Ar(t,Or(a));const kr=({basicInfoForm:t,setBasicInfoForm:a,userData:s,uploadingPhoto:r,uploadProfilePhoto:i,removeProfilePhoto:d})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first-name",className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{id:"first-name",type:"text",value:t.first_name,onChange:u=>a(c=>J(Z({},c),{first_name:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last-name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{id:"last-name",type:"text",value:t.last_name,onChange:u=>a(c=>J(Z({},c),{last_name:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:t.email,onChange:u=>a(c=>J(Z({},c),{email:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{id:"phone",type:"tel",value:t.phone,onChange:u=>a(c=>J(Z({},c),{phone:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{id:"department",type:"text",value:t.department,onChange:u=>a(c=>J(Z({},c),{department:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),e.jsx("input",{id:"position",type:"text",value:t.position,onChange:u=>a(c=>J(Z({},c),{position:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-of-birth",className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{id:"date-of-birth",type:"date",value:t.date_of_birth,onChange:u=>a(c=>J(Z({},c),{date_of_birth:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{id:"bio",value:t.bio||"",onChange:u=>a(c=>J(Z({},c),{bio:u.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tell us about yourself..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"preferred-language",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Language"}),e.jsxs("select",{id:"preferred-language",value:t.preferred_language||"en",onChange:u=>a(c=>J(Z({},c),{preferred_language:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"}),e.jsx("option",{value:"pt",children:"Portuguese"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timezone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsxs("select",{id:"timezone",value:t.timezone||"UTC",onChange:u=>a(c=>J(Z({},c),{timezone:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx("option",{value:"Europe/London",children:"London"}),e.jsx("option",{value:"Europe/Paris",children:"Paris"}),e.jsx("option",{value:"Asia/Tokyo",children:"Tokyo"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:r?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#4ECDC4]"})}):s!=null&&s.avatar_url?e.jsx("img",{src:String(s.avatar_url),alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):e.jsx(S,{path:ur,size:2,className:"text-gray-400"})}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("input",{type:"file",id:"profile-photo",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:u=>{var c;const n=(c=u.target.files)==null?void 0:c[0];n&&i(n),u.target.value=""},className:"hidden",disabled:r}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm cursor-pointer text-center disabled:opacity-50 disabled:cursor-not-allowed",onClick:u=>{if(r){u.preventDefault();return}document.getElementById("profile-photo").click()},disabled:r,children:r?"Uploading...":"Upload Photo"}),(s==null?void 0:s.avatar_url)&&e.jsx("button",{onClick:d,disabled:r,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Remove Photo"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG or GIF. Max size 2MB."}),r&&e.jsx("p",{className:"text-xs text-blue-600",children:"Uploading photo..."})]})]})]})]}),q=({id:t,checked:a,onChange:s,label:r,description:i,disabled:d=!1})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:r}),i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]}),e.jsxs("label",{htmlFor:t,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{id:t,type:"checkbox",className:"sr-only peer",checked:a,onChange:u=>s(u.target.checked),disabled:d}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"} ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}`}),e.jsx("span",{className:"sr-only",children:r})]})]});let Je=null;const Lr=()=>(Je||(Je=new(window.AudioContext||window.webkitAudioContext)),Je),$r=(t,a=50)=>{const s=Lr(),r=s.createOscillator(),i=s.createGain();switch(i.gain.value=a/100,r.connect(i),i.connect(s.destination),t){case"gentle-chime":r.frequency.setValueAtTime(800,s.currentTime),r.frequency.setValueAtTime(1e3,s.currentTime+.1),r.frequency.setValueAtTime(1200,s.currentTime+.2),r.type="sine";break;case"medical-alert":r.frequency.setValueAtTime(600,s.currentTime),r.frequency.setValueAtTime(800,s.currentTime+.15),r.type="square";break;case"soft-bell":r.frequency.setValueAtTime(1e3,s.currentTime),r.frequency.setValueAtTime(800,s.currentTime+.2),r.type="sine";break;case"digital-beep":r.frequency.setValueAtTime(1e3,s.currentTime),r.type="square";break;case"success-tone":r.frequency.setValueAtTime(800,s.currentTime),r.frequency.setValueAtTime(1e3,s.currentTime+.1),r.type="sine";break;case"warning-sound":r.frequency.setValueAtTime(400,s.currentTime),r.frequency.setValueAtTime(600,s.currentTime+.1),r.type="sawtooth";break;default:return}r.start(s.currentTime),r.stop(s.currentTime+.3)},Mr=t=>{switch(t){case"short-pulse":return[100];case"double-tap":return[100,50,100];case"long-pulse":return[300];case"pattern":return[100,50,100,50,200];case"off":default:return[]}},wa=t=>{if("vibrate"in navigator){const a=Mr(t);a.length>0&&navigator.vibrate(a)}else console.log("Vibration not supported on this device")},Ea=(t,a=50)=>{if(t!=="none")try{$r(t,a)}catch(s){console.error("Error playing notification sound:",s)}},Fr=t=>{const{sound:a,volume:s,vibration:r,vibrationEnabled:i}=t.notifications;a&&a!=="none"&&Ea(a,s),i&&r&&r!=="off"&&wa(r)};var Gr=Object.defineProperty,Ur=Object.defineProperties,zr=Object.getOwnPropertyDescriptors,Jt=Object.getOwnPropertySymbols,Br=Object.prototype.hasOwnProperty,Hr=Object.prototype.propertyIsEnumerable,Qt=(t,a,s)=>a in t?Gr(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Qe=(t,a)=>{for(var s in a||(a={}))Br.call(a,s)&&Qt(t,s,a[s]);if(Jt)for(var s of Jt(a))Hr.call(a,s)&&Qt(t,s,a[s]);return t},Xe=(t,a)=>Ur(t,zr(a));const qr=({preferences:t,setPreferences:a})=>{const s=(i,d)=>{a(Xe(Qe({},t),{[i]:d}))},r=(i,d)=>{a(Xe(Qe({},t),{notifications:Xe(Qe({},t.notifications),{[i]:d})}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Appearance"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-600 mb-2",children:"Theme"}),e.jsxs("select",{id:"theme",value:t.theme,onChange:i=>s("theme",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"auto",children:"Auto (System)"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Notifications"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{id:"push-notifications",checked:t.notifications.push,onChange:i=>r("push",i),label:"Push Notifications (Browser)"}),t.notifications.push&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Notification Sounds"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notification-sound",className:"block text-sm font-medium text-gray-600 mb-2",children:"Default Sound"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{id:"notification-sound",value:t.notifications.sound||"gentle-chime",onChange:i=>r("sound",i.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"gentle-chime",children:"Gentle Chime"}),e.jsx("option",{value:"medical-alert",children:"Medical Alert"}),e.jsx("option",{value:"soft-bell",children:"Soft Bell"}),e.jsx("option",{value:"digital-beep",children:"Digital Beep"}),e.jsx("option",{value:"success-tone",children:"Success Tone"}),e.jsx("option",{value:"warning-sound",children:"Warning Sound"}),e.jsx("option",{value:"none",children:"No Sound"})]}),e.jsx("button",{type:"button",onClick:()=>Ea(t.notifications.sound||"gentle-chime",t.notifications.volume||50),className:"px-3 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Preview"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notification-volume",className:"block text-sm font-medium text-gray-600 mb-2",children:"Volume"}),e.jsx("input",{id:"notification-volume",type:"range",min:"0",max:"100",value:t.notifications.volume||50,onChange:i=>r("volume",parseInt(i.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0%"}),e.jsxs("span",{children:[t.notifications.volume||50,"%"]}),e.jsx("span",{children:"100%"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Vibration (Mobile Devices)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vibration-pattern",className:"block text-sm font-medium text-gray-600 mb-2",children:"Vibration Pattern"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{id:"vibration-pattern",value:t.notifications.vibration||"short-pulse",onChange:i=>r("vibration",i.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"short-pulse",children:"Short Pulse"}),e.jsx("option",{value:"double-tap",children:"Double Tap"}),e.jsx("option",{value:"long-pulse",children:"Long Pulse"}),e.jsx("option",{value:"pattern",children:"Pattern"}),e.jsx("option",{value:"off",children:"Off"})]}),e.jsx("button",{type:"button",onClick:()=>wa(t.notifications.vibration||"short-pulse"),className:"px-3 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Test"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(q,{id:"vibration-enabled",checked:t.notifications.vibrationEnabled!==!1,onChange:i=>r("vibrationEnabled",i),label:"Enable Vibration"})})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsx("button",{type:"button",onClick:()=>Fr(t),className:"w-full px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:"Test Full Notification"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can customize notification preferences for specific features in each module."})]})]})]})};var Vr=Object.defineProperty,Yr=Object.defineProperties,Wr=Object.getOwnPropertyDescriptors,Xt=Object.getOwnPropertySymbols,Kr=Object.prototype.hasOwnProperty,Zr=Object.prototype.propertyIsEnumerable,es=(t,a,s)=>a in t?Vr(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Ie=(t,a)=>{for(var s in a||(a={}))Kr.call(a,s)&&es(t,s,a[s]);if(Xt)for(var s of Xt(a))Zr.call(a,s)&&es(t,s,a[s]);return t},Pe=(t,a)=>Yr(t,Wr(a)),ts=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Jr=()=>{const[t,a]=g.useState([{id:"clean-tool",name:"Clean Tool Scan",description:"Scan clean tools ready for use",icon:Gt,enabled:!1,shortcutSlot:null},{id:"dirty-tool",name:"Dirty Tool Scan",description:"Scan tools that need sterilization",icon:Gt,enabled:!1,shortcutSlot:null},{id:"problem-tool",name:"Problem Tool Scan",description:"Scan tools with issues/repair needs",icon:z,enabled:!1,shortcutSlot:null},{id:"import-receipt",name:"Import Autoclave Receipt",description:"Import physical autoclave documentation",icon:mr,enabled:!1,shortcutSlot:null},{id:"package-tools",name:"Package Tools",description:"Package tools for sterilization",icon:gr,enabled:!1,shortcutSlot:null},{id:"single-scan",name:"Single Scan Mode",description:"Individual tool scanning",icon:Ut,enabled:!1,shortcutSlot:null},{id:"batch-scan",name:"Batch Scan Mode",description:"Multiple tools at once",icon:Ut,enabled:!1,shortcutSlot:null},{id:"add-inventory",name:"Add Inventory",description:"Scan new items to add",icon:ya,enabled:!1,shortcutSlot:null},{id:"use-inventory",name:"Use Inventory",description:"Scan items to remove/consume",icon:xr,enabled:!1,shortcutSlot:null},{id:"scan-room",name:"Scan Room",description:"Scan room barcodes for cleaning",icon:Ze,enabled:!1,shortcutSlot:null},{id:"complete-cleaning",name:"Complete Cleaning",description:"Mark room as cleaned",icon:Ze,enabled:!1,shortcutSlot:null},{id:"update-status",name:"Update Status",description:"Change room cleaning status",icon:Ze,enabled:!1,shortcutSlot:null}]),s=(n,o)=>{if(o&&r().length===0){alert("No mobile shortcuts available. Please disable another workflow first or assign this workflow to an existing shortcut.");return}a(l=>l.map(m=>m.id===n?Pe(Ie({},m),{enabled:o,shortcutSlot:o?m.shortcutSlot:null}):m))},r=()=>{const n=t.filter(l=>l.enabled&&l.shortcutSlot!==null).map(l=>l.shortcutSlot);return["volume-up","volume-down","volume-up-double","volume-down-double","power-double","double-tap","shake","flip"].filter(l=>!n.includes(l))},i=(n,o)=>{o===null&&setTimeout(()=>{a(l=>l.map(m=>m.id===n&&m.shortcutSlot===null?Pe(Ie({},m),{enabled:!1}):m))},5e3),a(l=>l.map(m=>m.shortcutSlot===o&&m.id!==n?Pe(Ie({},m),{shortcutSlot:null}):m.id===n?Pe(Ie({},m),{shortcutSlot:o}):m))},d=n=>{var o;return((o=[{id:"volume-up",label:"Volume Up"},{id:"volume-down",label:"Volume Down"},{id:"volume-up-double",label:"Volume Up (2x)"},{id:"volume-down-double",label:"Volume Down (2x)"},{id:"power-double",label:"Power (2x)"},{id:"double-tap",label:"Double Tap"},{id:"shake",label:"Shake"},{id:"flip",label:"Flip"}].find(m=>m.id===n))==null?void 0:o.label)||n},u=()=>ts(null,null,function*(){try{const{data:{user:n}}=yield O.auth.getUser();if(!n)return;const{data:o,error:l}=yield O.from("users").select("mobile_shortcuts").eq("id",n.id).single();if(l&&l.code!=="PGRST116")return;o!=null&&o.mobile_shortcuts&&typeof o.mobile_shortcuts=="object"&&a(m=>m.map(x=>{const h=o.mobile_shortcuts[x.id];return h?Pe(Ie({},x),{enabled:h.enabled,shortcutSlot:h.shortcut}):x}))}catch(n){console.error("Failed to load mobile shortcuts:",n)}}),c=g.useCallback(()=>ts(null,null,function*(){try{const{data:{user:n}}=yield O.auth.getUser();if(!n)return;const o=t.reduce((m,x)=>(x.enabled&&x.shortcutSlot&&(m[x.id]={enabled:x.enabled,shortcut:x.shortcutSlot}),m),{}),{error:l}=yield O.from("users").update({mobile_shortcuts:o,updated_at:new Date().toISOString()}).eq("id",n.id);l?console.error("Error saving mobile settings:",l):console.log("Mobile settings saved successfully")}catch(n){console.error("Failed to save mobile shortcuts:",n)}}),[t]);return g.useEffect(()=>{setTimeout(()=>{u()},0)},[]),g.useEffect(()=>{t.some(n=>n.enabled)&&c()},[t,c]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Mobile Scanner Shortcuts"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure up to 4 mobile shortcuts for quick access to your most-used scanning workflows."}),e.jsx("div",{className:"space-y-4",children:t.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{path:n.icon,size:1.2,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:n.name}),e.jsx("p",{className:"text-xs text-gray-500",children:n.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable"}),e.jsx(q,{id:`toggle-${n.id}`,label:`Enable ${n.name}`,checked:n.enabled,onChange:o=>s(n.id,o)})]}),n.enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:n.shortcutSlot||"",onChange:o=>i(n.id,o.target.value?o.target.value:null),className:`px-3 py-1 border rounded text-sm ${n.shortcutSlot?"border-gray-300":"border-red-300 bg-red-50"}`,children:[e.jsx("option",{value:"",children:"Select Shortcut"}),[{id:"volume-up",label:"Volume Up (Single Press)",description:"Press volume up button once"},{id:"volume-down",label:"Volume Down (Single Press)",description:"Press volume down button once"},{id:"volume-up-double",label:"Volume Up (Double Press)",description:"Press volume up button twice quickly"},{id:"volume-down-double",label:"Volume Down (Double Press)",description:"Press volume down button twice quickly"},{id:"power-double",label:"Power Button (Double Press)",description:"Press power button twice quickly"},{id:"double-tap",label:"Double Tap Screen",description:"Tap screen twice quickly"},{id:"shake",label:"Shake Device",description:"Shake your phone"},{id:"flip",label:"Flip Device",description:"Turn phone face down"}].map(o=>e.jsx("option",{value:o.id,disabled:t.some(l=>l.id!==n.id&&l.shortcutSlot===o.id),children:o.label},o.id))]}),!n.shortcutSlot&&e.jsx("p",{className:"text-xs text-red-500",children:"⚠️ Please select a mobile shortcut or this workflow will be disabled in 5 seconds"})]})]})]},n.id))}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h6",{className:"text-sm font-medium text-blue-700 mb-3",children:"Current Shortcuts"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[t.filter(n=>n.enabled&&n.shortcutSlot).map(n=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(S,{path:n.icon,size:1.2,className:"text-blue-600"})}),e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:n.name}),e.jsx("p",{className:"text-xs text-blue-500",children:d(n.shortcutSlot)})]},n.id)),t.filter(n=>n.enabled&&n.shortcutSlot).length===0&&e.jsxs("div",{className:"col-span-2 md:col-span-4 text-center py-4",children:[e.jsx("p",{className:"text-blue-500 text-sm",children:"No shortcuts configured yet"}),e.jsx("p",{className:"text-blue-400 text-xs",children:"Enable workflows and assign mobile shortcuts above"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"How to Use Mobile Shortcuts"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Enable workflows:"})," Use the toggles for scanning workflows you use frequently"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Assign shortcuts:"})," Choose mobile device actions (volume buttons, double tap, shake, etc.)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Mobile access:"})," These shortcuts will trigger on your mobile device for quick scanning"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Unique assignments:"})," Each mobile shortcut can only be used by one workflow"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Quick launch:"})," Perform the assigned action to directly open that scanner workflow"]})]})]})]})})};var Qr=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Xr=({userData:t,onPasswordChange:a,onOpenPasswordModal:s,onArchiveAccount:r,passwordError:i,passwordSuccess:d})=>{const[u,c]=g.useState(!1),[n,o]=g.useState(!1),[l,m]=g.useState(""),x=h=>Qr(null,null,function*(){yield a(h),c(!1)}),p=()=>{l.trim()&&(r(),o(!1),m(""))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Account Security"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#4ECDC4] rounded-lg flex items-center justify-center",children:e.jsx(S,{path:Ve,size:1,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-gray-700",children:"Password"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Last changed:"," ",t!=null&&t.password_changed_at?t.password_changed_at:"Never"]})]})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Change Password"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"two-factor-toggle",className:"block text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),e.jsx("button",{id:"two-factor-toggle",disabled:!0,className:"px-4 py-2 rounded-md transition-colors text-sm bg-gray-400 text-white cursor-not-allowed opacity-60",title:"Coming Soon",children:"Coming Soon"})]}),e.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sessions-toggle",className:"block text-sm font-medium text-gray-700",children:"Login Sessions"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Active sessions:"," ",t!=null&&t.active_sessions?t.active_sessions:1]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Account Actions"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:e.jsx(S,{path:va,size:1,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-orange-700",children:"Archive Account"}),e.jsx("p",{className:"text-sm text-orange-600",children:"Archive your account - data is preserved but access is disabled"})]})]}),e.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors text-sm",children:"Archive Account"})]})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),i&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:i})}),d&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-green-600 text-sm",children:d})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("input",{id:"current-password",type:"password",placeholder:"Enter your current password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsx("input",{id:"new-password",type:"password",placeholder:"Enter new password (min 8 characters)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{id:"confirm-password",type:"password",placeholder:"Confirm new password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>x({currentPassword:"",newPassword:"",confirmPassword:""}),className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] rounded-md hover:bg-[#38b2ac]",children:"Change Password"})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-900 mb-4",children:"Archive Account"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Your account will be archived. This means:"}),e.jsxs("ul",{className:"text-sm text-gray-600 mb-4 space-y-1",children:[e.jsx("li",{children:"• Your data will be preserved"}),e.jsx("li",{children:"• You won't be able to access the system"}),e.jsx("li",{children:"• Your account can be restored by administrators"}),e.jsx("li",{children:"• All sessions will be terminated"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This action can be reversed by contacting support."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"delete-reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for archiving (optional)"}),e.jsx("textarea",{id:"archive-reason",value:l,onChange:h=>m(h.target.value),placeholder:"Please let us know why you're archiving your account...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-md hover:bg-orange-700",children:"Archive Account"})]})]})})]})};var en=Object.defineProperty,tn=Object.defineProperties,sn=Object.getOwnPropertyDescriptors,ss=Object.getOwnPropertySymbols,an=Object.prototype.hasOwnProperty,rn=Object.prototype.propertyIsEnumerable,as=(t,a,s)=>a in t?en(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,et=(t,a)=>{for(var s in a||(a={}))an.call(a,s)&&as(t,s,a[s]);if(ss)for(var s of ss(a))rn.call(a,s)&&as(t,s,a[s]);return t},tt=(t,a)=>tn(t,sn(a)),nn=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const ln=({isOpen:t,onClose:a,onSubmit:s,error:r,success:i,isPasswordReset:d=!1})=>{const[u,c]=g.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[n,o]=g.useState(!1),[l,m]=g.useState(!1),x=()=>nn(null,null,function*(){yield s(u),i&&c({currentPassword:"*********",newPassword:"",confirmPassword:""})}),p=()=>{c({currentPassword:"*********",newPassword:"",confirmPassword:""}),a()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:d?"Reset Password":"Change Password"}),r&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:r})}),i&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-green-600 text-sm",children:i})}),e.jsxs("div",{className:"space-y-4",children:[!d&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("div",{className:"relative",children:e.jsx("input",{id:"currentPassword",type:"password",placeholder:"Enter your current password",value:u.currentPassword||"*********",onChange:h=>c(tt(et({},u),{currentPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your current password to verify your identity before changing."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:d?"Choose New Password":"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"newPassword",type:n?"text":"password",placeholder:"Enter new password (min 6 characters)",value:u.newPassword,onChange:h=>c(tt(et({},u),{newPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("button",{type:"button",onClick:()=>o(!n),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(S,{path:n?zt:Bt,size:1,className:"text-gray-400"})})]}),u.newPassword&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Password Requirements:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[u.newPassword.length>=6?e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsxs("span",{className:`text-xs ${u.newPassword.length>=6?"text-green-700":"text-gray-500"}`,children:["At least 6 characters (",u.newPassword.length,"/6)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[u.newPassword===u.confirmPassword&&u.confirmPassword?e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${u.newPassword===u.confirmPassword&&u.confirmPassword?"text-green-700":"text-gray-500"}`,children:"Passwords match"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",type:l?"text":"password",value:u.confirmPassword,onChange:h=>c(tt(et({},u),{confirmPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("button",{type:"button",onClick:()=>m(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(S,{path:l?zt:Bt,size:1,className:"text-gray-400"})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:x,className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] rounded-md hover:bg-[#38b2ac]",children:d?"Send Reset Email":"Save"})]})]})}):null};var re=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});class oe{static fetchUserData(a){return re(this,null,function*(){try{const{data:s}=yield O.from("users").select("*").eq("id",a).single();return s||(yield this.createDefaultProfile(a))}catch(s){throw console.error("Error fetching user data:",s),s}})}static createDefaultProfile(a){return re(this,null,function*(){const{data:s}=yield O.from("users").select("facility_id").eq("id",a).single(),r={id:a,email:"",first_name:"",last_name:"",role:"user",phone:"",department:"",position:"",date_of_birth:"",bio:"",preferred_language:"en",timezone:"UTC",facility_id:(s==null?void 0:s.facility_id)||"550e8400-e29b-41d4-a716-446655440000"},{data:i,error:d}=yield O.from("users").insert(r).select().single();if(d)throw console.error("Error creating default profile:",d),d;return i})}static getActiveSessionsCount(a){return re(this,null,function*(){const{data:s}=yield O.from("user_sessions").select("id").eq("user_id",a).eq("is_active",!0);return(s==null?void 0:s.length)||0})}static saveProfile(a,s){return re(this,null,function*(){const{data:r}=yield O.from("users").select("avatar_url").eq("id",a).single(),{error:i}=yield O.from("users").update({first_name:s.first_name,last_name:s.last_name,email:s.email,phone:s.phone,department:s.department,position:s.position,date_of_birth:s.date_of_birth,bio:s.bio,preferred_language:s.preferred_language,timezone:s.timezone,avatar_url:(r==null?void 0:r.avatar_url)||null,updated_at:new Date().toISOString()}).eq("id",a);if(i)throw i})}static changePassword(a){return re(this,null,function*(){const{error:s}=yield O.auth.updateUser({password:a.newPassword});if(s)throw s})}static resetPassword(a){return re(this,null,function*(){const{error:s}=yield O.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/settings?tab=account&openPasswordModal=true`});if(s)throw s})}static archiveAccount(a){return re(this,null,function*(){const{error:s}=yield O.from("users").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",a);if(s)throw s})}static uploadProfilePhoto(a,s){return re(this,null,function*(){const r=s.name.split(".").pop(),i=`${Date.now()}.${r}`,d=`${a}/${i}`,{error:u}=yield O.storage.from("profile-photos").upload(d,s);if(u)throw u;const{data:{publicUrl:c}}=O.storage.from("profile-photos").getPublicUrl(d),{error:n}=yield O.from("users").update({avatar_url:c}).eq("id",a);if(n)throw n;return c})}static removeProfilePhoto(a){return re(this,null,function*(){const{error:s}=yield O.from("users").update({avatar_url:null}).eq("id",a);if(s)throw s})}}var on=Object.defineProperty,cn=Object.defineProperties,dn=Object.getOwnPropertyDescriptors,rs=Object.getOwnPropertySymbols,un=Object.prototype.hasOwnProperty,mn=Object.prototype.propertyIsEnumerable,ns=(t,a,s)=>a in t?on(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,M=(t,a)=>{for(var s in a||(a={}))un.call(a,s)&&ns(t,s,a[s]);if(rs)for(var s of rs(a))mn.call(a,s)&&ns(t,s,a[s]);return t},F=(t,a)=>cn(t,dn(a)),ve=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const gn=()=>{const{refreshUserData:t}=te(),a=ga(),[s,r]=g.useState({activeTab:"basic-info",userData:null,loading:!0,saving:!1,saveSuccess:!1,saveError:null,basicInfoForm:{first_name:"",last_name:"",email:"",phone:"",department:"",position:"",date_of_birth:"",bio:"",preferred_language:"en",timezone:"UTC"},preferences:{theme:"light",notifications:{push:!0,sound:"default",volume:50,email:!0,sms:!1,desktop:!0,mobile:!0,weekly_digest:!0,security_alerts:!0,system_updates:!0,maintenance_notices:!0},privacy:{profile_visibility:"public",show_online_status:!0,allow_direct_messages:!0,data_sharing:!1,analytics_tracking:!0},accessibility:{high_contrast:!1,large_text:!1,screen_reader:!1,keyboard_navigation:!0,reduced_motion:!1}},mobileShortcuts:{quick_scan:!0,emergency_contact:!0,voice_commands:!1,gesture_navigation:!0,haptic_feedback:!0,auto_sync:!0,offline_mode:!1,biometric_login:!1},showPasswordModal:!1,isPasswordReset:!1,passwordError:null,passwordSuccess:null});g.useEffect(()=>{const l=new URLSearchParams(a.search),m=l.get("tab"),x=l.get("openPasswordModal");m&&r(p=>F(M({},p),{activeTab:m})),x==="true"&&(r(p=>F(M({},p),{showPasswordModal:!0})),window.history.replaceState({},"","/settings"))},[a.search]);const i=g.useCallback(()=>ve(null,null,function*(){try{r(j=>F(M({},j),{loading:!0}));const{data:{user:l}}=yield O.auth.getUser();if(!l)return;const m=yield oe.fetchUserData(l.id),x=yield oe.getActiveSessionsCount(l.id);let p=m.first_name||"",h=m.last_name||"";if(!p&&!h&&m.full_name){const j=m.full_name.split(" ");p=j[0]||"",h=j.slice(1).join(" ")||""}const C=m.email||l.email||"";let I=C;if(!C&&l.email){const j=l.email.split("@")[0];if(j.includes(".")){const f=j.split(".");p=f[0]||p,h=f.slice(1).join(" ")||h}I=l.email}const _=F(M({},m),{first_name:p,last_name:h,email:I,active_sessions:x});r(j=>F(M({},j),{userData:_,basicInfoForm:{first_name:p,last_name:h,email:I,phone:m.phone||"",department:m.department||"",position:m.position||"",date_of_birth:m.date_of_birth||"",bio:m.bio||"",preferred_language:m.preferred_language||"en",timezone:m.timezone||"UTC"},loading:!1}))}catch(l){console.error("Error fetching user data:",l),r(m=>F(M({},m),{loading:!1}))}}),[r]);return{state:s,setState:r,fetchUserData:i,handleSave:()=>ve(null,null,function*(){try{r(m=>F(M({},m),{saving:!0,saveError:null}));const{data:{user:l}}=yield O.auth.getUser();if(!l)return;yield oe.saveProfile(l.id,s.basicInfoForm),r(m=>F(M({},m),{saving:!1,saveSuccess:!0,saveError:null})),setTimeout(()=>{r(m=>F(M({},m),{saveSuccess:!1}))},3e3),t()}catch(l){r(m=>F(M({},m),{saving:!1,saveError:l instanceof Error?l.message:"Failed to save profile"}))}}),handlePasswordChange:l=>ve(null,null,function*(){try{if(r(m=>F(M({},m),{passwordError:null,passwordSuccess:null})),l.newPassword!==l.confirmPassword){r(m=>F(M({},m),{passwordError:"Passwords do not match"}));return}s.isPasswordReset?(yield oe.resetPassword(l.newPassword),r(m=>F(M({},m),{passwordSuccess:"Password reset email sent! Check your inbox.",showPasswordModal:!1}))):(yield oe.changePassword(l),r(m=>F(M({},m),{passwordSuccess:"Password changed successfully!",showPasswordModal:!1})))}catch(m){r(x=>F(M({},x),{passwordError:m instanceof Error?m.message:"Failed to change password"}))}}),handleArchiveAccount:()=>ve(null,null,function*(){try{const{data:{user:l}}=yield O.auth.getUser();if(!l)return;yield oe.archiveAccount(l.id),yield O.auth.signOut(),window.location.href="/login"}catch(l){console.error("Error archiving account:",l)}}),uploadProfilePhoto:l=>ve(null,null,function*(){try{const{data:{user:m}}=yield O.auth.getUser();if(!m)return;const x=yield oe.uploadProfilePhoto(m.id,l);r(p=>F(M({},p),{userData:p.userData?F(M({},p.userData),{avatar_url:x}):null})),t()}catch(m){console.error("Error uploading profile photo:",m)}}),removeProfilePhoto:()=>ve(null,null,function*(){try{const{data:{user:l}}=yield O.auth.getUser();if(!l)return;yield oe.removeProfilePhoto(l.id),r(m=>F(M({},m),{userData:m.userData?F(M({},m.userData),{avatar_url:null}):null})),t()}catch(l){console.error("Error removing profile photo:",l)}})}},Ta=g.createContext(void 0),xn=({children:t})=>{const a=gn();return e.jsx(Ta.Provider,{value:a,children:t})},hn=()=>{const t=g.useContext(Ta);if(t===void 0)throw new Error("useProfileSettingsContext must be used within a ProfileSettingsProvider");return t};var pn=Object.defineProperty,fn=Object.defineProperties,bn=Object.getOwnPropertyDescriptors,is=Object.getOwnPropertySymbols,yn=Object.prototype.hasOwnProperty,vn=Object.prototype.propertyIsEnumerable,ls=(t,a,s)=>a in t?pn(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Q=(t,a)=>{for(var s in a||(a={}))yn.call(a,s)&&ls(t,s,a[s]);if(is)for(var s of is(a))vn.call(a,s)&&ls(t,s,a[s]);return t},ce=(t,a)=>fn(t,bn(a));const jn=()=>{const{state:t,setState:a,fetchUserData:s,handleSave:r,handlePasswordChange:i,handleArchiveAccount:d,uploadProfilePhoto:u,removeProfilePhoto:c}=hn();g.useEffect(()=>{s()},[s]);const n=[{id:"quick_scan",label:"Quick Scan",description:"Fast barcode scanning"},{id:"emergency_contact",label:"Emergency Contact",description:"Quick access to emergency"},{id:"voice_commands",label:"Voice Commands",description:"Hands-free operation"},{id:"gesture_navigation",label:"Gesture Navigation",description:"Swipe-based navigation"},{id:"haptic_feedback",label:"Haptic Feedback",description:"Touch vibration feedback"},{id:"auto_sync",label:"Auto Sync",description:"Automatic data synchronization"},{id:"offline_mode",label:"Offline Mode",description:"Work without internet"},{id:"biometric_login",label:"Biometric Login",description:"Fingerprint/Face ID login"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ir,{activeTab:t.activeTab,onTabChange:o=>a(l=>ce(Q({},l),{activeTab:o}))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[t.activeTab==="basic-info"&&e.jsx(kr,{basicInfoForm:t.basicInfoForm,setBasicInfoForm:o=>a(l=>ce(Q({},l),{basicInfoForm:o})),userData:t.userData?{avatar_url:t.userData.avatar_url}:null,uploadingPhoto:t.uploadingPhoto,uploadProfilePhoto:u,removeProfilePhoto:c}),t.activeTab==="preferences"&&e.jsx(qr,{preferences:{theme:t.preferences.theme,notifications:{push:t.preferences.notifications.push,sound:t.preferences.notifications.sound,volume:t.preferences.notifications.volume,vibration:"medium",vibrationEnabled:!0}},setPreferences:o=>{a(l=>{var m,x,p;return ce(Q({},l),{preferences:ce(Q({},l.preferences),{theme:o.theme,notifications:ce(Q({},l.preferences.notifications),{push:(m=o.notifications)==null?void 0:m.push,sound:(x=o.notifications)==null?void 0:x.sound,volume:(p=o.notifications)==null?void 0:p.volume})})})})}}),t.activeTab==="mobile"&&e.jsx(Jr,{mobileShortcuts:Object.entries(t.mobileShortcuts).map(([o,l])=>({[o]:l})),setMobileShortcuts:o=>{const l=o.reduce((m,x)=>Q(Q({},m),x),{});a(m=>ce(Q({},m),{mobileShortcuts:l}))},availableShortcuts:n}),t.activeTab==="account"&&e.jsx(Xr,{userData:t.userData,onPasswordChange:i,onOpenPasswordModal:()=>a(o=>ce(Q({},o),{showPasswordModal:!0})),onArchiveAccount:d,passwordError:t.passwordError,passwordSuccess:t.passwordSuccess})]}),e.jsx(ln,{isOpen:t.showPasswordModal,onClose:()=>a(o=>ce(Q({},o),{showPasswordModal:!1})),onSubmit:i,error:t.passwordError,success:t.passwordSuccess,isPasswordReset:t.isPasswordReset})]})},Nn=()=>e.jsx(xn,{children:e.jsx(jn,{})});var Cn=Object.defineProperty,_n=Object.defineProperties,Sn=Object.getOwnPropertyDescriptors,os=Object.getOwnPropertySymbols,wn=Object.prototype.hasOwnProperty,En=Object.prototype.propertyIsEnumerable,cs=(t,a,s)=>a in t?Cn(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,$e=(t,a)=>{for(var s in a||(a={}))wn.call(a,s)&&cs(t,s,a[s]);if(os)for(var s of os(a))En.call(a,s)&&cs(t,s,a[s]);return t},Me=(t,a)=>_n(t,Sn(a)),Fe=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Tn=()=>{const[t,a]=g.useState(null),[s,r]=g.useState([]),[i,d]=g.useState(!0),[u,c]=g.useState(!1),[n,o]=g.useState(!1),[l,m]=g.useState({closure_date:"",closure_type:"holiday",description:"",is_recurring:!1});g.useEffect(()=>{Fe(null,null,function*(){try{const j=yield St.getCurrentFacilityId();a(j)}catch(j){console.error("Failed to load facility ID:",j)}})},[]);const x=g.useCallback(()=>Fe(null,null,function*(){if(t)try{d(!0);const{data:_,error:j}=yield O.from("office_closures").select("*").eq("facility_id",t).order("closure_date",{ascending:!0});if(j){console.error("Error loading closures:",j);return}r(_.map(f=>{var N;return{id:f.id,closure_date:f.closure_date,closure_type:f.closure_type,description:((N=f.data)==null?void 0:N.description)||"",is_recurring:f.is_recurring}})||[])}catch(_){console.error("Error loading closures:",_)}finally{d(!1)}}),[t]);g.useEffect(()=>{t&&x()},[t,x]);const p=()=>Fe(null,null,function*(){if(!(!t||!l.closure_date))try{c(!0);const{error:_}=yield O.from("office_closures").insert({facility_id:t,closure_date:l.closure_date,closure_type:l.closure_type,description:l.description,is_recurring:l.is_recurring});if(_){console.error("Error adding closure:",_);return}m({closure_date:"",closure_type:"holiday",description:"",is_recurring:!1}),o(!1),x()}catch(_){console.error("Error adding closure:",_)}finally{c(!1)}}),h=_=>Fe(null,null,function*(){try{const{error:j}=yield O.from("office_closures").delete().eq("id",_);if(j){console.error("Error deleting closure:",j);return}x()}catch(j){console.error("Error deleting closure:",j)}}),C=_=>{switch(_){case"holiday":return"Holiday";case"maintenance":return"Maintenance";case"custom":return"Custom";default:return _}},I=_=>{switch(_){case"holiday":return"bg-red-100 text-red-800";case"maintenance":return"bg-yellow-100 text-yellow-800";case"custom":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return i?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]})}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"🗓️ Office Closures & Holidays"})]}),e.jsx("button",{onClick:()=>o(!n),className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-lg hover:bg-[#45b8b0] transition-all duration-200 transform hover:scale-105 shadow-sm",children:n?"❌ Cancel":"➕ Add Closure"})]}),n&&e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 p-6 rounded-xl border-2 border-gray-200 space-y-4 mb-6",children:[e.jsx("h6",{className:"text-lg font-semibold text-gray-800 mb-4",children:"➕ Add New Closure"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureDate",className:"block text-sm font-medium text-gray-600 mb-2",children:"📅 Date"}),e.jsx("input",{id:"closureDate",type:"date",value:l.closure_date,onChange:_=>m(j=>Me($e({},j),{closure_date:_.target.value})),className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureType",className:"block text-sm font-medium text-gray-600 mb-2",children:"🏷️ Type"}),e.jsxs("select",{id:"closureType",value:l.closure_type,onChange:_=>m(j=>Me($e({},j),{closure_type:_.target.value})),className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:[e.jsx("option",{value:"holiday",children:"🎉 Holiday"}),e.jsx("option",{value:"maintenance",children:"🔧 Maintenance"}),e.jsx("option",{value:"custom",children:"📝 Custom"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureDescription",className:"block text-sm font-medium text-gray-600 mb-2",children:"📝 Description"}),e.jsx("input",{id:"closureDescription",type:"text",value:l.description,onChange:_=>m(j=>Me($e({},j),{description:_.target.value})),placeholder:"e.g., Christmas Day, Annual Maintenance",className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"recurring",checked:l.is_recurring,onChange:_=>m(j=>Me($e({},j),{is_recurring:_.target.checked})),className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4] h-4 w-4"}),e.jsx("label",{htmlFor:"recurring",className:"text-sm font-medium text-gray-600",children:"🔄 Recurring annually"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:p,disabled:u||!l.closure_date,className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-lg hover:bg-[#45b8b0] disabled:opacity-50 transition-all duration-200 transform hover:scale-105 shadow-sm",children:u?"⏳ Adding...":"✅ Add Closure"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-sm bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-all duration-200 transform hover:scale-105",children:"❌ Cancel"})]})]}),e.jsx("div",{className:"space-y-2",children:s.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No office closures configured. Add holidays and maintenance days above."}):s.map(_=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${I(_.closure_type)}`,children:C(_.closure_type)}),_.is_recurring&&e.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Recurring"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(_.closure_date).toLocaleDateString()}),_.description&&e.jsx("div",{className:"text-sm text-gray-600",children:_.description})]}),e.jsx("button",{onClick:()=>h(_.id),className:"ml-2 p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete closure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},_.id))}),e.jsx("p",{className:"text-xs text-gray-500",children:"Office closures are automatically excluded from streak calculations. Users won't lose their streak on holidays or maintenance days."})]})};var In=Object.defineProperty,Pn=Object.defineProperties,An=Object.getOwnPropertyDescriptors,ds=Object.getOwnPropertySymbols,On=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,us=(t,a,s)=>a in t?In(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,W=(t,a)=>{for(var s in a||(a={}))On.call(a,s)&&us(t,s,a[s]);if(ds)for(var s of ds(a))Dn.call(a,s)&&us(t,s,a[s]);return t},ne=(t,a)=>Pn(t,An(a)),st=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Rn=()=>{const[t,a]=g.useState(null),[s,r]=g.useState(!0),[i,d]=g.useState(!1),[u,c]=g.useState(""),[n,o]=g.useState(()=>({workingDays:{monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!0,saturday:!1,sunday:!1},openHolidays:!1,startHour:8,endHour:17,clinicTypes:[],clinics:[]}));g.useEffect(()=>{st(null,null,function*(){try{const v=yield St.getCurrentFacilityId();a(v)}catch(v){console.error("Failed to load facility ID:",v)}})},[]),g.useEffect(()=>{try{const y=localStorage.getItem("officeHoursSettings");if(y){const v=JSON.parse(y);v&&typeof v=="object"&&o(T=>W(W({},T),v))}}catch(y){}},[]);const l=g.useCallback(()=>st(null,null,function*(){if(t)try{r(!0);const{data:y,error:v}=yield O.from("facility_office_hours").select("*").eq("facility_id",t).single();if(v&&v.code!=="PGRST116"){console.error("Error loading office hours:",v);return}y&&o({workingDays:y.working_days,startHour:y.start_hour,endHour:y.end_hour,openHolidays:y.open_holidays})}catch(y){console.error("Error loading office hours:",y)}finally{r(!1)}}),[t]);g.useEffect(()=>{t&&l()},[t,l]);const m=y=>st(null,null,function*(){if(t)try{d(!0);const{error:v}=yield O.from("facility_office_hours").upsert({facility_id:t,working_days:y.workingDays,start_hour:y.startHour,end_hour:y.endHour,open_holidays:y.openHolidays});if(v){console.error("Error saving office hours:",v);return}localStorage.setItem("officeHoursSettings",JSON.stringify(y))}catch(v){console.error("Error saving office hours:",v)}finally{d(!1)}}),x=y=>{const v=new Set(n.clinicTypes||[]);v.has(y)?v.delete(y):v.add(y);const T=ne(W({},n),{clinicTypes:Array.from(v)});o(T),m(T)},p=()=>{const y=[...n.clinics||[],{name:"",phone:"",fax:"",email:""}],v=ne(W({},n),{clinics:y});o(v),m(v)},h=y=>{const v=(n.clinics||[]).filter(($,Y)=>Y!==y),T=ne(W({},n),{clinics:v});o(T),m(T)},C=(y,v,T)=>{const $=(n.clinics||[]).map((le,k)=>k===y?ne(W({},le),{[v]:T}):le),Y=ne(W({},n),{clinics:$});o(Y),m(Y)},I=y=>{const v=ne(W({},n),{workingDays:ne(W({},n.workingDays),{[y]:!n.workingDays[y]})});o(v),m(v)},_=()=>{const y=ne(W({},n),{openHolidays:!n.openHolidays});o(y),m(y)},j=(y,v)=>{const T=ne(W({},n),{[y==="start"?"startHour":"endHour"]:v});o(T),m(T)},f=y=>{const v=y>=12?"PM":"AM";return`${y===0?12:y>12?y-12:y}:00 ${v}`},N=()=>{const y=Object.entries(n.workingDays).filter(([,v])=>v).map(([v])=>v.charAt(0).toUpperCase()+v.slice(1));return y.length===0?"No days selected":y.length===7?"Every day":y.length===5&&!n.workingDays.saturday&&!n.workingDays.sunday?"Monday - Friday":y.join(", ")};return s?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Office Hours & Scheduling"}),e.jsx("p",{className:"text-sm text-gray-600",children:"These settings affect BI test scheduling, analytics calculations, and streak tracking"}),i&&e.jsx("div",{className:"mt-4 text-sm text-blue-600 bg-blue-50 px-4 py-2 rounded-lg",children:"💾 Saving changes..."})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"📅 Working Days"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-3 mb-4",children:Object.entries(n.workingDays).map(([y,v])=>e.jsxs("button",{onClick:()=>I(y),className:`p-4 text-center rounded-xl font-medium transition-all duration-200 transform hover:scale-105 ${v?"bg-[#4ECDC4] text-white shadow-lg shadow-[#4ECDC4]/25":"bg-gray-50 text-gray-600 hover:bg-gray-100 border-2 border-gray-200"}`,children:[e.jsx("div",{className:"text-sm font-bold",children:y.charAt(0).toUpperCase()}),e.jsx("div",{className:"text-xs opacity-75",children:y.slice(0,3)})]},y))}),e.jsx("div",{className:"bg-[#4ECDC4] bg-opacity-10 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-[#4ECDC4] font-medium",children:["✅ Selected: ",N()]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"⏰ Hours of Operation"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"Start Time"}),e.jsx("select",{value:n.startHour,onChange:y=>j("start",parseInt(y.target.value)),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] text-lg font-semibold bg-white shadow-sm",children:Array.from({length:24},(y,v)=>e.jsx("option",{value:v,children:f(v)},v))})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-2xl text-[#4ECDC4] font-bold",children:"→"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"to"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"End Time"}),e.jsx("select",{value:n.endHour,onChange:y=>j("end",parseInt(y.target.value)),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] text-lg font-semibold bg-white shadow-sm",children:Array.from({length:24},(y,v)=>e.jsx("option",{value:v,children:f(v)},v))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7l9-4 9 4-9 4-9-4zm0 6l9 4 9-4"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"🏥 Clinic Type & Location"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2",children:"Clinic Type"}),e.jsx("input",{type:"text",value:u,onChange:y=>c(y.target.value),placeholder:"Search clinic types...",className:"w-full mb-4 px-4 py-2 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]"}),(()=>{const v=[{title:"Primary Care & Wellness",tags:["Primary Care","Internal Medicine","Pediatrics","Adolescent Medicine","Geriatrics","Women’s Health","Men’s Health","Obstetrics & Gynecology","Midwifery","Fertility & Reproductive Health","Sexual Health / STI","Preventive Health & Wellness"]},{title:"Dentistry",tags:["Dental (General)","Pediatric Dentistry","Orthodontics","Endodontics","Periodontics","Prosthodontics","Oral & Maxillofacial Surgery"]},{title:"Surgery",tags:["General Surgery","Ambulatory Surgery Center","Orthopedic Surgery","Cardiothoracic Surgery","Vascular Surgery","Neurosurgery","Plastic & Reconstructive Surgery","ENT (Otolaryngology) Surgery","Urologic Surgery","Colorectal Surgery","Ophthalmic Surgery"]},{title:"Urgent, Occupational & Travel",tags:["Urgent Care","Walk-in / After-hours","Occupational Health","Travel Medicine","Sports Medicine","Student Health"]},{title:"Medical Specialties",tags:["Cardiology","Pulmonology","Endocrinology","Gastroenterology","Nephrology","Rheumatology","Hematology","Oncology","Neurology","Allergy & Immunology","Infectious Disease","Dermatology","Pain Management","Palliative Care","Sleep Medicine","Wound Care","Diabetes Education","Nutrition & Dietetics"]},{title:"Mental & Behavioral Health",tags:["Psychiatry","Psychology / Behavioral Health","Substance Use & Recovery","Developmental & Autism Services"]},{title:"Rehabilitation & Therapies",tags:["Physical Therapy","Occupational Therapy","Speech-Language Pathology","Chiropractic","Podiatry"]},{title:"Vision, Imaging & Diagnostics",tags:["Audiology","Optometry / Medical Ophthalmology","Radiology & Imaging"]},{title:"Care Models & Settings",tags:["Community Health Center","Rural Health Clinic","Public Health / Immunization","Telemedicine / Virtual Care","Home Health","Private Practice","Integrative / Functional Medicine","Allied Health (Multidisciplinary)"]}].flatMap(k=>k.tags),T=u.trim().toLowerCase(),$=new Set(n.clinicTypes||[]),Y=(n.clinicTypes||[]).slice().sort(),le=T?v.filter(k=>!$.has(k)).filter(k=>k.toLowerCase().includes(T)).sort((k,Ee)=>k.localeCompare(Ee)):[];return e.jsxs(e.Fragment,{children:[Y.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 mb-2",children:"Selected"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Y.map(k=>e.jsxs("button",{onClick:()=>x(k),className:"px-3 py-1.5 rounded-full text-sm font-medium transition bg-[#4ECDC4] text-white shadow flex items-center","aria-label":`Remove ${k}`,title:`Remove ${k}`,children:[e.jsx("span",{children:k}),e.jsx("span",{className:"ml-2 text-white/90 hover:text-white font-bold",children:"×"})]},k))})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:le.map(k=>e.jsx("button",{onClick:()=>x(k),className:"px-3 py-1.5 rounded-full text-sm font-medium transition bg-gray-100 text-gray-700 hover:bg-gray-200",children:k},k))})]})})()]}),e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Clinic Locations"}),e.jsx("button",{type:"button",onClick:p,className:"px-3 py-1.5 rounded-lg text-sm font-semibold bg-[#4ECDC4] text-white hover:opacity-90",children:"+ Add Location"})]}),(n.clinics||[]).length===0?e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"No locations added yet."}):null,e.jsx("div",{className:"space-y-4",children:(n.clinics||[]).map((y,v)=>e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Name"}),e.jsx("input",{type:"text",value:y.name,onChange:T=>C(v,"name",T.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",placeholder:"Enter clinic name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Phone"}),e.jsx("input",{type:"tel",value:y.phone,onChange:T=>C(v,"phone",T.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",placeholder:"e.g. +1 555 123 4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Fax"}),e.jsx("input",{type:"tel",value:y.fax||"",onChange:T=>C(v,"fax",T.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Clinic Email"}),e.jsx("input",{type:"email",value:y.email||"",onChange:T=>C(v,"email",T.target.value),className:"w-full px-4 py-2 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",placeholder:"name@example.com"})]})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>h(v),className:"px-3 py-1.5 rounded-lg text-sm font-semibold bg-red-100 text-red-700 hover:bg-red-200",children:"Remove"})})]},v))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"🎉 Holiday Operations"})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-4xl",children:n.openHolidays?"🎊":"🏠"}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:n.openHolidays?"Open on holidays":"Closed on holidays"}),e.jsx("p",{className:"text-sm text-gray-600",children:n.openHolidays?"BI tests and operations will continue on holidays":"BI tests due on holidays will be rescheduled to the next business day"})]})]}),e.jsx("button",{onClick:_,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-[#4ECDC4]/20 ${n.openHolidays?"bg-[#4ECDC4] shadow-lg shadow-[#4ECDC4]/25":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-all duration-300 shadow-lg ${n.openHolidays?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-blue-800",children:"📋 Current Schedule Summary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Working Days"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:N()})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Hours"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[f(n.startHour)," - ",f(n.endHour)]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Holidays"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:n.openHolidays?"Open":"Closed"})]})]})]}),e.jsx(Tn,{})]})},kn=({user:t,mode:a})=>{var s,r;return e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{id:"firstName",type:"text",placeholder:"Enter first name",defaultValue:((s=t==null?void 0:t.full_name)==null?void 0:s.split(" ")[0])||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{id:"lastName",type:"text",placeholder:"Enter last name",defaultValue:((r=t==null?void 0:t.full_name)==null?void 0:r.split(" ").slice(1).join(" "))||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{id:"email",type:"email",placeholder:"user@clinic.com",defaultValue:(t==null?void 0:t.email)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),a==="add"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"An invitation email will be sent to this address"})]})]})]})},Ln=({user:t})=>{const[a,s]=g.useState(!1),[r,i]=g.useState("");return e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Role & Permissions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),a?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{id:"newRoleInput",type:"text",placeholder:"Enter new role name",value:r,onChange:d=>i(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{r.trim()&&(i(""),s(!1))},className:"px-3 py-1 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-xs",children:"Add Role"}),e.jsx("button",{onClick:()=>{i(""),s(!1)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Cancel"})]})]}):e.jsxs("select",{id:"userRole",defaultValue:(t==null?void 0:t.role)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"Select a role"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Technician",children:"Technician"}),e.jsx("option",{value:"Nurse",children:"Nurse"}),e.jsx("option",{value:"add-new",children:"+ Add New Role"})]}),!a&&e.jsx("button",{onClick:()=>s(!0),className:"text-xs text-[#4ECDC4] hover:text-[#38b2ac] mt-1",children:"+ Add New Role"})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Module Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{name:"Inventory Management",key:"inventory"},{name:"Sterilization",key:"sterilization"},{name:"Environmental Cleaning",key:"cleaning"},{name:"Knowledge Hub",key:"knowledge"},{name:"Settings",key:"settings"},{name:"Reports",key:"reports"}].map(d=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:(t==null?void 0:t.role)==="Admin",className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-sm text-gray-700",children:d.name})]},d.key))})]})]})},$n=()=>{const[t,a]=g.useState(!1),[s,r]=g.useState("");return e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Department Assignment"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userDepartment",className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{id:"newDepartmentInput",type:"text",placeholder:"Enter new department name",value:s,onChange:i=>r(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{s.trim()&&(r(""),a(!1))},className:"px-3 py-1 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-xs",children:"Add Department"}),e.jsx("button",{onClick:()=>{r(""),a(!1)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Cancel"})]})]}):e.jsxs("select",{id:"userDepartment",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"Select department"}),e.jsx("option",{value:"Sterilization",children:"Sterilization"}),e.jsx("option",{value:"Environmental Cleaning",children:"Environmental Cleaning"}),e.jsx("option",{value:"Inventory",children:"Inventory"}),e.jsx("option",{value:"General",children:"General"}),e.jsx("option",{value:"add-new",children:"+ Add New Department"})]}),!t&&e.jsx("button",{onClick:()=>a(!0),className:"text-xs text-[#4ECDC4] hover:text-[#38b2ac] mt-1",children:"+ Add New Department"})]})})]})},Mn=()=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Security Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Force Password Change"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Require user to change password on next login"})]}),e.jsx("button",{className:"px-3 py-1 bg-orange-100 text-orange-700 rounded-md hover:bg-orange-200 transition-colors text-xs",children:"Force Change"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Session Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"View and manage active sessions"})]}),e.jsx("button",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-xs",children:"View Sessions"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Access Logs"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Monitor login attempts and system access"})]}),e.jsx("button",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors text-xs",children:"View Logs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"IP Restrictions"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure allowed IP ranges for this user"})]}),e.jsx("button",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors text-xs",children:"Manage IPs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Device Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Approve and manage mobile devices"})]}),e.jsx("button",{className:"px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 transition-colors text-xs",children:"Manage Devices"})]})]})]}),Fn=({user:t})=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Login Security"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Failed Login Attempts"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Account lockout after multiple failed attempts"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"10",defaultValue:"5",className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-xs text-gray-500",children:"attempts"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Lockout Duration"}),e.jsx("p",{className:"text-xs text-gray-500",children:"How long to lock account after failed attempts"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"5",max:"1440",defaultValue:"30",className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-xs text-gray-500",children:"minutes"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Session Timeout"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-logout after inactivity"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",selected:!0,children:"30 minutes"}),e.jsx("option",{value:"60",children:"1 hour"}),e.jsx("option",{value:"240",children:"4 hours"}),e.jsx("option",{value:"480",children:"8 hours"})]})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Audit & Compliance"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Activity Monitoring"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Track user actions and system changes"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"activity-monitoring",defaultChecked:!0,className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"activity-monitoring",className:"text-xs text-gray-700",children:"Enabled"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Data Export Logs"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Log all data export activities"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"export-logs",defaultChecked:!0,className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"export-logs",className:"text-xs text-gray-700",children:"Enabled"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Sensitive Data Access"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Require additional verification for sensitive data"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"sensitive-data",defaultChecked:(t==null?void 0:t.role)==="Admin",className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"sensitive-data",className:"text-xs text-gray-700",children:"Enabled"})]})]})]})]})]}),Gn=({isOpen:t,onClose:a,user:s,mode:r,onSave:i})=>t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r==="add"?"Add New User":`Edit: ${(s==null?void 0:s.full_name)||"Unknown User"}`}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(S,{path:hr,size:1.2})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(kn,{user:s,mode:r}),e.jsx(Ln,{user:s,mode:r}),e.jsx($n,{user:s,mode:r}),e.jsx(Mn,{}),e.jsx(Fn,{user:s,mode:r})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{i({}),a()},className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:r==="add"?"Add User":"Save Changes"})]})]})}):null,Un=({showDeleteModal:t,selectedUser:a,onCloseDeleteModal:s,onConfirmDelete:r})=>e.jsx(e.Fragment,{children:t&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-lg p-2 mr-3",children:e.jsx(S,{path:va,size:1.5,className:"text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete User"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Are you sure you want to delete this user? This action cannot be undone."}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-red-600",children:a==null?void 0:a.name.split(" ").map(i=>i[0]).join("")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-xs text-gray-500",children:a==null?void 0:a.email}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded-full text-xs font-medium ${(a==null?void 0:a.role)==="Admin"?"bg-red-100 text-red-800":(a==null?void 0:a.role)==="Technician"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:a==null?void 0:a.role}),e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded-full text-xs font-medium ${(a==null?void 0:a.status)==="Active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:a==null?void 0:a.status})]})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"Delete User"})]})]})})});var zn=Object.defineProperty,Bn=Object.defineProperties,Hn=Object.getOwnPropertyDescriptors,ms=Object.getOwnPropertySymbols,qn=Object.prototype.hasOwnProperty,Vn=Object.prototype.propertyIsEnumerable,gs=(t,a,s)=>a in t?zn(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Yn=(t,a)=>{for(var s in a||(a={}))qn.call(a,s)&&gs(t,s,a[s]);if(ms)for(var s of ms(a))Vn.call(a,s)&&gs(t,s,a[s]);return t},Wn=(t,a)=>Bn(t,Hn(a)),xs=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Kn=()=>{const{currentUser:t}=te(),[a,s]=g.useState({sessionTimeout:480,inactiveTimeout:30,rememberMeDuration:7,requireReauthForSensitive:!0,twoFactorEnabled:!1}),[r,i]=g.useState(!1),[d,u]=g.useState(!1),[c,n]=g.useState(null),o=g.useCallback(()=>xs(null,null,function*(){var x,p;if(t){i(!0);try{const{data:h,error:C}=yield O.from("user_security_settings").select("*").eq("user_id",t.id).single();C&&C.code!=="PGRST116"?console.error("Error loading security settings:",C):h&&s({sessionTimeout:h.session_timeout||480,inactiveTimeout:h.inactive_timeout||30,rememberMeDuration:h.remember_me_duration||7,requireReauthForSensitive:(x=h.require_reauth_for_sensitive)!=null?x:!0,twoFactorEnabled:(p=h.two_factor_enabled)!=null?p:!1})}catch(h){console.error("Error loading security settings:",h)}finally{i(!1)}}}),[t]);g.useEffect(()=>{o()},[o]);const l=()=>xs(null,null,function*(){if(t){u(!0),n(null);try{const{error:x}=yield O.from("user_security_settings").upsert({user_id:t.id,session_timeout:a.sessionTimeout,inactive_timeout:a.inactiveTimeout,remember_me_duration:a.rememberMeDuration,require_reauth_for_sensitive:a.requireReauthForSensitive,two_factor_enabled:a.twoFactorEnabled,updated_at:new Date().toISOString()});if(x)throw x;n({type:"success",text:"Security settings saved successfully!"}),localStorage.setItem("cliniio_session_timeout",a.sessionTimeout.toString()),localStorage.setItem("cliniio_inactive_timeout",a.inactiveTimeout.toString()),localStorage.setItem("cliniio_remember_me_duration",a.rememberMeDuration.toString()),Ua.updateConfig({sessionTimeout:a.sessionTimeout,inactiveTimeout:a.inactiveTimeout,rememberMeDuration:a.rememberMeDuration})}catch(x){console.error("Error saving security settings:",x),n({type:"error",text:"Failed to save security settings. Please try again."})}finally{u(!1)}}}),m=(x,p)=>{s(h=>Wn(Yn({},h),{[x]:p}))};return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(x=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},x))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Security & Sessions"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Configure how long you stay logged in and security preferences for your account."})]}),c&&e.jsx("div",{className:`p-4 rounded-lg ${c.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:c.text}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Session Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"session-timeout",className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Session Duration"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"session-timeout",type:"number",min:"60",max:"1440",value:a.sessionTimeout,onChange:x=>m("sessionTimeout",parseInt(x.target.value)||480),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"minutes (1-24 hours)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long you stay logged in before being automatically logged out"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inactive-timeout",className:"block text-sm font-medium text-gray-700 mb-2",children:"Inactive Timeout"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"inactive-timeout",type:"number",min:"5",max:"120",value:a.inactiveTimeout,onChange:x=>m("inactiveTimeout",parseInt(x.target.value)||30),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"minutes (5-120 minutes)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long of inactivity before automatic logout"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"remember-me-duration",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remember Me Duration"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"remember-me-duration",type:"number",min:"1",max:"30",value:a.rememberMeDuration,onChange:x=>m("rememberMeDuration",parseInt(x.target.value)||7),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"days (1-30 days)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'How long to stay logged in when using "Remember Me"'})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Security Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"require-reauth-toggle",className:"text-sm font-medium text-gray-700",children:"Require Re-authentication for Sensitive Actions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ask for password confirmation before changing critical settings"})]}),e.jsx("button",{id:"require-reauth-toggle",onClick:()=>m("requireReauthForSensitive",!a.requireReauthForSensitive),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${a.requireReauthForSensitive?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.requireReauthForSensitive?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"two-factor-toggle",className:"text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add an extra layer of security to your account (coming soon)"})]}),e.jsx("button",{id:"two-factor-toggle",disabled:!0,className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 cursor-not-allowed",children:e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white translate-x-1"})})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-4",children:"Current Session"}),e.jsx("div",{className:"text-sm text-blue-800 space-y-2",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Logged in as:"})," ",t==null?void 0:t.email]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Ga,{variant:"detailed"})})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:l,disabled:d,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Saving...":"Save Settings"})})]})};var Ge=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});function Zn(){const{getCurrentFacilityId:t}=V(),{currentUser:a}=te(),[s,r]=g.useState([]),[i,d]=g.useState([]),[u,c]=g.useState(!0),[n,o]=g.useState(null),[l,m]=g.useState(null),[x,p]=g.useState(!1),[h,C]=g.useState(!1),[I,_]=g.useState([]),[j,f]=g.useState(new Set);function N(){return Ge(this,null,function*(){c(!0);try{const[w,E]=yield Promise.all([Ka(),Za()]);r(w),d(E)}catch(w){console.error("Failed to load audit dashboard:",w)}finally{c(!1)}})}function y(){return Ge(this,null,function*(){try{const w=yield Ja();_(w)}catch(w){console.error("Failed to load historical compliance data:",w)}})}g.useEffect(()=>{N()},[]);const v=w=>{o(w)},T=()=>{o(null)},$=w=>{const E=new Set(j);E.has(w)?E.delete(w):E.add(w),f(E)},Y=w=>{switch(w){case"high":return e.jsx(Le,{className:"w-4 h-4 text-red-500"});case"medium":return e.jsx(Le,{className:"w-4 h-4 text-orange-500"});case"low":return e.jsx(Le,{className:"w-4 h-4 text-yellow-500"});default:return e.jsx(Le,{className:"w-4 h-4 text-gray-500"})}},le=w=>{switch(w){case"high":return"bg-red-500 text-white";case"medium":return"bg-orange-500 text-white";case"low":return"bg-yellow-500 text-white";default:return"bg-gray-500 text-white"}},k=w=>Ge(null,null,function*(){m(w);try{const{data:{user:E}}=yield O.auth.getUser(),{error:R}=yield O.from("audit_flags").update({resolved:!0}).eq("id",w);if(R){console.error("Failed to resolve audit flag:",R),alert("Failed to resolve compliance issue: "+R.message);return}console.log("Successfully updated audit flag in database");const{error:A}=yield O.from("audit_logs").insert({id:crypto.randomUUID(),module:"compliance",table_name:"audit_flags",action:"compliance_issue_resolved",record_id:w,user_id:(a==null?void 0:a.id)||"00000000-0000-0000-0000-000000000000",facility_id:t()||"unknown-facility",metadata:{resolution_timestamp:new Date().toISOString(),resolved_by:(a==null?void 0:a.id)||"unknown-user",resolution_type:"manual_resolution"},created_at:new Date().toISOString()});A&&console.error("Failed to create audit log:",A),console.log("Refreshing data..."),yield N();const se=s.filter(H=>H.id!==w);r(se),console.log("Data refreshed, current flags count:",se.length),(n==null?void 0:n.id)===w&&o(null),console.log("Compliance issue resolved successfully:",w),setTimeout(()=>{console.log("Dispatching complianceIssueResolved event"),window.dispatchEvent(new CustomEvent("complianceIssueResolved",{detail:{flagId:w,resolvedCount:se.length}}))},500)}catch(E){console.error("Error resolving compliance issue:",E)}finally{m(null)}}),Ee=()=>Ge(null,null,function*(){p(!0);try{const{data:{user:w}}=yield O.auth.getUser(),E={generated_at:new Date().toISOString(),generated_by:(w==null?void 0:w.id)||"unknown-user",facility_id:t()||"unknown-facility",active_issues:s.filter(H=>!H.resolved),resolved_issues:s.filter(H=>H.resolved),total_issues:s.length,severity_breakdown:{high:s.filter(H=>H.severity==="high"&&!H.resolved).length,medium:s.filter(H=>H.severity==="medium"&&!H.resolved).length,low:s.filter(H=>H.severity==="low"&&!H.resolved).length}};yield O.from("audit_logs").insert({id:crypto.randomUUID(),module:"compliance",table_name:"audit_flags",action:"compliance_report_exported",record_id:null,user_id:(w==null?void 0:w.id)||"unknown-user",facility_id:t()||"unknown-facility",metadata:{export_timestamp:new Date().toISOString(),exported_by:(w==null?void 0:w.id)||"unknown-user",report_summary:E},created_at:new Date().toISOString()});const R=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),A=URL.createObjectURL(R),se=document.createElement("a");se.href=A,se.download=`compliance-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(A)}catch(w){console.error("Error exporting compliance report:",w)}finally{p(!1)}});return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Audit & Compliance Dashboard"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{C(!h),h||y()},className:`px-4 py-2 rounded transition-colors ${h?"bg-purple-500 text-white hover:bg-purple-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:h?"Hide Historical":"View Historical"}),e.jsxs("button",{onClick:Ee,disabled:x||s.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(ka,{className:"w-4 h-4"}),x?"Exporting...":"Export Report"]})]})]}),u?e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"animate-spin w-4 h-4"})," Loading…"]}):e.jsx(e.Fragment,{children:e.jsxs(za,{className:"p-4",children:[e.jsxs("h2",{className:"text-lg font-medium mb-2",children:["🚨 Active Compliance Issues (",s.length,")"]}),s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),e.jsx("p",{className:"text-muted text-lg",children:"No active compliance issues!"}),e.jsx("p",{className:"text-muted text-sm mt-2",children:"All systems are operating within compliance standards."})]}):e.jsx("div",{className:"space-y-4",children:s.map(w=>{const E=j.has(w.id);return e.jsxs("div",{className:"border rounded-lg hover:shadow-md transition-all",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>$(w.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[E?e.jsx(La,{className:"w-4 h-4 text-gray-500"}):e.jsx($a,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${w.severity==="high"?"bg-red-100 text-red-800 border border-red-200":w.severity==="medium"?"bg-orange-100 text-orange-800 border border-orange-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`,children:[w.severity.toUpperCase()," SEVERITY"]}),w.compliance_standard&&e.jsx("span",{className:"text-sm bg-[#4ECDC4] text-white px-3 py-1 rounded font-medium",children:w.compliance_standard})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:R=>{R.stopPropagation(),v(w)},className:"px-3 py-1 bg-[#4ECDC4] text-white text-sm rounded hover:bg-[#3BB5AD] transition-colors",children:"View Details"}),e.jsxs("button",{onClick:R=>{R.stopPropagation(),k(w.id)},disabled:l===w.id,className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center gap-1",children:[l===w.id?e.jsx(We,{className:"w-3 h-3 animate-spin"}):e.jsx(At,{className:"w-3 h-3"}),l===w.id?"Resolving...":"Resolve"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("p",{className:"text-gray-900 font-medium",children:w.description})})]}),E&&e.jsx("div",{className:"px-4 pb-4 border-t bg-gray-50/50",children:e.jsxs("div",{className:"pt-4 space-y-4",children:[w.compliance_standard&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Compliance Requirement"}),e.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Standard:"}),e.jsx("p",{className:"text-gray-800 font-semibold",children:w.compliance_standard})]}),w.regulation_reference&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Reference:"}),e.jsx("p",{className:"text-gray-800",children:w.regulation_reference})]})]}),w.requirement_description&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Requirement:"}),e.jsx("p",{className:"text-blue-700 mt-1",children:w.requirement_description})]})]})]}),w.corrective_action&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"Required Actions"}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:e.jsx("div",{className:"text-green-800 whitespace-pre-line text-sm",children:w.corrective_action})})]}),(w.responsible_party||w.due_date)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:"Assignment & Timeline"}),e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[w.responsible_party&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Responsible:"}),e.jsx("p",{className:"text-purple-700 font-semibold",children:w.responsible_party})]}),w.due_date&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Due Date:"}),e.jsx("p",{className:"text-purple-700 font-semibold",children:new Date(w.due_date).toLocaleDateString()})]})]})})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["📋 System: ",w.related_table.replace("_"," ")]}),w.related_id&&e.jsxs("span",{children:["🔗 Record: ",w.related_id.slice(0,8),"..."]}),e.jsxs("span",{children:["📅 Detected: ",new Date(w.created_at).toLocaleDateString()]})]})})]})})]},w.id)})})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto scrollbar-hide",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Y(n.severity),e.jsx("h2",{className:"text-xl font-semibold",children:"Compliance Issue Details"})]}),e.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Ma,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${le(n.severity)}`,children:[n.severity.toUpperCase()," SEVERITY"]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${n.resolved?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:n.resolved?"RESOLVED":"ACTIVE"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Issue Description"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:n.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ot,{className:"w-4 h-4 text-blue-600"}),e.jsx("h4",{className:"font-medium text-blue-900",children:"Related Table"})]}),e.jsx("p",{className:"text-blue-700",children:n.related_table})]}),n.related_id&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ot,{className:"w-4 h-4 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:"Record ID"})]}),e.jsx("p",{className:"text-green-700 font-mono text-sm",children:n.related_id})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Fa,{className:"w-4 h-4 text-gray-600"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Timeline"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(n.created_at).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age:"})," ",Math.floor((Date.now()-new Date(n.created_at).getTime())/(1e3*60*60*24))," days"]})]})]}),n.compliance_standard&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Compliance Requirements"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Standard:"}),e.jsx("span",{className:"text-blue-700 ml-2",children:n.compliance_standard})]}),n.regulation_reference&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Reference:"}),e.jsx("span",{className:"text-blue-700 ml-2",children:n.regulation_reference})]}),n.requirement_description&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Requirement:"}),e.jsx("p",{className:"text-blue-700 mt-1",children:n.requirement_description})]})]})]}),n.corrective_action&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Required Corrective Actions"}),e.jsx("div",{className:"text-sm text-green-800 whitespace-pre-line",children:n.corrective_action})]}),(n.responsible_party||n.due_date)&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:"Assignment & Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[n.responsible_party&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Responsible Party:"}),e.jsx("p",{className:"text-purple-700",children:n.responsible_party})]}),n.due_date&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Due Date:"}),e.jsx("p",{className:"text-purple-700",children:new Date(n.due_date).toLocaleDateString()})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:[e.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:"Close"}),e.jsxs("button",{onClick:()=>k(n.id),disabled:l===n.id,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[l===n.id?e.jsx(We,{className:"w-4 h-4 animate-spin"}):e.jsx(At,{className:"w-4 h-4"}),l===n.id?"Resolving...":"Mark as Resolved"]})]})]})})})]})}var Jn=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Qn=({initialTab:t,complianceFlagCount:a=0})=>{const[s]=g.useState([]),[r,i]=g.useState(!1),[d,u]=g.useState(!1),[c,n]=g.useState(!1),[o,l]=g.useState(null),[m,x]=g.useState(t==="audit"?"audit":t==="security"?"security":t==="office-hours"?"office-hours":"users"),[p,h]=g.useState(0);(()=>{const f=s.filter($=>$.status==="Active").length,N=[{min:0,max:5,name:"0-5 Users"},{min:6,max:15,name:"6-15 Users"},{min:16,max:21,name:"16-21 Users"},{min:22,max:1/0,name:"21+ Users"}],y=N.find($=>f>=$.min&&f<=$.max),v=N.find($=>$.min>f);if(!y||!v)return null;const T=v.min-f;return{currentTier:y,nextTier:v,usersToNextTier:T,activeUserCount:f}})(),g.useEffect(()=>{function f(){return Jn(this,null,function*(){try{const{count:N,error:y}=yield O.from("audit_flags").select("*",{count:"exact",head:!0}).eq("resolved",!1);!y&&typeof N=="number"&&h(N)}catch(N){console.error("Failed to fetch audit flag count:",N)}})}f()},[]);const I=()=>{i(!1),u(!1),n(!1),l(null)},_=f=>{console.log("Saving user:",f),I()},j=()=>{console.log("Deleting user:",o),I()};return e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"System Administration"}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>x("users"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="users"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"User Management"}),e.jsx("button",{onClick:()=>x("office-hours"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="office-hours"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Office Set-up"}),e.jsx("button",{onClick:()=>x("security"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="security"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Security & Sessions"}),e.jsx("button",{onClick:()=>x("audit"),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${m==="audit"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} ${a>0?"bg-red-50 text-red-700 border-red-300":""}`,children:e.jsx("span",{children:"Audit & Compliance"})})]})})}),m==="users"&&e.jsx(e.Fragment,{children:e.jsx(Ba,{})}),m==="office-hours"&&e.jsx("div",{children:e.jsx(Rn,{})}),m==="security"&&e.jsx("div",{children:e.jsx(Kn,{})}),m==="audit"&&e.jsx("div",{children:e.jsx(Zn,{})}),e.jsx(Gn,{isOpen:r||d,onClose:I,onSave:_,user:o,mode:d?"edit":"add"}),e.jsx(Un,{showDeleteModal:c,selectedUser:o,onCloseDeleteModal:()=>n(!1),onConfirmDelete:j})]})},Xn=()=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Billing & Subscription Settings"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Plan"}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"text-base font-semibold text-blue-900",children:"Professional Plan"}),e.jsx("p",{className:"text-xs text-blue-700",children:"$299/month • 50 users • Full features"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Next billing: Jan 15, 2024"})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"Active"})})]})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Methods"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-5 bg-blue-600 rounded mr-2 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"VISA"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"•••• •••• •••• 4242"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Expires 12/25"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-xs px-1 py-0.5 rounded-full",children:"Default"}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-xs",children:"Edit"})]})]}),e.jsx("button",{className:"w-full p-2 border-2 border-dashed border-gray-300 rounded-md text-gray-500 hover:border-gray-400 hover:text-gray-700 transition-colors text-xs",children:"+ Add Payment Method"})]})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Billing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company-name",className:"block text-xs font-medium text-gray-600 mb-1",children:"Company Name"}),e.jsx("input",{id:"company-name",type:"text",defaultValue:"Medical Center Inc.",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tax-id",className:"block text-xs font-medium text-gray-600 mb-1",children:"Tax ID"}),e.jsx("input",{id:"tax-id",type:"text",defaultValue:"12-3456789",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-email",className:"block text-xs font-medium text-gray-600 mb-1",children:"Billing Email"}),e.jsx("input",{id:"billing-email",type:"email",defaultValue:"billing@medicalcenter.com",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-phone",className:"block text-xs font-medium text-gray-600 mb-1",children:"Phone"}),e.jsx("input",{id:"billing-phone",type:"tel",defaultValue:"+1 (555) 123-4567",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-city",className:"block text-xs font-medium text-gray-600 mb-1",children:"City"}),e.jsx("input",{id:"billing-city",type:"text",defaultValue:"New York",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-state-zip",className:"block text-xs font-medium text-gray-600 mb-1",children:"State/ZIP"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{id:"billing-state",type:"text",defaultValue:"NY",className:"w-1/2 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("input",{id:"billing-zip",type:"text",defaultValue:"10001",className:"w-1/2 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Invoice Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Frequency"}),e.jsxs("select",{className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{children:"Monthly"}),e.jsx("option",{children:"Quarterly"}),e.jsx("option",{children:"Annually"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Auto-pay"}),e.jsx("input",{type:"checkbox",id:"auto-pay",className:"rounded",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Reminders"}),e.jsx("input",{type:"checkbox",id:"payment-reminders",className:"rounded",defaultChecked:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Usage & Limits"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Users"}),e.jsx("span",{className:"text-xs text-gray-600",children:"35/50"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:"70%"}})})]}),e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Storage"}),e.jsx("span",{className:"text-xs text-gray-600",children:"2.1/10 GB"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-600 h-1.5 rounded-full",style:{width:"21%"}})})]}),e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"API Calls"}),e.jsx("span",{className:"text-xs text-gray-600",children:"45K/100K"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-yellow-600 h-1.5 rounded-full",style:{width:"45%"}})})]})]})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Plan Management"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{className:"p-2 border border-blue-300 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-xs",children:"Upgrade"}),e.jsx("button",{className:"p-2 border border-gray-300 bg-gray-50 text-gray-700 rounded-md hover:bg-gray-100 transition-colors text-xs",children:"Downgrade"}),e.jsx("button",{className:"p-2 border border-red-300 bg-red-50 text-red-700 rounded-md hover:bg-red-100 transition-colors text-xs",children:"Cancel"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Save Changes"})})]}),b={HEADER:{TITLE:"AI and Analytics Settings",SUBTITLE:"Configure AI features, analytics, and intelligence settings"},BUTTONS:{RESET:"Reset",SAVE:"Save Settings",SAVING:"Saving..."},MESSAGES:{LOADING:"Loading AI settings...",FACILITY_NOT_AVAILABLE:"Facility not available. Please select a facility first.",FAILED_TO_LOAD:"Failed to load AI settings. Please try refreshing the page.",SAVE_SUCCESS:"AI settings saved and applied successfully!",SAVE_ERROR:"Failed to save AI settings",RESET_SUCCESS:"Settings reset to defaults",RESET_ERROR:"Failed to reset settings"},SECTIONS:{AI_SERVICE_STATUS:"AI Service Status",ENABLE_AI_FEATURES:"Enable AI Features",AI_FEATURES:"AI Features",TOKEN_USAGE_DASHBOARD:"AI Usage Dashboard",THROTTLING_CONTROLS:"Throttling Controls",ANALYTICS_CONFIGURATION:"Analytics Configuration",INTELLIGENCE_SETTINGS:"Intelligence Settings",PERFORMANCE_MONITORING:"Performance Monitoring",DATA_PRIVACY_SECURITY:"Data Privacy & Security",INTEGRATION_SETTINGS:"Integration Settings",USER_EXPERIENCE:"User Experience"},FORM_GROUPS:{COMPUTER_VISION:"Computer Vision",PREDICTIVE_ANALYTICS:"Predictive Analytics",SMART_WORKFLOW:"Smart Workflow",DATA_COLLECTION:"Data Collection",REPORTING_EXPORT:"Reporting & Export",RISK_ALERTS:"Risk & Alerts",AI_INSIGHTS:"AI Insights",QUALITY_METRICS:"Quality Metrics",OPTIMIZATION:"Optimization",PRIVACY_CONTROLS:"Privacy Controls",SECURITY_FEATURES:"Security Features",EXTERNAL_SERVICES:"External Services",SYSTEM_HEALTH:"System Health",AI_ASSISTANCE:"AI Assistance",INTERFACE_HELP:"Interface & Help"},TOGGLE_LABELS:{TOOL_CONDITION_ASSESSMENT:"Tool Condition Assessment",BARCODE_QUALITY_DETECTION:"Barcode Quality Detection",DAMAGE_DETECTION:"Damage Detection",CYCLE_OPTIMIZATION:"Cycle Optimization",FAILURE_PREDICTION:"Failure Prediction",EFFICIENCY_OPTIMIZATION:"Efficiency Optimization",INTELLIGENT_WORKFLOW_SELECTION:"Intelligent Workflow Selection",AUTOMATED_PROBLEM_DETECTION:"Automated Problem Detection",DATA_COLLECTION:"Data Collection",REAL_TIME_UPDATES:"Real-time Updates",HISTORICAL_DATA_RETENTION:"Historical Data Retention",EXPORT_CAPABILITIES:"Export Capabilities",DASHBOARD_CUSTOMIZATION:"Dashboard Customization",RISK_ASSESSMENT:"Risk Assessment",ALERT_SYSTEM:"Alert System",ESCALATION_RULES:"Escalation Rules",AI_RECOMMENDATIONS:"AI Recommendations",OPTIMIZATION_TIPS:"Optimization Tips",ACCURACY_TRACKING:"Accuracy Tracking",RESPONSE_TIME_MONITORING:"Response Time Monitoring",ERROR_RATE_TRACKING:"Error Rate Tracking",PERFORMANCE_ALERTS:"Performance Alerts",MODEL_HEALTH_MONITORING:"Model Health Monitoring",DATA_ANONYMIZATION:"Data Anonymization",THIRD_PARTY_PERMISSIONS:"Third-party Permissions",COMPLIANCE_MONITORING:"Compliance Monitoring",ENCRYPTION:"Encryption",ACCESS_CONTROL:"Access Control",EXTERNAL_SERVICES:"External Services",API_RATE_LIMITING:"API Rate Limiting",WEBHOOK_ENDPOINTS:"Webhook Endpoints",HEALTH_MONITORING:"Health Monitoring",SYNC_SCHEDULING:"Sync Scheduling",AI_SUGGESTIONS:"AI Suggestions",LEARNING_PATHS:"Learning Paths",PERSONALIZATION:"Personalization",ACCESSIBILITY_FEATURES:"Accessibility Features",SMART_HELP_SYSTEM:"Smart Help System"},DESCRIPTIONS:{MASTER_AI_TOGGLE:"Master toggle for all AI-powered features across the system",TOOL_CONDITION_ASSESSMENT:"AI-powered tool wear and condition analysis",BARCODE_QUALITY_DETECTION:"Automatic barcode readability assessment",DAMAGE_DETECTION:"AI detection of tool damage and defects",CYCLE_OPTIMIZATION:"AI-powered sterilization cycle optimization",FAILURE_PREDICTION:"Predictive maintenance and failure alerts",EFFICIENCY_OPTIMIZATION:"AI-driven workflow efficiency improvements",INTELLIGENT_WORKFLOW_SELECTION:"AI-powered workflow recommendations",AUTOMATED_PROBLEM_DETECTION:"AI detection of workflow issues",DATA_COLLECTION:"Enable comprehensive data collection",REAL_TIME_UPDATES:"Live analytics and dashboard updates",HISTORICAL_DATA_RETENTION:"Long-term data storage and analysis",EXPORT_CAPABILITIES:"PDF, CSV, and Excel export options",DASHBOARD_CUSTOMIZATION:"Customizable analytics dashboards",RISK_ASSESSMENT:"AI-powered risk analysis and scoring",ALERT_SYSTEM:"Smart notification and alert system",ESCALATION_RULES:"Automatic alert escalation based on priority",AI_RECOMMENDATIONS:"Intelligent recommendations and suggestions",OPTIMIZATION_TIPS:"AI-generated optimization suggestions",ACCURACY_TRACKING:"Monitor AI prediction accuracy",RESPONSE_TIME_MONITORING:"Track AI response times and performance",ERROR_RATE_TRACKING:"Monitor and track error rates",PERFORMANCE_ALERTS:"Alerts for performance issues",MODEL_HEALTH_MONITORING:"AI model performance and health tracking",DATA_ANONYMIZATION:"Automatically anonymize sensitive data",THIRD_PARTY_PERMISSIONS:"Control third-party AI service access",COMPLIANCE_MONITORING:"Monitor regulatory compliance",ENCRYPTION:"End-to-end data encryption",ACCESS_CONTROL:"Role-based access control for AI features",EXTERNAL_SERVICES:"Connect to external AI and analytics services",API_RATE_LIMITING:"Control API usage and rate limits",WEBHOOK_ENDPOINTS:"Enable webhook notifications and integrations",HEALTH_MONITORING:"Monitor integration system health",SYNC_SCHEDULING:"Automated data synchronization",AI_SUGGESTIONS:"Contextual AI-powered suggestions",LEARNING_PATHS:"Personalized AI learning recommendations",PERSONALIZATION:"AI-driven interface personalization",ACCESSIBILITY_FEATURES:"AI-powered accessibility enhancements",SMART_HELP_SYSTEM:"AI-powered contextual help and guidance"},STATUS:{ACTIVE:"Available",INACTIVE:"In Use"}},hs={MESSAGE_DISPLAY:5e3,RESET_MESSAGE_DISPLAY:3e3},D=({id:t,checked:a,onChange:s,label:r,description:i,disabled:d=!1})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:r}),i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]}),e.jsxs("label",{htmlFor:t,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{id:t,type:"checkbox",className:"sr-only peer",checked:a,onChange:u=>s(u.target.checked),disabled:d}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"} ${d?"opacity-50 cursor-not-allowed":"cursor-pointer"}`}),e.jsx("span",{className:"sr-only",children:r})]})]}),B=({title:t,children:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 border-b border-gray-200 pb-2",children:t}),e.jsx("div",{className:"space-y-4",children:a})]}),ei=({settings:t,updateMasterAI:a,updateComputerVision:s,updatePredictiveAnalytics:r,updateSmartWorkflow:i})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:b.SECTIONS.ENABLE_AI_FEATURES}),e.jsx("p",{className:"text-sm text-gray-500",children:b.DESCRIPTIONS.MASTER_AI_TOGGLE})]}),e.jsx(D,{id:"aiEnabled",checked:t.aiEnabled,onChange:a,label:""})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:pr,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.AI_FEATURES})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.COMPUTER_VISION,children:[e.jsx(D,{id:"toolConditionAssessment",checked:t.computerVision.toolConditionAssessment,onChange:d=>s("toolConditionAssessment",d),label:b.TOGGLE_LABELS.TOOL_CONDITION_ASSESSMENT,description:b.DESCRIPTIONS.TOOL_CONDITION_ASSESSMENT,disabled:!t.aiEnabled}),e.jsx(D,{id:"barcodeQualityDetection",checked:t.computerVision.barcodeQualityDetection,onChange:d=>s("barcodeQualityDetection",d),label:b.TOGGLE_LABELS.BARCODE_QUALITY_DETECTION,description:b.DESCRIPTIONS.BARCODE_QUALITY_DETECTION,disabled:!t.aiEnabled}),e.jsx(D,{id:"damageDetection",checked:t.computerVision.damageDetection,onChange:d=>s("damageDetection",d),label:b.TOGGLE_LABELS.DAMAGE_DETECTION,description:b.DESCRIPTIONS.DAMAGE_DETECTION,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.PREDICTIVE_ANALYTICS,children:[e.jsx(D,{id:"cycleOptimization",checked:t.predictiveAnalytics.cycleOptimization,onChange:d=>r("cycleOptimization",d),label:b.TOGGLE_LABELS.CYCLE_OPTIMIZATION,description:b.DESCRIPTIONS.CYCLE_OPTIMIZATION,disabled:!t.aiEnabled}),e.jsx(D,{id:"failurePrediction",checked:t.predictiveAnalytics.failurePrediction,onChange:d=>r("failurePrediction",d),label:b.TOGGLE_LABELS.FAILURE_PREDICTION,description:b.DESCRIPTIONS.FAILURE_PREDICTION,disabled:!t.aiEnabled}),e.jsx(D,{id:"efficiencyOptimization",checked:t.predictiveAnalytics.efficiencyOptimization,onChange:d=>r("efficiencyOptimization",d),label:b.TOGGLE_LABELS.EFFICIENCY_OPTIMIZATION,description:b.DESCRIPTIONS.EFFICIENCY_OPTIMIZATION,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.SMART_WORKFLOW,children:[e.jsx(D,{id:"intelligentWorkflowSelection",checked:t.smartWorkflow.intelligentWorkflowSelection,onChange:d=>i("intelligentWorkflowSelection",d),label:b.TOGGLE_LABELS.INTELLIGENT_WORKFLOW_SELECTION,description:b.DESCRIPTIONS.INTELLIGENT_WORKFLOW_SELECTION,disabled:!t.aiEnabled}),e.jsx(D,{id:"automatedProblemDetection",checked:t.smartWorkflow.automatedProblemDetection,onChange:d=>i("automatedProblemDetection",d),label:b.TOGGLE_LABELS.AUTOMATED_PROBLEM_DETECTION,description:b.DESCRIPTIONS.AUTOMATED_PROBLEM_DETECTION,disabled:!t.aiEnabled})]})]})]})})]}),ti=({settings:t,updateAnalytics:a})=>e.jsxs(B,{title:b.FORM_GROUPS.REPORTING_EXPORT,children:[e.jsx(D,{id:"exportCapabilities",checked:t.analytics.exportCapabilities,onChange:s=>a("exportCapabilities",s),label:b.TOGGLE_LABELS.EXPORT_CAPABILITIES,description:b.DESCRIPTIONS.EXPORT_CAPABILITIES,disabled:!t.aiEnabled}),e.jsx(D,{id:"dashboardCustomization",checked:t.analytics.dashboardCustomization,onChange:s=>a("dashboardCustomization",s),label:b.TOGGLE_LABELS.DASHBOARD_CUSTOMIZATION,description:b.DESCRIPTIONS.DASHBOARD_CUSTOMIZATION,disabled:!t.aiEnabled})]}),si=({settings:t,updateAnalytics:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:_e,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.ANALYTICS_CONFIGURATION})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.DATA_COLLECTION,children:[e.jsx(D,{id:"dataCollection",checked:t.analytics.dataCollection,onChange:s=>a("dataCollection",s),label:b.TOGGLE_LABELS.DATA_COLLECTION,description:b.DESCRIPTIONS.DATA_COLLECTION,disabled:!t.aiEnabled}),e.jsx(D,{id:"realTimeUpdates",checked:t.analytics.realTimeUpdates,onChange:s=>a("realTimeUpdates",s),label:b.TOGGLE_LABELS.REAL_TIME_UPDATES,description:b.DESCRIPTIONS.REAL_TIME_UPDATES,disabled:!t.aiEnabled}),e.jsx(D,{id:"historicalDataRetention",checked:t.analytics.historicalDataRetention,onChange:s=>a("historicalDataRetention",s),label:b.TOGGLE_LABELS.HISTORICAL_DATA_RETENTION,description:b.DESCRIPTIONS.HISTORICAL_DATA_RETENTION,disabled:!t.aiEnabled})]}),e.jsx(ti,{settings:t,updateAnalytics:a})]})]}),ai=({settings:t,updatePerformance:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:ja,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.PERFORMANCE_MONITORING})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.QUALITY_METRICS,children:[e.jsx(D,{id:"accuracyTracking",checked:t.performance.accuracyTracking,onChange:s=>a("accuracyTracking",s),label:b.TOGGLE_LABELS.ACCURACY_TRACKING,description:b.DESCRIPTIONS.ACCURACY_TRACKING,disabled:!t.aiEnabled}),e.jsx(D,{id:"responseTimeMonitoring",checked:t.performance.responseTimeMonitoring,onChange:s=>a("responseTimeMonitoring",s),label:b.TOGGLE_LABELS.RESPONSE_TIME_MONITORING,description:b.DESCRIPTIONS.RESPONSE_TIME_MONITORING,disabled:!t.aiEnabled}),e.jsx(D,{id:"errorRateTracking",checked:t.performance.errorRateTracking,onChange:s=>a("errorRateTracking",s),label:b.TOGGLE_LABELS.ERROR_RATE_TRACKING,description:b.DESCRIPTIONS.ERROR_RATE_TRACKING,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.OPTIMIZATION,children:[e.jsx(D,{id:"performanceAlerts",checked:t.performance.performanceAlerts,onChange:s=>a("performanceAlerts",s),label:b.TOGGLE_LABELS.PERFORMANCE_ALERTS,description:b.DESCRIPTIONS.PERFORMANCE_ALERTS,disabled:!t.aiEnabled}),e.jsx(D,{id:"modelHealthMonitoring",checked:t.performance.modelHealthMonitoring,onChange:s=>a("modelHealthMonitoring",s),label:b.TOGGLE_LABELS.MODEL_HEALTH_MONITORING,description:b.DESCRIPTIONS.MODEL_HEALTH_MONITORING,disabled:!t.aiEnabled})]})]})]}),ri=({settings:t,updatePrivacy:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:Na,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.DATA_PRIVACY_SECURITY})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.PRIVACY_CONTROLS,children:[e.jsx(D,{id:"dataAnonymization",checked:t.privacy.dataAnonymization,onChange:s=>a("dataAnonymization",s),label:b.TOGGLE_LABELS.DATA_ANONYMIZATION,description:b.DESCRIPTIONS.DATA_ANONYMIZATION,disabled:!t.aiEnabled}),e.jsx(D,{id:"thirdPartyPermissions",checked:t.privacy.thirdPartyPermissions,onChange:s=>a("thirdPartyPermissions",s),label:b.TOGGLE_LABELS.THIRD_PARTY_PERMISSIONS,description:b.DESCRIPTIONS.THIRD_PARTY_PERMISSIONS,disabled:!t.aiEnabled}),e.jsx(D,{id:"complianceMonitoring",checked:t.privacy.complianceMonitoring,onChange:s=>a("complianceMonitoring",s),label:b.TOGGLE_LABELS.COMPLIANCE_MONITORING,description:b.DESCRIPTIONS.COMPLIANCE_MONITORING,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.SECURITY_FEATURES,children:[e.jsx(D,{id:"encryption",checked:t.privacy.encryption,onChange:s=>a("encryption",s),label:b.TOGGLE_LABELS.ENCRYPTION,description:b.DESCRIPTIONS.ENCRYPTION,disabled:!t.aiEnabled}),e.jsx(D,{id:"accessControl",checked:t.privacy.accessControl,onChange:s=>a("accessControl",s),label:b.TOGGLE_LABELS.ACCESS_CONTROL,description:b.DESCRIPTIONS.ACCESS_CONTROL,disabled:!t.aiEnabled})]})]})]}),ni=({settings:t,updateIntegration:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:fr,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.INTEGRATION_SETTINGS})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.EXTERNAL_SERVICES,children:[e.jsx(D,{id:"externalServices",checked:t.integration.externalServices,onChange:s=>a("externalServices",s),label:b.TOGGLE_LABELS.EXTERNAL_SERVICES,description:b.DESCRIPTIONS.EXTERNAL_SERVICES,disabled:!t.aiEnabled}),e.jsx(D,{id:"apiRateLimiting",checked:t.integration.apiRateLimiting,onChange:s=>a("apiRateLimiting",s),label:b.TOGGLE_LABELS.API_RATE_LIMITING,description:b.DESCRIPTIONS.API_RATE_LIMITING,disabled:!t.aiEnabled}),e.jsx(D,{id:"webhookEndpoints",checked:t.integration.webhookEndpoints,onChange:s=>a("webhookEndpoints",s),label:b.TOGGLE_LABELS.WEBHOOK_ENDPOINTS,description:b.DESCRIPTIONS.WEBHOOK_ENDPOINTS,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.SYSTEM_HEALTH,children:[e.jsx(D,{id:"healthMonitoring",checked:t.integration.healthMonitoring,onChange:s=>a("healthMonitoring",s),label:b.TOGGLE_LABELS.HEALTH_MONITORING,description:b.DESCRIPTIONS.HEALTH_MONITORING,disabled:!t.aiEnabled}),e.jsx(D,{id:"syncScheduling",checked:t.integration.syncScheduling,onChange:s=>a("syncScheduling",s),label:b.TOGGLE_LABELS.SYNC_SCHEDULING,description:b.DESCRIPTIONS.SYNC_SCHEDULING,disabled:!t.aiEnabled})]})]})]}),ii=({serviceStatus:t})=>e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-3",children:b.SECTIONS.AI_SERVICE_STATUS}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(t).map(([a,s])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:s?be:z,size:1,className:s?"text-green-600":"text-red-500"}),e.jsx("span",{className:"text-sm capitalize",children:a}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s?b.STATUS.ACTIVE:b.STATUS.INACTIVE})]},a))})]}),li=({settings:t,updateUserExperience:a})=>e.jsxs(B,{title:b.FORM_GROUPS.INTERFACE_HELP,children:[e.jsx(D,{id:"accessibility",checked:t.userExperience.accessibility,onChange:s=>a("accessibility",s),label:b.TOGGLE_LABELS.ACCESSIBILITY_FEATURES,description:b.DESCRIPTIONS.ACCESSIBILITY_FEATURES,disabled:!t.aiEnabled}),e.jsx(D,{id:"helpSystem",checked:t.userExperience.helpSystem,onChange:s=>a("helpSystem",s),label:b.TOGGLE_LABELS.SMART_HELP_SYSTEM,description:b.DESCRIPTIONS.SMART_HELP_SYSTEM,disabled:!t.aiEnabled})]}),oi=({settings:t,updateUserExperience:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:ba,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.USER_EXPERIENCE})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.AI_ASSISTANCE,children:[e.jsx(D,{id:"aiSuggestions",checked:t.userExperience.aiSuggestions,onChange:s=>a("aiSuggestions",s),label:b.TOGGLE_LABELS.AI_SUGGESTIONS,description:b.DESCRIPTIONS.AI_SUGGESTIONS,disabled:!t.aiEnabled}),e.jsx(D,{id:"learningPaths",checked:t.userExperience.learningPaths,onChange:s=>a("learningPaths",s),label:b.TOGGLE_LABELS.LEARNING_PATHS,description:b.DESCRIPTIONS.LEARNING_PATHS,disabled:!t.aiEnabled}),e.jsx(D,{id:"personalization",checked:t.userExperience.personalization,onChange:s=>a("personalization",s),label:b.TOGGLE_LABELS.PERSONALIZATION,description:b.DESCRIPTIONS.PERSONALIZATION,disabled:!t.aiEnabled})]}),e.jsx(li,{settings:t,updateUserExperience:a})]})]}),Ia=()=>{const{currentUser:t}=te(),a=()=>{var d;if(!t)return!1;const u=(d=t.role)==null?void 0:d.toLowerCase();return["administrator","admin","👑 administrator","system_admin","super_admin"].includes(u)},s=()=>a(),r=()=>!!t,i=()=>a();return{isAdmin:a(),canManageThrottling:s(),canViewUsage:r(),canConfigureAI:i(),userRole:(t==null?void 0:t.role)||"Unknown"}};var ci=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const di=({facilityId:t})=>{const[a,s]=g.useState(null),[r,i]=g.useState(!0),[d,u]=g.useState(null),[c,n]=g.useState(!1),[o,l]=g.useState(!1),m=pa.getInstance(),{canViewUsage:x}=Ia();g.useEffect(()=>{const C=()=>ci(null,null,function*(){try{i(!0);const _=m.getUsageData();s(_)}catch(_){u("Failed to load usage data"),console.error("Error fetching token usage:",_)}finally{i(!1)}});C();const I=setInterval(C,3e4);return()=>clearInterval(I)},[t,m]);const p=C=>C>=90?"text-red-600 bg-red-50 border-red-200":C>=75?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-green-600 bg-green-50 border-green-200",h=C=>C>=90?z:C>=75?Ht:be;return x?r?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})]})}):d||!a?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{path:z,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:d||"No usage data available"})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(S,{path:_e,size:1.2,className:"text-[#4ECDC4]"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"AI Usage Dashboard"})]}),e.jsxs("div",{className:`p-4 rounded-lg border mb-6 ${p(a.budget.percentage)}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:h(a.budget.percentage),size:1,className:a.budget.percentage>=75?"text-current":"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Monthly Usage Status"}),e.jsxs("p",{className:"text-sm opacity-75",children:[a.currentMonth.tokens.toLocaleString()," tokens used this month"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.budget.percentage.toFixed(1),"%"]}),e.jsxs("div",{className:"text-sm opacity-75",children:[Math.max(0,a.budget.limit-a.currentMonth.tokens).toLocaleString()," tokens remaining"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${a.budget.percentage>=90?"bg-red-500":a.budget.percentage>=75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.budget.percentage,100)}%`}})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Tokens"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.currentMonth.tokens.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"This month"})]}),e.jsx(S,{path:_e,size:1.5,className:"text-gray-400"})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"API Requests"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.currentMonth.requests.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"This month"})]}),e.jsx(S,{path:Ht,size:1.5,className:"text-gray-400"})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Tokens/Request"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.currentMonth.requests>0?Math.round(a.currentMonth.tokens/a.currentMonth.requests).toLocaleString():"0"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Efficiency metric"})]}),e.jsx(S,{path:_e,size:1.5,className:"text-gray-400"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>n(!c),className:"flex items-center justify-between w-full p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Usage by Feature"}),e.jsx(S,{path:c?qt:Vt,size:1,className:"text-gray-500"})]}),c&&e.jsx("div",{className:"mt-3 space-y-3",children:a.featureBreakdown.map((C,I)=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:C.feature}),e.jsxs("span",{className:"text-sm text-gray-600",children:[C.tokens.toLocaleString()," tokens (",C.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-[#4ECDC4] h-2 rounded-full transition-all duration-300",style:{width:`${C.percentage}%`}})})]})},I))})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>l(!o),className:"flex items-center justify-between w-full p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Daily Usage Trend"}),e.jsx(S,{path:o?qt:Vt,size:1,className:"text-gray-500"})]}),o&&e.jsx("div",{className:"mt-3 bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:a.dailyUsage.map((C,I)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:new Date(C.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.tokens.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-600",children:[C.requests," requests"]})]})]},I))})})]})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{path:z,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Access denied. You need to be logged in to view AI usage data."})]})})};var ui=Object.defineProperty,mi=Object.defineProperties,gi=Object.getOwnPropertyDescriptors,ps=Object.getOwnPropertySymbols,xi=Object.prototype.hasOwnProperty,hi=Object.prototype.propertyIsEnumerable,fs=(t,a,s)=>a in t?ui(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,ge=(t,a)=>{for(var s in a||(a={}))xi.call(a,s)&&fs(t,s,a[s]);if(ps)for(var s of ps(a))hi.call(a,s)&&fs(t,s,a[s]);return t},xe=(t,a)=>mi(t,gi(a));const pi=({settings:t,onUpdateSettings:a,currentUsage:s})=>{const[r,i]=g.useState(!1),[d,u]=g.useState(t),{canManageThrottling:c,userRole:n}=Ia(),o=()=>{a(d),i(!1)},l=()=>{u(t),i(!1)},m=(p,h)=>{const C=p/h*100;return C>=90?"text-red-600":C>=75?"text-yellow-600":"text-green-600"},x=(p,h)=>{const C=p/h*100;return C>=90?z:C>=75?z:be};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:ja,size:1.2,className:"text-[#4ECDC4]"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Throttling Controls"}),!c&&e.jsx(S,{path:Na,size:.8,className:"text-gray-400",title:"Admin Only"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:t.enabled?"Enabled":"Disabled"})]}),c?e.jsx("button",{onClick:()=>i(!r),className:"px-4 py-2 text-sm font-medium text-[#4ECDC4] hover:text-[#3db8b0] transition-colors",children:r?"Cancel":"Configure"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Admin access required"}),e.jsxs("div",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:["Role: ",n," | Admin: ",c?"Yes":"No"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Requests/Minute"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.requestsThisMinute,t.requestsPerMinute)}`,children:s.requestsThisMinute}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",t.requestsPerMinute]})]}),e.jsx(S,{path:x(s.requestsThisMinute,t.requestsPerMinute),size:1.5,className:m(s.requestsThisMinute,t.requestsPerMinute)})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Requests/Hour"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.requestsThisHour,t.requestsPerHour)}`,children:s.requestsThisHour}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",t.requestsPerHour]})]}),e.jsx(S,{path:x(s.requestsThisHour,t.requestsPerHour),size:1.5,className:m(s.requestsThisHour,t.requestsPerHour)})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Monthly Tokens"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.monthlyTokens,s.monthlyTokenLimit)}`,children:s.monthlyTokens.toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",s.monthlyTokenLimit.toLocaleString()]})]}),e.jsx(S,{path:x(s.monthlyTokens,s.monthlyTokenLimit),size:1.5,className:m(s.monthlyTokens,s.monthlyTokenLimit)})]})})]}),r&&c&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Throttling Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requests Per Minute"}),e.jsx("input",{type:"number",value:d.requestsPerMinute,onChange:p=>u(h=>xe(ge({},h),{requestsPerMinute:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requests Per Hour"}),e.jsx("input",{type:"number",value:d.requestsPerHour,onChange:p=>u(h=>xe(ge({},h),{requestsPerHour:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"10000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Burst Limit"}),e.jsx("input",{type:"number",value:d.burstLimit,onChange:p=>u(h=>xe(ge({},h),{burstLimit:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"100"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Token Limit"}),e.jsx("input",{type:"number",value:d.monthlyTokenLimit,onChange:p=>u(h=>xe(ge({},h),{monthlyTokenLimit:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"10000",max:"10000000",step:"1000"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: 500,000 - 1,000,000 tokens/month"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Warning Threshold (%)"}),e.jsx("input",{type:"number",value:d.warningThreshold,onChange:p=>u(h=>xe(ge({},h),{warningThreshold:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"50",max:"95"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Critical Threshold (%)"}),e.jsx("input",{type:"number",value:d.criticalThreshold,onChange:p=>u(h=>xe(ge({},h),{criticalThreshold:parseInt(p.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"75",max:"100"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),e.jsx("button",{onClick:o,className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] hover:bg-[#3db8b0] rounded-md transition-colors",children:"Save Changes"})]})]}),c&&e.jsx("div",{className:"mt-6 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable/Disable Throttling"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:p=>a(xe(ge({},t),{enabled:p.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#4ECDC4]"})]})]})})]})},fi=({isSaving:t,onResetToDefaults:a,onSaveSettings:s})=>e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{path:we,size:1.5,className:"text-[#4ECDC4]"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-800",children:b.HEADER.TITLE}),e.jsx("p",{className:"text-sm text-gray-600",children:b.HEADER.SUBTITLE})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(S,{path:yt,size:1}),b.BUTTONS.RESET]}),e.jsxs("button",{onClick:s,disabled:t,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-[#4ECDC4] hover:bg-[#3db8b0] rounded-lg disabled:opacity-50",children:[e.jsx(S,{path:t?yt:ke,size:1,className:t?"animate-spin":""}),t?b.BUTTONS.SAVING:b.BUTTONS.SAVE]})]})]}),bi=({settings:t,updateIntelligence:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(S,{path:we,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:b.SECTIONS.INTELLIGENCE_SETTINGS})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{title:b.FORM_GROUPS.RISK_ALERTS,children:[e.jsx(D,{id:"riskAssessment",checked:t.intelligence.riskAssessment,onChange:s=>a("riskAssessment",s),label:b.TOGGLE_LABELS.RISK_ASSESSMENT,description:b.DESCRIPTIONS.RISK_ASSESSMENT,disabled:!t.aiEnabled}),e.jsx(D,{id:"alertSystem",checked:t.intelligence.alertSystem,onChange:s=>a("alertSystem",s),label:b.TOGGLE_LABELS.ALERT_SYSTEM,description:b.DESCRIPTIONS.ALERT_SYSTEM,disabled:!t.aiEnabled}),e.jsx(D,{id:"escalationRules",checked:t.intelligence.escalationRules,onChange:s=>a("escalationRules",s),label:b.TOGGLE_LABELS.ESCALATION_RULES,description:b.DESCRIPTIONS.ESCALATION_RULES,disabled:!t.aiEnabled})]}),e.jsxs(B,{title:b.FORM_GROUPS.AI_INSIGHTS,children:[e.jsx(D,{id:"aiRecommendations",checked:t.intelligence.aiRecommendations,onChange:s=>a("aiRecommendations",s),label:b.TOGGLE_LABELS.AI_RECOMMENDATIONS,description:b.DESCRIPTIONS.AI_RECOMMENDATIONS,disabled:!t.aiEnabled}),e.jsx(D,{id:"optimizationTips",checked:t.intelligence.optimizationTips,onChange:s=>a("optimizationTips",s),label:b.TOGGLE_LABELS.OPTIMIZATION_TIPS,description:b.DESCRIPTIONS.OPTIMIZATION_TIPS,disabled:!t.aiEnabled})]})]})]});var yi=Object.defineProperty,vi=Object.defineProperties,ji=Object.getOwnPropertyDescriptors,bs=Object.getOwnPropertySymbols,Ni=Object.prototype.hasOwnProperty,Ci=Object.prototype.propertyIsEnumerable,ys=(t,a,s)=>a in t?yi(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,G=(t,a)=>{for(var s in a||(a={}))Ni.call(a,s)&&ys(t,s,a[s]);if(bs)for(var s of bs(a))Ci.call(a,s)&&ys(t,s,a[s]);return t},U=(t,a)=>vi(t,ji(a)),Ue=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const _i=()=>{const{getCurrentFacilityId:t}=V(),a=t(),s=Sa(),r=Qa(),[i,d]=g.useState(null),[u,c]=g.useState(!1),[n,o]=g.useState(!1),[l,m]=g.useState(null),[x,p]=g.useState(null),[h,C]=g.useState("overview"),I=g.useCallback(()=>Ue(null,null,function*(){if(r){c(!0);try{const E=yield r.loadUnifiedSettings();d(E)}catch(E){console.error("Failed to load AI settings:",E),m({type:"error",text:b.MESSAGES.SAVE_ERROR})}finally{c(!1)}}}),[r]),_=g.useCallback(()=>Ue(null,null,function*(){if(r)try{const E=yield r.getServiceStatus();p(E)}catch(E){console.error("Failed to load service status:",E)}}),[r]);g.useEffect(()=>{r&&(I(),_())},[r,I,_]);const j=()=>Ue(null,null,function*(){if(!(!r||!i)){o(!0);try{(yield r.saveUnifiedSettings(i))?(yield r.applySettings(i),m({type:"success",text:b.MESSAGES.SAVE_SUCCESS}),setTimeout(()=>m(null),hs.MESSAGE_DISPLAY),yield _()):m({type:"error",text:b.MESSAGES.SAVE_ERROR})}catch(E){console.error("Failed to save AI settings:",E),m({type:"error",text:b.MESSAGES.SAVE_ERROR})}finally{o(!1)}}}),f=()=>Ue(null,null,function*(){if(r)try{const E=yield r.loadUnifiedSettings();d(E),m({type:"success",text:b.MESSAGES.RESET_SUCCESS}),setTimeout(()=>m(null),hs.RESET_MESSAGE_DISPLAY)}catch(E){console.error("Failed to reset settings:",E),m({type:"error",text:b.MESSAGES.RESET_ERROR})}}),N=(E,R)=>{i&&d(A=>A?U(G({},A),{computerVision:U(G({},A.computerVision),{[E]:R})}):null)},y=(E,R)=>{i&&d(A=>A?U(G({},A),{predictiveAnalytics:U(G({},A.predictiveAnalytics),{[E]:R})}):null)},v=(E,R)=>{i&&d(A=>A?U(G({},A),{smartWorkflow:U(G({},A.smartWorkflow),{[E]:R})}):null)},T=(E,R)=>{i&&d(A=>A?U(G({},A),{analytics:U(G({},A.analytics),{[E]:R})}):null)},$=(E,R)=>{i&&d(A=>A?U(G({},A),{intelligence:U(G({},A.intelligence),{[E]:R})}):null)},Y=(E,R)=>{i&&d(A=>A?U(G({},A),{performance:U(G({},A.performance),{[E]:R})}):null)},le=(E,R)=>{i&&d(A=>A?U(G({},A),{privacy:U(G({},A.privacy),{[E]:R})}):null)},k=(E,R)=>{i&&d(A=>A?U(G({},A),{integration:U(G({},A.integration),{[E]:R})}):null)},Ee=(E,R)=>{i&&d(A=>A?U(G({},A),{userExperience:U(G({},A.userExperience),{[E]:R})}):null)},w=E=>{i&&d(R=>R?U(G({},R),{aiEnabled:E}):null)};return a?u?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#4ECDC4] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:b.MESSAGES.LOADING})]}):i?!a||!r?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"⚠️"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Facility Not Available"}),e.jsx("p",{className:"text-gray-600",children:"AI Settings are not available because no facility is currently selected. Please ensure you are logged in and have access to a facility."})]})})}):e.jsxs("div",{className:"space-y-6",children:[s.hasIssues&&e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${s.isExceeded?"bg-red-50 border-red-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{path:s.isExceeded?z:z,size:1.2,className:`mr-3 ${s.isExceeded?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${s.isExceeded?"text-red-800":"text-yellow-800"}`,children:s.isExceeded?"AI Usage Limit Exceeded":"AI Usage Warning"}),e.jsx("p",{className:`text-sm ${s.isExceeded?"text-red-700":"text-yellow-700"}`,children:s.isExceeded?`You've used ${s.usedTokens.toLocaleString()} tokens (${Math.round(s.usagePercentage)}%) of your ${s.limitTokens.toLocaleString()} token limit.`:`You've used ${s.usedTokens.toLocaleString()} tokens (${Math.round(s.usagePercentage)}%) of your ${s.limitTokens.toLocaleString()} token limit. Consider adjusting throttling settings.`})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[{id:"overview",name:"Overview",icon:"📊"},{id:"usage",name:"Usage & Limits",icon:"📈"},{id:"features",name:"AI Features",icon:"⚙️"},{id:"settings",name:"Settings",icon:"🔧"}].map(E=>e.jsxs("button",{onClick:()=>C(E.id),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${h===E.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:E.icon}),E.name]},E.id))})}),e.jsxs("div",{className:"p-6",children:[h==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(fi,{isSaving:n,onResetToDefaults:f,onSaveSettings:j}),x&&e.jsx(ii,{serviceStatus:x})]}),h==="usage"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(di,{facilityId:a}),e.jsx(pi,{settings:{enabled:!0,requestsPerMinute:60,requestsPerHour:1e3,burstLimit:10,monthlyTokenLimit:1e6,warningThreshold:75,criticalThreshold:90},onUpdateSettings:E=>{console.log("Updating throttling settings:",E)},currentUsage:{requestsThisMinute:15,requestsThisHour:120,monthlyTokens:125e3,monthlyTokenLimit:1e6}})]}),h==="features"&&e.jsx(ei,{settings:i,updateMasterAI:w,updateComputerVision:N,updatePredictiveAnalytics:y,updateSmartWorkflow:v}),h==="settings"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(si,{settings:i,updateAnalytics:T}),e.jsx(bi,{settings:i,updateIntelligence:$}),e.jsx(ai,{settings:i,updatePerformance:Y}),e.jsx(ri,{settings:i,updatePrivacy:le}),e.jsx(ni,{settings:i,updateIntegration:k}),e.jsx(oi,{settings:i,updateUserExperience:Ee})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{path:z,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:b.MESSAGES.FAILED_TO_LOAD})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{path:z,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:b.MESSAGES.FACILITY_NOT_AVAILABLE})]})},me={AI_VERSION:"1.0.0",AI_CONFIDENCE_THRESHOLD:.85,AI_DATA_RETENTION_DAYS:90,ENCRYPTED_DATA_TRANSMISSION:!0},at={COMPUTER_VISION:[{key:"tool_condition_assessment",label:"Tool Condition Assessment",desc:"AI-powered visual inspection of tool wear and damage"},{key:"barcode_quality_detection",label:"Barcode Quality Detection",desc:"Automated barcode readability assessment"},{key:"tool_type_recognition",label:"Tool Type Recognition",desc:"Automatic tool identification from images"},{key:"cleaning_validation",label:"Cleaning Validation",desc:"Visual verification of cleaning effectiveness"}],PREDICTIVE_ANALYTICS:[{key:"cycle_optimization",label:"Cycle Optimization",desc:"AI-driven sterilization cycle parameter optimization"},{key:"failure_prediction",label:"Failure Prediction",desc:"Predictive maintenance and equipment failure alerts"},{key:"efficiency_optimization",label:"Efficiency Optimization",desc:"Process efficiency analysis and recommendations"},{key:"resource_planning",label:"Resource Planning",desc:"Intelligent resource allocation and scheduling"}],SMART_WORKFLOW:[{key:"intelligent_workflow_selection",label:"Intelligent Workflow Selection",desc:"AI-powered workflow recommendation based on tool type and condition"},{key:"automated_problem_detection",label:"Automated Problem Detection",desc:"Real-time issue identification and alerting"},{key:"smart_phase_transitions",label:"Smart Phase Transitions",desc:"Intelligent sterilization phase management"},{key:"batch_optimization",label:"Batch Optimization",desc:"Optimal tool grouping and batch processing"}]},Si=[{value:"unwrapped",label:"Unwrapped (3 min, 132°C)"},{value:"pouches",label:"Pouches (5 min, 132°C)"},{value:"packs",label:"Packs (30 min, 121°C)"},{value:"handpieces",label:"Handpieces (6 min, 132°C)"},{value:"custom",label:"Custom"}],wi=[{value:3,label:"3 months"},{value:6,label:"6 months"},{value:12,label:"1 year (recommended)"},{value:18,label:"18 months"},{value:24,label:"2 years"}],Ei=[{value:30,label:"30 days"},{value:60,label:"60 days"},{value:90,label:"90 days (recommended)"},{value:180,label:"180 days"},{value:365,label:"1 year"}],de={TEMPERATURE:{min:100,max:150},PRESSURE:{min:10,max:30},STERILIZE_TIME:{min:1,max:60},DRY_TIME:{min:10,max:60}},rt={min:.5,max:1,step:.05},vs=3e3;var It=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Ti=t=>It(null,null,function*(){try{return yield new wt(t).loadSettings()}catch(a){return console.error("Failed to load AI settings:",a),null}}),js=(t,a)=>It(null,null,function*(){try{return yield new wt(t).saveSettings(a)}catch(s){return console.error("Failed to save AI settings:",s),!1}}),Ii=t=>It(null,null,function*(){try{const a={facility_id:t,ai_enabled:!1,ai_version:me.AI_VERSION,computer_vision_enabled:!1,tool_condition_assessment:!1,barcode_quality_detection:!1,tool_type_recognition:!1,cleaning_validation:!1,predictive_analytics_enabled:!1,cycle_optimization:!1,failure_prediction:!1,efficiency_optimization:!1,resource_planning:!1,smart_workflow_enabled:!1,intelligent_workflow_selection:!1,automated_problem_detection:!1,smart_phase_transitions:!1,batch_optimization:!1,quality_assurance_enabled:!1,biological_indicator_analysis:!1,compliance_monitoring:!1,audit_trail_enhancement:!1,risk_assessment:!1,scanner_intelligence_enabled:!1,multi_format_barcode_support:!1,tool_history_integration:!1,smart_validation:!1,error_prevention:!1,real_time_monitoring_enabled:!1,anomaly_detection:!1,predictive_maintenance:!1,quality_drift_detection:!1,smart_notifications:!1,ai_confidence_threshold:me.AI_CONFIDENCE_THRESHOLD,ai_data_retention_days:me.AI_DATA_RETENTION_DAYS,real_time_processing_enabled:!1,batch_processing_enabled:!1,data_sharing_enabled:!1,local_ai_processing_enabled:!1,encrypted_data_transmission:me.ENCRYPTED_DATA_TRANSMISSION,ai_model_training:!1,auto_optimization_enabled:!1,performance_monitoring:!1,resource_optimization:!1,openai_api_key_encrypted:"",google_vision_api_key_encrypted:"",azure_computer_vision_key_encrypted:""};return yield new wt(t).saveSettings(a)}catch(a){return console.error("Failed to reset AI settings:",a),!1}}),nt=t=>({facility_id:t,ai_enabled:!1,ai_version:me.AI_VERSION,computer_vision_enabled:!1,tool_condition_assessment:!1,barcode_quality_detection:!1,tool_type_recognition:!1,cleaning_validation:!1,predictive_analytics_enabled:!1,cycle_optimization:!1,failure_prediction:!1,efficiency_optimization:!1,resource_planning:!1,smart_workflow_enabled:!1,intelligent_workflow_selection:!1,automated_problem_detection:!1,smart_phase_transitions:!1,batch_optimization:!1,quality_assurance_enabled:!1,biological_indicator_analysis:!1,compliance_monitoring:!1,audit_trail_enhancement:!1,risk_assessment:!1,scanner_intelligence_enabled:!1,multi_format_barcode_support:!1,tool_history_integration:!1,smart_validation:!1,error_prevention:!1,real_time_monitoring_enabled:!1,anomaly_detection:!1,predictive_maintenance:!1,quality_drift_detection:!1,smart_notifications:!1,ai_confidence_threshold:me.AI_CONFIDENCE_THRESHOLD,ai_data_retention_days:me.AI_DATA_RETENTION_DAYS,real_time_processing_enabled:!1,batch_processing_enabled:!1,data_sharing_enabled:!1,local_ai_processing_enabled:!1,encrypted_data_transmission:me.ENCRYPTED_DATA_TRANSMISSION,ai_model_training:!1,auto_optimization_enabled:!1,performance_monitoring:!1,resource_optimization:!1,openai_api_key_encrypted:"",google_vision_api_key_encrypted:"",azure_computer_vision_key_encrypted:""}),je=(t,a,s,r)=>{console.log("Setting changed:",{setting:t,oldValue:a,newValue:s,facilityId:r,timestamp:new Date().toISOString()})},Pi=(t,a)=>{console.log("Save attempt:",{facilityId:a,timestamp:new Date().toISOString(),settingsCount:Object.keys(t).length,aiEnabled:t.ai_enabled})},it=(t,a,s)=>{console.log("Save result:",{success:t,facilityId:a,timestamp:new Date().toISOString(),error:s||null})},Ai=t=>{console.log("Reset attempt:",{facilityId:t,timestamp:new Date().toISOString()})},lt=(t,a,s)=>{console.log("Reset result:",{success:t,facilityId:a,timestamp:new Date().toISOString(),error:s||null})},Oi=(t,a,s)=>{console.log("AI feature toggle:",{feature:t,enabled:a,facilityId:s,timestamp:new Date().toISOString()})},Ne=(t,a,s)=>{console.log("Cycle settings change:",{cycleType:t,changes:a,facilityId:s,timestamp:new Date().toISOString()})},Ns=(t,a,s)=>{console.log("Enforcement toggle:",{type:t,enabled:a,facilityId:s,timestamp:new Date().toISOString()})},Cs=(t,a,s)=>{console.log("Receipt settings change:",{setting:t,value:a,facilityId:s,timestamp:new Date().toISOString()})},Di=()=>{const{enforceCi:t,enforceBi:a,_allowOverrides:s,updateComplianceSettings:r,fetchComplianceSettings:i}=_t(),[d,u]=g.useState(!1),[c,n]=g.useState(!1),{getCurrentFacilityId:o}=V();return g.useEffect(()=>{const l=o();l&&i(l)},[o,i]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Sterilization Enforcement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"enforceBI",className:"text-sm font-medium",children:"Biological Indicator Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable daily BI test requirements and compliance tracking"})]}),e.jsx("button",{onClick:()=>{const l=o();l&&(Ns("BI",!a,l),r(l,{enforceBi:!a}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${a?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a?"translate-x-6":"translate-x-1"}`})})]}),a&&e.jsxs("div",{className:"ml-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"BI tests are being enforced"})]}),e.jsxs("button",{onClick:()=>u(!d),className:"text-xs text-blue-600 hover:text-blue-800",children:[d?"Hide":"Show"," BI test history"]}),d&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md text-xs text-gray-600",children:[e.jsx("p",{children:"• Last BI test: 2024-01-15 (PASS)"}),e.jsx("p",{children:"• Next required: 2024-01-16"}),e.jsx("p",{children:"• Tests passed this month: 15"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Chemical Indicator (CI) Management"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Configure how CI indicators are handled during autoclave cycles."}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("strong",{children:"ON:"})," Users must confirm CI strip usage (Y/N selection in workflow)",e.jsx("br",{}),e.jsx("strong",{children:"OFF:"})," Users get a warning but can proceed without CI confirmation"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"enforceCI",className:"font-medium",children:"Require CI Confirmation"}),e.jsx("button",{id:"enforceCI",onClick:()=>{const l=o();l&&(Ns("CI",!t,l),r(l,{enforceCi:!t}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${t?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t?"translate-x-6":"translate-x-1"}`})})]})]})]})};var _s=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Ri=()=>{const{currentUser:t}=te(),[a,s]=g.useState(!0),[r,i]=g.useState(null),[d,u]=g.useState(["pouch","wrap","container","tray"]),[c,n]=g.useState(["small","medium","large","extra-large"]),[o,l]=g.useState(!1),[m,x]=g.useState("PKG-"),[p,h]=g.useState(25);g.useEffect(()=>{_s(null,null,function*(){try{if(!t)return;const{data:f,error:N}=yield O.from("facility_settings").select("packaging_settings").eq("facility_id",t.facility_id).single();if(N&&console.warn("No existing packaging settings found"),f!=null&&f.packaging_settings){const y=f.packaging_settings;u(v=>y.packageTypes||v),n(v=>y.packageSizes||v),l(!!y.requireReceiptUpload),x(v=>y.batchPrefix||v),h(v=>y.maxToolsPerBatch||v)}i(t.facility_id)}catch(f){console.error("Error loading packaging settings:",f)}finally{s(!1)}})},[t]);const C=()=>_s(null,null,function*(){if(!r)return;s(!0);const j={packageTypes:d,packageSizes:c,requireReceiptUpload:o,batchPrefix:m,maxToolsPerBatch:p},{error:f}=yield O.from("facility_settings").update({packaging_settings:j}).eq("facility_id",r);f&&console.error("Error saving packaging settings:",f),s(!1)}),I=j=>{u(f=>f.includes(j)?f.filter(N=>N!==j):[...f,j])},_=j=>{n(f=>f.includes(j)?f.filter(N=>N!==j):[...f,j])};return a?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading packaging settings..."}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"📦 Packaging Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Te,{className:"font-medium",children:"Available Package Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:["pouch","wrap","container","tray"].map(j=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{checked:d.includes(j),onCheckedChange:()=>I(j)}),e.jsx("span",{className:"capitalize",children:j})]},j))})]}),e.jsxs("div",{children:[e.jsx(Te,{className:"font-medium",children:"Available Package Sizes"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:["small","medium","large","extra-large"].map(j=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{checked:c.includes(j),onCheckedChange:()=>_(j)}),e.jsx("span",{className:"capitalize",children:j})]},j))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Te,{className:"font-medium",children:"Require Receipt Upload"}),e.jsx(Ha,{checked:o,onCheckedChange:l})]}),e.jsxs("div",{children:[e.jsx(Te,{className:"font-medium",children:"Batch Code Prefix"}),e.jsx(kt,{value:m,onChange:j=>x(j.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Te,{className:"font-medium",children:"Max Tools per Batch"}),e.jsx(kt,{type:"number",value:p,onChange:j=>h(parseInt(j.target.value,10)),className:"mt-1"})]}),e.jsx("button",{onClick:C,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Save Settings"})]})]})},ki=()=>{const{cycleSettings:t,defaultCycleType:a,allowCustomCycles:s,setDefaultCycleType:r,setAllowCustomCycles:i,updateCycleSettings:d,resetCycleSettings:u}=_t(),[c,n]=g.useState(null),{getCurrentFacilityId:o}=V();return e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Autoclave Cycle Customization"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultCycle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Cycle Type"}),e.jsx("select",{id:"defaultCycle",value:a,onChange:l=>{const m=o();m&&Ne("defaultCycleType",{cycleType:l.target.value},m),r(l.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:Si.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This cycle type will be selected by default for new sterilization runs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"allowCustomCycles",className:"text-sm font-medium",children:"Allow Custom Cycle Parameters"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable users to modify temperature, pressure, and timing for special cases"})]}),e.jsx("button",{id:"allowCustomCycles",onClick:()=>{const l=o();l&&Ne("allowCustomCycles",{enabled:!s},l),i(!s)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${s?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Cycle Presets"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(t).map(([l,m])=>{const x=m;return e.jsxs("div",{className:"border border-gray-200 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"text-sm font-medium",children:x.name}),l==="custom"&&s&&e.jsx("button",{onClick:()=>n(c===l?null:l),className:"text-xs text-blue-600 hover:text-blue-800",children:c===l?"Save":"Edit"})]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Temperature: ",x.temperature,"°C"]}),e.jsxs("p",{children:["Pressure: ",x.pressure," PSI"]}),e.jsxs("p",{children:["Sterilize Time: ",x.sterilizeTime," min"]}),e.jsxs("p",{children:["Dry Time: ",x.dryTime," min"]}),e.jsxs("p",{children:["Total Time: ",x.totalTime," min"]})]}),l==="custom"&&s&&c===l&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customTemperature",className:"text-xs text-gray-500",children:"Temperature (°C)"}),e.jsx("input",{id:"customTemperature",type:"number",value:x.temperature,onChange:p=>{const h=o();h&&Ne("custom",{temperature:Number(p.target.value)},h),d("custom",{temperature:Number(p.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:de.TEMPERATURE.min,max:de.TEMPERATURE.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customPressure",className:"text-xs text-gray-500",children:"Pressure (PSI)"}),e.jsx("input",{id:"customPressure",type:"number",value:x.pressure,onChange:p=>{const h=o();h&&Ne("custom",{pressure:Number(p.target.value)},h),d("custom",{pressure:Number(p.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:de.PRESSURE.min,max:de.PRESSURE.max})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customSterilizeTime",className:"text-xs text-gray-500",children:"Sterilize (min)"}),e.jsx("input",{id:"customSterilizeTime",type:"number",value:x.sterilizeTime,onChange:p=>{const h=o();h&&Ne("custom",{sterilizeTime:Number(p.target.value)},h),d("custom",{sterilizeTime:Number(p.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:de.STERILIZE_TIME.min,max:de.STERILIZE_TIME.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customDryTime",className:"text-xs text-gray-500",children:"Dry (min)"}),e.jsx("input",{id:"customDryTime",type:"number",value:x.dryTime,onChange:p=>{const h=o();h&&Ne("custom",{dryTime:Number(p.target.value)},h),d("custom",{dryTime:Number(p.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:de.DRY_TIME.min,max:de.DRY_TIME.max})]})]})]})]},l)})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:"Reset to Defaults"})})]})]})},Li=()=>{const{autoclaveReceiptSettings:t,setAutoclaveHasPrinter:a,setReceiptRetentionMonths:s}=_t(),{getCurrentFacilityId:r}=V();return e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Autoclave Receipt Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"autoclaveHasPrinter",className:"text-sm font-medium",children:"Autoclave Has Printer"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable receipt upload functionality for autoclave cycles"})]}),e.jsx("button",{id:"autoclaveHasPrinter",onClick:()=>{const i=r();i&&Cs("autoclaveHasPrinter",!t.autoclaveHasPrinter,i),a(!t.autoclaveHasPrinter)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${t.autoclaveHasPrinter?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.autoclaveHasPrinter?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retentionPeriod",className:"block text-sm font-medium text-gray-700 mb-2",children:"Receipt Retention Period"}),e.jsx("select",{id:"retentionPeriod",value:t.receiptRetentionMonths,onChange:i=>{const d=r();d&&Cs("receiptRetentionMonths",Number(i.target.value),d),s(Number(i.target.value))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:wi.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Receipts will be automatically deleted after this period"})]}),t.autoclaveHasPrinter&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-md",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Receipt Management Active"}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[e.jsx("p",{children:"• Users can upload autoclave receipts via camera or file"}),e.jsx("p",{children:"• Receipts are linked to sterilization batch codes"}),e.jsxs("p",{children:["• Automatic cleanup after"," ",t.receiptRetentionMonths," months"]}),e.jsx("p",{children:"• Available for audit and compliance review"})]})]})]})]})};var $i=Object.defineProperty,Mi=Object.defineProperties,Fi=Object.getOwnPropertyDescriptors,Ss=Object.getOwnPropertySymbols,Gi=Object.prototype.hasOwnProperty,Ui=Object.prototype.propertyIsEnumerable,ws=(t,a,s)=>a in t?$i(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,zi=(t,a)=>{for(var s in a||(a={}))Gi.call(a,s)&&ws(t,s,a[s]);if(Ss)for(var s of Ss(a))Ui.call(a,s)&&ws(t,s,a[s]);return t},Bi=(t,a)=>Mi(t,Fi(a)),ot=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Hi=()=>{const{getCurrentFacilityId:t}=V(),[a,s]=g.useState(()=>{const l=t();return nt(l||"")}),[r,i]=g.useState(null),[d,u]=g.useState(!1),c=(l,m)=>{const x=t();x&&Oi(l,m,x),s(p=>Bi(zi({},p),{[l]:m}))},n=()=>ot(null,null,function*(){try{u(!0);const l=t();if(!l){i({type:"error",text:"User facility not found"});return}Pi(a,l),(yield js(l,a))?(it(!0,l),i({type:"success",text:"AI settings saved successfully!"}),setTimeout(()=>i(null),vs)):(it(!1,l,"Save operation failed"),i({type:"error",text:"Failed to save AI settings"}))}catch(l){it(!1,t()||"",l instanceof Error?l.message:"Unknown error"),i({type:"error",text:"Failed to save AI settings"})}finally{u(!1)}}),o=()=>ot(null,null,function*(){try{u(!0);const l=t();if(!l){i({type:"error",text:"User facility not found"});return}Ai(l);const m=nt(l);s(m),(yield Ii(l))?(lt(!0,l),i({type:"success",text:"AI settings reset to defaults"}),setTimeout(()=>i(null),vs)):(lt(!1,l,"Reset operation failed"),i({type:"error",text:"Failed to reset AI settings"}))}catch(l){lt(!1,t()||"",l instanceof Error?l.message:"Unknown error"),i({type:"error",text:"Failed to reset AI settings"})}finally{u(!1)}});return g.useEffect(()=>{ot(null,null,function*(){const m=t();if(m)try{const x=yield Ti(m);if(x)s(x);else{const p=nt(m);s(p),yield js(m,p)}}catch(x){console.error("Failed to load AI settings:",x)}})},[t]),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI-Powered Sterilization Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure intelligent automation and machine learning capabilities"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:o,className:"px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:"Reset"}),e.jsxs("button",{onClick:n,disabled:d,className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-md hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] disabled:opacity-50",children:[e.jsx(S,{path:ke,size:.8,className:"inline mr-1"}),"Save AI Settings"]})]})]}),r&&e.jsx("div",{className:`p-4 rounded-lg border mb-6 ${r.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:r.type==="success"?be:z,size:1,className:"text-current"}),r.text]})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:we,size:1.5,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-800",children:"Master AI Control"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Enable or disable all AI features globally"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiEnabledToggle",className:"text-sm font-medium text-purple-800",children:"Enable AI Features"}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Master switch for all sterilization AI capabilities"})]}),e.jsx("button",{id:"aiEnabledToggle",onClick:()=>{const l=t();l&&je("ai_enabled",a.ai_enabled,!a.ai_enabled,l),c("ai_enabled",!a.ai_enabled)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 ${a.ai_enabled?"bg-purple-600":"bg-gray-200"}`,"aria-label":`${a.ai_enabled?"Disable":"Enable"} AI Features`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.ai_enabled?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(S,{path:X,size:1.2,className:"text-blue-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Computer Vision"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:at.COMPUTER_VISION.map(({key:l,label:m,desc:x})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${l}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x})]}),e.jsx("button",{id:`${l}Toggle`,onClick:()=>{const p=t();p&&je(l,a[l],!a[l],p),c(l,!a[l])},disabled:!a.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 ${a[l]?"bg-blue-600":"bg-gray-200"} ${a.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${a[l]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${a[l]?"translate-x-5":"translate-x-1"}`})})]},l))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(S,{path:Et,size:1.2,className:"text-green-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Predictive Analytics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:at.PREDICTIVE_ANALYTICS.map(({key:l,label:m,desc:x})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${l}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x})]}),e.jsx("button",{id:`${l}Toggle`,onClick:()=>{const p=t();p&&je(l,a[l],!a[l],p),c(l,!a[l])},disabled:!a.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1 ${a[l]?"bg-green-600":"bg-gray-200"} ${a.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${a[l]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${a[l]?"translate-x-5":"translate-x-1"}`})})]},l))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(S,{path:X,size:1.2,className:"text-orange-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Smart Workflow Automation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:at.SMART_WORKFLOW.map(({key:l,label:m,desc:x})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${l}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:x})]}),e.jsx("button",{id:`${l}Toggle`,onClick:()=>{const p=t();p&&je(l,a[l],!a[l],p),c(l,!a[l])},disabled:!a.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-1 ${a[l]?"bg-orange-600":"bg-gray-200"} ${a.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${a[l]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${a[l]?"translate-x-5":"translate-x-1"}`})})]},l))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(S,{path:ye,size:1.2,className:"text-purple-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"AI Configuration"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiConfidenceThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Confidence Threshold"}),e.jsx("input",{id:"aiConfidenceThreshold",type:"range",min:rt.min,max:rt.max,step:rt.step,value:a.ai_confidence_threshold||.8,onChange:l=>{const m=t();m&&je("ai_confidence_threshold",a.ai_confidence_threshold,parseFloat(l.target.value),m),c("ai_confidence_threshold",parseFloat(l.target.value))},disabled:!a.ai_enabled,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"50%"}),e.jsxs("span",{children:[Math.round(a.ai_confidence_threshold*100),"%"]}),e.jsx("span",{children:"100%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiDataRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (Days)"}),e.jsx("select",{id:"aiDataRetentionDays",value:a.ai_data_retention_days||365,onChange:l=>{const m=t();m&&je("ai_data_retention_days",a.ai_data_retention_days,parseInt(l.target.value),m),c("ai_data_retention_days",parseInt(l.target.value))},disabled:!a.ai_enabled,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] disabled:opacity-50",children:Ei.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]})]})})]})]})]})};function qi(){return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx(Di,{}),e.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:e.jsx(Ri,{})}),e.jsx(ki,{}),e.jsx(Li,{}),e.jsx(Hi,{})]})}var Vi=Object.defineProperty,Yi=Object.defineProperties,Wi=Object.getOwnPropertyDescriptors,Es=Object.getOwnPropertySymbols,Ki=Object.prototype.hasOwnProperty,Zi=Object.prototype.propertyIsEnumerable,Ts=(t,a,s)=>a in t?Vi(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Oe=(t,a)=>{for(var s in a||(a={}))Ki.call(a,s)&&Ts(t,s,a[s]);if(Es)for(var s of Es(a))Zi.call(a,s)&&Ts(t,s,a[s]);return t},vt=(t,a)=>Yi(t,Wi(a));const he={enableContentCreation:!0,autoSave:!0,draftRetention:30,templateLibrary:!0,collaborativeEditing:!1},Pa=t=>`contentBuilderSettings_${t}`,Ji=Ct((t,a)=>({settings:he,loading:!1,error:null,loadSettings:s=>{t({loading:!0,error:null});try{if(!(typeof window!="undefined")){t({settings:he,loading:!1});return}const i=Pa(s),d=localStorage.getItem(i);if(d){const u=JSON.parse(d),c=Oe(Oe({},he),u);t({settings:c,loading:!1})}else localStorage.setItem(i,JSON.stringify(he)),t({settings:he,loading:!1})}catch(r){console.error("Failed to load content builder settings:",r),t({error:r instanceof Error?r.message:"Failed to load settings",settings:he,loading:!1})}},updateSetting:(s,r)=>{const{settings:i}=a(),d=vt(Oe({},i),{[s]:r});t({settings:d})},resetSettings:()=>{t({settings:he})},setLoading:s=>t({loading:s}),setError:s=>t({error:s})})),Aa=()=>{const{getCurrentFacilityId:t,isLoading:a}=V(),s=t(),r=Ji();Se.useEffect(()=>{var d;a||(s?r.loadSettings(s):(typeof window!="undefined"&&((d=window.location)==null?void 0:d.hostname)==="localhost"||console.warn("No facility ID available, using default settings"),r.loadSettings("default")))},[s,a,r]);const i=Se.useCallback((d,u)=>{const c=s||"default",n=vt(Oe({},r.settings),{[d]:u});try{if(!(typeof window!="undefined")){r.updateSetting(d,u);return}const l=Pa(c);localStorage.setItem(l,JSON.stringify(n)),r.updateSetting(d,u)}catch(o){console.error("Failed to save content builder settings:",o),r.setError(o instanceof Error?o.message:"Failed to save settings")}},[s,r]);return vt(Oe({},r),{updateSetting:i,facilityId:s||"default",facilityLoading:a})},Qi=()=>{const{settings:t}=Aa(),{currentUser:a}=te(),i=(()=>{if(!(a!=null&&a.role))return Wt("User");const u=Yt(a.role);return Wt(u)})().canCreateContent;return{isContentCreationEnabled:i&&t.enableContentCreation,hasRolePermission:i,facilitySettingEnabled:t.enableContentCreation,userRole:(a==null?void 0:a.role)||"User",mappedRole:Yt((a==null?void 0:a.role)||"User"),settings:t}};var Xi=Object.defineProperty,Is=Object.getOwnPropertySymbols,el=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,Ps=(t,a,s)=>a in t?Xi(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,sl=(t,a)=>{for(var s in a||(a={}))el.call(a,s)&&Ps(t,s,a[s]);if(Is)for(var s of Is(a))tl.call(a,s)&&Ps(t,s,a[s]);return t},ct=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});function al(t){const{getCurrentFacilityId:a}=V(),[s,r]=g.useState([]),[i,d]=g.useState({total_activities:0,activities_by_type:{},activities_by_content_type:{},activities_by_user:{},recent_activities:[]}),[u,c]=g.useState(!1),[n,o]=g.useState(null),l=g.useCallback(()=>ct(null,null,function*(){const p=a();if(!p){o("No facility ID available");return}c(!0),o(null);try{const h=sl({facility_id:p,limit:50},t),[C,I]=yield Promise.all([Xa(h),Lt(p,30)]);r(C),d(I)}catch(h){const C=h instanceof Error?h.message:"Failed to load activities";o(C),console.error("Error loading content activities:",h)}finally{c(!1)}}),[a,t]),m=g.useCallback(()=>ct(null,null,function*(){yield l()}),[l]),x=g.useCallback(()=>ct(null,null,function*(){const p=a();if(p)try{const h=yield Lt(p,30);d(h)}catch(h){console.error("Error refreshing stats:",h)}}),[a]);return g.useEffect(()=>{l()},[l]),{activities:s,stats:i,loading:u,error:n,refreshActivities:m,refreshStats:x}}const As=({onLaunchBuilder:t})=>{const{settings:a,loading:s,error:r,updateSetting:i,facilityLoading:d}=Aa(),{isContentCreationEnabled:u,hasRolePermission:c,userRole:n}=Qi(),{activities:o,loading:l,error:m}=al();return r?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading settings"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:r})})]})})})}):d||s?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Loading settings..."})})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Content Builder"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Launch Content Builder"}),e.jsxs("button",{onClick:t,disabled:!u||d||s,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md transition-colors ${u&&!d&&!s?"text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4]":"text-gray-400 bg-gray-200 cursor-not-allowed"}`,children:[e.jsx(S,{path:ya,size:1,className:"mr-2"}),"Launch Builder"]})]}),!u&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Content creation is disabled.",c?" Enable it above in the facility settings.":` You need Administrator role to create content. (Current role: ${n})`]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable content creation"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"enable-content-creation",className:"sr-only peer",checked:a.enableContentCreation,onChange:x=>i("enableContentCreation",x.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.enableContentCreation?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.enableContentCreation?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Enable content creation"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-save drafts"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-save-drafts",className:"sr-only peer",checked:a.autoSave,onChange:x=>i("autoSave",x.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.autoSave?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.autoSave?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Auto-save drafts"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Draft retention (days)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"365",value:a.draftRetention,onChange:x=>i("draftRetention",parseInt(x.target.value)||30),disabled:d||s,className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent"}),e.jsx("span",{className:"text-sm text-gray-500",children:"days"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable template library"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"template-library",className:"sr-only peer",checked:a.templateLibrary,onChange:x=>i("templateLibrary",x.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.templateLibrary?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.templateLibrary?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Enable template library"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Collaborative editing"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"collaborative-editing",className:"sr-only peer",checked:a.collaborativeEditing,onChange:x=>i("collaborativeEditing",x.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.collaborativeEditing?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.collaborativeEditing?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Collaborative editing"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Recent Activity"}),l?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-[#4ECDC4]"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading activities..."})]}):m?e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-sm text-red-600",children:["Error loading activities: ",m]})}):o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(S,{path:br,size:2,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Content creation activity will appear here"})]}):e.jsx("div",{className:"space-y-3",children:o.slice(0,10).map(x=>{const p=er(x.activity_type),h=tr(x.content_type);return e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${x.activity_type==="published"?"bg-green-500":x.activity_type==="draft_saved"?"bg-yellow-500":x.activity_type==="created"?"bg-blue-500":x.activity_type==="updated"?"bg-purple-500":"bg-gray-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:p.icon,size:.8,className:p.color}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.text}),e.jsx(S,{path:h.icon,size:.7,className:h.color}),e.jsx("span",{className:"text-xs text-gray-500",children:h.text})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:x.content_title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",x.user_name]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:sr(x.created_at)})]},x.id)})})]})]})};var rl=Object.defineProperty,nl=Object.defineProperties,il=Object.getOwnPropertyDescriptors,Os=Object.getOwnPropertySymbols,ll=Object.prototype.hasOwnProperty,ol=Object.prototype.propertyIsEnumerable,Ds=(t,a,s)=>a in t?rl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,De=(t,a)=>{for(var s in a||(a={}))ll.call(a,s)&&Ds(t,s,a[s]);if(Os)for(var s of Os(a))ol.call(a,s)&&Ds(t,s,a[s]);return t},jt=(t,a)=>nl(t,il(a));const pe={requireApproval:!0,notifyReviewers:!0},Oa=t=>`publishingSettings_${t}`,cl=Ct((t,a)=>({settings:pe,loading:!1,error:null,loadSettings:s=>{t({loading:!0,error:null});try{if(!(typeof window!="undefined")){t({settings:pe,loading:!1});return}const i=Oa(s),d=localStorage.getItem(i);if(d){const u=JSON.parse(d),c=De(De({},pe),u);t({settings:c,loading:!1})}else localStorage.setItem(i,JSON.stringify(pe)),t({settings:pe,loading:!1})}catch(r){console.error("Failed to load publishing settings:",r),t({error:r instanceof Error?r.message:"Failed to load settings",settings:pe,loading:!1})}},updateSetting:(s,r)=>{const{settings:i}=a(),d=jt(De({},i),{[s]:r});t({settings:d})},resetSettings:()=>{t({settings:pe})},setLoading:s=>t({loading:s}),setError:s=>t({error:s})})),dl=()=>{const{getCurrentFacilityId:t,isLoading:a}=V(),s=t(),r=cl();Se.useEffect(()=>{var d;a||(s?r.loadSettings(s):(typeof window!="undefined"&&((d=window.location)==null?void 0:d.hostname)==="localhost"||console.warn("No facility ID available, using default publishing settings"),r.loadSettings("default")))},[s,a,r]);const i=Se.useCallback((d,u)=>{const c=s||"default",n=jt(De({},r.settings),{[d]:u});try{if(!(typeof window!="undefined")){r.updateSetting(d,u);return}const l=Oa(c);localStorage.setItem(l,JSON.stringify(n)),r.updateSetting(d,u)}catch(o){console.error("Failed to save publishing settings:",o),r.setError(o instanceof Error?o.message:"Failed to save settings")}},[s,r]);return jt(De({},r),{updateSetting:i,facilityId:s||"default",facilityLoading:a})},ul=t=>({administrator:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!0,assign_roles:!0,view_user_activity:!0,system_settings:!0,facility_settings:!0,security_settings:!0,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0,approve_content:!0},manager:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!0,view_user_activity:!0,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0,approve_content:!0},technician:{view_dashboard:!0,view_analytics:!1,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!1,approve_content:!1},viewer:{view_dashboard:!0,view_analytics:!0,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!1,edit_tasks:!1,delete_tasks:!1,assign_tasks:!1,approve_content:!1},trainer:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!0,approve_content:!1},custom:{}})[t]||{},ml=()=>[{id:"administrator",name:"Administrator",displayName:"👑 Administrator"},{id:"manager",name:"Manager",displayName:"👨‍💼 Manager"},{id:"technician",name:"Technician",displayName:"🔧 Technician"},{id:"viewer",name:"Viewer",displayName:"👀 Viewer"},{id:"trainer",name:"Trainer",displayName:"📚 Trainer"}].filter(a=>ul(a.id).approve_content===!0),gl=()=>{const{isLoading:t}=V();return{approvalRoles:Se.useMemo(()=>ml(),[]),facilityLoading:t}};var dt=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const xl=({reviewContentId:t})=>{const{settings:a,loading:s,error:r,updateSetting:i,facilityLoading:d}=dl(),{approvalRoles:u}=gl(),{getCurrentFacilityId:c}=V(),{currentUser:n}=te(),[o,l]=g.useState([]),[m,x]=g.useState(!0),[p,h]=g.useState(null);g.useEffect(()=>{d||dt(null,null,function*(){const N=c();if(N)try{x(!0),h(null);const y=yield Ke.getPendingContent(N);l(y)}catch(y){const v=K.handleApprovalError(y,"fetch_pending_content");K.logError(v,"pending_content_fetch","current-user-id"),h(v.userMessage)}finally{x(!1)}})},[c,d]),g.useEffect(()=>{t&&o.length>0&&o.find(N=>N.id===t)&&setTimeout(()=>{const N=document.getElementById(`content-${t}`);N&&(N.scrollIntoView({behavior:"smooth",block:"center"}),N.classList.add("ring-2","ring-blue-500","ring-opacity-50","bg-blue-50"),setTimeout(()=>{N.classList.remove("ring-2","ring-blue-500","ring-opacity-50","bg-blue-50")},5e3))},500)},[t,o]);const C=(f,N,y)=>dt(null,null,function*(){if(!n){ie.error("User not authenticated");return}try{yield Ke.approveContent(f,N,n.id);const v=o.find(T=>T.id===f);if(v!=null&&v.taskId&&(yield $t.completeContentApprovalTask(v.taskId,"approved",y)),v)try{yield Mt.notifyContentApproval(v.authorId,v.facilityId,f,N,"approved",y,n.name||n.email)}catch(T){K.handleNotificationError(T)}l(T=>T.filter($=>$.id!==f)),ie.success("Content approved and published to Library",{duration:4e3})}catch(v){const T=K.handleApprovalActionError(v,"approve");K.logError(T,"content_approval",n.id),K.showErrorToast(T)}}),I=(f,N,y)=>dt(null,null,function*(){if(!n){ie.error("User not authenticated");return}try{yield Ke.rejectContent(f,N,n.id,y);const v=o.find(T=>T.id===f);if(v!=null&&v.taskId&&(yield $t.completeContentApprovalTask(v.taskId,"rejected",y)),v)try{yield Mt.notifyContentApproval(v.authorId,v.facilityId,f,N,"rejected",y,n.name||n.email)}catch(T){K.handleNotificationError(T)}l(T=>T.filter($=>$.id!==f)),ie.success("Content rejected and returned to creator")}catch(v){const T=K.handleApprovalActionError(v,"reject");K.logError(T,"content_rejection",n.id),K.showErrorToast(T)}});if(r)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading publishing settings"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:r})})]})})})});const _=(f,N,y)=>{C(f,N,y)},j=(f,N,y)=>{I(f,N,y)};return d||s?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Loading publishing settings..."})})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Publishing Workflow"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Require approval before publishing"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"require-approval",className:"sr-only peer",checked:a.requireApproval,onChange:f=>i("requireApproval",f.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.requireApproval?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.requireApproval?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Require approval before publishing"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Notify reviewers on submission"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"notify-reviewers",className:"sr-only peer",checked:a.notifyReviewers,onChange:f=>i("notifyReviewers",f.target.checked),disabled:d||s}),e.jsx("div",{className:`w-11 h-6 ${a.notifyReviewers?"bg-[#4ECDC4]":"bg-gray-300"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a.notifyReviewers?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Notify reviewers on submission"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Approval Roles"}),e.jsx("div",{className:"space-y-3",children:u.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${f.id==="administrator"?"bg-red-100 text-red-800":f.id==="manager"?"bg-yellow-100 text-yellow-800":f.id==="technician"?"bg-green-100 text-green-800":f.id==="viewer"?"bg-blue-100 text-blue-800":f.id==="trainer"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:f.name})]},f.id))}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500",children:[e.jsx("p",{children:'Users with these roles have the "Approve Content" permission.'}),e.jsx("p",{children:"They will be notified when content requires approval and can approve content for publishing."})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"text-base font-medium text-gray-900 mb-4",children:["Pending Approval (",o.length,")"]}),m?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(f=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]})]})},f))}):p?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-red-600 text-sm",children:["Error loading pending content: ",p]})}):o.length===0?e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"No pending approvals"}),e.jsx("p",{className:"text-sm text-gray-500",children:"All content has been reviewed. New submissions will appear here."})]}):e.jsx("div",{className:"space-y-4",children:o.map(f=>e.jsx(qa,{content:f,onApprove:_,onReject:j},f.id))})]})]})};var hl=Object.defineProperty,Rs=Object.getOwnPropertySymbols,pl=Object.prototype.hasOwnProperty,fl=Object.prototype.propertyIsEnumerable,ks=(t,a,s)=>a in t?hl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,ze=(t,a)=>{for(var s in a||(a={}))pl.call(a,s)&&ks(t,s,a[s]);if(Rs)for(var s of Rs(a))fl.call(a,s)&&ks(t,s,a[s]);return t},bl=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const yl=()=>{const{getCurrentFacilityId:t,isLoading:a}=V(),s=t(),[r,i]=g.useState({enableAISuggestions:!0,contentOptimization:!0,seoOptimization:!1,readabilityScore:!0,plagiarismCheck:!1,autoTagging:!0}),[d,u]=g.useState(!1),[c,n]=g.useState(null),o=g.useCallback(()=>{if(!a)try{const h=`contentAISettings_${s||"default"}`,C=localStorage.getItem(h);if(C){const I=JSON.parse(C);i(_=>ze(ze({},_),I))}}catch(p){console.error("Failed to load content AI settings:",p),n("Failed to load AI settings")}},[s,a]),l=g.useCallback(p=>bl(null,null,function*(){if(a)return!1;try{u(!0),n(null);const C=`contentAISettings_${s||"default"}`,I=ze(ze({},r),p);return localStorage.setItem(C,JSON.stringify(I)),i(I),I}catch(h){return console.error("Failed to save content AI settings:",h),n("Failed to save AI settings"),!1}finally{u(!1)}}),[r,s,a]),m=g.useCallback((p,h)=>l({[p]:h}),[l]),x=g.useCallback(()=>{l({enableAISuggestions:!0,contentOptimization:!0,seoOptimization:!1,readabilityScore:!0,plagiarismCheck:!1,autoTagging:!0})},[l]);return g.useEffect(()=>{o()},[o]),{settings:r,loading:d,error:c,updateSetting:m,saveSettings:l,resetSettings:x,facilityId:s||"default",facilityLoading:a}};var Ae=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const vl=()=>{const{settings:t,loading:a,error:s,updateSetting:r,facilityLoading:i}=yl(),{getCurrentFacilityId:d}=V(),u=d(),c=xa(),{currentUser:n}=te(),[o,l]=g.useState([]),[m,x]=g.useState(!1),[p,h]=g.useState(!1),C=(f,N)=>Ae(null,null,function*(){try{yield r(f,N),ie.success(`${f.replace(/([A-Z])/g," $1").replace(/^./,y=>y.toUpperCase())} ${N?"enabled":"disabled"}`)}catch(y){ie.error("Failed to update setting")}}),I=f=>Ae(null,null,function*(){try{yield r("confidenceThreshold",parseFloat(f)),ie.success("Confidence threshold updated")}catch(N){ie.error("Failed to update confidence threshold")}}),_=g.useCallback(()=>Ae(null,null,function*(){if(u)try{x(!0);const f=yield Ft.getPendingSuggestions(u);l(f)}catch(f){console.error("Failed to load AI suggestions",f)}finally{x(!1)}}),[u]);g.useEffect(()=>{_()},[_]);const j=f=>Ae(null,null,function*(){try{yield Ft.acceptSuggestion(f.id);const N=new URLSearchParams({title:f.topic,suggestionId:f.id});c(`/content-builder?${N.toString()}`)}catch(N){console.error("Failed to accept suggestion",N),ie.error("Failed to open Content Builder")}});return g.useEffect(()=>{Ae(null,null,function*(){try{if(!(n!=null&&n.id)||!u){h(!1);return}const N=yield ar.getUserPermissions(n.id,u),y=N==null?void 0:N.role,v=n==null?void 0:n.role,$=(y||v||"").toString().toLowerCase();h($==="administrator"||$==="admin"||$==="manager")}catch(N){console.error("AI suggestions permission check failed",N),h(!1)}})},[n,u]),i||a?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"space-y-4",children:[1,2,3].map(f=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded w-11"})]},f))})]})})}):s?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600 text-sm",children:s})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"AI Content Suggestions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:`flex items-center justify-between ${p?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable AI suggestions"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"enable-ai-suggestions",className:"sr-only peer",checked:t.enableAISuggestions,onChange:f=>C("enableAISuggestions",f.target.checked),disabled:!p}),e.jsx("div",{className:`w-11 h-6 ${t.enableAISuggestions?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.enableAISuggestions?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Enable AI suggestions"})]})]}),e.jsxs("div",{className:`flex items-center justify-between ${p?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Content optimization suggestions"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"content-optimization",className:"sr-only peer",checked:t.contentOptimization,onChange:f=>C("contentOptimization",f.target.checked),disabled:!p}),e.jsx("div",{className:`w-11 h-6 ${t.contentOptimization?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.contentOptimization?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Content optimization suggestions"})]})]}),e.jsxs("div",{className:`flex items-center justify-between ${p?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Duplicate detection (internal library)"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"duplicate-detection",className:"sr-only peer",checked:t.plagiarismCheck,onChange:f=>C("plagiarismCheck",f.target.checked),disabled:!p}),e.jsx("div",{className:`w-11 h-6 ${t.plagiarismCheck?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.plagiarismCheck?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Duplicate detection (internal library)"})]})]}),e.jsxs("div",{className:`flex items-center justify-between ${p?"":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Automatic tagging"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-tagging",className:"sr-only peer",checked:t.autoTagging,onChange:f=>C("autoTagging",f.target.checked),disabled:!p}),e.jsx("div",{className:`w-11 h-6 ${t.autoTagging?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.autoTagging?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Automatic tagging"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"AI Configuration"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confidence-threshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Suggestion Confidence Threshold"}),e.jsxs("select",{id:"confidence-threshold",value:t.confidenceThreshold||.8,onChange:f=>I(f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"0.7",children:"70% - Balanced"}),e.jsx("option",{value:"0.8",children:"80% - Recommended"}),e.jsx("option",{value:"0.9",children:"90% - High Quality"})]})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900",children:"Suggested Topics"}),m&&e.jsx("span",{className:"text-xs text-gray-500",children:"Loading…"})]}),o.length===0&&!m?e.jsx("p",{className:"text-sm text-gray-500",children:"No suggestions right now. Check back later."}):e.jsx("div",{className:"space-y-3",children:o.map(f=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex items-start justify-between",children:[e.jsxs("div",{className:"pr-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.title||f.topic}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 capitalize",children:[f.suggestion_type," • Priority: ",f.priority]}),f.description&&e.jsx("div",{className:"text-sm text-gray-600 mt-2",children:f.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f.suggestion_type==="create"&&e.jsx("button",{onClick:()=>j(f),className:"px-3 py-2 text-sm rounded-md bg-[#4ECDC4] text-white hover:opacity-90",children:"Create in Builder"}),f.suggestion_type==="improve"&&e.jsx("button",{onClick:()=>c(`/content-builder?editId=${f.related_content_id||""}&suggestionId=${f.id}`),className:"px-3 py-2 text-sm rounded-md bg-blue-600 text-white hover:opacity-90",children:"Edit Content"})]})]},f.id))})]})]})};var jl=Object.defineProperty,Nl=Object.defineProperties,Cl=Object.getOwnPropertyDescriptors,Ls=Object.getOwnPropertySymbols,_l=Object.prototype.hasOwnProperty,Sl=Object.prototype.propertyIsEnumerable,$s=(t,a,s)=>a in t?jl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,qe=(t,a)=>{for(var s in a||(a={}))_l.call(a,s)&&$s(t,s,a[s]);if(Ls)for(var s of Ls(a))Sl.call(a,s)&&$s(t,s,a[s]);return t},Da=(t,a)=>Nl(t,Cl(a));const ue={maxFileSize:50,allowedFormats:["jpg","jpeg","png","gif","webp","heic","mp4","webm","mov","avi","mp3","wav","aac","ogg","pdf","doc","docx","ppt","pptx","xls","xlsx"],autoCompression:!0,watermarkSettings:{enabled:!1,position:"bottom-right",opacity:.5},cdnEnabled:!1,backupEnabled:!0},Nt=t=>`mediaSettings_${t}`,wl=Ct((t,a)=>({settings:ue,loading:!1,error:null,loadSettings:s=>{t({loading:!0,error:null});try{if(!(typeof window!="undefined")){t({settings:ue,loading:!1});return}const i=Nt(s),d=localStorage.getItem(i);if(d){const u=JSON.parse(d),c=qe(qe({},ue),u);t({settings:c,loading:!1})}else localStorage.setItem(i,JSON.stringify(ue)),t({settings:ue,loading:!1})}catch(r){console.error("Failed to load media settings:",r),t({error:r instanceof Error?r.message:"Failed to load settings",settings:ue,loading:!1})}},updateSetting:(s,r)=>{const{settings:i}=a(),d=Da(qe({},i),{[s]:r});t({settings:d})},resetSettings:()=>{t({settings:ue})},setLoading:s=>t({loading:s}),setError:s=>t({error:s})})),El=()=>{const{getCurrentFacilityId:t,isLoading:a}=V(),s=t(),r=wl();Se.useEffect(()=>{var u;a||(s?r.loadSettings(s):(typeof window!="undefined"&&((u=window.location)==null?void 0:u.hostname)==="localhost"||console.warn("No facility ID available, using default media settings"),r.loadSettings("default")))},[s,a,r]);const i=g.useCallback((u,c)=>{if(r.updateSetting(u,c),!a){const o=Nt(s||"default"),l=Da(qe({},r.settings),{[u]:c});try{localStorage.setItem(o,JSON.stringify(l))}catch(m){console.error("Failed to save media settings:",m),r.setError("Failed to save settings")}}},[r,s,a]),d=g.useCallback(()=>{if(r.resetSettings(),!a){const c=Nt(s||"default");try{localStorage.setItem(c,JSON.stringify(ue))}catch(n){console.error("Failed to save default media settings:",n),r.setError("Failed to save default settings")}}},[r,s,a]);return{settings:r.settings,loading:r.loading,error:r.error,updateSetting:i,resetSettings:d,facilityId:s||"default",facilityLoading:a}};var Tl=Object.defineProperty,Il=Object.defineProperties,Pl=Object.getOwnPropertyDescriptors,Ms=Object.getOwnPropertySymbols,Al=Object.prototype.hasOwnProperty,Ol=Object.prototype.propertyIsEnumerable,Fs=(t,a,s)=>a in t?Tl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,ut=(t,a)=>{for(var s in a||(a={}))Al.call(a,s)&&Fs(t,s,a[s]);if(Ms)for(var s of Ms(a))Ol.call(a,s)&&Fs(t,s,a[s]);return t},mt=(t,a)=>Il(t,Pl(a));const Dl=()=>{const{settings:t,loading:a,error:s,updateSetting:r,facilityLoading:i}=El(),d=(l,m)=>{r(l,m)},u=l=>{r("maxFileSize",l)},c=l=>{r("watermarkSettings",mt(ut({},t.watermarkSettings),{enabled:l}))},n=l=>{r("watermarkSettings",mt(ut({},t.watermarkSettings),{position:l}))},o=l=>{r("watermarkSettings",mt(ut({},t.watermarkSettings),{opacity:l}))};return a||i?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"text-sm text-gray-500",children:"Loading media settings..."})}):s?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"text-sm text-red-700",children:["Error loading media settings: ",s]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Media Upload Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max file size per upload"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"500",value:t.maxFileSize,onChange:l=>u(parseInt(l.target.value)||50),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"MB"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-compress images"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-compress-images",className:"sr-only peer",checked:t.autoCompression,onChange:l=>d("autoCompression",l.target.checked)}),e.jsx("div",{className:`w-11 h-6 ${t.autoCompression?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.autoCompression?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Auto-compress images"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Generate thumbnails"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"generate-thumbnails",className:"sr-only peer",checked:t.backupEnabled,onChange:l=>d("backupEnabled",l.target.checked)}),e.jsx("div",{className:`w-11 h-6 ${t.backupEnabled?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.backupEnabled?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Generate thumbnails"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"CDN enabled"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"cdn-enabled",className:"sr-only peer",checked:t.cdnEnabled,onChange:l=>d("cdnEnabled",l.target.checked)}),e.jsx("div",{className:`w-11 h-6 ${t.cdnEnabled?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.cdnEnabled?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"CDN enabled"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Watermark Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable watermark"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"watermark-enabled",className:"sr-only peer",checked:t.watermarkSettings.enabled,onChange:l=>c(l.target.checked)}),e.jsx("div",{className:`w-11 h-6 ${t.watermarkSettings.enabled?"bg-[#4ECDC4]":"bg-gray-200"} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t.watermarkSettings.enabled?"after:translate-x-full":""}`}),e.jsx("span",{className:"sr-only",children:"Enable watermark"})]})]}),t.watermarkSettings.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Position"}),e.jsxs("select",{value:t.watermarkSettings.position,onChange:l=>n(l.target.value),className:"px-3 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",children:[e.jsx("option",{value:"top-left",children:"Top Left"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"center",children:"Center"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Opacity"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:t.watermarkSettings.opacity,onChange:l=>o(parseFloat(l.target.value)),className:"w-20"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 w-8",children:[Math.round(t.watermarkSettings.opacity*100),"%"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Supported File Types"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-2",children:"Images"}),e.jsx("p",{className:"text-xs text-green-700",children:"JPEG, PNG, GIF, WebP, HEIC"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2",children:"Videos"}),e.jsx("p",{className:"text-xs text-blue-700",children:"MP4, WebM, MOV, AVI"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-purple-800 mb-2",children:"Audio"}),e.jsx("p",{className:"text-xs text-purple-700",children:"MP3, WAV, AAC, OGG"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"Documents"}),e.jsx("p",{className:"text-xs text-gray-700",children:"PDF, Word, PowerPoint, Excel"})]})]})]})]})},Rl=()=>{const t=xa(),[a]=ha(),s=()=>{const l=a.get("subtab");return a.get("review")?"publishing":l&&["builder","publishing","ai","media"].includes(l)?l:"builder"},[r,i]=g.useState(s),[d,u]=g.useState(a.get("review"));g.useEffect(()=>{const l=a.get("review");l&&setTimeout(()=>u(l),0)},[a]);const c=()=>{t("/content-builder")},n=[{id:"builder",label:"Content Builder",icon:yr},{id:"publishing",label:"Publishing",icon:vr},{id:"ai",label:"AI Suggestions",icon:jr},{id:"media",label:"Media Settings",icon:Nr}],o=()=>{switch(r){case"builder":return e.jsx(As,{onLaunchBuilder:c});case"publishing":return e.jsx(xl,{reviewContentId:d});case"ai":return e.jsx(vl,{});case"media":return e.jsx(Dl,{});default:return e.jsx(As,{onLaunchBuilder:c})}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:n.map(l=>e.jsxs("button",{onClick:()=>i(l.id),className:`${r===l.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(S,{path:l.icon,size:1,className:"mr-2"}),l.label]},l.id))})}),e.jsx("div",{className:"py-4",children:o()})]})})},L=({id:t,checked:a,onChange:s,label:r,description:i})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-gray-700",children:r}),i&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:i})]}),e.jsxs("label",{htmlFor:t,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:t,className:"sr-only peer",checked:a,onChange:d=>s(d.target.checked)}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${a?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`}),e.jsx("span",{className:"sr-only",children:r})]})]}),ee=({title:t,children:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:t}),e.jsx("div",{className:"space-y-3",children:a})]});var kl=Object.defineProperty,Ll=Object.defineProperties,$l=Object.getOwnPropertyDescriptors,Gs=Object.getOwnPropertySymbols,Ml=Object.prototype.hasOwnProperty,Fl=Object.prototype.propertyIsEnumerable,Us=(t,a,s)=>a in t?kl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Gl=(t,a)=>{for(var s in a||(a={}))Ml.call(a,s)&&Us(t,s,a[s]);if(Gs)for(var s of Gs(a))Fl.call(a,s)&&Us(t,s,a[s]);return t},Ul=(t,a)=>Ll(t,$l(a));const zl=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(Ul(Gl({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:X,size:1.5,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-800",children:"General Learning Settings"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Basic configuration for learning and training modules"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ee,{title:"Core Features",children:[e.jsx(L,{id:"enable-learning-paths",checked:t.enableLearningPaths,onChange:r=>s("enableLearningPaths",r),label:"Enable Learning Paths"}),e.jsx(L,{id:"enable-certifications",checked:t.enableCertifications,onChange:r=>s("enableCertifications",r),label:"Enable Certifications"}),e.jsx(L,{id:"enable-progress-tracking",checked:t.enableProgressTracking,onChange:r=>s("enableProgressTracking",r),label:"Enable Progress Tracking"}),e.jsx(L,{id:"enable-social-learning",checked:t.enableSocialLearning,onChange:r=>s("enableSocialLearning",r),label:"Enable Social Learning"})]}),e.jsxs(ee,{title:"Content Management",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"default-content-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Content Type"}),e.jsxs("select",{id:"default-content-type",value:t.defaultContentType,onChange:r=>s("defaultContentType",r.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"course",children:"Course"}),e.jsx("option",{value:"procedure",children:"Procedure"}),e.jsx("option",{value:"policy",children:"Policy"}),e.jsx("option",{value:"learning_pathway",children:"Learning Pathway"})]})]}),e.jsx(L,{id:"enable-content-rating",checked:t.enableContentRating,onChange:r=>s("enableContentRating",r),label:"Enable Content Rating"}),e.jsx(L,{id:"require-content-approval",checked:t.requireContentApproval,onChange:r=>s("requireContentApproval",r),label:"Require Content Approval"})]})]})]})})};var Bl=Object.defineProperty,Hl=Object.defineProperties,ql=Object.getOwnPropertyDescriptors,zs=Object.getOwnPropertySymbols,Vl=Object.prototype.hasOwnProperty,Yl=Object.prototype.propertyIsEnumerable,Bs=(t,a,s)=>a in t?Bl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Wl=(t,a)=>{for(var s in a||(a={}))Vl.call(a,s)&&Bs(t,s,a[s]);if(zs)for(var s of zs(a))Yl.call(a,s)&&Bs(t,s,a[s]);return t},Kl=(t,a)=>Hl(t,ql(a));const Zl=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(Kl(Wl({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:we,size:1.5,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-800",children:"AI Learning Features"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Configure AI-powered learning capabilities"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ee,{title:"AI Learning Features",children:[e.jsx(L,{id:"personalized-recommendations",checked:t.personalizedRecommendations,onChange:r=>s("personalizedRecommendations",r),label:"Personalized Recommendations"}),e.jsx(L,{id:"skill-gap-analysis",checked:t.skillGapAnalysis,onChange:r=>s("skillGapAnalysis",r),label:"Skill Gap Analysis"}),e.jsx(L,{id:"learning-path-optimization",checked:t.learningPathOptimization,onChange:r=>s("learningPathOptimization",r),label:"Learning Path Optimization"}),e.jsx(L,{id:"adaptive-difficulty",checked:t.adaptiveDifficulty,onChange:r=>s("adaptiveDifficulty",r),label:"Adaptive Difficulty"})]}),e.jsxs(ee,{title:"AI Configuration",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ai-confidence-threshold",className:"block text-sm font-medium text-gray-700 mb-1",children:"AI Confidence Threshold"}),e.jsx("input",{id:"ai-confidence-threshold",type:"range",min:"0.1",max:"1",step:"0.1",value:t.aiConfidenceThreshold,onChange:r=>s("aiConfidenceThreshold",parseFloat(r.target.value)),className:"w-full"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(t.aiConfidenceThreshold*100),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recommendation-limit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Recommendation Limit"}),e.jsx("input",{id:"recommendation-limit",type:"number",min:"1",max:"20",value:t.recommendationLimit,onChange:r=>s("recommendationLimit",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"data-retention-days",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Retention (Days)"}),e.jsx("input",{id:"data-retention-days",type:"number",min:"30",max:"1095",value:t.dataRetentionDays,onChange:r=>s("dataRetentionDays",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]})]})]})]})})};var Jl=Object.defineProperty,Ql=Object.defineProperties,Xl=Object.getOwnPropertyDescriptors,Hs=Object.getOwnPropertySymbols,eo=Object.prototype.hasOwnProperty,to=Object.prototype.propertyIsEnumerable,qs=(t,a,s)=>a in t?Jl(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,so=(t,a)=>{for(var s in a||(a={}))eo.call(a,s)&&qs(t,s,a[s]);if(Hs)for(var s of Hs(a))to.call(a,s)&&qs(t,s,a[s]);return t},ao=(t,a)=>Ql(t,Xl(a));const ro=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(ao(so({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:Ca,size:1.5,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Certification Management"}),e.jsx("p",{className:"text-sm text-green-700",children:"Configure certification and compliance tracking"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ee,{title:"Certification Features",children:[e.jsx(L,{id:"enable-auto-certification",checked:t.enableAutoCertification,onChange:r=>s("enableAutoCertification",r),label:"Enable Auto-Certification"}),e.jsx(L,{id:"require-re-certification",checked:t.requireReCertification,onChange:r=>s("requireReCertification",r),label:"Require Re-Certification"}),e.jsx(L,{id:"enable-certification-templates",checked:t.enableCertificationTemplates,onChange:r=>s("enableCertificationTemplates",r),label:"Enable Certification Templates"})]}),e.jsxs(ee,{title:"Assessment Settings",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passing-score-threshold",className:"block text-sm font-medium text-gray-700 mb-1",children:"Passing Score Threshold"}),e.jsx("input",{id:"passing-score-threshold",type:"number",min:"50",max:"100",value:t.passingScoreThreshold,onChange:r=>s("passingScoreThreshold",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-assessment-attempts",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Assessment Attempts"}),e.jsx("input",{id:"max-assessment-attempts",type:"number",min:"1",max:"10",value:t.maxAssessmentAttempts,onChange:r=>s("maxAssessmentAttempts",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"certification-expiry-days",className:"block text-sm font-medium text-gray-700 mb-1",children:"Certification Expiry (Days)"}),e.jsx("input",{id:"certification-expiry-days",type:"number",min:"30",max:"1095",value:t.certificationExpiryDays,onChange:r=>s("certificationExpiryDays",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]})]})]})]})})};var no=Object.defineProperty,io=Object.defineProperties,lo=Object.getOwnPropertyDescriptors,Vs=Object.getOwnPropertySymbols,oo=Object.prototype.hasOwnProperty,co=Object.prototype.propertyIsEnumerable,Ys=(t,a,s)=>a in t?no(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,uo=(t,a)=>{for(var s in a||(a={}))oo.call(a,s)&&Ys(t,s,a[s]);if(Vs)for(var s of Vs(a))co.call(a,s)&&Ys(t,s,a[s]);return t},mo=(t,a)=>io(t,lo(a));const go=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(mo(uo({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:Re,size:1.5,className:"text-orange-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-800",children:"Learning Path Configuration"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Configure learning paths and progress tracking"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ee,{title:"Path Features",children:[e.jsx(L,{id:"enable-custom-paths",checked:t.enableCustomPaths,onChange:r=>s("enableCustomPaths",r),label:"Enable Custom Learning Paths"}),e.jsx(L,{id:"enable-prerequisites",checked:t.enablePrerequisites,onChange:r=>s("enablePrerequisites",r),label:"Enable Prerequisites"}),e.jsx(L,{id:"enable-branching",checked:t.enableBranching,onChange:r=>s("enableBranching",r),label:"Enable Branching Paths"}),e.jsx(L,{id:"adaptive-path-generation",checked:t.adaptivePathGeneration,onChange:r=>s("adaptivePathGeneration",r),label:"AI Adaptive Path Generation"})]}),e.jsxs(ee,{title:"Progress & Gamification",children:[e.jsx(L,{id:"enable-milestones",checked:t.enableMilestones,onChange:r=>s("enableMilestones",r),label:"Enable Learning Milestones"}),e.jsx(L,{id:"enable-progress-gamification",checked:t.enableProgressGamification,onChange:r=>s("enableProgressGamification",r),label:"Enable Progress Gamification"}),e.jsx(L,{id:"enable-learning-streaks",checked:t.enableLearningStreaks,onChange:r=>s("enableLearningStreaks",r),label:"Enable Learning Streaks"}),e.jsx(L,{id:"enable-achievement-badges",checked:t.enableAchievementBadges,onChange:r=>s("enableAchievementBadges",r),label:"Enable Achievement Badges"})]})]})]})})};var xo=Object.defineProperty,ho=Object.defineProperties,po=Object.getOwnPropertyDescriptors,Ws=Object.getOwnPropertySymbols,fo=Object.prototype.hasOwnProperty,bo=Object.prototype.propertyIsEnumerable,Ks=(t,a,s)=>a in t?xo(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,yo=(t,a)=>{for(var s in a||(a={}))fo.call(a,s)&&Ks(t,s,a[s]);if(Ws)for(var s of Ws(a))bo.call(a,s)&&Ks(t,s,a[s]);return t},vo=(t,a)=>ho(t,po(a));const jo=({aiSettings:t,onAiSettingsChange:a})=>{const s=(r,i)=>{a(vo(yo({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:ye,size:1.5,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Advanced Configuration"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Advanced settings for power users"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ee,{title:"Data & Privacy",children:[e.jsx(L,{id:"data-sharing-enabled",checked:t.dataSharingEnabled,onChange:r=>s("dataSharingEnabled",r),label:"Enable Data Sharing for AI Training"}),e.jsx(L,{id:"local-ai-processing-enabled",checked:t.localAIProcessingEnabled,onChange:r=>s("localAIProcessingEnabled",r),label:"Local AI Processing"}),e.jsx(L,{id:"encrypted-data-transmission",checked:t.encryptedDataTransmission,onChange:r=>s("encryptedDataTransmission",r),label:"Encrypted Data Transmission"})]}),e.jsx(ee,{title:"System Information",children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"AI Model Version:"})," ",t.modelVersion]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Data Retention:"})," ",t.dataRetentionDays," days"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Confidence Threshold:"})," ",Math.round(t.aiConfidenceThreshold*100),"%"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Recommendation Limit:"})," ",t.recommendationLimit," items"]})]})})]})]})})},No=()=>{const[t,a]=g.useState({aiEnabled:!0,personalizedRecommendations:!0,skillGapAnalysis:!0,learningPathOptimization:!0,performancePrediction:!0,adaptiveDifficulty:!0,learningAnalyticsEnabled:!0,behaviorTracking:!0,progressPrediction:!0,engagementMetrics:!0,retentionAnalysis:!0,aiConfidenceThreshold:.8,recommendationLimit:5,dataRetentionDays:365,modelVersion:"v1.0",dataSharingEnabled:!1,localAIProcessingEnabled:!0,encryptedDataTransmission:!0,aiModelTraining:!1}),[s,r]=g.useState({enableLearningPaths:!0,enableCertifications:!0,enableProgressTracking:!0,enableSocialLearning:!1,defaultContentType:"course",enableContentRating:!0,enableComments:!0,requireContentApproval:!0,showLearningRecommendations:!0,enableLearningReminders:!0,adaptiveInterface:!0,mobileLearningEnabled:!0}),[i,d]=g.useState({enableAutoCertification:!0,certificationExpiryDays:365,requireReCertification:!0,enableCertificationTemplates:!0,complianceTrackingEnabled:!0,regulatoryUpdatesEnabled:!0,auditTrailEnabled:!0,complianceReportingEnabled:!0,enableAssessments:!0,passingScoreThreshold:80,maxAssessmentAttempts:3,enableRetakes:!0}),[u,c]=g.useState({enableCustomPaths:!0,enablePrerequisites:!0,enableBranching:!0,adaptivePathGeneration:!0,enableMilestones:!0,enableProgressGamification:!0,enableLearningStreaks:!0,enableAchievementBadges:!0,estimatedCompletionTracking:!0,enableStudyScheduling:!0,optimalStudyTimeRecommendations:!0,enableLearningReminders:!0});return{aiSettings:t,setAiSettings:a,generalSettings:s,setGeneralSettings:r,certificationSettings:i,setCertificationSettings:d,learningPathSettings:u,setLearningPathSettings:c}};var Co=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const _o=()=>{const[t,a]=g.useState("general"),[s,r]=g.useState(!1),[i,d]=g.useState(null),{aiSettings:u,setAiSettings:c,generalSettings:n,setGeneralSettings:o,certificationSettings:l,setCertificationSettings:m,learningPathSettings:x,setLearningPathSettings:p}=No(),h=[{id:"general",label:"General Settings",icon:X},{id:"ai",label:"AI & Analytics",icon:we},{id:"certifications",label:"Certifications",icon:Ca},{id:"learning-paths",label:"Learning Paths",icon:Re},{id:"advanced",label:"Advanced",icon:ye}],C=()=>Co(null,null,function*(){try{r(!0),d(null),d({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>d(null),3e3)}catch(_){console.error(_),d({type:"error",text:"Failed to save settings. Please try again."})}finally{r(!1)}}),I=()=>{switch(t){case"general":return e.jsx(zl,{settings:n,onSettingsChange:o});case"ai":return e.jsx(Zl,{settings:u,onSettingsChange:c});case"certifications":return e.jsx(ro,{settings:l,onSettingsChange:m});case"learning-paths":return e.jsx(go,{settings:x,onSettingsChange:p});case"advanced":return e.jsx(jo,{aiSettings:u,onAiSettingsChange:c});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Learning & Training Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure AI-powered learning features and training modules"})]}),e.jsxs("button",{onClick:C,disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4] disabled:opacity-50",children:[e.jsx(S,{path:ke,size:1,className:"mr-2"}),s?"Saving...":"Save Settings"]})]}),i&&e.jsx("div",{className:`rounded-md p-4 ${i.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{path:i.type==="success"?be:z,size:1.2,className:`mr-2 ${i.type==="success"?"text-green-400":"text-red-400"}`}),i.text]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:h.map(_=>e.jsxs("button",{onClick:()=>a(_.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${t===_.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(S,{path:_.icon,size:1}),e.jsx("span",{children:_.label})]},_.id))})}),e.jsx("div",{className:"tab-content-area",children:I()})]})},So={aiEnabled:!1,predictiveCleaningEnabled:!1,smartScheduling:!1,contaminationPrediction:!1,resourceOptimization:!1,efficiencyAnalytics:!1,smartRoomManagementEnabled:!1,automaticPriorityAssignment:!1,riskAssessment:!1,trendAnalysis:!1,predictiveMaintenance:!1,supplyOptimizationEnabled:!1,staffScheduling:!1,costOptimization:!1,inventoryPrediction:!1,workloadBalancing:!1,qualityAssuranceEnabled:!1,complianceMonitoring:!1,auditTrailEnhancement:!1,performanceTracking:!1,automatedReporting:!1,realTimeMonitoringEnabled:!1,anomalyDetection:!1,smartNotifications:!1,statusUpdates:!1,emergencyAlerts:!1,aiConfidenceThreshold:.85,aiDataRetentionDays:90,realTimeProcessingEnabled:!1,batchProcessingEnabled:!1,dataSharingEnabled:!1,localAIProcessingEnabled:!1,encryptedDataTransmission:!0,aiModelTraining:!1},wo={defaultCleaningDuration:45,qualityScoreThreshold:8,contaminationLevels:["low","medium","high","critical"],cleaningTypes:["routine","deep","emergency","post_procedure"],autoSchedulingEnabled:!1,bufferTimeMinutes:15,maxConcurrentCleanings:3,weekendCleaningEnabled:!0,complianceTrackingEnabled:!0,auditLogRetentionDays:365,regulatoryReportingEnabled:!1,certificationTracking:!1},Eo={emailNotificationsEnabled:!0,dailySummaryEnabled:!0,urgentAlertsEnabled:!0,completionNotificationsEnabled:!1,inAppNotificationsEnabled:!0,pushNotificationsEnabled:!1,soundEnabled:!0,adminNotificationsEnabled:!0,staffNotificationsEnabled:!1,supervisorNotificationsEnabled:!0},P={defaultCleaningDuration:{min:15,max:180},qualityScoreThreshold:{min:1,max:10},bufferTimeMinutes:{min:0,max:60},maxConcurrentCleanings:{min:1,max:10},auditLogRetentionDays:{min:30,max:2555},aiConfidenceThreshold:{min:.1,max:1,step:.05},aiDataRetentionDays:{min:30,max:1095}},To=[{id:"general",label:"General",icon:X},{id:"ai",label:"AI & Analytics",icon:_e},{id:"protocols",label:"Cleaning Protocols",icon:Re},{id:"rooms",label:"Room Management",icon:Ve},{id:"checklists",label:"Checklists",icon:Re},{id:"notifications",label:"Notifications",icon:_a},{id:"compliance",label:"Compliance",icon:Ve},{id:"advanced",label:"Advanced",icon:ye}],Zs={email:[{key:"emailNotificationsEnabled",label:"Enable Email Notifications"},{key:"dailySummaryEnabled",label:"Daily Summary Reports"},{key:"urgentAlertsEnabled",label:"Urgent Alerts"},{key:"completionNotificationsEnabled",label:"Task Completion Notifications"}],inApp:[{key:"inAppNotificationsEnabled",label:"Enable In-App Notifications"},{key:"pushNotificationsEnabled",label:"Push Notifications"},{key:"soundEnabled",label:"Sound Alerts"}]},Io=3e3,Po=t=>{const a=[];return(t.aiConfidenceThreshold<P.aiConfidenceThreshold.min||t.aiConfidenceThreshold>P.aiConfidenceThreshold.max)&&a.push(`AI confidence threshold must be between ${P.aiConfidenceThreshold.min} and ${P.aiConfidenceThreshold.max}`),(t.aiDataRetentionDays<P.aiDataRetentionDays.min||t.aiDataRetentionDays>P.aiDataRetentionDays.max)&&a.push(`AI data retention days must be between ${P.aiDataRetentionDays.min} and ${P.aiDataRetentionDays.max}`),a},Ao=t=>{const a=[];return(t.defaultCleaningDuration<P.defaultCleaningDuration.min||t.defaultCleaningDuration>P.defaultCleaningDuration.max)&&a.push(`Default cleaning duration must be between ${P.defaultCleaningDuration.min} and ${P.defaultCleaningDuration.max} minutes`),(t.qualityScoreThreshold<P.qualityScoreThreshold.min||t.qualityScoreThreshold>P.qualityScoreThreshold.max)&&a.push(`Quality score threshold must be between ${P.qualityScoreThreshold.min} and ${P.qualityScoreThreshold.max}`),(t.bufferTimeMinutes<P.bufferTimeMinutes.min||t.bufferTimeMinutes>P.bufferTimeMinutes.max)&&a.push(`Buffer time must be between ${P.bufferTimeMinutes.min} and ${P.bufferTimeMinutes.max} minutes`),(t.maxConcurrentCleanings<P.maxConcurrentCleanings.min||t.maxConcurrentCleanings>P.maxConcurrentCleanings.max)&&a.push(`Max concurrent cleanings must be between ${P.maxConcurrentCleanings.min} and ${P.maxConcurrentCleanings.max}`),(t.auditLogRetentionDays<P.auditLogRetentionDays.min||t.auditLogRetentionDays>P.auditLogRetentionDays.max)&&a.push(`Audit log retention days must be between ${P.auditLogRetentionDays.min} and ${P.auditLogRetentionDays.max}`),a},Oo=t=>{const a=[];return!t.emailNotificationsEnabled&&!t.inAppNotificationsEnabled&&a.push("At least one notification method must be enabled"),a},Do=(t,a,s)=>[...Po(t),...Ao(a),...Oo(s)],Ro=(t,a,s)=>{const r=Do(t,a,s);return{isValid:r.length===0,errors:r}};var ko=Object.defineProperty,Lo=Object.defineProperties,$o=Object.getOwnPropertyDescriptors,Js=Object.getOwnPropertySymbols,Mo=Object.prototype.hasOwnProperty,Fo=Object.prototype.propertyIsEnumerable,Qs=(t,a,s)=>a in t?ko(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,gt=(t,a)=>{for(var s in a||(a={}))Mo.call(a,s)&&Qs(t,s,a[s]);if(Js)for(var s of Js(a))Fo.call(a,s)&&Qs(t,s,a[s]);return t},Go=(t,a)=>Lo(t,$o(a)),Ye=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Ra={settings:"/api/environmental-cleaning/settings",aiSettings:"/api/environmental-cleaning/ai-settings",testSync:"/api/environmental-cleaning/test-sync",resetDefaults:"/api/environmental-cleaning/reset-defaults"},xt={timeout:3e4,retries:3,headers:{"Content-Type":"application/json"}},Pt=(t,a,...s)=>Ye(null,[t,a,...s],function*(r,i,d=xt.retries){try{const u=new AbortController,c=setTimeout(()=>u.abort(),xt.timeout),n=yield fetch(r,Go(gt({},i),{signal:u.signal,headers:gt(gt({},xt.headers),i.headers)}));if(clearTimeout(c),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return yield n.json()}catch(u){if(d>0&&u instanceof Error&&u.name==="AbortError")return Pt(r,i,d-1);throw u}}),Uo=t=>Ye(null,null,function*(){try{const a=yield Pt(Ra.settings,{method:"POST",body:JSON.stringify(t)});if(!a.success)throw new Error(a.error||"Failed to save settings")}catch(a){throw console.error("Error saving environmental cleaning settings:",a),new Error("Failed to save settings. Please try again.")}}),zo=t=>Ye(null,null,function*(){try{const a=yield Pt(Ra.aiSettings,{method:"POST",body:JSON.stringify(t)});if(!a.success)throw new Error(a.error||"Failed to save AI settings")}catch(a){throw console.error("Error saving AI settings:",a),new Error("Failed to save AI settings. Please try again.")}}),Bo=(t,a,s)=>Ye(null,null,function*(){try{t.aiEnabled&&(yield zo({aiSettings:t})),yield Uo({protocols:a,notifications:s})}catch(r){throw console.error("Error saving all settings:",r),r}}),Ho=({protocolSettings:t,onProtocolSettingChange:a})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:X,size:1.5,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-800",children:"General Settings"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Basic configuration for environmental cleaning"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultCleaningDuration",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Cleaning Duration (minutes)"}),e.jsx("input",{id:"defaultCleaningDuration",type:"number",value:t.defaultCleaningDuration,onChange:s=>a("defaultCleaningDuration",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:P.defaultCleaningDuration.min,max:P.defaultCleaningDuration.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"qualityScoreThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Score Threshold"}),e.jsx("input",{id:"qualityScoreThreshold",type:"number",value:t.qualityScoreThreshold,onChange:s=>a("qualityScoreThreshold",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:P.qualityScoreThreshold.min,max:P.qualityScoreThreshold.max})]})]})]})}),qo=()=>e.jsx("div",{children:"Test"}),Vo=({protocolSettings:t,onProtocolSettingChange:a})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:Re,size:1.5,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Cleaning Protocols"}),e.jsx("p",{className:"text-sm text-green-700",children:"Configure cleaning procedures and standards"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bufferTimeMinutes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Buffer Time (minutes)"}),e.jsx("input",{id:"bufferTimeMinutes",type:"number",value:t.bufferTimeMinutes,onChange:s=>a("bufferTimeMinutes",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:P.bufferTimeMinutes.min,max:P.bufferTimeMinutes.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxConcurrentCleanings",className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Concurrent Cleanings"}),e.jsx("input",{id:"maxConcurrentCleanings",type:"number",value:t.maxConcurrentCleanings,onChange:s=>a("maxConcurrentCleanings",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:P.maxConcurrentCleanings.min,max:P.maxConcurrentCleanings.max})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"autoSchedulingEnabled",className:"text-sm font-medium text-gray-700",children:"Auto Scheduling"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable automatic cleaning schedule generation"})]}),e.jsx("button",{id:"autoSchedulingEnabled",onClick:()=>a("autoSchedulingEnabled",!t.autoSchedulingEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ${t.autoSchedulingEnabled?"bg-green-600":"bg-gray-200"}`,"aria-label":"Auto Scheduling",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.autoSchedulingEnabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekendCleaningEnabled",className:"text-sm font-medium text-gray-700",children:"Weekend Cleaning"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Allow cleaning tasks on weekends"})]}),e.jsx("button",{id:"weekendCleaningEnabled",onClick:()=>a("weekendCleaningEnabled",!t.weekendCleaningEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ${t.weekendCleaningEnabled?"bg-green-600":"bg-gray-200"}`,"aria-label":"Weekend Cleaning",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.weekendCleaningEnabled?"translate-x-6":"translate-x-1"}`})})]})]})]})}),Yo=({notificationSettings:t,onNotificationSettingChange:a})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:_a,size:1.5,className:"text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-yellow-800",children:"Notification Settings"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Configure how and when you receive notifications"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-800 mb-3",children:"Email Notifications"}),e.jsx("div",{className:"space-y-3",children:Zs.email.map(({key:s,label:r})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:s,className:"text-sm text-gray-700",children:r}),e.jsx("button",{id:s,onClick:()=>a(s,!t[s]),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-1 ${t[s]?"bg-yellow-600":"bg-gray-200"}`,"aria-label":r,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t[s]?"translate-x-5":"translate-x-1"}`})})]},s))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-800 mb-3",children:"In-App Notifications"}),e.jsx("div",{className:"space-y-3",children:Zs.inApp.map(({key:s,label:r})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:s,className:"text-sm text-gray-700",children:r}),e.jsx("button",{id:s,onClick:()=>a(s,!t[s]),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-1 ${t[s]?"bg-yellow-600":"bg-gray-200"}`,"aria-label":r,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t[s]?"translate-x-5":"translate-x-1"}`})})]},s))})]})]})]})}),Wo=({protocolSettings:t,onProtocolSettingChange:a})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:Ve,size:1.5,className:"text-red-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Compliance & Audit"}),e.jsx("p",{className:"text-sm text-red-700",children:"Configure compliance tracking and reporting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"complianceTrackingEnabled",className:"text-sm font-medium text-gray-700",children:"Compliance Tracking"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Track regulatory compliance automatically"})]}),e.jsx("button",{id:"complianceTrackingEnabled",onClick:()=>a("complianceTrackingEnabled",!t.complianceTrackingEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 ${t.complianceTrackingEnabled?"bg-red-600":"bg-gray-200"}`,"aria-label":"Compliance Tracking",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.complianceTrackingEnabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"auditLogRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Audit Log Retention (days)"}),e.jsx("input",{id:"auditLogRetentionDays",type:"number",value:t.auditLogRetentionDays,onChange:s=>a("auditLogRetentionDays",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",min:P.auditLogRetentionDays.min,max:P.auditLogRetentionDays.max})]})]})]})}),Ko=({aiSettings:t,onAISettingChange:a})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(S,{path:ye,size:1.5,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Advanced Settings"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Advanced configuration and system settings"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiConfidenceThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Confidence Threshold"}),e.jsx("input",{id:"aiConfidenceThreshold",type:"number",value:t.aiConfidenceThreshold,onChange:s=>a("aiConfidenceThreshold",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500",min:P.aiConfidenceThreshold.min,max:P.aiConfidenceThreshold.max,step:P.aiConfidenceThreshold.step}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum confidence for AI predictions"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiDataRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (days)"}),e.jsx("input",{id:"aiDataRetentionDays",type:"number",value:t.aiDataRetentionDays,onChange:s=>a("aiDataRetentionDays",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500",min:P.aiDataRetentionDays.min,max:P.aiDataRetentionDays.max}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long to keep AI training data"})]})]})]})});var Zo=Object.defineProperty,Jo=Object.defineProperties,Qo=Object.getOwnPropertyDescriptors,Xs=Object.getOwnPropertySymbols,Xo=Object.prototype.hasOwnProperty,ec=Object.prototype.propertyIsEnumerable,ea=(t,a,s)=>a in t?Zo(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,ht=(t,a)=>{for(var s in a||(a={}))Xo.call(a,s)&&ea(t,s,a[s]);if(Xs)for(var s of Xs(a))ec.call(a,s)&&ea(t,s,a[s]);return t},pt=(t,a)=>Jo(t,Qo(a)),tc=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const sc=()=>{const[t,a]=g.useState(So),[s,r]=g.useState(wo),[i,d]=g.useState(Eo),[u,c]=g.useState(null),[n,o]=g.useState(!1);return{aiSettings:t,protocolSettings:s,notificationSettings:i,message:u,isLoading:n,handleAISettingChange:(C,I)=>{a(_=>pt(ht({},_),{[C]:I}))},handleProtocolSettingChange:(C,I)=>{r(_=>pt(ht({},_),{[C]:I}))},handleNotificationSettingChange:(C,I)=>{d(_=>pt(ht({},_),{[C]:I}))},handleSaveSettings:()=>tc(null,null,function*(){try{o(!0),c(null);const C=Ro(t,s,i);if(!C.isValid){c({type:"error",text:C.errors[0]||"Validation failed"});return}yield Bo(t,s,i),c({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>c(null),Io)}catch(C){console.error(C),c({type:"error",text:"Failed to save settings. Please try again."})}finally{o(!1)}}),clearMessage:()=>c(null)}},ac=()=>{const[t,a]=g.useState("general"),{aiSettings:s,protocolSettings:r,notificationSettings:i,message:d,isLoading:u,handleAISettingChange:c,handleProtocolSettingChange:n,handleNotificationSettingChange:o,handleSaveSettings:l}=sc(),m=()=>{switch(t){case"general":return e.jsx(Ho,{protocolSettings:r,onProtocolSettingChange:n});case"ai":return e.jsx(qo,{});case"protocols":return e.jsx(Vo,{protocolSettings:r,onProtocolSettingChange:n});case"rooms":return e.jsx(Ya,{});case"checklists":return e.jsx(Va,{});case"notifications":return e.jsx(Yo,{notificationSettings:i,onNotificationSettingChange:o});case"compliance":return e.jsx(Wo,{protocolSettings:r,onProtocolSettingChange:n});case"advanced":return e.jsx(Ko,{aiSettings:s,onAISettingChange:c});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Environmental Cleaning Settings"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Configure comprehensive settings for environmental cleaning workflows, AI features, protocols, and compliance."})]}),d&&e.jsx("div",{className:`p-4 rounded-lg border ${d.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:d.type==="success"?be:z,size:1,className:"text-current"}),d.text]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:To.map(x=>e.jsxs("button",{onClick:()=>a(x.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${t===x.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(S,{path:x.icon,size:1}),x.label||x.name]},x.id))})}),e.jsx("div",{className:"min-h-[400px]",children:m()}),e.jsx("div",{className:"flex justify-end pt-6 border-t",children:e.jsxs("button",{onClick:l,disabled:u,className:"px-6 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#45B7AF] focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(S,{path:ke,size:1}),u?"Saving...":"Save Settings"]})})]})},fe=({title:t,children:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700",children:t}),e.jsx("div",{className:"space-y-3",children:a})]});var rc=Object.defineProperty,nc=Object.defineProperties,ic=Object.getOwnPropertyDescriptors,ta=Object.getOwnPropertySymbols,lc=Object.prototype.hasOwnProperty,oc=Object.prototype.propertyIsEnumerable,sa=(t,a,s)=>a in t?rc(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,cc=(t,a)=>{for(var s in a||(a={}))lc.call(a,s)&&sa(t,s,a[s]);if(ta)for(var s of ta(a))oc.call(a,s)&&sa(t,s,a[s]);return t},dc=(t,a)=>nc(t,ic(a));const uc=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(dc(cc({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(S,{path:X,size:1,className:"text-gray-600"}),"General Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(fe,{title:"Core Features",children:[e.jsx(q,{id:"autoCalculateTotals",checked:t.autoCalculateTotals,onChange:r=>s("autoCalculateTotals",r),label:"Auto-calculate totals"}),e.jsx(q,{id:"requireApprovalForAdjustments",checked:t.requireApprovalForAdjustments,onChange:r=>s("requireApprovalForAdjustments",r),label:"Require approval for adjustments"}),e.jsx(q,{id:"allowNegativeQuantities",checked:t.allowNegativeQuantities,onChange:r=>s("allowNegativeQuantities",r),label:"Allow negative quantities"})]}),e.jsxs(fe,{title:"System Features",children:[e.jsx(q,{id:"enableRealTimeUpdates",checked:t.enableRealTimeUpdates,onChange:r=>s("enableRealTimeUpdates",r),label:"Enable real-time updates"}),e.jsx(q,{id:"enableAuditTrails",checked:t.enableAuditTrails,onChange:r=>s("enableAuditTrails",r),label:"Enable audit trails"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultTransactionType",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default transaction type"}),e.jsxs("select",{id:"defaultTransactionType",value:t.defaultTransactionType,onChange:r=>s("defaultTransactionType",r.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"in",children:"In"}),e.jsx("option",{value:"out",children:"Out"}),e.jsx("option",{value:"adjustment",children:"Adjustment"})]})]})]})]})]})})};var mc=Object.defineProperty,gc=Object.defineProperties,xc=Object.getOwnPropertyDescriptors,aa=Object.getOwnPropertySymbols,hc=Object.prototype.hasOwnProperty,pc=Object.prototype.propertyIsEnumerable,ra=(t,a,s)=>a in t?mc(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,fc=(t,a)=>{for(var s in a||(a={}))hc.call(a,s)&&ra(t,s,a[s]);if(aa)for(var s of aa(a))pc.call(a,s)&&ra(t,s,a[s]);return t},bc=(t,a)=>gc(t,xc(a));const yc=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(bc(fc({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(S,{path:Tt,size:1,className:"text-gray-600"}),"Stock Management"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(fe,{title:"Stock Thresholds",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lowStockThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Low stock threshold"}),e.jsx("input",{id:"lowStockThreshold",type:"number",value:t.lowStockThreshold,onChange:r=>s("lowStockThreshold",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"criticalStockThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Critical stock threshold"}),e.jsx("input",{id:"criticalStockThreshold",type:"number",value:t.criticalStockThreshold,onChange:r=>s("criticalStockThreshold",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"0"})]})]}),e.jsxs(fe,{title:"Reorder Settings",children:[e.jsx(q,{id:"autoReorderEnabled",checked:t.autoReorderEnabled,onChange:r=>s("autoReorderEnabled",r),label:"Enable automatic reordering"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reorderBufferDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reorder buffer (days)"}),e.jsx("input",{id:"reorderBufferDays",type:"number",value:t.reorderBufferDays,onChange:r=>s("reorderBufferDays",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"1",max:"30"})]})]})]})]})})};var vc=Object.defineProperty,jc=Object.defineProperties,Nc=Object.getOwnPropertyDescriptors,na=Object.getOwnPropertySymbols,Cc=Object.prototype.hasOwnProperty,_c=Object.prototype.propertyIsEnumerable,ia=(t,a,s)=>a in t?vc(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Sc=(t,a)=>{for(var s in a||(a={}))Cc.call(a,s)&&ia(t,s,a[s]);if(na)for(var s of na(a))_c.call(a,s)&&ia(t,s,a[s]);return t},wc=(t,a)=>jc(t,Nc(a));const Ec=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(wc(Sc({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(S,{path:ye,size:1,className:"text-gray-600"}),"Categories & Organization"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(fe,{title:"Organization Features",children:[e.jsx(q,{id:"enableSubcategories",checked:t.enableSubcategories,onChange:r=>s("enableSubcategories",r),label:"Enable subcategories"}),e.jsx(q,{id:"enableCustomTags",checked:t.enableCustomTags,onChange:r=>s("enableCustomTags",r),label:"Enable custom tags"}),e.jsx(q,{id:"requireCategoryAssignment",checked:t.requireCategoryAssignment,onChange:r=>s("requireCategoryAssignment",r),label:"Require category assignment"})]})})]})})};var Tc=Object.defineProperty,Ic=Object.defineProperties,Pc=Object.getOwnPropertyDescriptors,la=Object.getOwnPropertySymbols,Ac=Object.prototype.hasOwnProperty,Oc=Object.prototype.propertyIsEnumerable,oa=(t,a,s)=>a in t?Tc(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,Dc=(t,a)=>{for(var s in a||(a={}))Ac.call(a,s)&&oa(t,s,a[s]);if(la)for(var s of la(a))Oc.call(a,s)&&oa(t,s,a[s]);return t},Rc=(t,a)=>Ic(t,Pc(a));const kc=({settings:t,onSettingsChange:a})=>{const s=(r,i)=>{a(Rc(Dc({},t),{[r]:i}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(S,{path:Et,size:1,className:"text-gray-600"}),"Reporting & Analytics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(fe,{title:"Report Generation",children:[e.jsx(q,{id:"autoGenerateReports",checked:t.autoGenerateReports,onChange:r=>s("autoGenerateReports",r),label:"Auto-generate reports"}),e.jsx(q,{id:"includeSensitiveData",checked:t.includeSensitiveData,onChange:r=>s("includeSensitiveData",r),label:"Include sensitive data"})]}),e.jsxs(fe,{title:"Report Configuration",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reportRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Report retention (days)"}),e.jsx("input",{id:"reportRetentionDays",type:"number",value:t.reportRetentionDays,onChange:r=>s("reportRetentionDays",parseInt(r.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"30",max:"1095"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reportFormat",className:"block text-sm font-medium text-gray-700 mb-2",children:"Report format"}),e.jsxs("select",{id:"reportFormat",value:t.reportFormat,onChange:r=>s("reportFormat",r.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"PDF",children:"PDF"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"CSV",children:"CSV"})]})]})]})]})]})})},Lc=()=>e.jsx("div",{children:"Test"});var Be=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});function $c(){const[t,a]=g.useState([]),[s,r]=g.useState(!0),[i,d]=g.useState(""),[u,c]=g.useState(""),[n,o]=g.useState(null),[l,m]=g.useState(null),[x,p]=g.useState(""),[h,C]=g.useState(!1),I=g.useCallback(()=>Be(null,null,function*(){r(!0);try{const N=yield rr(x);a(N)}catch(N){console.error("Failed to fetch locations",N)}finally{r(!1)}}),[x]);function _(){return Be(this,null,function*(){if(!i||!u)return alert("Name and barcode are required");C(!0);try{yield nr(x,i,u,n!=null?n:void 0,l!=null?l:void 0),yield I(),d(""),c(""),m(null)}catch(N){alert("Failed to create location")}finally{C(!1)}})}function j(N){return Be(this,null,function*(){if(confirm("Delete this location?"))try{yield lr(N),a(y=>y.filter(v=>v.id!==N))}catch(y){alert("Failed to delete location")}})}function f(N,y){return Be(this,null,function*(){try{yield ir(N,y),yield I()}catch(v){alert("Failed to update status")}})}return g.useEffect(()=>{I()},[I]),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Location Management"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 space-y-2",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Add New Location"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{className:"form-control",placeholder:"Location Name",value:i,onChange:N=>d(N.target.value)}),e.jsx("input",{className:"form-control",placeholder:"Barcode",value:u,onChange:N=>c(N.target.value)}),e.jsx("input",{className:"form-control",placeholder:"Capacity (optional)",type:"number",value:l!=null?l:"",onChange:N=>m(Number(N.target.value)||null)}),e.jsx(Dt,{onClick:_,disabled:h,children:h?"Adding...":"Add Location"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Existing Locations"}),s?e.jsx("p",{className:"flex items-center gap-2",children:"Loading…"}):t.length===0?e.jsx("p",{className:"text-muted",children:"No locations found."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Name"}),e.jsx("th",{className:"text-left p-2",children:"Barcode"}),e.jsx("th",{className:"text-left p-2",children:"Capacity"}),e.jsx("th",{className:"text-left p-2",children:"Status"}),e.jsx("th",{className:"text-left p-2",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(N=>{var y;return e.jsxs("tr",{className:"border-b hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:N.name}),e.jsx("td",{className:"p-2 font-mono",children:N.barcode}),e.jsx("td",{className:"p-2",children:(y=N.capacity)!=null?y:"—"}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"form-select",value:N.status,onChange:v=>f(N.id,v.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"full",children:"Full"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})}),e.jsx("td",{className:"p-2",children:e.jsx(Dt,{variant:"danger",size:"sm",onClick:()=>j(N.id),children:"Delete"})})]},N.id)})})]})]})]})}var Mc=Object.defineProperty,Fc=Object.defineProperties,Gc=Object.getOwnPropertyDescriptors,ca=Object.getOwnPropertySymbols,Uc=Object.prototype.hasOwnProperty,zc=Object.prototype.propertyIsEnumerable,da=(t,a,s)=>a in t?Mc(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,He=(t,a)=>{for(var s in a||(a={}))Uc.call(a,s)&&da(t,s,a[s]);if(ca)for(var s of ca(a))zc.call(a,s)&&da(t,s,a[s]);return t},ft=(t,a)=>Fc(t,Gc(a)),Ce=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const Bc=()=>{const{currentUser:t}=te(),[a,s]=g.useState(null),[r,i]=g.useState(""),[d,u]=g.useState(!1),[c,n]=g.useState(null),[o,l]=g.useState({autoCalculateTotals:!0,requireApprovalForAdjustments:!0,allowNegativeQuantities:!1,requireReasonForAdjustments:!0,defaultTransactionType:"in",enableRealTimeUpdates:!0,enableAuditTrails:!0,lowStockThreshold:10,criticalStockThreshold:5,autoReorderEnabled:!1,reorderBufferDays:7,enableSubcategories:!0,enableCustomTags:!0,requireCategoryAssignment:!0,autoGenerateReports:!1,reportRetentionDays:365,includeSensitiveData:!1,reportFormat:"PDF",aiEnabled:!1,computerVisionEnabled:!1,smartCategorizationEnabled:!1,predictiveAnalyticsEnabled:!1,aiConfidenceThreshold:.8,autoCategorizationEnabled:!1,smartFormFillingEnabled:!1,maintenancePredictionsEnabled:!1,demandForecastingEnabled:!1,openaiApiKey:"",googleVisionApiKey:"",dataSharingEnabled:!1,localAIProcessingEnabled:!1,aiDataRetentionDays:90});g.useEffect(()=>{Ce(null,null,function*(){try{const f=yield St.getCurrentFacilityId(),N=new or(f);n(N),m(N)}catch(f){console.error("Failed to initialize AI service:",f),i("Failed to initialize AI service")}})},[]);const m=j=>Ce(null,null,function*(){try{u(!0);let f=yield j.loadSettings();f||(yield j.initializeSettings(),f=yield j.loadSettings()),s(f)}catch(f){console.error("Error loading AI settings:",f),i("Error loading AI settings")}finally{u(!1)}}),x=(j,f)=>{a&&s(ft(He({},a),{[j]:f}))},p=()=>Ce(null,null,function*(){if(!(!c||!a))try{u(!0),(yield c.saveSettings(a))?(i("AI settings saved successfully"),setTimeout(()=>i(""),3e3)):i("Error saving AI settings")}catch(j){console.error("Error saving AI settings:",j),i("Error saving AI settings")}finally{u(!1)}}),h=()=>Ce(null,null,function*(){if(c)try{u(!0),yield c.initializeSettings(),yield m(c),i("AI settings reset to defaults"),setTimeout(()=>i(""),3e3)}catch(j){console.error("Error resetting AI settings:",j),i("Error resetting AI settings")}finally{u(!1)}}),C=g.useCallback(()=>Ce(null,null,function*(){if(t!=null&&t.id){u(!0);try{const j=localStorage.getItem("cliniio_ai_settings");if(j){const f=JSON.parse(j);l(N=>ft(He(He({},N),f),{openaiApiKey:f.openaiApiKey?"••••••••"+f.openaiApiKey.slice(-4):"",googleVisionApiKey:f.googleVisionApiKey?"••••••••"+f.googleVisionApiKey.slice(-4):""}))}}catch(j){console.error("Failed to load inventory settings:",j)}finally{u(!1)}}}),[t==null?void 0:t.id]);return g.useEffect(()=>{C()},[C]),{settings:o,setSettings:l,aiSettings:a,aiMessage:r,isLoading:d,handleInputChange:(j,f)=>{l(N=>ft(He({},N),{[j]:f}))},handleAISettingChange:x,handleAISettingsSave:p,handleAISettingsReset:h,saveSettings:()=>Ce(null,null,function*(){if(t!=null&&t.id)try{const j={aiEnabled:o.aiEnabled,computerVisionEnabled:o.computerVisionEnabled,smartCategorizationEnabled:o.smartCategorizationEnabled,predictiveAnalyticsEnabled:o.predictiveAnalyticsEnabled,aiConfidenceThreshold:o.aiConfidenceThreshold,autoCategorizationEnabled:o.autoCategorizationEnabled,smartFormFillingEnabled:o.smartFormFillingEnabled,maintenancePredictionsEnabled:o.maintenancePredictionsEnabled,demandForecastingEnabled:o.demandForecastingEnabled,dataSharingEnabled:o.dataSharingEnabled,localAIProcessingEnabled:o.localAIProcessingEnabled,aiDataRetentionDays:o.aiDataRetentionDays};localStorage.setItem("cliniio_ai_settings",JSON.stringify(j))}catch(j){console.error("Failed to save inventory settings:",j)}}),loadSettings:C}};var Hc=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const qc=()=>{const[t,a]=g.useState("general"),[s,r]=g.useState(!1),[i,d]=g.useState(null),{settings:u,setSettings:c,isLoading:n,saveSettings:o,loadSettings:l}=Bc(),m=[{id:"general",label:"General Settings",icon:X},{id:"stock",label:"Stock Management",icon:Tt},{id:"categories",label:"Categories & Tags",icon:ye},{id:"locations",label:"Location Management",icon:Cr},{id:"reporting",label:"Reporting & Analytics",icon:Et},{id:"ai",label:"AI & Machine Learning",icon:we}],x=()=>Hc(null,null,function*(){try{r(!0),d(null),yield o(),d({type:"success",text:"Settings saved successfully"}),setTimeout(()=>d(null),3e3)}catch(h){console.error(h),d({type:"error",text:"Failed to save settings"})}finally{r(!1)}}),p=()=>{switch(t){case"general":return e.jsx(uc,{settings:u,onSettingsChange:c});case"stock":return e.jsx(yc,{settings:u,onSettingsChange:c});case"categories":return e.jsx(Ec,{settings:u,onSettingsChange:c});case"locations":return e.jsx($c,{});case"reporting":return e.jsx(kc,{settings:u,onSettingsChange:c});case"ai":return e.jsx(Lc,{});default:return null}};return n?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading inventory settings..."})]}):e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Inventory Management Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure inventory behavior, AI features, and system preferences"}),i&&e.jsx("div",{className:`p-4 rounded-lg border mb-6 ${i.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{path:i.type==="success"?be:z,size:1,className:"text-current"}),i.text]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:m.map(h=>e.jsxs("button",{onClick:()=>a(h.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${t===h.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(S,{path:h.icon,size:1}),e.jsx("span",{children:h.label})]},h.id))})})}),e.jsx("div",{className:"tab-content-area",children:p()}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsxs("button",{onClick:l,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",children:[e.jsx(S,{path:yt,size:1,className:"inline mr-2"}),"Reset"]}),e.jsxs("button",{onClick:x,disabled:s,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(S,{path:ke,size:1,className:"inline mr-2"}),s?"Saving...":"Save Settings"]})]})]})};var ua=(t,a,s)=>new Promise((r,i)=>{var d=n=>{try{c(s.next(n))}catch(o){i(o)}},u=n=>{try{c(s.throw(n))}catch(o){i(o)}},c=n=>n.done?r(n.value):Promise.resolve(n.value).then(d,u);c((s=s.apply(t,a)).next())});const bt=[{id:"profile",label:"Profile & Account",icon:fa,description:"Manage your admin account information and personal settings."},{id:"system",label:"System Administration",icon:X,description:"Manage users, roles, permissions, and system-wide settings."},{id:"content",label:"Content Management",icon:_r,description:"Create, edit, and manage Knowledge Hub and Library content."},{id:"learning",label:"Learning & Training",icon:Sr,description:"Configure training modules, certifications, and learning paths."},{id:"cleaning",label:"Environmental Cleaning",icon:wr,description:"Manage room cleaning schedules, protocols, and status."},{id:"inventory",label:"Inventory Management",icon:Tt,description:"Oversee inventory, categories, stock levels, and procurement."},{id:"sterilization",label:"Sterilization",icon:Er,description:"Monitor sterilization cycles, equipment, and compliance."},{id:"system-config",label:"Billing",icon:Tr,description:"Manage billing settings, payment methods, and subscription plans."},{id:"analytics",label:"AI and Analytics",icon:_e,description:"Configure AI features, view system analytics, and generate intelligent reports."}],ma={profile:{bg:"bg-blue-100",icon:"text-blue-700"},system:{bg:"bg-green-100",icon:"text-green-800"},content:{bg:"bg-purple-200",icon:"text-purple-900"},learning:{bg:"bg-yellow-200",icon:"text-yellow-900"},cleaning:{bg:"bg-teal-100",icon:"text-teal-700"},inventory:{bg:"bg-blue-100",icon:"text-blue-700"},sterilization:{bg:"bg-purple-200",icon:"text-purple-900"},"system-config":{bg:"bg-green-100",icon:"text-green-800"},analytics:{bg:"bg-yellow-200",icon:"text-yellow-900"}},Vc=()=>{const[t]=ha(),a=ga(),[s,r]=g.useState(null),[i,d]=g.useState(0),[u,c]=g.useState(null),{currentUser:n}=te(),o=Sa();g.useEffect(()=>{},[a.state]),g.useEffect(()=>{const x=t.get("section");t.get("subtab");const p=t.get("review");x&&bt.some(h=>h.id===x)&&setTimeout(()=>r(x),0),p&&x==="content"&&sessionStorage.setItem("reviewContentId",p)},[t]),g.useEffect(()=>{function x(){return ua(this,null,function*(){try{const{count:h,error:C}=yield O.from("audit_flags").select("*",{count:"exact",head:!0}).eq("resolved",!1);!C&&typeof h=="number"&&d(h)}catch(h){console.error("Failed to fetch compliance flags:",h)}})}x();const p=()=>{setTimeout(()=>{x()},300)};return window.addEventListener("complianceIssueResolved",p),()=>{window.removeEventListener("complianceIssueResolved",p)}},[]),g.useEffect(()=>{ua(null,null,function*(){if(n!=null&&n.facility_id)try{const p=yield cr.getFacilitySettings(n.facility_id);p&&c(p)}catch(p){console.error("Error loading facility settings:",p)}})},[n==null?void 0:n.facility_id]);const l=x=>{try{r(p=>p===x?null:x)}catch(p){console.error("Error opening settings card:",p)}},m=()=>{const x=[];for(let p=0;p<bt.length;p++){const h=bt[p];x.push(e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>l(h.id),className:`rounded-xl shadow p-6 border text-left transition-all duration-200 hover:shadow-md hover:scale-105 focus:outline-none w-full min-h-[180px] flex flex-col justify-between ${s===h.id?"ring-2 ring-[#4ECDC4]":""} ${h.id==="system"&&i>0||h.id==="analytics"&&o.hasIssues?"border-red-500 bg-red-100 shadow-red-200 shadow-lg":"bg-white border-gray-100"}`,type:"button",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`${ma[h.id].bg} rounded-md p-2 mr-3`,children:e.jsx(S,{path:h.icon,size:1,className:ma[h.id].icon})}),e.jsx("h3",{className:`text-base font-medium ${h.id==="system"&&i>0||h.id==="analytics"&&o.hasIssues?"text-red-800":"text-gray-700"}`,children:h.label})]}),h.id==="system"&&i>0&&e.jsx("div",{className:"bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold",children:"!"}),h.id==="analytics"&&o.hasIssues&&e.jsx("div",{className:"bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold",children:"!"})]}),e.jsx("p",{className:`text-sm mt-auto ${h.id==="system"&&i>0||h.id==="analytics"&&o.hasIssues?"text-red-600 font-medium":"text-gray-500"}`,children:h.id==="system"&&i>0?"⚠️ Compliance issues require attention":h.id==="analytics"&&o.hasIssues?`⚠️ AI usage ${o.isExceeded?"exceeded":"approaching"} limit (${Math.round(o.usagePercentage)}%)`:h.description})]})},h.id)),s===h.id&&x.push(e.jsxs("div",{className:"col-span-full bg-white border border-gray-200 rounded-xl shadow-lg p-6 animate-fade-in my-2",style:{gridColumn:"1 / -1"},children:[h.id==="profile"&&e.jsx(ae,{children:e.jsx(Nn,{})}),h.id==="system"&&e.jsx(ae,{children:e.jsx(Qn,{initialTab:t.get("tab"),complianceFlagCount:i})}),h.id==="system-config"&&e.jsx(ae,{children:e.jsx(Xn,{})}),h.id==="content"&&e.jsx(ae,{children:e.jsx(Rl,{})}),h.id==="learning"&&e.jsx(ae,{children:e.jsx(_o,{})}),h.id==="cleaning"&&e.jsx(ae,{children:e.jsx(ac,{})}),h.id==="inventory"&&e.jsx(ae,{children:e.jsx(qc,{})}),h.id==="sterilization"&&e.jsx(ae,{children:e.jsx(qi,{})}),h.id==="analytics"&&e.jsx(ae,{children:e.jsx(_i,{})})]},h.id+"-drawer"))}return x};return e.jsx(Wa,{hasComplianceIssues:i>0,hasAIUsageIssues:o.hasIssues,children:e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsxs("div",{className:"p-4 max-w-7xl w-full mx-auto flex-1 flex flex-col",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-[#5b5b5b] mb-1",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Configure system-wide settings, manage users, and control application features"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex-1",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:m()})})]})})})},Qc=Object.freeze(Object.defineProperty({__proto__:null,default:Vc},Symbol.toStringTag,{value:"Module"}));export{yl as a,Aa as b,Qc as i,dl as u};
