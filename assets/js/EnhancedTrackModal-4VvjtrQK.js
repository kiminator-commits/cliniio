import{j as t}from"./utils-5cl0BHpv.js";import{a as d}from"./vendor-DVtBqAv5.js";import{J as Q,I as o}from"./main-RuFFPtZZ.js";import{b as B,T as N,aB as M,j as Y,n as w,N as _,m as D}from"./errors-89nfNYWX.js";import{u as F}from"./useTrackedTools-arC1dG-d.js";import"./login-CScPvZaJ.js";import"./data-Djiu4445.js";import"./ui-C2vLYFVP.js";const W=({isOpen:k,onClose:h,className:C=""})=>{const{getAllItems:T}=Q(),{trackedTools:i,trackTool:g,untrackTool:b,getPriorityQueue:S}=F(),[c,I]=d.useState(""),[p,z]=d.useState("all"),[n,L]=d.useState("medium"),[u,P]=d.useState(null),y=T().filter(e=>{var s,a;return((s=e.data)==null?void 0:s.toolId)||((a=e.data)==null?void 0:a.supplyId)}).filter(e=>{const s=(e.name||"").toLowerCase().includes(c.toLowerCase())||(e.category||"").toLowerCase().includes(c.toLowerCase())||e.data&&typeof e.data=="object"&&"barcode"in e.data&&typeof e.data.barcode=="string"&&e.data.barcode||"".toLowerCase().includes(c.toLowerCase()),a=i.some(r=>r.toolId===e.id),l=e.status==="available"||e.status==="complete"||e.status==="clean";switch(p){case"tracked":return s&&a;case"available":return s&&l;case"unavailable":return s&&!l;default:return s}}),x=e=>i.some(s=>s.toolId===e),$=e=>i.find(s=>s.toolId===e),f=e=>{x(e)?b(e):g(e,n)},A=(e,s)=>{x(e)&&(b(e),g(e,s))},E=e=>{const s=e.toLowerCase();return["available","complete","clean"].includes(s)?"bg-green-100 text-green-800":["dirty","in_cycle","bath1","bath2","airDry","autoclave"].includes(s)?"bg-yellow-100 text-yellow-800":["failed","problem","maintenance"].includes(s)?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"},m=e=>{switch(e){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},j=e=>{switch(e){case"high":return D;case"medium":return w;case"low":return _;default:return w}};return k?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-hidden ${C}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Track Tools & Supplies"}),t.jsx("button",{onClick:h,className:"text-gray-500 hover:text-gray-700 transition-colors","aria-label":"Close modal",children:t.jsx(o,{path:B,size:1.5})})]}),t.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-3",children:"Select Priority Level"}),t.jsx("div",{className:"flex gap-3",children:["high","medium","low"].map(e=>t.jsxs("button",{onClick:()=>L(e),className:`flex items-center gap-2 px-4 py-2 rounded-lg border-2 transition-colors ${n===e?`${m(e)} border-current`:"border-gray-300 text-gray-600 hover:border-gray-400"}`,children:[t.jsx(o,{path:j(e),size:1}),t.jsx("span",{className:"capitalize font-medium",children:e})]},e))}),t.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[n==="high"&&"High priority: You will be notified immediately when the tool becomes available.",n==="medium"&&"Medium priority: You will be notified when the tool becomes available (default).",n==="low"&&"Low priority: You will be notified when the tool becomes available, but others may have higher priority."]})]}),t.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx("input",{type:"text",placeholder:"Search tools and supplies...",value:c,onChange:e=>I(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none"})}),t.jsx("div",{className:"flex gap-2",children:["all","tracked","available","unavailable"].map(e=>t.jsx("button",{onClick:()=>z(e),className:`px-4 py-2 rounded-lg border transition-colors capitalize ${p===e?"bg-blue-500 text-white border-blue-500":"border-gray-300 text-gray-600 hover:border-gray-400"}`,children:e},e))})]}),t.jsx("div",{className:"overflow-y-auto max-h-96",children:t.jsx("div",{className:"grid gap-4",children:y.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(o,{path:N,size:3,className:"mx-auto mb-2 text-gray-300"}),t.jsx("p",{children:"No items found matching your criteria"})]}):y.map(e=>{const s=x(e.id),a=$(e.id),l=S(e.id);return t.jsx("div",{className:`p-4 border rounded-lg transition-colors ${s?"border-blue-300 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h4",{className:"font-medium text-gray-800",children:e.name||""}),t.jsx("span",{className:"text-sm text-gray-500",children:e.category||""}),e.data&&typeof e.data=="object"&&"barcode"in e.data&&typeof e.data.barcode=="string"&&t.jsx("span",{className:"text-xs text-gray-400 font-mono",children:e.data.barcode})]}),t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${E(e.status||"")}`,children:e.status||""}),s&&a&&t.jsxs("span",{className:`px-2 py-1 text-xs rounded-full flex items-center gap-1 ${m(a.priority)}`,children:[t.jsx(o,{path:j(a.priority),size:.8}),a.priority]})]}),s&&l.length>1&&t.jsxs("div",{className:"mt-2",children:[t.jsxs("button",{onClick:()=>P(u===e.id?null:e.id),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[t.jsx(o,{path:u===e.id?M:N,size:.8}),"Show priority queue (",l.length," ","waiting)"]}),u===e.id&&t.jsxs("div",{className:"mt-2 p-2 bg-white rounded border text-xs",children:[t.jsx("div",{className:"font-medium mb-1",children:"Priority Queue:"}),l.map((r,v)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:v===0?"font-medium text-green-600":"text-gray-600",children:[v+1,". ",r.doctorName]}),t.jsx("span",{className:`px-1 py-0.5 rounded text-xs ${m(r.priority)}`,children:r.priority})]},`${r.doctorName}-${r.timestamp}`))]})]})]}),t.jsx("div",{className:"flex items-center gap-2 ml-4",children:s?t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("button",{onClick:()=>f(e.id),className:"px-3 py-1 text-sm bg-red-100 text-red-700 hover:bg-red-200 rounded transition-colors",children:"Untrack"}),a&&t.jsxs("select",{value:a.priority,onChange:r=>A(e.id,r.target.value),className:"px-2 py-1 text-xs border rounded focus:outline-none",children:[t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"low",children:"Low"})]})]}):t.jsxs("button",{onClick:()=>f(e.id),className:"px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded-lg transition-colors flex items-center gap-2",children:[t.jsx(o,{path:Y,size:1}),"Track"]})})]})},e.id)})})}),t.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200 flex justify-between items-center",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:[i.length," item",i.length!==1?"s":""," ","currently tracked"]}),t.jsx("button",{onClick:h,className:"px-4 py-2 bg-gray-500 text-white hover:bg-gray-600 rounded-lg transition-colors",children:"Close"})]})]})}):null};export{W as EnhancedTrackModal,W as default};
