import{a as o}from"./vendor-DVtBqAv5.js";import{u as q}from"./login-CgiYf71G.js";import{G as z,u as F,K as e}from"./main-Ccza29P3.js";const j=()=>{const{currentUser:i,getUserDisplayName:f}=q(),{trackedItems:U,trackingData:w,toggleTrackedItem:k}=z(),{availableTools:d}=F(),[m,x]=o.useState([]),[N,I]=o.useState([]),[b,A]=o.useState([]),[p,Q]=o.useState({totalTracked:0,highPriority:0,mediumPriority:0,lowPriority:0,pendingNotifications:0}),a=o.useCallback(()=>f()||(i==null?void 0:i.email)||"Unknown Doctor",[f,i]),T=o.useCallback(()=>{const t=a(),s=e.getTrackedToolsForDoctor(t);x(s)},[a]),l=o.useCallback(()=>{const t=a(),s=e.getPendingNotifications(t),n=e.getAllNotifications(t);I(s),A(n)},[a]),r=o.useCallback(()=>{const t=e.getTrackingStats();Q(t)},[]),C=o.useCallback((t,s="medium",n)=>{const c=i?a():"Test Doctor";e.trackTool(t,c,s,n),k(t,c),T(),r()},[i,a,k,T,r]),g=o.useCallback(t=>{const s=i?a():"Test Doctor";e.untrackTool(t,s),k(t,s),T(),r()},[i,a,k,T,r]),S=o.useCallback(t=>{e.acknowledgeNotification(t),l(),r()},[l,r]),h=o.useCallback(()=>{e.clearExpiredNotifications(),l(),r()},[l,r]),v=o.useCallback(t=>e.getPriorityQueue(t),[]),P=o.useCallback(t=>e.isToolTracked(t),[]),y=o.useCallback(t=>e.getToolTrackers(t),[]),E=o.useCallback(t=>e.subscribeToStatusChanges(t),[]);return o.useEffect(()=>e.subscribeToStatusChanges((s,n,c)=>{if(c==="available"||c==="complete"){const u=a();e.getToolTrackers(s).find(Y=>Y.doctorName===u)&&g(s)}l(),r()}),[l,r,a,g]),o.useEffect(()=>{const s=setInterval(()=>{d.forEach(n=>{const c=n.currentPhase||n.status||"";e.isToolTracked(n.id)&&e.monitorToolStatusChange(n.id,"",c)})},5e3);return()=>clearInterval(s)},[d]),o.useEffect(()=>{(()=>{const s=a();e.getPendingNotifications(s).forEach(c=>{const u=d.find(D=>D.id===c.toolId);u&&c.toolName!==u.name&&(c.toolName=u.name,c.message=`Your tracked tool "${u.name}" is now available! You have first priority to claim it.`)})})()},[d,a]),!U||!w||!d?(console.warn("useTrackedTools: Missing required store data"),{trackedTools:m,pendingNotifications:N,allNotifications:b,trackingStats:p,trackTool:C,untrackTool:g,acknowledgeNotification:S,clearExpiredNotifications:h,getPriorityQueue:v,isToolTracked:P,getToolTrackers:y,subscribeToStatusChanges:E}):{trackedTools:m,pendingNotifications:N,allNotifications:b,trackingStats:p,trackTool:C,untrackTool:g,acknowledgeNotification:S,clearExpiredNotifications:h,getPriorityQueue:v,isToolTracked:P,getToolTrackers:y,subscribeToStatusChanges:E}};export{j as u};
