import{j as e,I as b,r as u,a8 as _e,B as Ie,c as $e,b as Ae,R as Me,Q as re}from"./react-vendor-CAfHStow.js";import{v as Oe,al as ve,am as Te,an as je,ao as Le,ap as ze,S as Fe}from"./components-CrSzLpHe.js";import{c as Ue,aV as Be,l as K,aW as Qe,a9 as Ce,X as qe,aN as H,A as ne,S as Ke,r as Ve,aX as He,f as We,ab as Ge,ac as Xe,ad as Ye,ae as Je,q as Ze,i as V,b as et,ah as tt,a2 as st,a3 as le,aY as at}from"./ui-vendor-mgcSnJSc.js";import{at as C,au as rt,av as nt}from"./services-Bq-O5kvJ.js";import{g as lt,a as ot,b as it,c as Se}from"./statusMappingUtils-BdgEHvqE.js";import"./data-vendor-B3X5ReaK.js";import"./vendor-BtFhHG5P.js";import"./utils-vendor-CfclMkuN.js";import"./inventory-pages-aeTDMVHI.js";import"./knowledgehub-pages-i9cBLZCy.js";const ct=({error:s,resetErrorBoundary:a})=>{const r=(n=>n.message.includes("fetch")||n.message.includes("network")?{title:"Connection Error",description:"Unable to connect to the server. Please check your internet connection.",suggestion:"Try refreshing the page or check your network connection.",severity:"warning"}:n.message.includes("permission")||n.message.includes("unauthorized")?{title:"Access Denied",description:"You don't have permission to access this feature.",suggestion:"Contact your administrator if you believe this is an error.",severity:"error"}:n.message.includes("timeout")?{title:"Request Timeout",description:"The request took too long to complete.",suggestion:"Try again in a moment. If the problem persists, contact support.",severity:"warning"}:{title:"Unexpected Error",description:"Something went wrong while loading the Environmental Clean module.",suggestion:"Try refreshing the page. If the problem continues, contact support.",severity:"error"})(s);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsx("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full mb-4 ${r.severity==="error"?"bg-red-100":"bg-yellow-100"}`,children:e.jsx(b,{path:Ue,size:2,className:r.severity==="error"?"text-red-600":"text-yellow-600"})}),e.jsx("h2",{className:`text-xl font-semibold mb-2 ${r.severity==="error"?"text-red-600":"text-yellow-600"}`,children:r.title}),e.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:r.description}),e.jsxs("details",{className:"mb-4 text-left",children:[e.jsxs("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700 flex items-center justify-center",children:[e.jsx(b,{path:Be,size:.8,className:"mr-1"}),"Technical Details"]}),e.jsxs("div",{className:"mt-2 p-3 bg-gray-100 rounded text-xs font-mono text-gray-600 break-all",children:[s.message,s.stack&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Stack trace:"}),e.jsx("div",{className:"mt-1",children:s.stack})]})]})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["💡 ",r.suggestion]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsxs("button",{onClick:a,className:"flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[e.jsx(b,{path:K,size:.8,className:"mr-2"}),"Try Again"]}),e.jsxs("button",{onClick:()=>window.location.href="/",className:"flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:[e.jsx(b,{path:Qe,size:.8,className:"mr-2"}),"Go Home"]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Still having trouble? Contact support at"," ",e.jsx("a",{href:"mailto:support@cliniio.com",className:"text-blue-600 hover:underline",children:"support@cliniio.com"})]})})]})})})};var q=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});const Ne=()=>{const[s,a]=u.useState([]),[t,r]=u.useState([]),[n,c]=u.useState(null),[l,o]=u.useState(!1),[i,d]=u.useState(null),g=(f,v)=>{const w=rt(f,v);d(w.message),console.error(`❌ ${v} failed:`,w)},m=u.useCallback(()=>q(null,null,function*(){try{o(!0),d(null);const f=yield C.fetchRooms();a(f)}catch(f){g(f,"fetchRooms")}finally{o(!1)}}),[]),p=u.useCallback(()=>q(null,null,function*(){try{o(!0),d(null);const f=yield C.fetchChecklists();r(f)}catch(f){g(f,"fetchChecklists")}finally{o(!1)}}),[]),x=u.useCallback(()=>q(null,null,function*(){try{o(!0),d(null);const f=yield C.fetchAnalytics();c(f)}catch(f){g(f,"fetchAnalytics")}finally{o(!1)}}),[]),h=u.useCallback(()=>q(null,null,function*(){Promise.all([m(),p(),x()]).catch(f=>{console.error("Background data refresh failed:",f)})}),[m,p,x]);return u.useEffect(()=>{const f=setTimeout(()=>{h()},0);return()=>clearTimeout(f)},[h]),{rooms:s,checklists:t,analytics:n,loading:l,error:i,fetchRooms:m,fetchChecklists:p,fetchAnalytics:x,refreshData:h}};function dt(s=[]){const[a,t]=u.useState(""),[r,n]=u.useState("all"),[c,l]=u.useState(1),o=20,i=u.useMemo(()=>s.filter(h=>{const f=a===""||h.id.toLowerCase().includes(a.toLowerCase())||h.status.toLowerCase().includes(a.toLowerCase()),v=r==="all"||h.status===r;return f&&v}),[s,a,r]),d=Math.ceil(i.length/o),g=u.useMemo(()=>{const h=(c-1)*o;return i.slice(h,h+o)},[i,c]),m=u.useCallback(h=>{t(h),l(1)},[]),p=u.useCallback(h=>{n(h),l(1)},[]),x=u.useCallback(h=>{l(h)},[]);return{searchTerm:a,status:r,paginatedItems:g,onSearchChange:m,onStatusChange:p,currentPage:c,totalPages:d,onPageChange:x}}var mt=Object.defineProperty,ut=Object.defineProperties,ht=Object.getOwnPropertyDescriptors,oe=Object.getOwnPropertySymbols,pt=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable,ie=(s,a,t)=>a in s?mt(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,ce=(s,a)=>{for(var t in a||(a={}))pt.call(a,t)&&ie(s,t,a[t]);if(oe)for(var t of oe(a))xt.call(a,t)&&ie(s,t,a[t]);return s},de=(s,a)=>ut(s,ht(a)),gt=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});function ft(){return _e({mutationFn:s=>gt(null,null,function*(){try{const a=new Date().toISOString(),t=s.operator||"Unknown Operator",r=de(ce({},s),{timestamp:a,operator:t,module:"environmental_clean",category:"environmental_clean"}),n=[Promise.resolve().then(()=>{try{Oe.log("environmental_clean",s.action,de(ce({},s.item),{operator:t,roomId:s.roomId,status:s.status,metadata:s.metadata,timestamp:a}))}catch(l){console.warn("Audit logger failed:",l)}})];return Promise.allSettled(n).catch(()=>{}),{success:!0,auditId:`EC-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:a}}catch(a){return console.error("❌ Failed to log Environmental Clean audit:",a),console.warn("⚠️ Audit logging failed, using console fallback:",s),{success:!1,error:a instanceof Error?a.message:"Unknown audit error"}}}),retry:2,retryDelay:1e3,onMutate:()=>{},onError:s=>{console.error("❌ Environmental Clean audit failed:",s)},onSuccess:s=>{}})}const bt=({onScan:s})=>e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-[#5b5b5b] mb-1",children:"Environmental Clean"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Track and manage room cleaning workflows and maintain compliance standards."})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex items-center gap-4",style:{borderLeft:"4px solid rgba(78, 205, 196, 0.5)"},children:[e.jsx("span",{className:"text-gray-600",children:"Room Scanner"}),e.jsx(Ie,{variant:"success",onClick:s,className:"bg-[#4ECDC4] hover:bg-[#3db8b0] border-[#4ECDC4] hover:border-[#3db8b0] text-white font-medium py-2 px-4 rounded-md transition-colors duration-200",children:"Scan Room"})]})]}),R={borderLeftColor:"rgba(78, 205, 196, 0.5)",primaryIconColor:"#4ECDC4",defaultBorderColor:"border-gray-200"},we={error:{light:"#fee2e2"},info:{light:"#dbeafe"}},U=s=>a=>{a.key==="Enter"&&(a.preventDefault(),s())},ke=s=>a=>{a.key===" "&&(a.preventDefault(),s())},Re=(s,a,t=0)=>{const[r,n]=u.useState(t),c=u.useCallback(l=>{switch(l.key){case"ArrowDown":l.preventDefault(),n(o=>(o+1)%s.length);break;case"ArrowUp":l.preventDefault(),n(o=>(o-1+s.length)%s.length);break;case"Home":l.preventDefault(),n(0);break;case"End":l.preventDefault(),n(s.length-1);break;case"Enter":case" ":l.preventDefault(),a(s[r],r);break}},[s,r,a]);return{selectedIndex:r,setSelectedIndex:n,handleKeyDown:c}},yt=(s,a,t)=>{const r=u.useCallback(n=>{if(s)switch(n.key){case"Escape":a();break}},[s,a,t]);return u.useEffect(()=>(document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)),[r]),{handleKeyDown:r}},vt=(s,a)=>a?`${s} ${a}`:s,jt=s=>{if(!s||typeof s!="object")return!1;const a=s;return typeof a.id=="string"&&typeof a.name=="string"&&typeof a.status=="string"},Ct=s=>typeof s=="string";var St=Object.defineProperty,Nt=Object.defineProperties,wt=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,kt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable,ue=(s,a,t)=>a in s?St(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,he=(s,a)=>{for(var t in a||(a={}))kt.call(a,t)&&ue(s,t,a[t]);if(me)for(var t of me(a))Rt.call(a,t)&&ue(s,t,a[t]);return s},pe=(s,a)=>Nt(s,wt(a)),I=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});const Et=$e((s,a)=>({rooms:[],checklists:[],analytics:{totalRooms:0,cleanRooms:0,dirtyRooms:0,inProgressRooms:0,cleaningEfficiency:0,averageCleaningTime:0,lastUpdated:new Date().toISOString()},isLoading:!1,error:null,setRooms:t=>{const r=t.filter(n=>jt(n));r.length!==t.length&&console.warn("Some rooms were filtered out due to invalid data"),s({rooms:r})},setChecklists:t=>{s({checklists:t})},setAnalytics:t=>{s({analytics:t})},setLoading:t=>{s({isLoading:t})},setError:t=>{s({error:t})},fetchRooms:()=>I(null,null,function*(){const{setLoading:t,setError:r,setRooms:n}=a();try{t(!0),r(null);const c=yield C.fetchRooms();n(c),console.log("✅ Fetched rooms from service:",c.length)}catch(c){const l=c instanceof Error?c.message:"Failed to fetch rooms";r(l),console.error("❌ Failed to fetch rooms:",c)}finally{t(!1)}}),fetchChecklists:()=>I(null,null,function*(){const{setLoading:t,setError:r,setChecklists:n}=a();try{t(!0),r(null);const c=yield C.fetchChecklists();n(c),console.log("✅ Fetched checklists from service:",c.length)}catch(c){const l=c instanceof Error?c.message:"Failed to fetch checklists";r(l),console.error("❌ Failed to fetch checklists:",c)}finally{t(!1)}}),fetchAnalytics:()=>I(null,null,function*(){const{setLoading:t,setError:r,setAnalytics:n}=a();try{t(!0),r(null);const c=yield C.fetchAnalytics();n(c),console.log("✅ Fetched analytics from service")}catch(c){const l=c instanceof Error?c.message:"Failed to fetch analytics";r(l),console.error("❌ Failed to fetch analytics:",c)}finally{t(!1)}}),updateRoomStatus:(t,r)=>I(null,null,function*(){const{setError:n,rooms:c,setRooms:l}=a();try{if(!t)throw new Error("Room ID is required");if(!Ct(r))throw new Error("Invalid status type");yield C.updateRoomStatus(t,r);const o=c.map(i=>i.id===t?pe(he({},i),{status:r}):i);l(o),yield C.addAuditLog("status_update",t,"system"),console.log("✅ Updated room status:",t,r)}catch(o){const i=o instanceof Error?o.message:"Failed to update room status";throw n(i),console.error("❌ Failed to update room status:",o),o}}),completeRoomCleaning:t=>I(null,null,function*(){const{setError:r,rooms:n,setRooms:c}=a();try{if(!t)throw new Error("Room ID is required");yield C.completeRoomCleaning(t);const l=n.map(o=>o.id===t?pe(he({},o),{status:"clean"}):o);c(l),yield C.addAuditLog("complete_cleaning",t,"system"),console.log("✅ Completed room cleaning:",t)}catch(l){const o=l instanceof Error?l.message:"Failed to complete room cleaning";throw r(o),console.error("❌ Failed to complete room cleaning:",l),l}}),scanRoomBarcode:t=>I(null,null,function*(){try{if(!t||t.trim()==="")return{success:!1,message:"Please enter a valid barcode"};const r=yield C.scanRoomBarcode(t);if(r.success&&r.room){const{rooms:n,setRooms:c}=a();n.find(o=>o.id===r.room.id)||c([...n,r.room]),yield C.addAuditLog("room_scan",r.room.id,"system")}return r}catch(r){return console.error("❌ Error scanning barcode:",r),{success:!1,message:"An error occurred while scanning the barcode. Please try again."}}}),showStatusModal:!1,isScanModalOpen:!1,selectedIds:[],selectedRoom:null,selectedStatus:null,searchTerm:"",filterStatus:"",setShowStatusModal:t=>s({showStatusModal:t}),setSelectedRoom:t=>s({selectedRoom:t}),setSelectedStatus:t=>s({selectedStatus:t}),toggleSelectedId:t=>{const{selectedIds:r}=a(),n=r.includes(t)?r.filter(c=>c!==t):[...r,t];s({selectedIds:n})},clearSelectedIds:()=>s({selectedIds:[]}),setSearchTerm:t=>s({searchTerm:t}),setFilterStatus:t=>s({filterStatus:t}),openScanModal:()=>s({isScanModalOpen:!0}),closeScanModal:()=>s({isScanModalOpen:!1}),lastAuditTimestamp:null,setLastAudit:t=>s({lastAuditTimestamp:t}),addAuditLog:(t,r)=>I(null,null,function*(){const n=new Date().toISOString(),{setLastAudit:c}=a();c(n),console.log("🔍 [ENVIRONMENTAL CLEAN AUDIT]",{action:t,metadata:r,timestamp:n})})}));var Pt=Object.defineProperty,Dt=Object.defineProperties,_t=Object.getOwnPropertyDescriptors,xe=Object.getOwnPropertySymbols,It=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable,ge=(s,a,t)=>a in s?Pt(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,At=(s,a)=>{for(var t in a||(a={}))It.call(a,t)&&ge(s,t,a[t]);if(xe)for(var t of xe(a))$t.call(a,t)&&ge(s,t,a[t]);return s},Mt=(s,a)=>Dt(s,_t(a)),Ot=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});const Ee=u.createContext(void 0);function Pe(){const s=u.useContext(Ee);if(!s)throw new Error("useRoomStatus must be used within a RoomStatusProvider");return s}const Tt=({children:s})=>{const{rooms:a}=Et(),[t,r]=u.useState([]),[n,c]=u.useState([]);u.useEffect(()=>{const m=a.map(x=>({id:x.id,status:x.status,name:x.name,metadata:x.metadata})),p=setTimeout(()=>{r(m)},0);return()=>clearTimeout(p)},[a]),u.useEffect(()=>{Ot(null,null,function*(){try{const p=yield C.fetchRecentlyCleanedRooms(10);c(p)}catch(p){console.error("Failed to fetch recently cleaned rooms:",p)}})},[]);const l=u.useCallback((m,p)=>{if(r(x=>x.map(h=>h.id===m?Mt(At({},h),{status:p}):h)),p==="Clean"){const x=a.find(v=>v.id===m),f={room:x?x.name:`Room ${m}`,cleanedAt:new Date().toISOString(),cleanedBy:"Current User"};c(v=>[f,...v.slice(0,9)])}},[a]),o=u.useCallback(()=>t.filter(m=>m.status==="Clean").length,[t]),i=u.useCallback(()=>t.filter(m=>m.status==="Dirty").length,[t]),d=u.useCallback(()=>{const m=t.length,p=o();return m>0?Math.round(p/m*100):0},[t,o]),g={rooms:t,recentlyCleanedRooms:n,updateRoomStatus:l,getCleanRoomsCount:o,getDirtyRoomsCount:i,getEfficiency:d};return e.jsx(Ee.Provider,{value:g,children:s})},Lt=()=>{const{getCoreStatusTypes:s,getPublishedStatusTypes:a,statusTypes:t,isLoading:r}=ve(),n=Se();return u.useMemo(()=>{const c=s(),l=a(),o=m=>m.map(p=>{const x=n.iconMap[p.icon]||n.iconMap.default;return{value:p.id,name:p.name,bgColor:n.bgColorMap[p.color]||n.bgColorMap.default,bgColorSelected:n.bgColorSelectedMap[p.color]||n.bgColorSelectedMap.default,borderColor:n.borderColorMap[p.color]||n.borderColorMap.default,color:n.colorMap[p.color]||n.colorMap.default,icon:x,isCore:p.isCore||!1}}),i=o(c),d=o(l),g=[...i];return d.forEach(m=>{g.find(p=>p.value===m.value)||g.push(m)}),g},[s,a,n.bgColorMap,n.bgColorSelectedMap,n.borderColorMap,n.colorMap,n.iconMap])},zt=()=>{const{getCoreStatusTypes:s,getPublishedStatusTypes:a}=ve(),t=Se();return u.useMemo(()=>{const r=s(),n=a();return[...r,...n.filter(l=>!l.isCore)].map(l=>({status:l.name,icon:it(l.icon,t.iconMap),color:l.color,bgColor:ot(l.color,t.bgColorMap),textColor:lt(l.color,t.textColorMap),isCore:l.isCore}))},[s,a,t.bgColorMap,t.iconMap,t.textColorMap])},Ft=(s,a)=>s.filter(t=>t.status===a).length,Ut=(s,a)=>{var t,r;if(s.name)return{name:s.name,department:((t=s.metadata)==null?void 0:t.department)||"",floor:((r=s.metadata)==null?void 0:r.floor)||""};const n=a.find(c=>(c.barcode||c.id)===s.id);return{name:n?n.name:`Room ${s.id}`,department:n&&n.department||"",floor:n&&n.floor||""}},Bt=({isOpen:s,onClose:a,onUpdate:t,currentStatus:r})=>{const[n,c]=u.useState([]);yt(s,a);const l=Lt(),{selectedIndex:o,handleKeyDown:i}=Re(l,m=>{const p=m.value;c(x=>x.includes(p)?x.filter(h=>h!==p):[...x,p])},0),d=m=>{c(p=>p.includes(m)?p.filter(x=>x!==m):[...p,m])},g=()=>{t(n),a()};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",role:"dialog","aria-modal":"true","aria-labelledby":"status-modal-title","aria-describedby":"status-modal-description",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",role:"document",children:[e.jsx("h3",{id:"status-modal-title",className:"text-lg font-semibold mb-4",children:"Update Room Status"}),e.jsx("div",{id:"status-modal-description",className:"sr-only",children:"Select room statuses using arrow keys to navigate and Enter or Space to select. Use Tab to move between options."}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",role:"grid","aria-label":"Status options",onKeyDown:i,tabIndex:0,children:l.map((m,p)=>e.jsx("button",{className:`p-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] ${n.includes(m.value)?`${m.bgColor} ${m.borderColor}`:r===m.value?`${m.borderColor} ${m.bgColorSelected}`:R.defaultBorderColor} ${o===p?"ring-2 ring-[#4ECDC4]":""}`,onClick:()=>d(m.value),onKeyDown:x=>{U(()=>d(m.value))(x),ke(()=>d(m.value))(x)},role:"gridcell","aria-selected":n.includes(m.value),tabIndex:o===p?0:-1,"aria-label":vt("Select status",m.name),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{path:m.icon,size:.8,color:m.color,"aria-hidden":"true"}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 min-w-0",children:[e.jsx("span",{className:"truncate",children:m.name}),m.isCore&&e.jsx(b,{path:Ce,size:.5,className:"text-gray-200 flex-shrink-0 ml-1",title:"Core status - always available"})]})]})},m.value))}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:a,onKeyDown:U(a),className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500 rounded","aria-label":"Cancel status update",children:"Cancel"}),e.jsx("button",{onClick:g,onKeyDown:U(g),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2","aria-label":"Update room status",children:"Update"})]})]})}):null},Qt=({status:s,icon:a,color:t,bgColor:r,textColor:n,isCore:c,roomCount:l,onClick:o,isSelected:i})=>e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-gray-200 shadow-sm transition-all duration-200 hover:shadow-md hover:-translate-y-0.5 cursor-pointer focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] min-h-[80px] min-w-[80px] relative group",onClick:o,role:"gridcell",tabIndex:i?0:-1,"aria-label":`${s} rooms: ${l} rooms`,title:s,onKeyDown:d=>{U(o)(d),ke(o)(d)},children:[e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-white text-gray-800 text-xs rounded border border-gray-300 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[s,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-300"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[e.jsx("div",{className:`${r} rounded-full p-2 mb-2`,children:e.jsx(b,{path:a,size:1,color:t,"aria-hidden":"true"})}),e.jsx("div",{className:`text-2xl font-bold ${n}`,children:l})]}),c&&e.jsx("div",{className:"absolute top-1 right-1",children:e.jsx(b,{path:Ce,size:.6,className:"text-gray-300",title:"Core status - always available"})})]}),qt=({status:s,rooms:a,onUpdateStatus:t})=>{const{getActiveRooms:r}=Te(),n=r(),c=a.filter(l=>l.status===s);return e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",role:"region","aria-label":`${s} rooms details`,children:[e.jsxs("h3",{className:"text-lg font-medium mb-3",children:[s," Rooms"]}),e.jsxs("div",{className:"space-y-2",children:[c.map(l=>{const{name:o,department:i,floor:d}=Ut(l,n);return e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:o}),(i||d)&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[i&&e.jsx("span",{children:i}),i&&d&&e.jsx("span",{children:" • "}),d&&e.jsx("span",{children:d})]})]}),e.jsx("button",{onClick:()=>t(l.id),onKeyDown:U(()=>t(l.id)),className:"text-xs text-blue-600 hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded ml-2","aria-label":`Update status for ${o}`,children:"Update Status"})]},l.id)}),c.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No rooms with this status"})]})]})},Kt=()=>{const{rooms:s,updateRoomStatus:a}=Pe(),[t,r]=u.useState(null),[n,c]=u.useState(null),[l,o]=u.useState(!1),i=zt(),d=h=>{r(t===h?null:h)},{selectedIndex:g,handleKeyDown:m}=Re(i,h=>d(h.status),0),p=(h,f)=>{if(f.length>0){const v=f[0];a(h,v)}},x=h=>{c(h),o(!0)};return e.jsxs("div",{id:"room-status-summary",className:"bg-white rounded-lg shadow p-6 mb-6 relative",style:{borderLeft:`4px solid ${R.borderLeftColor}`},role:"region","aria-label":"Room status summary",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 text-[#5b5b5b] flex items-center",children:[e.jsx(b,{path:qe,size:1.1,color:R.primaryIconColor,className:"mr-2"}),"Room Status Summary"]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",role:"grid","aria-label":"Status summary cards",onKeyDown:m,tabIndex:0,children:i.map((h,f)=>e.jsx(Qt,{status:h.status,icon:h.icon,color:h.color,bgColor:h.bgColor,textColor:h.textColor,isCore:h.isCore,roomCount:Ft(s,h.status),onClick:()=>d(h.status),isSelected:g===f,index:f},h.status))}),t&&e.jsx(qt,{status:t,rooms:s,onUpdateStatus:x}),e.jsx(Bt,{isOpen:l,onClose:()=>o(!1),onUpdate:h=>{n&&p(n,h)},currentStatus:t||"Available"})]})},Vt=()=>e.jsx("div",{className:"flex-1",children:e.jsx(Kt,{})});var fe=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});function Ht(){const[s,a]=u.useState({totalRooms:0,cleanRooms:0,dirtyRooms:0,inProgressRooms:0,cleaningEfficiency:0,averageCleaningTime:0,lastUpdated:new Date().toISOString()}),[t,r]=u.useState(!0),[n,c]=u.useState(null),l=u.useCallback(()=>fe(null,null,function*(){try{r(!0),c(null);const i=yield C.fetchAnalytics();a(i)}catch(i){c("Failed to load analytics"),console.error("Error fetching analytics:",i)}finally{r(!1)}}),[]),o=u.useCallback(()=>fe(null,null,function*(){yield l()}),[l]);return u.useEffect(()=>{l()},[l]),{analytics:s,isLoading:t,error:n,refreshAnalytics:o}}const Wt=()=>{const{analytics:s,isLoading:a,error:t,refreshAnalytics:r}=Ht();return a?e.jsxs("div",{id:"cleaning-analytics",className:"bg-white p-3 md:p-4 rounded-xl shadow-lg mb-6",style:{borderLeft:`4px solid ${R.borderLeftColor}`},role:"region","aria-label":"Cleaning analytics summary",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-[#5b5b5b] flex items-center",children:[e.jsx(b,{path:H,size:1.1,color:R.primaryIconColor,className:"mr-2"}),"Cleaning Analytics"]}),e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg text-center",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"})}),e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg text-center",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"})}),e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg text-center",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded animate-pulse"})})]})]}):t?e.jsxs("div",{id:"cleaning-analytics",className:"bg-white p-3 md:p-4 rounded-xl shadow-lg mb-6",style:{borderLeft:`4px solid ${R.borderLeftColor}`},role:"region","aria-label":"Cleaning analytics summary",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-[#5b5b5b] flex items-center",children:[e.jsx(b,{path:H,size:1.1,color:R.primaryIconColor,className:"mr-2"}),"Cleaning Analytics"]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"Refresh analytics",children:e.jsx(b,{path:K,size:.8,className:"text-gray-600"})})]}),e.jsx("div",{className:"text-red-600 text-sm text-center py-4",children:t})]}):e.jsxs("div",{id:"cleaning-analytics",className:"bg-white p-3 md:p-4 rounded-xl shadow-lg mb-6",style:{borderLeft:`4px solid ${R.borderLeftColor}`},role:"region","aria-label":"Cleaning analytics summary",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-lg font-semibold text-[#5b5b5b] flex items-center",children:[e.jsx(b,{path:H,size:1.1,color:R.primaryIconColor,className:"mr-2"}),"Cleaning Analytics"]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-gray-100 rounded transition-colors",title:"Refresh analytics",children:e.jsx(b,{path:K,size:.8,className:"text-gray-600"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",role:"group","aria-label":"Analytics metrics",children:[e.jsxs("div",{className:"p-2 bg-green-100 rounded-lg text-center",role:"status","aria-label":`Clean rooms: ${s.cleanRooms}`,children:[e.jsx("h3",{className:"text-sm text-green-700 font-medium mb-1",children:"Clean Rooms"}),e.jsx("p",{className:"text-xl font-bold text-green-700",children:s.cleanRooms})]}),e.jsxs("div",{className:"p-2 bg-orange-100 rounded-lg text-center",role:"status","aria-label":`Dirty rooms: ${s.dirtyRooms}`,children:[e.jsx("h3",{className:"text-sm text-orange-700 font-medium mb-1",children:"Dirty Rooms"}),e.jsx("p",{className:"text-xl font-bold text-orange-700",children:s.dirtyRooms})]}),e.jsxs("div",{className:"p-2 bg-purple-100 rounded-lg text-center",role:"status","aria-label":`Efficiency: ${s.cleaningEfficiency}%`,children:[e.jsx("h3",{className:"text-sm text-purple-700 font-medium mb-1",children:"Efficiency"}),e.jsxs("p",{className:"text-xl font-bold text-purple-700",children:[s.cleaningEfficiency,"%"]})]})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["Last updated: ",new Date(s.lastUpdated).toLocaleTimeString()]})]})};var Gt=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});const Xt=()=>{const{recentlyCleanedRooms:s}=Pe(),{refreshData:a}=Ne(),t=u.useRef(null),r=!1,n=()=>{t.current&&(t.current.scrollTop=0)},c=()=>Gt(null,null,function*(){try{yield a()}catch(l){console.error("Error refreshing cleaned rooms:",l)}});return e.jsxs("div",{className:"bg-white p-3 md:p-4 rounded-xl shadow-lg mb-6 relative",style:{borderLeft:"4px solid rgba(78, 205, 196, 0.5)"},children:[e.jsxs("div",{className:"sticky top-0 bg-white pb-1 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-1 text-[#5b5b5b] flex items-center",children:[e.jsx(b,{path:ne,size:1.1,color:"#4ECDC4",className:"mr-2"}),"Recently Cleaned Rooms"]}),e.jsx("button",{onClick:c,className:"p-1 text-gray-500 hover:text-[#4ECDC4] transition-colors",title:"Refresh data",disabled:r,children:e.jsx(b,{path:K,size:.8,className:""})})]}),e.jsx("div",{className:"overflow-y-auto [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",style:{maxHeight:"120px"},ref:t,children:s.length===0?e.jsx("p",{className:"text-gray-500 text-sm py-1",children:"No rooms cleaned recently"}):e.jsx("div",{className:"space-y-1",children:s.map((l,o)=>e.jsx("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg relative",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"relative",children:e.jsxs("span",{className:"font-medium text-gray-700 cursor-help hover:text-brand-primary transition-colors group",children:[l.room,e.jsxs("div",{className:"hidden group-hover:block absolute left-0 top-full mt-1 bg-white rounded-lg shadow-xl border border-gray-200 p-3 w-64 z-50",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(b,{path:Ke,size:.8,color:"#4ECDC4"}),e.jsx("span",{className:"font-medium text-gray-800",children:l.cleanedBy})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{path:ne,size:.8,color:"#4ECDC4"}),e.jsx("span",{className:"text-sm text-gray-600",children:new Date(l.cleanedAt).toLocaleString()})]})]})]})}),e.jsx(b,{path:Ve,size:.8,color:"#4ECDC4"})]})},o))})}),e.jsx("button",{onClick:n,className:"absolute bottom-2 right-2 p-1.5 bg-brand-primary text-white rounded-full shadow-md hover:bg-brand-primary transition-colors",title:"Scroll to most recent",children:e.jsx(b,{path:He,size:.8,className:"opacity-70"})})]})},Yt=()=>e.jsxs("div",{className:"flex-1",children:[e.jsx(Wt,{}),e.jsx("div",{className:"mt-4",children:e.jsx(Xt,{})})]});var Jt=Object.defineProperty,Zt=Object.defineProperties,es=Object.getOwnPropertyDescriptors,be=Object.getOwnPropertySymbols,ts=Object.prototype.hasOwnProperty,ss=Object.prototype.propertyIsEnumerable,ye=(s,a,t)=>a in s?Jt(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,W=(s,a)=>{for(var t in a||(a={}))ts.call(a,t)&&ye(s,t,a[t]);if(be)for(var t of be(a))ss.call(a,t)&&ye(s,t,a[t]);return s},G=(s,a)=>Zt(s,es(a));const as=()=>{const[s,a]=u.useState(null),[t,r]=u.useState(null),[n,c]=u.useState("checklists"),[l,o]=u.useState(""),[i,d]=u.useState(null),[g,m]=u.useState("all"),[p,x]=u.useState(new Set),[h,f]=u.useState({}),[v,w]=u.useState(!1),[T,$]=u.useState(""),[E,D]=u.useState([]),[_,P]=u.useState([]),A=j=>{a(j),r(null),w(!0)},L=j=>{r(j)},M=()=>{a(null),r(null),w(!1)};return{selectedCategory:s,selectedChecklist:t,activeTab:n,searchQuery:l,selectedSDS:i,sdsCategory:g,bypassedItems:p,adjustedQuantities:h,showModal:v,notes:T,stolenItems:E,prnItems:_,setSelectedCategory:a,setSelectedChecklist:r,setActiveTab:c,setSearchQuery:o,setSelectedSDS:d,setSdsCategory:m,setShowModal:w,setNotes:$,handleCategoryClick:A,handleChecklistSelect:L,handleCloseModal:M,handleMarkComplete:()=>{M()},handleBypassItem:j=>{x(k=>{const y=new Set(k);return y.has(j)?y.delete(j):y.add(j),y})},handleAdjustQuantity:(j,k,y)=>{f(S=>G(W({},S),{[`${j}-${k}`]:(S[`${j}-${k}`]||0)+y}))},handleAddStolenItem:()=>{D([...E,{item:"",quantity:1,notes:""}])},handleAddPrnItem:()=>{P([..._,{item:"",quantity:1,reason:""}])},handleUpdateStolenItem:(j,k,y)=>{const S=[...E];S[j]=G(W({},S[j]),{[k]:y}),D(S)},handleUpdatePrnItem:(j,k,y)=>{const S=[..._];S[j]=G(W({},S[j]),{[k]:y}),P(S)},clearStolenItems:()=>{D([])},clearPrnItems:()=>{P([])},clearNotes:()=>{$("")}}},rs=()=>{const[s,a]=u.useState(!1),[t,r]=u.useState(""),n=u.useRef(null),c=()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){alert("Speech recognition is not supported in this browser. Please use Chrome or Edge.");return}const i=window.SpeechRecognition||window.webkitSpeechRecognition,d=new i;d.continuous=!0,d.interimResults=!0,d.lang="en-US",d.addEventListener("start",()=>{a(!0),r("")}),d.onresult=g=>{let m="",p="";for(let x=g.resultIndex;x<g.results.length;x++){const h=g.results[x][0].transcript;g.results[x].isFinal?m+=h:p+=h}r(m+p)},d.onerror=g=>{console.error("Speech recognition error:",g.error),a(!1),g.error==="no-speech"&&alert("No speech detected. Please try again.")},d.onend=()=>{a(!1)},n.current=d,d.start()},l=()=>{n.current&&(n.current.stop(),n.current=null),a(!1)},o=i=>{t.trim()&&(i(t),r(""))};return u.useEffect(()=>()=>{n.current&&n.current.stop()},[]),{isListening:s,transcript:t,startSpeechRecognition:c,stopSpeechRecognition:l,applyTranscriptToNotes:o}},ns=[{id:"setup",title:"Setup/Take Down",iconColor:"#FF6B6B",icon:We},{id:"patient",title:"Per Patient",iconColor:"#4ECDC4",icon:Ge},{id:"weekly",title:"Weekly",iconColor:"#45B7D1",icon:Xe},{id:"public",title:"Public Spaces",iconColor:"#96CEB4",icon:Ye},{id:"deep",title:"Deep Clean",iconColor:"#FF9F1C",icon:Je}],ls=[{id:"1",name:"Bleach SDS",category:"Cleaning",lastUpdated:"2024-03-20",url:"/sds/bleach.pdf",sections:[]},{id:"2",name:"Disinfectant SDS",category:"Cleaning",lastUpdated:"2024-03-19",url:"/sds/disinfectant.pdf",sections:[]},{id:"3",name:"Hand Sanitizer SDS",category:"Sanitization",lastUpdated:"2024-03-18",url:"/sds/hand-sanitizer.pdf",sections:[]}],os=({activeTab:s,onTabChange:a})=>e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("button",{className:`pb-2 px-1 font-medium flex items-center ${s==="checklists"?"text-[#5b5b5b] border-b-2 border-[#4ECDC4]":"text-gray-500 hover:text-gray-700"}`,onClick:()=>a("checklists"),type:"button",children:[e.jsx(b,{path:Ze,size:1.1,color:"#4ECDC4",className:"mr-2"}),"Cleaning Checklists"]}),e.jsxs("button",{className:`pb-2 px-1 font-medium flex items-center ${s==="sds"?"text-[#5b5b5b] border-b-2 border-[#4ECDC4]":"text-gray-500 hover:text-gray-700"}`,onClick:()=>a("sds"),type:"button",children:[e.jsx(b,{path:V,size:1.1,color:"#4ECDC4",className:"mr-2"}),"SDS Sheets"]})]})}),is=({categories:s,selectedCategory:a,onCategoryClick:t})=>e.jsx("div",{className:"p-6",children:e.jsx("div",{role:"tablist","aria-label":"Cleaning Category Tabs",className:"grid grid-cols-5 gap-4",children:s.map(r=>e.jsxs("button",{role:"tab","aria-selected":(a==null?void 0:a.id)===r.id,"aria-controls":`panel-${r.id}`,id:`tab-${r.id}`,onClick:()=>t(r),className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-colors w-full ${(a==null?void 0:a.id)===r.id?"bg-brand-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(b,{path:r.icon,size:1.2,color:r.iconColor}),e.jsx("span",{children:r.title})]},r.id))})}),De=({item:s,bypassedItems:a,adjustedQuantities:t,onBypassItem:r,onAdjustQuantity:n,onViewSDS:c})=>e.jsx("div",{className:"border-b border-gray-200 py-3",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 px-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-medium text-[#5b5b5b]",children:s.title}),e.jsx("button",{onClick:()=>r(s.id),className:`ml-4 px-3 py-1 text-sm rounded-full transition-colors ${a.has(s.id)?"bg-yellow-100 text-yellow-800 hover:bg-yellow-200":"bg-gray-100 text-gray-800 hover:bg-gray-200"}`,type:"button",children:a.has(s.id)?"Not Needed":"Mark Not Needed"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:s.instructions}),s.inventoryItems&&e.jsxs("div",{className:"mt-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Required Items:"}),e.jsx("ul",{className:"mt-1 space-y-1",children:s.inventoryItems.map(l=>{const o=t[`${s.id}-${l.id}`]||0,i=l.requiredQuantity+o;return e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("span",{className:"w-32",children:l.name}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Required: ",i]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Available: ",l.currentStock]}),l.status&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Status: ",l.status]})]}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(s.id,l.id,-1),className:"px-2 py-1 bg-gray-100 rounded hover:bg-gray-200",type:"button",children:"-"}),e.jsx("button",{onClick:()=>n(s.id,l.id,1),className:"px-2 py-1 bg-gray-100 rounded hover:bg-gray-200",type:"button",children:"+"})]})]},l.id)})})]}),s.sds&&e.jsx("div",{className:"mt-2",children:e.jsxs("button",{onClick:()=>c(s.sds),className:"inline-flex items-center text-sm text-[#4ECDC4] hover:text-[#3db8b0]",type:"button",children:[e.jsx(b,{path:V,size:1,className:"mr-1"}),"View SDS Sheet"]})})]})})}),cs=({selectedCategory:s,selectedChecklist:a,bypassedItems:t,adjustedQuantities:r,onCategoryClick:n,onChecklistSelect:c,onBypassItem:l,onAdjustQuantity:o,onViewSDS:i,onMarkComplete:d,getChecklistsForCategory:g})=>e.jsxs(e.Fragment,{children:[e.jsx(is,{categories:ns,selectedCategory:s,onCategoryClick:n}),s&&e.jsxs("div",{role:"tabpanel",id:`panel-${s.id}`,"aria-labelledby":`tab-${s.id}`,className:"p-6 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:`${s.iconColor}20`},children:e.jsx(b,{path:s.icon,size:1.5,color:s.iconColor})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.title})]}),e.jsxs("div",{className:"space-y-4",children:[!a&&e.jsxs("div",{className:"space-y-4",children:[g(s.id).map(m=>e.jsxs("div",{onClick:()=>c(m),onKeyDown:p=>p.key==="Enter"&&c(m),className:"w-full text-left p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",role:"button",tabIndex:0,"aria-label":`Select ${m.title} checklist`,children:[e.jsx("h3",{className:"font-medium text-[#5b5b5b]",children:m.title}),m.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:m.description})]},m.id)),g(s.id).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No published checklists available for this category."}),e.jsx("p",{className:"text-sm mt-1",children:"Create and publish checklists in Settings to see them here."})]})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-[#5b5b5b]",children:a.title}),e.jsx("div",{className:"space-y-2",children:a.items.map(m=>e.jsx(De,{item:m,bypassedItems:t,adjustedQuantities:r,onBypassItem:l,onAdjustQuantity:o,onViewSDS:i},m.id))}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:d,className:"bg-[#4ECDC4] text-white px-4 py-2 rounded-lg hover:bg-[#3db8b0] transition-colors",type:"button",children:"Mark All Complete"})})]})]})]})]}),ds=({searchQuery:s,sdsCategory:a,filteredSDSSheets:t,onTabChange:r,onSearchQueryChange:n,onSdsCategoryChange:c,onSDSSelect:l})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>r("checklists"),onKeyDown:o=>o.key==="Escape"&&r("checklists"),role:"dialog","aria-label":"SDS Sheets Modal",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",role:"document",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{path:V,size:1.2,color:"#4ECDC4",className:"mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-[#5b5b5b]",children:"SDS Sheets"})]}),e.jsx("button",{onClick:()=>r("checklists"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close SDS Sheets",type:"button",children:e.jsx(b,{path:et,size:1.2,color:"#5b5b5b"})})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Search SDS sheets...",value:s,onChange:o=>n(o.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx(b,{path:tt,size:1,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),e.jsxs("select",{value:a,onChange:o=>c(o.target.value),className:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Cleaning",children:"Cleaning"}),e.jsx("option",{value:"Sanitization",children:"Sanitization"})]})]}),e.jsx("div",{className:"space-y-2",children:t.map(o=>e.jsxs("div",{onClick:()=>l(o),onKeyDown:i=>i.key==="Enter"&&l(o),className:"w-full flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",role:"button",tabIndex:0,"aria-label":`Select ${o.name} SDS sheet`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-[#5b5b5b]",children:o.name}),e.jsx("span",{className:"text-sm text-gray-500",children:"•"}),e.jsx("p",{className:"text-sm text-gray-500",children:o.category})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:o.lastUpdated}),e.jsx(b,{path:V,size:1,color:"#4ECDC4"})]})]},o.id))})]})}),ms=({stolenItems:s,onAddStolenItem:a,onUpdateStolenItem:t,onClearStolenItems:r})=>e.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Reported Stolen Items"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 text-sm",children:"Clear All"}),e.jsx("button",{onClick:a,className:`px-3 py-1 ${we.error.light} text-red-600 rounded-md hover:bg-red-100 text-sm`,children:"+ Add Stolen Item"})]})]}),s.map((n,c)=>{var l;return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Item",value:n.item,onChange:o=>t(c,"item",o.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"number",placeholder:"Qty",value:n.quantity,onChange:o=>t(c,"quantity",parseInt(o.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"text",placeholder:"Notes",value:(l=n.data)==null?void 0:l.notes,onChange:o=>t(c,"notes",o.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md"})]},c)})]}),us=({prnItems:s,onAddPrnItem:a,onUpdatePrnItem:t,onClearPrnItems:r})=>e.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"PRN Cleaning Items"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r,className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 text-sm",children:"Clear All"}),e.jsx("button",{onClick:a,className:`px-3 py-1 ${we.info.light} text-blue-600 rounded-md hover:bg-blue-100 text-sm`,children:"+ Add PRN Item"})]})]}),s.map((n,c)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Item",value:n.item,onChange:l=>t(c,"item",l.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"number",placeholder:"Qty",value:n.quantity,onChange:l=>t(c,"quantity",parseInt(l.target.value)||0),className:"w-20 px-3 py-2 border border-gray-300 rounded-md"}),e.jsx("input",{type:"text",placeholder:"Reason",value:n.reason,onChange:l=>t(c,"reason",l.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md"})]},c))]}),hs=({notes:s,isListening:a,transcript:t,onNotesChange:r,onClearNotes:n,onStartSpeechRecognition:c,onStopSpeechRecognition:l,onApplyTranscriptToNotes:o})=>e.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Notes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:n,className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 text-sm",children:"Clear Notes"}),e.jsxs("button",{onClick:a?l:c,className:`px-3 py-1 rounded-md text-sm flex items-center gap-1 ${a?"bg-red-100 text-red-600 hover:bg-red-200":"bg-blue-100 text-blue-600 hover:bg-blue-200"}`,children:[e.jsx(b,{path:a?st:le,size:.8}),a?"Stop Dictation":"Start Dictation"]})]})]}),a&&e.jsxs("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800 flex items-center",children:[e.jsx(b,{path:le,size:.8,className:"mr-1 animate-pulse"}),"Listening... Speak now"]}),e.jsx("button",{onClick:()=>o(r),disabled:!t.trim(),className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add to Notes"})]}),e.jsx("div",{className:"text-sm text-blue-700 min-h-[2rem]",children:t||"Waiting for speech..."})]}),e.jsx("textarea",{value:s,onChange:i=>r(i.target.value),placeholder:"Add any additional notes here... Use the dictation button to speak your notes!",className:"w-full h-32 px-3 py-2 border border-gray-300 rounded-md"})]}),ps=({showModal:s,selectedCategory:a,selectedChecklist:t,bypassedItems:r,adjustedQuantities:n,stolenItems:c,prnItems:l,notes:o,isListening:i,transcript:d,onClose:g,onChecklistSelect:m,onSetSelectedChecklist:p,onBypassItem:x,onAdjustQuantity:h,onViewSDS:f,onAddStolenItem:v,onUpdateStolenItem:w,onClearStolenItems:T,onAddPrnItem:$,onUpdatePrnItem:E,onClearPrnItems:D,onNotesChange:_,onClearNotes:P,onStartSpeechRecognition:A,onStopSpeechRecognition:L,onApplyTranscriptToNotes:M,getChecklistsForCategory:z})=>e.jsx(je,{show:s,onClose:g,title:(a==null?void 0:a.title)||"Select Checklist",footer:e.jsx("div",{className:"flex justify-end w-full",children:e.jsx("button",{onClick:g,className:"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300 font-medium py-2 px-4 rounded-md transition-colors",children:"Close"})}),children:t?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:t.title}),e.jsxs("button",{onClick:()=>p(null),className:"text-sm text-gray-600 hover:text-gray-800 flex items-center",children:[e.jsx(b,{path:at,size:1,className:"mr-1"}),"Back to Lists"]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 divide-y divide-gray-200",children:t.items.map(N=>e.jsx(De,{item:N,bypassedItems:r,adjustedQuantities:n,onBypassItem:x,onAdjustQuantity:h,onViewSDS:f},N.id))}),e.jsx(ms,{stolenItems:c,onAddStolenItem:v,onUpdateStolenItem:w,onClearStolenItems:T}),e.jsx(us,{prnItems:l,onAddPrnItem:$,onUpdatePrnItem:E,onClearPrnItems:D}),e.jsx(hs,{notes:o,isListening:i,transcript:d,onNotesChange:_,onClearNotes:P,onStartSpeechRecognition:A,onStopSpeechRecognition:L,onApplyTranscriptToNotes:M})]}):e.jsxs("div",{className:"space-y-3",children:[a&&z(a.id).map(N=>e.jsxs("div",{onClick:()=>m(N),onKeyDown:B=>B.key==="Enter"&&m(N),className:"w-full p-3 text-left bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 cursor-pointer",role:"button",tabIndex:0,"aria-label":`Select ${N.title} checklist`,children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-1",children:N.title}),e.jsx("p",{className:"text-sm text-gray-600",children:N.description})]},N.id)),a&&z(a.id).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No published checklists available for this category."}),e.jsx("p",{className:"text-sm mt-1",children:"Create and publish checklists in Settings to see them here."})]})]})}),xs=({selectedSDS:s,onClose:a})=>e.jsx(je,{show:!!s,onClose:a,title:"Safety Data Sheet",children:s&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:s.name}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.sections.map(t=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm",children:t},t))})]})})}),gs=()=>{const{getPublishedChecklistsByCategory:s}=Le(),{selectedCategory:a,selectedChecklist:t,activeTab:r,searchQuery:n,selectedSDS:c,sdsCategory:l,bypassedItems:o,adjustedQuantities:i,showModal:d,notes:g,stolenItems:m,prnItems:p,setSelectedChecklist:x,setActiveTab:h,setSearchQuery:f,setSelectedSDS:v,setSdsCategory:w,setNotes:T,handleCategoryClick:$,handleChecklistSelect:E,handleCloseModal:D,handleMarkComplete:_,handleBypassItem:P,handleAdjustQuantity:A,handleAddStolenItem:L,handleAddPrnItem:M,handleUpdateStolenItem:z,handleUpdatePrnItem:N,clearStolenItems:B,clearPrnItems:X,clearNotes:Y}=as(),{isListening:J,transcript:Z,startSpeechRecognition:ee,stopSpeechRecognition:te,applyTranscriptToNotes:se}=rs(),j=y=>s(y).map(O=>({id:O.id,title:O.title,description:`Published checklist with ${O.items.length} items`,items:O.items.map(F=>{var ae;return{id:F.id,title:F.title,instructions:F.instructions,inventoryItems:(ae=F.requiredInventory)==null?void 0:ae.map(Q=>({id:Q.id,name:Q.name,currentStock:Q.available,requiredQuantity:Q.required,category:"Cleaning Supplies"})),completed:F.completed||!1}})})),k=ls.filter(y=>{const S=y.name.toLowerCase().includes(n.toLowerCase()),O=l==="all"||y.category===l;return S&&O});return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow",style:{borderLeft:"4px solid rgba(78, 205, 196, 0.5)"},children:[e.jsx(os,{activeTab:r,onTabChange:y=>h(y)}),r==="checklists"&&e.jsx(cs,{selectedCategory:a,selectedChecklist:t,bypassedItems:o,adjustedQuantities:i,onCategoryClick:$,onChecklistSelect:E,onBypassItem:P,onAdjustQuantity:A,onViewSDS:v,onMarkComplete:_,getChecklistsForCategory:j}),r==="sds"&&e.jsx(ds,{searchQuery:n,sdsCategory:l,filteredSDSSheets:k,onTabChange:y=>h(y),onSearchQueryChange:f,onSdsCategoryChange:w,onSDSSelect:y=>v(y)}),e.jsx(ps,{showModal:d,selectedCategory:a,selectedChecklist:t,bypassedItems:o,adjustedQuantities:i,stolenItems:m,prnItems:p,notes:g,isListening:J,transcript:Z,onClose:D,onChecklistSelect:E,onSetSelectedChecklist:x,onBypassItem:P,onAdjustQuantity:A,onViewSDS:v,onAddStolenItem:L,onUpdateStolenItem:z,onClearStolenItems:B,onAddPrnItem:M,onUpdatePrnItem:N,onClearPrnItems:X,onNotesChange:T,onClearNotes:Y,onStartSpeechRecognition:ee,onStopSpeechRecognition:te,onApplyTranscriptToNotes:se,getChecklistsForCategory:j}),e.jsx(xs,{selectedSDS:c,onClose:()=>v(null)})]})},fs=()=>e.jsx("div",{children:e.jsx(gs,{})}),bs=Me.memo(({clean:s})=>e.jsxs("div",{className:"p-4 border rounded-lg shadow-sm",children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["Room ",s.id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",s.status]})]}));bs.displayName="EnvironmentalCleanItem";const ys=()=>{const s=Ae(),[a]=u.useState(!1),t=ft(),r=u.useRef(t);u.useEffect(()=>{r.current=t},[t]);const{rooms:n}=Ne(),{searchTerm:c,status:l,onSearchChange:o,onStatusChange:i}=dt(n);u.useEffect(()=>{r.current.mutate({action:"view_page"})},[]),u.useEffect(()=>{l&&l!=="all"&&r.current.mutate({action:"filter_status",item:{status:l}})},[l]);const d=()=>{console.log("🔍 Navigating to scanner page..."),s("/environmental-clean/scanner")};return e.jsx(Tt,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(bt,{isScanning:a,onScan:d,searchTerm:c,onSearchTermChange:o,selectedStatus:l,onStatusChange:i}),e.jsx("div",{className:"flex flex-col lg:flex-row gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx(Vt,{}),e.jsx(Yt,{})]}),e.jsx(fs,{})]})})]})})};var vs=(s,a,t)=>new Promise((r,n)=>{var c=i=>{try{o(t.next(i))}catch(d){n(d)}},l=i=>{try{o(t.throw(i))}catch(d){n(d)}},o=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,l);o((t=t.apply(s,a)).next())});function _s(){const[s,a]=u.useState(null);return u.useEffect(()=>{vs(null,null,function*(){try{const r=yield nt.startSession({module:"environmental_clean"});r!=null&&r.id&&a(r.id)}catch(r){console.error("Failed to start workflow session:",r)}})},[]),e.jsx(re,{FallbackComponent:ze,children:e.jsx(Fe,{children:e.jsx(re,{FallbackComponent:ct,children:e.jsx(ys,{})})})})}export{_s as default};
