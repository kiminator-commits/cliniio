const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/components-CQ0__InY.js","assets/js/react-vendor-QwocJJ0l.js","assets/js/data-vendor-74w85Vz1.js","assets/js/vendor-B35QfyBG.js","assets/js/services-TvYZC6AJ.js","assets/js/inventory-pages-Clxt543p.js","assets/js/ui-vendor-mgcSnJSc.js","assets/css/ui-vendor-DJSy8M6b.css","assets/js/utils-vendor-DPZjRVl3.js","assets/js/knowledgehub-pages-BPCkPWE6.js","assets/css/components-B4OH_j2L.css"])))=>i.map(i=>d[i]);
import{b as q,r as x,j as e,k as Y,S as V,w as y,T as Z}from"./react-vendor-QwocJJ0l.js";import{g as J,h as F,i as K,E as Q,_ as X,L as ee,j,k as A,l as se,m as z,n as H}from"./components-CQ0__InY.js";import{aa as G,S as re,ab as M,ac as te,ad as ne}from"./services-TvYZC6AJ.js";import"./data-vendor-74w85Vz1.js";import"./vendor-B35QfyBG.js";import"./ui-vendor-mgcSnJSc.js";import"./utils-vendor-DPZjRVl3.js";import"./inventory-pages-Clxt543p.js";import"./knowledgehub-pages-BPCkPWE6.js";const O={rememberMe:"Remember me",rememberDevice:"Remember device"},g={PROGRESS_STEPS:{IDLE:"idle",CONNECTING:"connecting",AUTHENTICATING:"authenticating",VERIFYING:"verifying",SUCCESS:"success"},REDIRECT_DELAY_MS:1e3,MIN_PASSWORD_LENGTH:6,OTP_LENGTH:6},B={unexpectedError:"An unexpected error occurred. Please try again.",offline:"You are currently offline. Please check your internet connection."};var ae=Object.defineProperty,le=Object.defineProperties,oe=Object.getOwnPropertyDescriptors,U=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,W=(s,t,r)=>t in s?ae(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,de=(s,t)=>{for(var r in t||(t={}))ie.call(t,r)&&W(s,r,t[r]);if(U)for(var r of U(t))ce.call(t,r)&&W(s,r,t[r]);return s},ue=(s,t)=>le(s,oe(t)),me=(s,t,r)=>new Promise((i,o)=>{var l=n=>{try{d(r.next(n))}catch(u){o(u)}},c=n=>{try{d(r.throw(n))}catch(u){o(u)}},d=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,c);d((r=r.apply(s,t)).next())});const xe=()=>{const s=q(),{refreshUserData:t}=J(),{formData:r,errors:i,loading:o,setField:l,setErrors:c,setLoading:d,setAuthToken:n,csrfToken:u,incrementFailedAttempts:w,resetFailedAttempts:E,isSecureMode:P}=F(),[C,b]=x.useState(""),k=x.useCallback(a=>h=>{const f=a==="rememberMe"||a==="rememberDevice"?h.target.checked:h.target.value;l(a,f),i[a]&&c(ue(de({},i),{[a]:""}))},[i,l,c]),N=(a,h,f,p,_=!1,R=!1)=>me(null,null,function*(){var v;if(!o){if(c({}),d(!0),P&&!f()){c({submit:"Security validation failed. Please refresh the page and try again."}),d(!1);return}try{G("attempt",{email:a,timestamp:new Date().toISOString()});const I=!1;if(R)try{console.log("🔍 Checking if device is already trusted...")}catch(D){console.warn("Failed to check trusted device:",D)}const S=yield new re().secureLogin({email:a,password:h,rememberMe:_});if(S.success&&S.data){b(g.PROGRESS_STEPS.VERIFYING);const D=new Date(Date.now()+S.data.expiresIn*1e3).toISOString();n(S.data.accessToken,D,_);try{yield t()}catch(T){console.warn("Failed to refresh user data:",T)}if(R)try{const T=M.generateDeviceFingerprint(),$=(v=S.data.user)==null?void 0:v.id;$&&((yield M.isDeviceTrusted($))?console.log("✅ Device already trusted"):(yield M.storeTrustedDevice($,T),console.log("✅ Device marked as trusted")))}catch(T){console.warn("Failed to store trusted device:",T)}G("success",{email:a,timestamp:new Date().toISOString()}),p("login_success",a),E(),b(g.PROGRESS_STEPS.SUCCESS),setTimeout(()=>{s("/home")},g.REDIRECT_DELAY_MS)}else throw new Error(S.error||"Authentication failed")}catch(I){console.error("Secure login error:",I),w();const L=I instanceof Error?I.message:B.unexpectedError;c({submit:L}),G("failure",{email:a,error:L,timestamp:new Date().toISOString()}),p("login_failure",a,L)}finally{d(!1),b("")}}}),m=x.useCallback(()=>{console.log("Forgot password clicked")},[]);return{formData:r,errors:i,loading:o,loadingStep:C,handleChange:k,handleSubmit:N,handleForgotPassword:m}},he=()=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mt-6 text-center text-3xl font-extrabold text-gray-500",children:"Welcome to Cliniio"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),fe=()=>e.jsx(K,{}),ge=({formData:s,handleChange:t,disabled:r=!1})=>{const i=x.useRef(null),[o,l]=x.useState(!1);x.useEffect(()=>{i.current&&!r&&i.current.focus()},[r]);const c=u=>u.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.trim())?null:"Please enter a valid email address":"Email is required",d=u=>{t("email")(u),l(!0)},n=o?c(s.email):null;return e.jsxs("div",{children:[e.jsx("span",{id:"emailHelp",className:"sr-only",children:"Enter your email address."}),e.jsx("label",{htmlFor:"email",className:"sr-only",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Y,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,disabled:r,"aria-label":"Email address","aria-describedby":"emailHelp",className:`appearance-none rounded-lg relative block w-full px-3 py-3 pl-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 focus:z-10 sm:text-sm transition-colors duration-200 ${n?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${r?"opacity-50 cursor-not-allowed bg-gray-100":""}`,placeholder:"Email address",value:s.email,onChange:d,onBlur:()=>l(!0),ref:i})]}),n&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:n})]})]})},pe=({password:s})=>{const r=(o=>{let l=0;const c={length:o.length>=8,lowercase:/[a-z]/.test(o),uppercase:/[A-Z]/.test(o),numbers:/\d/.test(o),symbols:/[!@#$%^&*(),.?":{}|<>]/.test(o),noRepeating:!/(.)\1{2,}/.test(o),noSequential:!/(?:abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz|012|123|234|345|456|567|678|789)/i.test(o)};return c.length&&(l+=2),c.lowercase&&(l+=1),c.uppercase&&(l+=1),c.numbers&&(l+=1),c.symbols&&(l+=1),c.noRepeating&&(l+=1),c.noSequential&&(l+=1),o.length>=12&&(l+=1),o.length>=16&&(l+=1),l>=8?{level:"Excellent",score:l,color:"text-emerald-600",bgColor:"bg-emerald-500",barColor:"bg-emerald-500"}:l>=6?{level:"Strong",score:l,color:"text-green-600",bgColor:"bg-green-500",barColor:"bg-green-500"}:l>=4?{level:"Good",score:l,color:"text-yellow-600",bgColor:"bg-yellow-500",barColor:"bg-yellow-500"}:l>=2?{level:"Fair",score:l,color:"text-orange-600",bgColor:"bg-orange-500",barColor:"bg-orange-500"}:{level:"Weak",score:l,color:"text-red-600",bgColor:"bg-red-500",barColor:"bg-red-500"}})(s),i=10;return s.length===0?null:e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Password Strength"}),e.jsx("span",{className:`text-sm font-semibold ${r.color}`,children:r.level})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-3",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ease-out ${r.barColor}`,style:{width:`${r.score/i*100}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-3",children:[e.jsxs("span",{children:["Score: ",r.score,"/",i]}),e.jsxs("span",{className:r.color,children:[Math.round(r.score/i*100),"%"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.length>=8?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${s.length>=8?"text-green-700":"text-gray-500"}`,children:"At least 8 characters"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[a-z]/.test(s)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[a-z]/.test(s)?"text-green-700":"text-gray-500"}`,children:"Lowercase letter"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[A-Z]/.test(s)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[A-Z]/.test(s)?"text-green-700":"text-gray-500"}`,children:"Uppercase letter"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/\d/.test(s)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/\d/.test(s)?"text-green-700":"text-gray-500"}`,children:"Number"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/[!@#$%^&*(),.?":{}|<>]/.test(s)?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${/[!@#$%^&*(),.?":{}|<>]/.test(s)?"text-green-700":"text-gray-500"}`,children:"Special character"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.length>=12?e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${s.length>=12?"text-green-700":"text-gray-500"}`,children:"At least 12 characters (bonus)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[/(.)\1{2,}/.test(s)?e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}):e.jsx(y,{className:"w-3 h-3 text-green-500 flex-shrink-0"}),e.jsx("span",{className:`text-xs ${/(.)\1{2,}/.test(s)?"text-gray-500":"text-green-700"}`,children:"No repeating characters"})]})]}),r.score<6&&e.jsx("div",{className:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded text-xs text-amber-800",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-500 mt-0.5 flex-shrink-0",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Tip:"})," Try adding uppercase letters, numbers, and special characters to make your password stronger."]})]})})]})},be=({formData:s,handleChange:t,disabled:r=!1,showStrengthIndicator:i=!1})=>{const[o,l]=x.useState(!1),c=u=>u?u.length<8?"Password must be at least 8 characters long":null:"Password is required",d=u=>{t("password")(u),l(!0)},n=o?c(s.password):null;return e.jsxs("div",{children:[e.jsx("span",{id:"passwordHelp",className:"sr-only",children:"Enter your account password."}),e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Z,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,disabled:r,"aria-label":"Password","aria-describedby":"passwordHelp",className:`appearance-none rounded-lg relative block w-full px-3 py-3 pl-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 focus:z-10 sm:text-sm transition-colors duration-200 ${n?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${r?"opacity-50 cursor-not-allowed bg-gray-100":""}`,placeholder:"Password",value:s.password,onChange:d,onBlur:()=>l(!0)})]}),i&&e.jsx(pe,{password:s.password}),n&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:n})]})]})},ve=({formData:s,handleChange:t,disabled:r=!1})=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",disabled:r,"aria-label":O.rememberMe,checked:s.rememberMe,onChange:t("rememberMe"),className:`h-4 w-4 text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 rounded transition-colors duration-200 ${r?"opacity-50 cursor-not-allowed":""}`}),e.jsx("label",{htmlFor:"remember-me",className:`ml-2 block text-sm transition-colors duration-200 ${r?"text-gray-500":"text-gray-900"}`,children:O.rememberMe})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-device",name:"remember-device",type:"checkbox",disabled:r,"aria-label":O.rememberDevice,checked:s.rememberDevice,onChange:t("rememberDevice"),className:`h-4 w-4 text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 rounded transition-colors duration-200 ${r?"opacity-50 cursor-not-allowed":""}`}),e.jsx("label",{htmlFor:"remember-device",className:`ml-2 block text-sm transition-colors duration-200 ${r?"text-gray-500":"text-gray-900"}`,children:O.rememberDevice})]})]})}),ye=({formData:s,handleChange:t,disabled:r=!1})=>{const[i,o]=x.useState(!1),l=n=>n?n.length!==6?"Verification code must be 6 digits":/^\d{6}$/.test(n)?null:"Verification code must contain only numbers":"Verification code is required",c=n=>{t("otp")(n),o(!0)},d=i?l(s.otp||""):null;return s.stage!=="otp"?null:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"otp",className:"sr-only",children:"One-time code"}),e.jsx("input",{id:"otp",name:"otp",type:"text",maxLength:6,disabled:r,placeholder:"Enter 6-digit code",value:s.otp||"",onChange:c,onBlur:()=>o(!0),className:`appearance-none rounded-lg relative block w-full px-3 py-3 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:border-blue-500 sm:text-sm transition-colors duration-200 ${d?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300"} ${r?"opacity-50 cursor-not-allowed bg-gray-100":""}`}),d&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(V,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:d})]})]})},je=({warnings:s=[]})=>x.useMemo(()=>!s||s.length===0?null:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Warning"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:s.map((r,i)=>e.jsx("li",{children:r},i))})})]})]})}),[s]),Ne=({isOnline:s=!0})=>s?null:e.jsx("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-amber-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-amber-800 font-medium",children:B.offline})})]})});var Se=(s,t,r)=>new Promise((i,o)=>{var l=n=>{try{d(r.next(n))}catch(u){o(u)}},c=n=>{try{d(r.throw(n))}catch(u){o(u)}},d=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,c);d((r=r.apply(s,t)).next())});const we=x.lazy(()=>X(()=>import("./components-CQ0__InY.js").then(s=>s.aA),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),Ee=()=>e.jsx("div",{className:"rounded-lg border p-4 bg-red-50 border-red-200",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"text-sm text-red-800",children:"Loading error handler..."})})}),Ae=()=>{const{formData:s,errors:t,loading:r,handleChange:i,handleSubmit:o,handleForgotPassword:l}=xe(),{csrfToken:c,isSecureMode:d}=F(),n=u=>Se(null,null,function*(){if(u.preventDefault(),!s.email.trim()||!s.password.trim())return;const w=s.email.trim().toLowerCase(),E=s.password;yield o(w,E,()=>d?!!c&&c.length>0:!0,(b,k,N)=>{console.log(`[SECURITY] ${b} for user: ${k}`,N?`Reason: ${N}`:"")},s.rememberMe,s.rememberDevice)});return e.jsx(Q,{children:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsx(he,{}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:n,children:[d&&c&&e.jsx("input",{type:"hidden",name:"csrfToken",value:c}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ge,{formData:s,handleChange:i,disabled:r}),e.jsx(be,{formData:s,handleChange:i,disabled:r,showStrengthIndicator:!1}),e.jsx(ve,{formData:s,handleChange:i,disabled:r})]}),s.stage==="otp"&&e.jsx(ye,{formData:s,handleChange:i,disabled:r}),e.jsx(je,{}),e.jsx(Ne,{}),t.submit&&e.jsx(x.Suspense,{fallback:e.jsx(Ee,{}),children:e.jsx(we,{error:t.submit,context:"login",onRetry:()=>{F.getState().setErrors({})},onDismiss:()=>{F.getState().setErrors({})}})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:r,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Sign in"})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:l,className:"text-sm text-blue-600 hover:text-blue-500 focus:outline-none focus:underline",children:"Forgot your password?"})})]}),e.jsx(fe,{})]})})})},Ge=()=>e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"mt-4 inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx("svg",{className:"w-3 h-3 mr-1.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z",clipRule:"evenodd"})}),"Secure Login Enabled"]})}),Me=({loading:s,loadingStep:t})=>{const r=i=>{switch(i){case g.PROGRESS_STEPS.CONNECTING:return"progress-bar-25";case g.PROGRESS_STEPS.AUTHENTICATING:return"progress-bar-50";case g.PROGRESS_STEPS.VERIFYING:return"progress-bar-75";case g.PROGRESS_STEPS.SUCCESS:return"progress-bar-100";default:return"progress-bar-0"}};return!s||t===g.PROGRESS_STEPS.IDLE?null:e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:[t===g.PROGRESS_STEPS.CONNECTING&&"Connecting to server...",t===g.PROGRESS_STEPS.AUTHENTICATING&&"Authenticating credentials...",t===g.PROGRESS_STEPS.VERIFYING&&"Verifying session...",t===g.PROGRESS_STEPS.SUCCESS&&"Login successful! Redirecting..."]}),e.jsx("div",{className:"mt-2 w-full bg-blue-200 rounded-full h-2",children:e.jsx("div",{className:`bg-blue-600 h-2 rounded-full transition-all duration-300 ease-out ${r(t)}`})})]})]})})},Ve=({loading:s,loadingStep:t})=>s?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-600",children:[e.jsx(ee,{size:"sm"}),e.jsx("span",{children:t||"Processing..."})]}):null;function ke(s,t){const r=x.useRef();return x.useCallback((...o)=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{s(...o)},t)},[s,t])}var Te=(s,t,r)=>new Promise((i,o)=>{var l=n=>{try{d(r.next(n))}catch(u){o(u)}},c=n=>{try{d(r.throw(n))}catch(u){o(u)}},d=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,c);d((r=r.apply(s,t)).next())});const ze=()=>{const[s,t]=x.useState(""),[r,i]=x.useState([]),[o,l]=x.useState(null),[c,d]=x.useState(!1);x.useEffect(()=>{const a=setTimeout(()=>{const h=j.getStoredToken();if(h)t(h);else{const f=j.generateToken();t(f),j.storeToken(f)}},0);return()=>clearTimeout(a)},[]);const n=(m,a)=>{A()&&console.warn(`[SECURITY] ${m}:`,a);const h=A()?a:{event_type:m,timestamp:new Date().toISOString(),has_details:Object.keys(a).length>0};te({event:"security_event",timestamp:new Date().toISOString(),metadata:h})};x.useEffect(()=>{(()=>{const a=window.location.protocol==="https:"||window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";d(a),!a&&!A()&&n("non_https_connection",{protocol:window.location.protocol,hostname:window.location.hostname})})()},[]);const u=(m,a)=>{const h=[];if(m.trim()&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.trim())||h.push("Please enter a valid email address."),a?a.length<6&&h.push("Password must be at least 6 characters long."):h.push("Password must be at least 6 characters long."),h.length>0)return{isValid:!1,email:m.trim(),password:a,errors:h};const f=z(m,"email"),p=z(a,"password");if(!f||!p)return{isValid:!1,email:f,password:p,errors:["Invalid email or password format"]};const _=H(f),R=H(p),v=[..._.threats,...R.threats];return v.length>0?(i(v),n("suspicious_input_detected",{email:f,threats:v}),{isValid:!1,email:f,password:p,errors:v}):(i([]),{isValid:!0,email:f,password:p,errors:[]})},w=ke(((m,a)=>u(m,a)),se.VALIDATION.DEBOUNCE_MS),E=(m,a)=>u(m,a),P=m=>{const a=j.getStoredToken(),h=j.validateToken(m,a||"");if(!h){n("csrf_validation_failed",{providedToken:m,storedToken:a});const f=j.refreshToken();t(f)}return h},C=m=>Te(null,null,function*(){try{const a=yield ne.checkRateLimit(m);return l(a),a.isLocked&&n("rate_limit_exceeded",{email:m,lockoutTime:a.lockoutTime}),a}catch(a){return console.error("Rate limit check failed:",a),{isLocked:!1,remainingAttempts:5}}}),b=()=>{i([])},k=()=>{j.clearToken(),t("")},N=x.useMemo(()=>{const m=r.length>0;return(o==null?void 0:o.isLocked)||!1?"locked":m?"warning":"secure"},[r,o]);return{csrfToken:s,securityWarnings:r,rateLimitInfo:o,isHttps:c,validateInputs:E,debouncedValidateInputs:w,validateCsrfToken:P,checkRateLimit:C,clearSecurityWarnings:b,clearCsrfToken:k,logSecurityEvent:n,getSecurityStatus:N}};export{ve as CheckboxFields,ge as EmailField,Ve as LoadingIndicator,Ae as LoginPage,Me as LoginProgressIndicator,Ne as OfflineWarning,ye as OtpField,be as PasswordField,pe as PasswordStrengthIndicator,Ge as SecurityStatusIndicator,je as SecurityWarnings,Ae as default,xe as useLoginForm,ze as useLoginSecurity};
