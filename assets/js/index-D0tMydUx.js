const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/main-RuFFPtZZ.js","assets/js/utils-5cl0BHpv.js","assets/js/vendor-DVtBqAv5.js","assets/js/login-CScPvZaJ.js","assets/js/data-Djiu4445.js","assets/js/ui-C2vLYFVP.js","assets/js/errors-89nfNYWX.js","assets/css/main-Cx7hEqqr.css"])))=>i.map(i=>d[i]);
import{j as e,A as Nn,m as _s}from"./utils-5cl0BHpv.js";import{a as x,d as _n,u as Cn,j as wn}from"./vendor-DVtBqAv5.js";import{j as za,F as Ut,k as Vt,m as qa,E as Sn,L as En,n as Tn,o as Qe,u as Cs,p as Pn,q as In,r as An,d as On,U as ws,s as Ie,t as Ds,w as ks,B as Rs,S as Dn}from"./main-RuFFPtZZ.js";import{U as Dt,aw as re,ax as kn,ay as Ua,I as y,at as Rn,O as $s,c as te,i as $n,e as Ln,S as vs,$ as ye,a as Mn,a8 as it,az as kt,aA as Rt,aB as js,T as Ns,l as $t,aC as ke,b as $e,aD as Fn,v as Ke,aE as Va,a9 as Ss,aF as zn,r as Le,K as Ls,G as ot,E as ct,aG as Ze,aH as ht,aa as Es,aI as Me,aJ as qn,aK as lt,aL as Un,aM as Ba,u as dt,a0 as ut,_ as Ms,j as mt,f as Ga,ac as Ha,ad as Ya,a3 as Wa,aq as Vn,d as Lt,ae as Bn,J as Gn,am as Hn,a5 as gt,Z as Ka,aN as Yn,aO as Wn,F as Kn,aP as Qn,aQ as Qa,ao as Zn,aR as Jn,ar as Xn,M as ei,aS as ti}from"./errors-89nfNYWX.js";import{s as P,u as Fe,f as si,x as ri,M as Ht,_ as Yt,E as xe}from"./login-CScPvZaJ.js";import{c as ai}from"./data-Djiu4445.js";import{D as ni,L as Wt,C as ii,b as li,c as Fs,X as oi,d as zs,e as ci,T as yt}from"./ui-C2vLYFVP.js";import{I as di}from"./inventoryTransformers-2cxuI-EV.js";var ui=Object.defineProperty,mi=Object.defineProperties,hi=Object.getOwnPropertyDescriptors,qs=Object.getOwnPropertySymbols,gi=Object.prototype.hasOwnProperty,xi=Object.prototype.propertyIsEnumerable,Us=(r,t,s)=>t in r?ui(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,pi=(r,t)=>{for(var s in t||(t={}))gi.call(t,s)&&Us(r,s,t[s]);if(qs)for(var s of qs(t))xi.call(t,s)&&Us(r,s,t[s]);return r},fi=(r,t)=>mi(r,hi(t)),Vs=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class bi{static getFacilitySettings(t){return Vs(this,null,function*(){try{const{data:s,error:a}=yield P.from("facility_settings").select("*").eq("facility_id",t).maybeSingle();return a?(console.error("Error fetching facility settings:",a),null):s}catch(s){return console.error("Error fetching facility settings:",s),null}})}static updateFacilitySettings(t,s){return Vs(this,null,function*(){try{const a=fi(pi({},s),{facility_id:t,updated_at:new Date().toISOString()}),{data:n,error:l}=yield P.from("facility_settings").upsert(a,{onConflict:"facility_id"}).select().single();return l?(console.error("Error updating facility settings:",l),null):n}catch(a){return console.error("Error updating facility settings:",a),null}})}}const Za=()=>{const r=za.getInstance();return x.useMemo(()=>{const s=r.getBudgetData(),a=r.isTokenLimitExceeded(),n=r.shouldShowTokenLimitWarning();return{hasIssues:a||n,isExceeded:a,shouldWarn:n,usagePercentage:s.percentage,remainingTokens:s.remaining,usedTokens:s.used,limitTokens:s.limit}},[r])},yi=({activeTab:r,onTabChange:t})=>{const s=[{id:"basic-info",label:"Basic Information",icon:Dt},{id:"preferences",label:"Preferences",icon:re},{id:"mobile",label:"Mobile Scanner Shortcuts",icon:kn},{id:"account",label:"Account Management",icon:Ua}];return e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:s.map(a=>e.jsxs("button",{onClick:()=>t(a.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${r===a.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(y,{path:a.icon,size:1}),e.jsx("span",{children:a.label})]},a.id))})})})};var vi=Object.defineProperty,ji=Object.defineProperties,Ni=Object.getOwnPropertyDescriptors,Bs=Object.getOwnPropertySymbols,_i=Object.prototype.hasOwnProperty,Ci=Object.prototype.propertyIsEnumerable,Gs=(r,t,s)=>t in r?vi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,oe=(r,t)=>{for(var s in t||(t={}))_i.call(t,s)&&Gs(r,s,t[s]);if(Bs)for(var s of Bs(t))Ci.call(t,s)&&Gs(r,s,t[s]);return r},ce=(r,t)=>ji(r,Ni(t));const wi=({basicInfoForm:r,setBasicInfoForm:t,userData:s,uploadingPhoto:a,uploadProfilePhoto:n,removeProfilePhoto:l})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"first-name",className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),e.jsx("input",{id:"first-name",type:"text",value:r.first_name,onChange:o=>t(c=>ce(oe({},c),{first_name:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"last-name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),e.jsx("input",{id:"last-name",type:"text",value:r.last_name,onChange:o=>t(c=>ce(oe({},c),{last_name:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:r.email,onChange:o=>t(c=>ce(oe({},c),{email:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",{id:"phone",type:"tel",value:r.phone,onChange:o=>t(c=>ce(oe({},c),{phone:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{id:"department",type:"text",value:r.department,onChange:o=>t(c=>ce(oe({},c),{department:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"position",className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),e.jsx("input",{id:"position",type:"text",value:r.position,onChange:o=>t(c=>ce(oe({},c),{position:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date-of-birth",className:"block text-sm font-medium text-gray-700 mb-2",children:"Date of Birth"}),e.jsx("input",{id:"date-of-birth",type:"date",value:r.date_of_birth,onChange:o=>t(c=>ce(oe({},c),{date_of_birth:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),e.jsx("textarea",{id:"bio",value:r.bio||"",onChange:o=>t(c=>ce(oe({},c),{bio:o.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Tell us about yourself..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"preferred-language",className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Language"}),e.jsxs("select",{id:"preferred-language",value:r.preferred_language||"en",onChange:o=>t(c=>ce(oe({},c),{preferred_language:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"}),e.jsx("option",{value:"pt",children:"Portuguese"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"timezone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsxs("select",{id:"timezone",value:r.timezone||"UTC",onChange:o=>t(c=>ce(oe({},c),{timezone:o.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx("option",{value:"Europe/London",children:"London"}),e.jsx("option",{value:"Europe/Paris",children:"Paris"}),e.jsx("option",{value:"Asia/Tokyo",children:"Tokyo"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center overflow-hidden",children:a?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#4ECDC4]"})}):s!=null&&s.avatar_url?e.jsx("img",{src:String(s.avatar_url),alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):e.jsx(y,{path:Rn,size:2,className:"text-gray-400"})}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("input",{type:"file",id:"profile-photo",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:o=>{var c;const i=(c=o.target.files)==null?void 0:c[0];i&&n(i),o.target.value=""},className:"hidden",disabled:a}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm cursor-pointer text-center disabled:opacity-50 disabled:cursor-not-allowed",onClick:o=>{if(a){o.preventDefault();return}document.getElementById("profile-photo").click()},disabled:a,children:a?"Uploading...":"Upload Photo"}),(s==null?void 0:s.avatar_url)&&e.jsx("button",{onClick:l,disabled:a,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:"Remove Photo"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG or GIF. Max size 2MB."}),a&&e.jsx("p",{className:"text-xs text-blue-600",children:"Uploading photo..."})]})]})]})]}),ne=({id:r,checked:t,onChange:s,label:a,description:n,disabled:l=!1})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a}),n&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]}),e.jsxs("label",{htmlFor:r,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{id:r,type:"checkbox",className:"sr-only peer",checked:t,onChange:o=>s(o.target.checked),disabled:l}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"} ${l?"opacity-50 cursor-not-allowed":"cursor-pointer"}`}),e.jsx("span",{className:"sr-only",children:a})]})]});let Kt=null;const Si=()=>(Kt||(Kt=new(window.AudioContext||window.webkitAudioContext)),Kt),Ei=(r,t=50)=>{const s=Si(),a=s.createOscillator(),n=s.createGain();switch(n.gain.value=t/100,a.connect(n),n.connect(s.destination),r){case"gentle-chime":a.frequency.setValueAtTime(800,s.currentTime),a.frequency.setValueAtTime(1e3,s.currentTime+.1),a.frequency.setValueAtTime(1200,s.currentTime+.2),a.type="sine";break;case"medical-alert":a.frequency.setValueAtTime(600,s.currentTime),a.frequency.setValueAtTime(800,s.currentTime+.15),a.type="square";break;case"soft-bell":a.frequency.setValueAtTime(1e3,s.currentTime),a.frequency.setValueAtTime(800,s.currentTime+.2),a.type="sine";break;case"digital-beep":a.frequency.setValueAtTime(1e3,s.currentTime),a.type="square";break;case"success-tone":a.frequency.setValueAtTime(800,s.currentTime),a.frequency.setValueAtTime(1e3,s.currentTime+.1),a.type="sine";break;case"warning-sound":a.frequency.setValueAtTime(400,s.currentTime),a.frequency.setValueAtTime(600,s.currentTime+.1),a.type="sawtooth";break;default:return}a.start(s.currentTime),a.stop(s.currentTime+.3)},Ti=r=>{switch(r){case"short-pulse":return[100];case"double-tap":return[100,50,100];case"long-pulse":return[300];case"pattern":return[100,50,100,50,200];case"off":default:return[]}},Ja=r=>{if("vibrate"in navigator){const t=Ti(r);t.length>0&&navigator.vibrate(t)}else console.log("Vibration not supported on this device")},Xa=(r,t=50)=>{if(r!=="none")try{Ei(r,t)}catch(s){console.error("Error playing notification sound:",s)}},Pi=r=>{const{sound:t,volume:s,vibration:a,vibrationEnabled:n}=r.notifications;t&&t!=="none"&&Xa(t,s),n&&a&&a!=="off"&&Ja(a)};var Ii=Object.defineProperty,Ai=Object.defineProperties,Oi=Object.getOwnPropertyDescriptors,Hs=Object.getOwnPropertySymbols,Di=Object.prototype.hasOwnProperty,ki=Object.prototype.propertyIsEnumerable,Ys=(r,t,s)=>t in r?Ii(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Qt=(r,t)=>{for(var s in t||(t={}))Di.call(t,s)&&Ys(r,s,t[s]);if(Hs)for(var s of Hs(t))ki.call(t,s)&&Ys(r,s,t[s]);return r},Zt=(r,t)=>Ai(r,Oi(t));const Ri=({preferences:r,setPreferences:t})=>{const s=(n,l)=>{t(Zt(Qt({},r),{[n]:l}))},a=(n,l)=>{t(Zt(Qt({},r),{notifications:Zt(Qt({},r.notifications),{[n]:l})}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Appearance"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"theme",className:"block text-sm font-medium text-gray-600 mb-2",children:"Theme"}),e.jsxs("select",{id:"theme",value:r.theme,onChange:n=>s("theme",n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"}),e.jsx("option",{value:"auto",children:"Auto (System)"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Notifications"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ne,{id:"push-notifications",checked:r.notifications.push,onChange:n=>a("push",n),label:"Push Notifications (Browser)"}),r.notifications.push&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Notification Sounds"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notification-sound",className:"block text-sm font-medium text-gray-600 mb-2",children:"Default Sound"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{id:"notification-sound",value:r.notifications.sound||"gentle-chime",onChange:n=>a("sound",n.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"gentle-chime",children:"Gentle Chime"}),e.jsx("option",{value:"medical-alert",children:"Medical Alert"}),e.jsx("option",{value:"soft-bell",children:"Soft Bell"}),e.jsx("option",{value:"digital-beep",children:"Digital Beep"}),e.jsx("option",{value:"success-tone",children:"Success Tone"}),e.jsx("option",{value:"warning-sound",children:"Warning Sound"}),e.jsx("option",{value:"none",children:"No Sound"})]}),e.jsx("button",{type:"button",onClick:()=>Xa(r.notifications.sound||"gentle-chime",r.notifications.volume||50),className:"px-3 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Preview"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notification-volume",className:"block text-sm font-medium text-gray-600 mb-2",children:"Volume"}),e.jsx("input",{id:"notification-volume",type:"range",min:"0",max:"100",value:r.notifications.volume||50,onChange:n=>a("volume",parseInt(n.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0%"}),e.jsxs("span",{children:[r.notifications.volume||50,"%"]}),e.jsx("span",{children:"100%"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"Vibration (Mobile Devices)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"vibration-pattern",className:"block text-sm font-medium text-gray-600 mb-2",children:"Vibration Pattern"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{id:"vibration-pattern",value:r.notifications.vibration||"short-pulse",onChange:n=>a("vibration",n.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"short-pulse",children:"Short Pulse"}),e.jsx("option",{value:"double-tap",children:"Double Tap"}),e.jsx("option",{value:"long-pulse",children:"Long Pulse"}),e.jsx("option",{value:"pattern",children:"Pattern"}),e.jsx("option",{value:"off",children:"Off"})]}),e.jsx("button",{type:"button",onClick:()=>Ja(r.notifications.vibration||"short-pulse"),className:"px-3 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Test"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(ne,{id:"vibration-enabled",checked:r.notifications.vibrationEnabled!==!1,onChange:n=>a("vibrationEnabled",n),label:"Enable Vibration"})})]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-4 mt-4",children:e.jsx("button",{type:"button",onClick:()=>Pi(r),className:"w-full px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:"Test Full Notification"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can customize notification preferences for specific features in each module."})]})]})]})};var $i=Object.defineProperty,Li=Object.defineProperties,Mi=Object.getOwnPropertyDescriptors,Ws=Object.getOwnPropertySymbols,Fi=Object.prototype.hasOwnProperty,zi=Object.prototype.propertyIsEnumerable,Ks=(r,t,s)=>t in r?$i(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Je=(r,t)=>{for(var s in t||(t={}))Fi.call(t,s)&&Ks(r,s,t[s]);if(Ws)for(var s of Ws(t))zi.call(t,s)&&Ks(r,s,t[s]);return r},Xe=(r,t)=>Li(r,Mi(t)),Qs=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const qi=()=>{const[r,t]=x.useState([{id:"clean-tool",name:"Clean Tool Scan",description:"Scan clean tools ready for use",icon:$s,enabled:!1,shortcutSlot:null},{id:"dirty-tool",name:"Dirty Tool Scan",description:"Scan tools that need sterilization",icon:$s,enabled:!1,shortcutSlot:null},{id:"problem-tool",name:"Problem Tool Scan",description:"Scan tools with issues/repair needs",icon:te,enabled:!1,shortcutSlot:null},{id:"import-receipt",name:"Import Autoclave Receipt",description:"Import physical autoclave documentation",icon:$n,enabled:!1,shortcutSlot:null},{id:"package-tools",name:"Package Tools",description:"Package tools for sterilization",icon:Ln,enabled:!1,shortcutSlot:null},{id:"single-scan",name:"Single Scan Mode",description:"Individual tool scanning",icon:vs,enabled:!1,shortcutSlot:null},{id:"batch-scan",name:"Batch Scan Mode",description:"Multiple tools at once",icon:vs,enabled:!1,shortcutSlot:null},{id:"add-inventory",name:"Add Inventory",description:"Scan new items to add",icon:ye,enabled:!1,shortcutSlot:null},{id:"use-inventory",name:"Use Inventory",description:"Scan items to remove/consume",icon:Mn,enabled:!1,shortcutSlot:null},{id:"scan-room",name:"Scan Room",description:"Scan room barcodes for cleaning",icon:it,enabled:!1,shortcutSlot:null},{id:"complete-cleaning",name:"Complete Cleaning",description:"Mark room as cleaned",icon:it,enabled:!1,shortcutSlot:null},{id:"update-status",name:"Update Status",description:"Change room cleaning status",icon:it,enabled:!1,shortcutSlot:null}]),s=(i,d)=>{if(d&&a().length===0){alert("No mobile shortcuts available. Please disable another workflow first or assign this workflow to an existing shortcut.");return}t(u=>u.map(m=>m.id===i?Xe(Je({},m),{enabled:d,shortcutSlot:d?m.shortcutSlot:null}):m))},a=()=>{const i=r.filter(u=>u.enabled&&u.shortcutSlot!==null).map(u=>u.shortcutSlot);return["volume-up","volume-down","volume-up-double","volume-down-double","power-double","double-tap","shake","flip"].filter(u=>!i.includes(u))},n=(i,d)=>{d===null&&setTimeout(()=>{t(u=>u.map(m=>m.id===i&&m.shortcutSlot===null?Xe(Je({},m),{enabled:!1}):m))},5e3),t(u=>u.map(m=>m.shortcutSlot===d&&m.id!==i?Xe(Je({},m),{shortcutSlot:null}):m.id===i?Xe(Je({},m),{shortcutSlot:d}):m))},l=i=>{var d;return((d=[{id:"volume-up",label:"Volume Up"},{id:"volume-down",label:"Volume Down"},{id:"volume-up-double",label:"Volume Up (2x)"},{id:"volume-down-double",label:"Volume Down (2x)"},{id:"power-double",label:"Power (2x)"},{id:"double-tap",label:"Double Tap"},{id:"shake",label:"Shake"},{id:"flip",label:"Flip"}].find(m=>m.id===i))==null?void 0:d.label)||i},o=()=>Qs(null,null,function*(){try{const{data:{user:i}}=yield P.auth.getUser();if(!i)return;const{data:d,error:u}=yield P.from("users").select("mobile_shortcuts").eq("id",i.id).single();if(u&&u.code!=="PGRST116")return;d!=null&&d.mobile_shortcuts&&typeof d.mobile_shortcuts=="object"&&t(m=>m.map(f=>{const h=d.mobile_shortcuts[f.id];return h?Xe(Je({},f),{enabled:h.enabled,shortcutSlot:h.shortcut}):f}))}catch(i){}}),c=x.useCallback(()=>Qs(null,null,function*(){try{const{data:{user:i}}=yield P.auth.getUser();if(!i)return;const d=r.reduce((m,f)=>(f.enabled&&f.shortcutSlot&&(m[f.id]={enabled:f.enabled,shortcut:f.shortcutSlot}),m),{}),{error:u}=yield P.from("users").update({mobile_shortcuts:d,updated_at:new Date().toISOString()}).eq("id",i.id);u?console.error("Error saving mobile settings:",u):console.log("Mobile settings saved successfully")}catch(i){}}),[r]);return x.useEffect(()=>{setTimeout(()=>{o()},0)},[]),x.useEffect(()=>{r.some(i=>i.enabled)&&c()},[r,c]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Mobile Scanner Shortcuts"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Configure up to 4 mobile shortcuts for quick access to your most-used scanning workflows."}),e.jsx("div",{className:"space-y-4",children:r.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(y,{path:i.icon,size:1.2,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:i.name}),e.jsx("p",{className:"text-xs text-gray-500",children:i.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable"}),e.jsx(ne,{id:`toggle-${i.id}`,label:`Enable ${i.name}`,checked:i.enabled,onChange:d=>s(i.id,d)})]}),i.enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:i.shortcutSlot||"",onChange:d=>n(i.id,d.target.value?d.target.value:null),className:`px-3 py-1 border rounded text-sm ${i.shortcutSlot?"border-gray-300":"border-red-300 bg-red-50"}`,children:[e.jsx("option",{value:"",children:"Select Shortcut"}),[{id:"volume-up",label:"Volume Up (Single Press)",description:"Press volume up button once"},{id:"volume-down",label:"Volume Down (Single Press)",description:"Press volume down button once"},{id:"volume-up-double",label:"Volume Up (Double Press)",description:"Press volume up button twice quickly"},{id:"volume-down-double",label:"Volume Down (Double Press)",description:"Press volume down button twice quickly"},{id:"power-double",label:"Power Button (Double Press)",description:"Press power button twice quickly"},{id:"double-tap",label:"Double Tap Screen",description:"Tap screen twice quickly"},{id:"shake",label:"Shake Device",description:"Shake your phone"},{id:"flip",label:"Flip Device",description:"Turn phone face down"}].map(d=>e.jsx("option",{value:d.id,disabled:r.some(u=>u.id!==i.id&&u.shortcutSlot===d.id),children:d.label},d.id))]}),!i.shortcutSlot&&e.jsx("p",{className:"text-xs text-red-500",children:"⚠️ Please select a mobile shortcut or this workflow will be disabled in 5 seconds"})]})]})]},i.id))}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h6",{className:"text-sm font-medium text-blue-700 mb-3",children:"Current Shortcuts"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[r.filter(i=>i.enabled&&i.shortcutSlot).map(i=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 mx-auto mb-2 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(y,{path:i.icon,size:1.2,className:"text-blue-600"})}),e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:i.name}),e.jsx("p",{className:"text-xs text-blue-500",children:l(i.shortcutSlot)})]},i.id)),r.filter(i=>i.enabled&&i.shortcutSlot).length===0&&e.jsxs("div",{className:"col-span-2 md:col-span-4 text-center py-4",children:[e.jsx("p",{className:"text-blue-500 text-sm",children:"No shortcuts configured yet"}),e.jsx("p",{className:"text-blue-400 text-xs",children:"Enable workflows and assign mobile shortcuts above"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-3",children:"How to Use Mobile Shortcuts"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Enable workflows:"})," Use the toggles for scanning workflows you use frequently"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Assign shortcuts:"})," Choose mobile device actions (volume buttons, double tap, shake, etc.)"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Mobile access:"})," These shortcuts will trigger on your mobile device for quick scanning"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Unique assignments:"})," Each mobile shortcut can only be used by one workflow"]}),e.jsxs("p",{children:["• ",e.jsx("strong",{children:"Quick launch:"})," Perform the assigned action to directly open that scanner workflow"]})]})]})]})})};var Ui=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Vi=({userData:r,onPasswordChange:t,onOpenPasswordModal:s,onArchiveAccount:a,passwordError:n,passwordSuccess:l})=>{const[o,c]=x.useState(!1),[i,d]=x.useState(!1),[u,m]=x.useState(""),f=h=>Ui(null,null,function*(){yield t(h),c(!1)}),b=()=>{u.trim()&&(a(),d(!1),m(""))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Account Security"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#4ECDC4] rounded-lg flex items-center justify-center",children:e.jsx(y,{path:kt,size:1,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-gray-700",children:"Password"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Last changed:"," ",r!=null&&r.password_changed_at?r.password_changed_at:"Never"]})]})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Change Password"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"two-factor-toggle",className:"block text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),e.jsx("button",{id:"two-factor-toggle",disabled:!0,className:"px-4 py-2 rounded-md transition-colors text-sm bg-gray-400 text-white cursor-not-allowed opacity-60",title:"Coming Soon",children:"Coming Soon"})]}),e.jsx("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sessions-toggle",className:"block text-sm font-medium text-gray-700",children:"Login Sessions"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Active sessions:"," ",r!=null&&r.active_sessions?r.active_sessions:1]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h5",{className:"text-md font-medium text-gray-700 mb-4",children:"Account Actions"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:e.jsx(y,{path:Rt,size:1,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-orange-700",children:"Archive Account"}),e.jsx("p",{className:"text-sm text-orange-600",children:"Archive your account - data is preserved but access is disabled"})]})]}),e.jsx("button",{onClick:()=>d(!0),className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors text-sm",children:"Archive Account"})]})})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Change Password"}),n&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:n})}),l&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-green-600 text-sm",children:l})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("input",{id:"current-password",type:"password",placeholder:"Enter your current password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),e.jsx("input",{id:"new-password",type:"password",placeholder:"Enter new password (min 8 characters)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsx("input",{id:"confirm-password",type:"password",placeholder:"Confirm new password",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>f({currentPassword:"",newPassword:"",confirmPassword:""}),className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] rounded-md hover:bg-[#38b2ac]",children:"Change Password"})]})]})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-orange-900 mb-4",children:"Archive Account"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Your account will be archived. This means:"}),e.jsxs("ul",{className:"text-sm text-gray-600 mb-4 space-y-1",children:[e.jsx("li",{children:"• Your data will be preserved"}),e.jsx("li",{children:"• You won't be able to access the system"}),e.jsx("li",{children:"• Your account can be restored by administrators"}),e.jsx("li",{children:"• All sessions will be terminated"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This action can be reversed by contacting support."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"delete-reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for archiving (optional)"}),e.jsx("textarea",{id:"archive-reason",value:u,onChange:h=>m(h.target.value),placeholder:"Please let us know why you're archiving your account...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-md hover:bg-orange-700",children:"Archive Account"})]})]})})]})};var Bi=Object.defineProperty,Gi=Object.defineProperties,Hi=Object.getOwnPropertyDescriptors,Zs=Object.getOwnPropertySymbols,Yi=Object.prototype.hasOwnProperty,Wi=Object.prototype.propertyIsEnumerable,Js=(r,t,s)=>t in r?Bi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Jt=(r,t)=>{for(var s in t||(t={}))Yi.call(t,s)&&Js(r,s,t[s]);if(Zs)for(var s of Zs(t))Wi.call(t,s)&&Js(r,s,t[s]);return r},Xt=(r,t)=>Gi(r,Hi(t)),Ki=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Qi=({isOpen:r,onClose:t,onSubmit:s,error:a,success:n,isPasswordReset:l=!1})=>{const[o,c]=x.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,d]=x.useState(!1),[u,m]=x.useState(!1),f=()=>Ki(null,null,function*(){yield s(o),n&&c({currentPassword:"*********",newPassword:"",confirmPassword:""})}),b=()=>{c({currentPassword:"*********",newPassword:"",confirmPassword:""}),t()};return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:l?"Reset Password":"Change Password"}),a&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:e.jsx("p",{className:"text-red-600 text-sm",children:a})}),n&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:e.jsx("p",{className:"text-green-600 text-sm",children:n})}),e.jsxs("div",{className:"space-y-4",children:[!l&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),e.jsx("div",{className:"relative",children:e.jsx("input",{id:"currentPassword",type:"password",placeholder:"Enter your current password",value:o.currentPassword||"*********",onChange:h=>c(Xt(Jt({},o),{currentPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your current password to verify your identity before changing."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:l?"Choose New Password":"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"newPassword",type:i?"text":"password",placeholder:"Enter new password (min 6 characters)",value:o.newPassword,onChange:h=>c(Xt(Jt({},o),{newPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(y,{path:i?js:Ns,size:1,className:"text-gray-400"})})]}),o.newPassword&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Password Requirements:"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[o.newPassword.length>=6?e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsxs("span",{className:`text-xs ${o.newPassword.length>=6?"text-green-700":"text-gray-500"}`,children:["At least 6 characters (",o.newPassword.length,"/6)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o.newPassword===o.confirmPassword&&o.confirmPassword?e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}):e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:`text-xs ${o.newPassword===o.confirmPassword&&o.confirmPassword?"text-green-700":"text-gray-500"}`,children:"Passwords match"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"confirmPassword",type:u?"text":"password",value:o.confirmPassword,onChange:h=>c(Xt(Jt({},o),{confirmPassword:h.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("button",{type:"button",onClick:()=>m(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(y,{path:u?js:Ns,size:1,className:"text-gray-400"})})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:f,className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] rounded-md hover:bg-[#38b2ac]",children:l?"Send Reset Email":"Save"})]})]})}):null};var pe=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class je{static fetchUserData(t){return pe(this,null,function*(){try{const{data:s}=yield P.from("users").select("*").eq("id",t).single();return s||(yield this.createDefaultProfile(t))}catch(s){throw console.error("Error fetching user data:",s),s}})}static createDefaultProfile(t){return pe(this,null,function*(){const{data:s}=yield P.from("users").select("facility_id").eq("id",t).single(),a={id:t,email:"",first_name:"",last_name:"",role:"user",phone:"",department:"",position:"",date_of_birth:"",bio:"",preferred_language:"en",timezone:"UTC",facility_id:(s==null?void 0:s.facility_id)||"550e8400-e29b-41d4-a716-446655440000"},{data:n,error:l}=yield P.from("users").insert(a).select().single();if(l)throw console.error("Error creating default profile:",l),l;return n})}static getActiveSessionsCount(t){return pe(this,null,function*(){const{data:s}=yield P.from("user_sessions").select("id").eq("user_id",t).eq("is_active",!0);return(s==null?void 0:s.length)||0})}static saveProfile(t,s){return pe(this,null,function*(){const{data:a}=yield P.from("users").select("avatar_url").eq("id",t).single(),{error:n}=yield P.from("users").update({first_name:s.first_name,last_name:s.last_name,email:s.email,phone:s.phone,department:s.department,position:s.position,date_of_birth:s.date_of_birth,bio:s.bio,preferred_language:s.preferred_language,timezone:s.timezone,avatar_url:(a==null?void 0:a.avatar_url)||null,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw n})}static changePassword(t){return pe(this,null,function*(){const{error:s}=yield P.auth.updateUser({password:t.newPassword});if(s)throw s})}static resetPassword(t){return pe(this,null,function*(){const{error:s}=yield P.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/settings?tab=account&openPasswordModal=true`});if(s)throw s})}static archiveAccount(t){return pe(this,null,function*(){const{error:s}=yield P.from("users").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",t);if(s)throw s})}static uploadProfilePhoto(t,s){return pe(this,null,function*(){const a=s.name.split(".").pop(),n=`${Date.now()}.${a}`,l=`${t}/${n}`,{error:o}=yield P.storage.from("profile-photos").upload(l,s);if(o)throw o;const{data:{publicUrl:c}}=P.storage.from("profile-photos").getPublicUrl(l),{error:i}=yield P.from("users").update({avatar_url:c}).eq("id",t);if(i)throw i;return c})}static removeProfilePhoto(t){return pe(this,null,function*(){const{error:s}=yield P.from("users").update({avatar_url:null}).eq("id",t);if(s)throw s})}}var Zi=Object.defineProperty,Ji=Object.defineProperties,Xi=Object.getOwnPropertyDescriptors,Xs=Object.getOwnPropertySymbols,el=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,er=(r,t,s)=>t in r?Zi(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,K=(r,t)=>{for(var s in t||(t={}))el.call(t,s)&&er(r,s,t[s]);if(Xs)for(var s of Xs(t))tl.call(t,s)&&er(r,s,t[s]);return r},Q=(r,t)=>Ji(r,Xi(t)),ze=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const sl=()=>{const{refreshUserData:r}=Fe(),t=_n(),[s,a]=x.useState({activeTab:"basic-info",userData:null,loading:!0,saving:!1,saveSuccess:!1,saveError:null,basicInfoForm:{first_name:"",last_name:"",email:"",phone:"",department:"",position:"",date_of_birth:"",bio:"",preferred_language:"en",timezone:"UTC"},preferences:{theme:"light",notifications:{push:!0,sound:"default",volume:50,email:!0,sms:!1,desktop:!0,mobile:!0,weekly_digest:!0,security_alerts:!0,system_updates:!0,maintenance_notices:!0},privacy:{profile_visibility:"public",show_online_status:!0,allow_direct_messages:!0,data_sharing:!1,analytics_tracking:!0},accessibility:{high_contrast:!1,large_text:!1,screen_reader:!1,keyboard_navigation:!0,reduced_motion:!1}},mobileShortcuts:{quick_scan:!0,emergency_contact:!0,voice_commands:!1,gesture_navigation:!0,haptic_feedback:!0,auto_sync:!0,offline_mode:!1,biometric_login:!1},showPasswordModal:!1,isPasswordReset:!1,passwordError:null,passwordSuccess:null});x.useEffect(()=>{const u=new URLSearchParams(t.search),m=u.get("tab"),f=u.get("openPasswordModal");m&&a(b=>Q(K({},b),{activeTab:m})),f==="true"&&(a(b=>Q(K({},b),{showPasswordModal:!0})),window.history.replaceState({},"","/settings"))},[t.search]);const n=x.useCallback(()=>ze(null,null,function*(){try{a(v=>Q(K({},v),{loading:!0}));const{data:{user:u}}=yield P.auth.getUser();if(!u)return;const m=yield je.fetchUserData(u.id),f=yield je.getActiveSessionsCount(u.id);let b=m.first_name||"",h=m.last_name||"";if(!b&&!h&&m.full_name){const v=m.full_name.split(" ");b=v[0]||"",h=v.slice(1).join(" ")||""}const p=m.email||u.email||"";let _=p;if(!p&&u.email){const v=u.email.split("@")[0];if(v.includes(".")){const j=v.split(".");b=j[0]||b,h=j.slice(1).join(" ")||h}_=u.email}const w=Q(K({},m),{first_name:b,last_name:h,email:_,active_sessions:f});a(v=>Q(K({},v),{userData:w,basicInfoForm:{first_name:b,last_name:h,email:_,phone:m.phone||"",department:m.department||"",position:m.position||"",date_of_birth:m.date_of_birth||"",bio:m.bio||"",preferred_language:m.preferred_language||"en",timezone:m.timezone||"UTC"},loading:!1}))}catch(u){console.error("Error fetching user data:",u),a(m=>Q(K({},m),{loading:!1}))}}),[a]);return{state:s,setState:a,fetchUserData:n,handleSave:()=>ze(null,null,function*(){try{a(m=>Q(K({},m),{saving:!0,saveError:null}));const{data:{user:u}}=yield P.auth.getUser();if(!u)return;yield je.saveProfile(u.id,s.basicInfoForm),a(m=>Q(K({},m),{saving:!1,saveSuccess:!0,saveError:null})),setTimeout(()=>{a(m=>Q(K({},m),{saveSuccess:!1}))},3e3),r()}catch(u){a(m=>Q(K({},m),{saving:!1,saveError:u instanceof Error?u.message:"Failed to save profile"}))}}),handlePasswordChange:u=>ze(null,null,function*(){try{if(a(m=>Q(K({},m),{passwordError:null,passwordSuccess:null})),u.newPassword!==u.confirmPassword){a(m=>Q(K({},m),{passwordError:"Passwords do not match"}));return}s.isPasswordReset?(yield je.resetPassword(u.newPassword),a(m=>Q(K({},m),{passwordSuccess:"Password reset email sent! Check your inbox.",showPasswordModal:!1}))):(yield je.changePassword(u),a(m=>Q(K({},m),{passwordSuccess:"Password changed successfully!",showPasswordModal:!1})))}catch(m){a(f=>Q(K({},f),{passwordError:m instanceof Error?m.message:"Failed to change password"}))}}),handleArchiveAccount:()=>ze(null,null,function*(){try{const{data:{user:u}}=yield P.auth.getUser();if(!u)return;yield je.archiveAccount(u.id),yield P.auth.signOut(),window.location.href="/login"}catch(u){console.error("Error archiving account:",u)}}),uploadProfilePhoto:u=>ze(null,null,function*(){try{const{data:{user:m}}=yield P.auth.getUser();if(!m)return;const f=yield je.uploadProfilePhoto(m.id,u);a(b=>Q(K({},b),{userData:b.userData?Q(K({},b.userData),{avatar_url:f}):null})),r()}catch(m){console.error("Error uploading profile photo:",m)}}),removeProfilePhoto:()=>ze(null,null,function*(){try{const{data:{user:u}}=yield P.auth.getUser();if(!u)return;yield je.removeProfilePhoto(u.id),a(m=>Q(K({},m),{userData:m.userData?Q(K({},m.userData),{avatar_url:null}):null})),r()}catch(u){console.error("Error removing profile photo:",u)}})}},en=x.createContext(void 0),rl=({children:r})=>{const t=sl();return e.jsx(en.Provider,{value:t,children:r})},al=()=>{const r=x.useContext(en);if(r===void 0)throw new Error("useProfileSettingsContext must be used within a ProfileSettingsProvider");return r};var nl=Object.defineProperty,il=Object.defineProperties,ll=Object.getOwnPropertyDescriptors,tr=Object.getOwnPropertySymbols,ol=Object.prototype.hasOwnProperty,cl=Object.prototype.propertyIsEnumerable,sr=(r,t,s)=>t in r?nl(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,de=(r,t)=>{for(var s in t||(t={}))ol.call(t,s)&&sr(r,s,t[s]);if(tr)for(var s of tr(t))cl.call(t,s)&&sr(r,s,t[s]);return r},Ne=(r,t)=>il(r,ll(t));const dl=()=>{const{state:r,setState:t,fetchUserData:s,handleSave:a,handlePasswordChange:n,handleArchiveAccount:l,uploadProfilePhoto:o,removeProfilePhoto:c}=al();x.useEffect(()=>{s()},[s]);const i=[{id:"quick_scan",label:"Quick Scan",description:"Fast barcode scanning"},{id:"emergency_contact",label:"Emergency Contact",description:"Quick access to emergency"},{id:"voice_commands",label:"Voice Commands",description:"Hands-free operation"},{id:"gesture_navigation",label:"Gesture Navigation",description:"Swipe-based navigation"},{id:"haptic_feedback",label:"Haptic Feedback",description:"Touch vibration feedback"},{id:"auto_sync",label:"Auto Sync",description:"Automatic data synchronization"},{id:"offline_mode",label:"Offline Mode",description:"Work without internet"},{id:"biometric_login",label:"Biometric Login",description:"Fingerprint/Face ID login"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(yi,{activeTab:r.activeTab,onTabChange:d=>t(u=>Ne(de({},u),{activeTab:d}))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[r.activeTab==="basic-info"&&e.jsx(wi,{basicInfoForm:r.basicInfoForm,setBasicInfoForm:d=>t(u=>Ne(de({},u),{basicInfoForm:d})),userData:r.userData?{avatar_url:r.userData.avatar_url}:null,uploadingPhoto:r.uploadingPhoto,uploadProfilePhoto:o,removeProfilePhoto:c}),r.activeTab==="preferences"&&e.jsx(Ri,{preferences:{theme:r.preferences.theme,notifications:{push:r.preferences.notifications.push,sound:r.preferences.notifications.sound,volume:r.preferences.notifications.volume,vibration:"medium",vibrationEnabled:!0}},setPreferences:d=>{t(u=>{var m,f,b;return Ne(de({},u),{preferences:Ne(de({},u.preferences),{theme:d.theme,notifications:Ne(de({},u.preferences.notifications),{push:(m=d.notifications)==null?void 0:m.push,sound:(f=d.notifications)==null?void 0:f.sound,volume:(b=d.notifications)==null?void 0:b.volume})})})})}}),r.activeTab==="mobile"&&e.jsx(qi,{mobileShortcuts:Object.entries(r.mobileShortcuts).map(([d,u])=>({[d]:u})),setMobileShortcuts:d=>{const u=d.reduce((m,f)=>de(de({},m),f),{});t(m=>Ne(de({},m),{mobileShortcuts:u}))},availableShortcuts:i}),r.activeTab==="account"&&e.jsx(Vi,{userData:r.userData,onPasswordChange:n,onOpenPasswordModal:()=>t(d=>Ne(de({},d),{showPasswordModal:!0})),onArchiveAccount:l,passwordError:r.passwordError,passwordSuccess:r.passwordSuccess})]}),e.jsx(Qi,{isOpen:r.showPasswordModal,onClose:()=>t(d=>Ne(de({},d),{showPasswordModal:!1})),onSubmit:n,error:r.passwordError,success:r.passwordSuccess,isPasswordReset:r.isPasswordReset})]})},ul=()=>e.jsx(rl,{children:e.jsx(dl,{})});var ml=Object.defineProperty,hl=Object.defineProperties,gl=Object.getOwnPropertyDescriptors,rr=Object.getOwnPropertySymbols,xl=Object.prototype.hasOwnProperty,pl=Object.prototype.propertyIsEnumerable,ar=(r,t,s)=>t in r?ml(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,vt=(r,t)=>{for(var s in t||(t={}))xl.call(t,s)&&ar(r,s,t[s]);if(rr)for(var s of rr(t))pl.call(t,s)&&ar(r,s,t[s]);return r},jt=(r,t)=>hl(r,gl(t)),Nt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const fl=()=>{const[r,t]=x.useState(null),[s,a]=x.useState([]),[n,l]=x.useState(!0),[o,c]=x.useState(!1),[i,d]=x.useState(!1),[u,m]=x.useState({closure_date:"",closure_type:"holiday",description:"",is_recurring:!1});x.useEffect(()=>{Nt(null,null,function*(){try{const v=yield Ut.getCurrentFacilityId();t(v)}catch(v){console.error("Failed to load facility ID:",v)}})},[]);const f=x.useCallback(()=>Nt(null,null,function*(){if(r)try{l(!0);const{data:w,error:v}=yield P.from("office_closures").select("*").eq("facility_id",r).order("closure_date",{ascending:!0});if(v){console.error("Error loading closures:",v);return}a(w.map(j=>{var E;return{id:j.id,closure_date:j.closure_date,closure_type:j.closure_type,description:((E=j.data)==null?void 0:E.description)||"",is_recurring:j.is_recurring}})||[])}catch(w){console.error("Error loading closures:",w)}finally{l(!1)}}),[r]);x.useEffect(()=>{r&&f()},[r,f]);const b=()=>Nt(null,null,function*(){if(!(!r||!u.closure_date))try{c(!0);const{error:w}=yield P.from("office_closures").insert({facility_id:r,closure_date:u.closure_date,closure_type:u.closure_type,description:u.description,is_recurring:u.is_recurring});if(w){console.error("Error adding closure:",w);return}m({closure_date:"",closure_type:"holiday",description:"",is_recurring:!1}),d(!1),f()}catch(w){console.error("Error adding closure:",w)}finally{c(!1)}}),h=w=>Nt(null,null,function*(){try{const{error:v}=yield P.from("office_closures").delete().eq("id",w);if(v){console.error("Error deleting closure:",v);return}f()}catch(v){console.error("Error deleting closure:",v)}}),p=w=>{switch(w){case"holiday":return"Holiday";case"maintenance":return"Maintenance";case"custom":return"Custom";default:return w}},_=w=>{switch(w){case"holiday":return"bg-red-100 text-red-800";case"maintenance":return"bg-yellow-100 text-yellow-800";case"custom":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return n?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-16 bg-gray-200 rounded"}),e.jsx("div",{className:"h-16 bg-gray-200 rounded"})]})]})}):e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"🗓️ Office Closures & Holidays"})]}),e.jsx("button",{onClick:()=>d(!i),className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-lg hover:bg-[#45b8b0] transition-all duration-200 transform hover:scale-105 shadow-sm",children:i?"❌ Cancel":"➕ Add Closure"})]}),i&&e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 p-6 rounded-xl border-2 border-gray-200 space-y-4 mb-6",children:[e.jsx("h6",{className:"text-lg font-semibold text-gray-800 mb-4",children:"➕ Add New Closure"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureDate",className:"block text-sm font-medium text-gray-600 mb-2",children:"📅 Date"}),e.jsx("input",{id:"closureDate",type:"date",value:u.closure_date,onChange:w=>m(v=>jt(vt({},v),{closure_date:w.target.value})),className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureType",className:"block text-sm font-medium text-gray-600 mb-2",children:"🏷️ Type"}),e.jsxs("select",{id:"closureType",value:u.closure_type,onChange:w=>m(v=>jt(vt({},v),{closure_type:w.target.value})),className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:[e.jsx("option",{value:"holiday",children:"🎉 Holiday"}),e.jsx("option",{value:"maintenance",children:"🔧 Maintenance"}),e.jsx("option",{value:"custom",children:"📝 Custom"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"closureDescription",className:"block text-sm font-medium text-gray-600 mb-2",children:"📝 Description"}),e.jsx("input",{id:"closureDescription",type:"text",value:u.description,onChange:w=>m(v=>jt(vt({},v),{description:w.target.value})),placeholder:"e.g., Christmas Day, Annual Maintenance",className:"w-full px-3 py-2 text-sm border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"recurring",checked:u.is_recurring,onChange:w=>m(v=>jt(vt({},v),{is_recurring:w.target.checked})),className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4] h-4 w-4"}),e.jsx("label",{htmlFor:"recurring",className:"text-sm font-medium text-gray-600",children:"🔄 Recurring annually"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:b,disabled:o||!u.closure_date,className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-lg hover:bg-[#45b8b0] disabled:opacity-50 transition-all duration-200 transform hover:scale-105 shadow-sm",children:o?"⏳ Adding...":"✅ Add Closure"}),e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-sm bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-all duration-200 transform hover:scale-105",children:"❌ Cancel"})]})]}),e.jsx("div",{className:"space-y-2",children:s.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No office closures configured. Add holidays and maintenance days above."}):s.map(w=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${_(w.closure_type)}`,children:p(w.closure_type)}),w.is_recurring&&e.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Recurring"})]}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(w.closure_date).toLocaleDateString()}),w.description&&e.jsx("div",{className:"text-sm text-gray-600",children:w.description})]}),e.jsx("button",{onClick:()=>h(w.id),className:"ml-2 p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete closure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},w.id))}),e.jsx("p",{className:"text-xs text-gray-500",children:"Office closures are automatically excluded from streak calculations. Users won't lose their streak on holidays or maintenance days."})]})};var bl=Object.defineProperty,yl=Object.defineProperties,vl=Object.getOwnPropertyDescriptors,nr=Object.getOwnPropertySymbols,jl=Object.prototype.hasOwnProperty,Nl=Object.prototype.propertyIsEnumerable,ir=(r,t,s)=>t in r?bl(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,_t=(r,t)=>{for(var s in t||(t={}))jl.call(t,s)&&ir(r,s,t[s]);if(nr)for(var s of nr(t))Nl.call(t,s)&&ir(r,s,t[s]);return r},Ct=(r,t)=>yl(r,vl(t)),es=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const _l=()=>{const[r,t]=x.useState(null),[s,a]=x.useState(!0),[n,l]=x.useState(!1),[o,c]=x.useState(()=>({workingDays:{monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!0,saturday:!1,sunday:!1},openHolidays:!1,startHour:8,endHour:17}));x.useEffect(()=>{es(null,null,function*(){try{const _=yield Ut.getCurrentFacilityId();t(_)}catch(_){console.error("Failed to load facility ID:",_)}})},[]);const i=x.useCallback(()=>es(null,null,function*(){if(r)try{a(!0);const{data:p,error:_}=yield P.from("facility_office_hours").select("*").eq("facility_id",r).single();if(_&&_.code!=="PGRST116"){console.error("Error loading office hours:",_);return}p&&c({workingDays:p.working_days,startHour:p.start_hour,endHour:p.end_hour,openHolidays:p.open_holidays})}catch(p){console.error("Error loading office hours:",p)}finally{a(!1)}}),[r]);x.useEffect(()=>{r&&i()},[r,i]);const d=p=>es(null,null,function*(){if(r)try{l(!0);const{error:_}=yield P.from("facility_office_hours").upsert({facility_id:r,working_days:p.workingDays,start_hour:p.startHour,end_hour:p.endHour,open_holidays:p.openHolidays});if(_){console.error("Error saving office hours:",_);return}localStorage.setItem("officeHoursSettings",JSON.stringify(p))}catch(_){console.error("Error saving office hours:",_)}finally{l(!1)}}),u=p=>{const _=Ct(_t({},o),{workingDays:Ct(_t({},o.workingDays),{[p]:!o.workingDays[p]})});c(_),d(_)},m=()=>{const p=Ct(_t({},o),{openHolidays:!o.openHolidays});c(p),d(p)},f=(p,_)=>{const w=Ct(_t({},o),{[p==="start"?"startHour":"endHour"]:_});c(w),d(w)},b=p=>{const _=p>=12?"PM":"AM";return`${p===0?12:p>12?p-12:p}:00 ${_}`},h=()=>{const p=Object.entries(o.workingDays).filter(([,_])=>_).map(([_])=>_.charAt(0).toUpperCase()+_.slice(1));return p.length===0?"No days selected":p.length===7?"Every day":p.length===5&&!o.workingDays.saturday&&!o.workingDays.sunday?"Monday - Friday":p.join(", ")};return s?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Office Hours & Scheduling"}),e.jsx("p",{className:"text-sm text-gray-600",children:"These settings affect BI test scheduling, analytics calculations, and streak tracking"}),n&&e.jsx("div",{className:"mt-4 text-sm text-blue-600 bg-blue-50 px-4 py-2 rounded-lg",children:"💾 Saving changes..."})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"📅 Working Days"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-3 mb-4",children:Object.entries(o.workingDays).map(([p,_])=>e.jsxs("button",{onClick:()=>u(p),className:`p-4 text-center rounded-xl font-medium transition-all duration-200 transform hover:scale-105 ${_?"bg-[#4ECDC4] text-white shadow-lg shadow-[#4ECDC4]/25":"bg-gray-50 text-gray-600 hover:bg-gray-100 border-2 border-gray-200"}`,children:[e.jsx("div",{className:"text-sm font-bold",children:p.charAt(0).toUpperCase()}),e.jsx("div",{className:"text-xs opacity-75",children:p.slice(0,3)})]},p))}),e.jsx("div",{className:"bg-[#4ECDC4] bg-opacity-10 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-[#4ECDC4] font-medium",children:["✅ Selected: ",h()]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"⏰ Hours of Operation"})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"Start Time"}),e.jsx("select",{value:o.startHour,onChange:p=>f("start",parseInt(p.target.value)),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] text-lg font-semibold bg-white shadow-sm",children:Array.from({length:24},(p,_)=>e.jsx("option",{value:_,children:b(_)},_))})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-2xl text-[#4ECDC4] font-bold",children:"→"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"to"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-3",children:"End Time"}),e.jsx("select",{value:o.endHour,onChange:p=>f("end",parseInt(p.target.value)),className:"px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] text-lg font-semibold bg-white shadow-sm",children:Array.from({length:24},(p,_)=>e.jsx("option",{value:_,children:b(_)},_))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-10 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-[#4ECDC4]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9"})})}),e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:"🎉 Holiday Operations"})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"text-4xl",children:o.openHolidays?"🎊":"🏠"}),e.jsxs("div",{children:[e.jsx("h6",{className:"text-lg font-semibold text-gray-800",children:o.openHolidays?"Open on holidays":"Closed on holidays"}),e.jsx("p",{className:"text-sm text-gray-600",children:o.openHolidays?"BI tests and operations will continue on holidays":"BI tests due on holidays will be rescheduled to the next business day"})]})]}),e.jsx("button",{onClick:m,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-[#4ECDC4]/20 ${o.openHolidays?"bg-[#4ECDC4] shadow-lg shadow-[#4ECDC4]/25":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-all duration-300 shadow-lg ${o.openHolidays?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h6",{className:"text-lg font-semibold text-blue-800",children:"📋 Current Schedule Summary"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Working Days"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:h()})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Hours"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[b(o.startHour)," - ",b(o.endHour)]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"Holidays"}),e.jsx("div",{className:"text-lg font-semibold text-gray-800",children:o.openHolidays?"Open":"Closed"})]})]})]}),e.jsx(fl,{})]})};var _e=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class Cl{getUsers(t){return _e(this,null,function*(){const{data:s,error:a}=yield P.from("users").select("*").eq("facility_id",t).is("deleted_at",null).or("is_active.is.null,is_active.eq.true");if(a)throw console.error("UserRoleService.getUsers error:",a),new Error(a.message);if(console.log("🔍 UserRoleService.getUsers - Raw data:",s),console.log("🔍 UserRoleService.getUsers - First user data:",s==null?void 0:s[0]),s&&s.length>0){const n=s.map(o=>o.id),l=[...new Set(n)];if(console.log("🔍 UserRoleService.getUsers - Total users:",s.length),console.log("🔍 UserRoleService.getUsers - Unique IDs:",l.length),console.log("🔍 UserRoleService.getUsers - All IDs:",n),n.length!==l.length){console.warn("⚠️ DUPLICATE USER IDs DETECTED!");const o=n.filter((c,i)=>n.indexOf(c)!==i);console.warn("⚠️ Duplicate IDs:",[...new Set(o)])}}return s!=null?s:[]})}getRoles(t){return _e(this,null,function*(){const{data:s,error:a}=yield P.from("users").select("role").eq("facility_id",t).or("is_active.is.null,is_active.eq.true");if(a)throw new Error(a.message);return[...new Set((s==null?void 0:s.map(l=>l.role))||[])].map((l,o)=>({id:`role-${o}`,facility_id:t,role_name:l,description:`${l} role`,is_default:l==="user",created_at:new Date().toISOString()}))})}getUserRoles(t){return _e(this,null,function*(){const{data:s,error:a}=yield P.from("users").select("id, facility_id, role, created_at").eq("facility_id",t).or("is_active.is.null,is_active.eq.true");if(a)throw new Error(a.message);return(s!=null?s:[]).map(n=>({id:n.id,user_id:n.id,facility_id:n.facility_id,role_id:n.role,assigned_at:n.created_at}))})}assignUserRole(t,s,a){return _e(this,null,function*(){const{error:n}=yield P.from("users").update({role:a}).eq("id",t).eq("facility_id",s);if(n)throw new Error(n.message)})}softDeleteUser(t,s){return _e(this,null,function*(){const{error:a}=yield P.from("users").update({is_active:!1,deleted_at:new Date().toISOString()}).eq("id",t).eq("facility_id",s);if(a)throw new Error(a.message)})}restoreUser(t,s){return _e(this,null,function*(){const{error:a}=yield P.from("users").update({is_active:!0,deleted_at:null}).eq("id",t).eq("facility_id",s);if(a)throw new Error(a.message)})}updateUserName(t,s,a){return _e(this,null,function*(){const{error:n}=yield P.from("users").update({first_name:s,last_name:a,updated_at:new Date().toISOString()}).eq("id",t);if(n)throw console.error("UserRoleService.updateUserName error:",n),new Error(n.message);console.log(`✅ Updated user ${t} name to: ${s} ${a}`)})}cleanupDuplicateUsers(t){return _e(this,null,function*(){const{data:s,error:a}=yield P.from("users").select("*").eq("facility_id",t).is("deleted_at",null).or("is_active.is.null,is_active.eq.true");if(a)throw console.error("UserRoleService.cleanupDuplicateUsers error:",a),new Error(a.message);if(!s||s.length===0)return;const n=s.reduce((o,c)=>(o[c.id]||(o[c.id]=[]),o[c.id].push(c),o),{}),l=Object.entries(n).filter(([o,c])=>c.length>1);if(l.length===0){console.log("✅ No duplicate users found");return}console.log(`🔍 Found ${l.length} duplicate user IDs`);for(const[o,c]of l){c.sort((u,m)=>{const f=new Date(u.created_at||0).getTime();return new Date(m.created_at||0).getTime()-f});const i=c[0],d=c.slice(1);console.log(`🔍 Keeping user ${o} (created: ${i.created_at})`);for(const u of d)yield this.softDeleteUser(u.id,t),console.log(`🗑️ Soft-deleted duplicate user ${u.id}`)}console.log("✅ Duplicate cleanup completed")})}}const et=new Cl;var tt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const wl=ai(r=>({users:[],roles:[],userRoles:[],loading:!1,error:null,fetchUsers(t){return tt(this,null,function*(){r({loading:!0,error:null});try{const s=yield et.getUsers(t);console.log("🔍 Store.fetchUsers - Received users:",s),console.log("🔍 Store.fetchUsers - First user:",s[0]),r({users:s,loading:!1})}catch(s){console.error("🔍 Store.fetchUsers - Error:",s),r({error:s instanceof Error?s.message:String(s),loading:!1})}})},fetchRoles(t){return tt(this,null,function*(){r({loading:!0,error:null});try{const s=yield et.getRoles(t);r({roles:s,loading:!1})}catch(s){r({error:s instanceof Error?s.message:String(s),loading:!1})}})},fetchUserRoles(t){return tt(this,null,function*(){r({loading:!0,error:null});try{const s=yield et.getUserRoles(t);r({userRoles:s,loading:!1})}catch(s){r({error:s instanceof Error?s.message:String(s),loading:!1})}})},assignRole(t,s,a){return tt(this,null,function*(){r({loading:!0});try{yield et.assignUserRole(t,s,a),yield this.fetchUserRoles(s),r({loading:!1})}catch(n){r({error:n instanceof Error?n.message:String(n),loading:!1})}})},removeRole(t,s,a){return tt(this,null,function*(){r({loading:!0});try{yield et.softDeleteUser(t,s),yield this.fetchUserRoles(s),r({loading:!1})}catch(n){r({error:n instanceof Error?n.message:String(n),loading:!1})}})},clearRoles(){r({users:[],roles:[],userRoles:[],error:null,loading:!1})}}));var Sl=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function El(r){const{users:t,roles:s,userRoles:a,loading:n,error:l,fetchUsers:o,fetchRoles:c,fetchUserRoles:i,assignRole:d,removeRole:u,clearRoles:m}=wl(),f=x.useCallback(()=>Sl(null,null,function*(){yield Promise.all([o(r),c(r),i(r)])}),[r,o,c,i]);return x.useEffect(()=>(f(),()=>m()),[r,f,m]),{users:t,roles:s,userRoles:a,loading:n,error:l,assignRole:d,removeRole:u,reload:f}}var Ce=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class Tl{constructor(){this.TIER_LIMITS={tier1:5,tier2:15,tier3:21,tier4:999999},this.TIER_NAMES={tier1:"0-5 Users",tier2:"6-15 Users",tier3:"16-21 Users",tier4:"21+ Users"}}checkTierLimits(t){return Ce(this,null,function*(){try{const{data:s,error:a}=yield P.from("users").select("id").eq("facility_id",t).is("deleted_at",null).or("is_active.is.null,is_active.eq.true");if(a)throw new Error(`Failed to get user count: ${a.message}`);const n=(s==null?void 0:s.length)||0;let l,o;return n>=0&&n<=5?(l="tier1",o=this.TIER_LIMITS.tier1):n>=6&&n<=15?(l="tier2",o=this.TIER_LIMITS.tier2):n>=16&&n<=21?(l="tier3",o=this.TIER_LIMITS.tier3):(l="tier4",o=this.TIER_LIMITS.tier4),{canAdd:n<o,currentCount:n,limit:o,tier:this.TIER_NAMES[l]}}catch(s){throw console.error("Error checking tier limits:",s),s}})}sendInvitation(t,s){return Ce(this,null,function*(){try{const a=yield fetch("/api/auth/invite-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,userData:s})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return yield a.json()}catch(a){throw console.error("Error sending invitation:",a),a}})}createInvitation(t){return Ce(this,null,function*(){try{const{data:s,error:a}=yield P.from("user_invitations").insert({email:t.email,facility_id:t.facility_id,invited_by:t.invited_by,role:t.role,permissions:t.permissions,status:"pending",expires_at:new Date(Date.now()+6048e5).toISOString()}).select().single();if(a)throw new Error(`Failed to create invitation: ${a.message}`);return s}catch(s){throw console.error("Error creating invitation:",s),s}})}getInvitations(t){return Ce(this,null,function*(){try{const{data:s,error:a}=yield P.from("user_invitations").select("*").eq("facility_id",t).order("created_at",{ascending:!1});if(a)throw new Error(`Failed to get invitations: ${a.message}`);return s||[]}catch(s){throw console.error("Error getting invitations:",s),s}})}updateInvitationStatus(t,s){return Ce(this,null,function*(){try{const a={status:s};s==="accepted"&&(a.accepted_at=new Date().toISOString());const{error:n}=yield P.from("user_invitations").update(a).eq("id",t);if(n)throw new Error(`Failed to update invitation: ${n.message}`)}catch(a){throw console.error("Error updating invitation:",a),a}})}cancelInvitation(t){return Ce(this,null,function*(){try{const{error:s}=yield P.from("user_invitations").update({status:"cancelled"}).eq("id",t);if(s)throw new Error(`Failed to cancel invitation: ${s.message}`)}catch(s){throw console.error("Error cancelling invitation:",s),s}})}resendInvitation(t){return Ce(this,null,function*(){try{const{data:s,error:a}=yield P.from("user_invitations").select("*").eq("id",t).single();if(a)throw new Error(`Failed to get original invitation: ${a.message}`);return yield this.cancelInvitation(t),yield this.createInvitation({email:s.email,facility_id:s.facility_id,invited_by:s.invited_by,role:s.role,permissions:s.permissions})}catch(s){throw console.error("Error resending invitation:",s),s}})}cleanupUserInvitations(t,s){return Ce(this,null,function*(){try{const{error:a}=yield P.from("user_invitations").update({status:"cancelled"}).eq("invited_by",t).eq("facility_id",s).eq("status","pending");if(a)throw new Error(`Failed to cleanup invitations: ${a.message}`)}catch(a){throw console.error("Error cleaning up user invitations:",a),a}})}}const st=new Tl;var qe=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class Pl{getRoles(t){return qe(this,null,function*(){try{const{data:s,error:a}=yield P.from("custom_roles").select("*").eq("facility_id",t).order("is_default",{ascending:!1}).order("created_at",{ascending:!0});if(a)throw new Error(`Failed to get roles: ${a.message}`);return s||[]}catch(s){throw console.error("Error getting roles:",s),s}})}createRole(t){return qe(this,null,function*(){try{const{data:s,error:a}=yield P.from("custom_roles").insert({name:t.name,description:t.description,permissions:t.permissions,facility_id:t.facility_id,created_by:t.created_by,is_default:!1}).select().single();if(a)throw new Error(`Failed to create role: ${a.message}`);return s}catch(s){throw console.error("Error creating role:",s),s}})}updateRole(t,s){return qe(this,null,function*(){try{const{data:a,error:n}=yield P.from("custom_roles").update({name:s.name,description:s.description,permissions:s.permissions,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(n)throw new Error(`Failed to update role: ${n.message}`);return a}catch(a){throw console.error("Error updating role:",a),a}})}deleteRole(t){return qe(this,null,function*(){try{const{data:s,error:a}=yield P.from("custom_roles").select("is_default").eq("id",t).single();if(a)throw new Error(`Failed to check role: ${a.message}`);if(s.is_default)throw new Error("Cannot delete default roles");const{data:n,error:l}=yield P.from("users").select("id").eq("role",t).limit(1);if(l)throw new Error(`Failed to check role usage: ${l.message}`);if(n&&n.length>0)throw new Error("Cannot delete role that is currently assigned to users");const{error:o}=yield P.from("custom_roles").delete().eq("id",t);if(o)throw new Error(`Failed to delete role: ${o.message}`)}catch(s){throw console.error("Error deleting role:",s),s}})}getDefaultRoles(){return[{id:"administrator",name:"👑 Administrator",description:"Full system access",permissions:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!0,assign_roles:!0,view_user_activity:!0,system_settings:!0,facility_settings:!0,security_settings:!0,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0},facility_id:"",is_default:!0,created_by:"",created_at:"",updated_at:""},{id:"manager",name:"👨‍💼 Manager",description:"Department management",permissions:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!0,view_user_activity:!0,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0},facility_id:"",is_default:!0,created_by:"",created_at:"",updated_at:""},{id:"technician",name:"🔧 Technician",description:"Task execution",permissions:{view_dashboard:!0,view_analytics:!1,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!1},facility_id:"",is_default:!0,created_by:"",created_at:"",updated_at:""},{id:"viewer",name:"👀 Viewer",description:"Read-only access",permissions:{view_dashboard:!0,view_analytics:!0,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!1,edit_tasks:!1,delete_tasks:!1,assign_tasks:!1},facility_id:"",is_default:!0,created_by:"",created_at:"",updated_at:""},{id:"trainer",name:"📚 Trainer",description:"Content management",permissions:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!0},facility_id:"",is_default:!0,created_by:"",created_at:"",updated_at:""}]}getAllRoles(t){return qe(this,null,function*(){try{const s=this.getDefaultRoles(),a=yield this.getRoles(t);return[...s,...a]}catch(s){throw console.error("Error getting all roles:",s),s}})}isRoleNameUnique(t,s,a){return qe(this,null,function*(){try{let n=P.from("custom_roles").select("id").eq("facility_id",t).eq("name",s);a&&(n=n.neq("id",a));const{data:l,error:o}=yield n;if(o)throw new Error(`Failed to check role name: ${o.message}`);return!l||l.length===0}catch(n){throw console.error("Error checking role name uniqueness:",n),n}})}}const ts=new Pl;var Il=Object.defineProperty,Al=Object.defineProperties,Ol=Object.getOwnPropertyDescriptors,lr=Object.getOwnPropertySymbols,Dl=Object.prototype.hasOwnProperty,kl=Object.prototype.propertyIsEnumerable,or=(r,t,s)=>t in r?Il(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,X=(r,t)=>{for(var s in t||(t={}))Dl.call(t,s)&&or(r,s,t[s]);if(lr)for(var s of lr(t))kl.call(t,s)&&or(r,s,t[s]);return r},ee=(r,t)=>Al(r,Ol(t)),Ue=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function Rl(){const{currentUser:r}=Fe(),t=(r==null?void 0:r.facility_id)||"550e8400-e29b-41d4-a716-446655440000",{users:s,loading:a,error:n,assignRole:l,removeRole:o,reload:c}=El(t),[i,d]=x.useState(""),[u,m]=x.useState(null),[f,b]=x.useState(!1),[h,p]=x.useState(!1),[_,w]=x.useState(!1),[v,j]=x.useState(null),[E,k]=x.useState(null),[A,V]=x.useState({name:"",description:"",permissions:{}}),[$,G]=x.useState(null),[D,S]=x.useState({first_name:"",last_name:"",email:"",role:"",permissions:{}}),[L,H]=x.useState({first_name:"",last_name:"",email:"",role:"",permissions:{}}),C=s.filter(g=>{var I,R,q;if(!i.trim())return!0;const ve=i.toLowerCase(),Pe=((I=g.first_name)==null?void 0:I.toLowerCase())||"",ft=((R=g.last_name)==null?void 0:R.toLowerCase())||"",bt=((q=g.email)==null?void 0:q.toLowerCase())||"";return Pe.includes(ve)||ft.includes(ve)||bt.includes(ve)});if(x.useEffect(()=>{if(n&&console.error("User Management error:",n),console.log("🔍 Debug - All users:",s),console.log("🔍 Debug - Filtered users:",C),console.log("🔍 Debug - Search term:",i),s.length>0){const g=s[0];console.log("🔍 Debug - First user name fields:",{id:g.id,first_name:g.first_name,last_name:g.last_name,email:g.email,full_name:g.full_name})}},[n,s,C,i]),x.useEffect(()=>{Ue(null,null,function*(){try{const I=yield st.checkTierLimits(t);G(I)}catch(I){console.error("Error fetching tier info:",I)}})},[t,s.length]),a)return e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading user management data..."})]});if(n)return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("p",{className:"text-red-600",children:["Error loading user data: ",n]})});const O=g=>{m(g),H({first_name:g.first_name||"",last_name:g.last_name||"",email:g.email||"",role:g.role||"",permissions:g.permissions||{}})},T=g=>{const I=se(g);H(ee(X({},L),{role:g,permissions:I}))},F=(g,I)=>{const R=ee(X({},L.permissions),{[g]:I}),q=ge(R);H(ee(X({},L),{role:q||"custom",permissions:R}))},se=g=>({administrator:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!0,assign_roles:!0,view_user_activity:!0,system_settings:!0,facility_settings:!0,security_settings:!0,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0},manager:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!0,view_user_activity:!0,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!0,assign_tasks:!0},technician:{view_dashboard:!0,view_analytics:!1,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!1},viewer:{view_dashboard:!0,view_analytics:!0,export_data:!1,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!1,security_settings:!1,create_tasks:!1,edit_tasks:!1,delete_tasks:!1,assign_tasks:!1},trainer:{view_dashboard:!0,view_analytics:!0,export_data:!0,manage_users:!1,assign_roles:!1,view_user_activity:!1,system_settings:!1,facility_settings:!0,security_settings:!1,create_tasks:!0,edit_tasks:!0,delete_tasks:!1,assign_tasks:!0},custom:{}})[g]||{},ge=g=>{const I=["administrator","manager","technician","viewer","trainer"];for(const R of I){const q=se(R);if(Object.keys(q).every(Pe=>g[Pe]===q[Pe]))return R}return null},z=g=>{j(g),w(!0)},B=()=>Ue(null,null,function*(){if(v)try{yield o(v.id,t,v.role),yield st.cleanupUserInvitations(v.id,t),alert(`User ${v.first_name} ${v.last_name} has been removed from the facility.`),w(!1),j(null),yield c()}catch(g){console.error("Error deleting user:",g),alert(`Failed to remove user: ${g instanceof Error?g.message:"Unknown error"}`)}}),W=()=>{w(!1),j(null)},ie=()=>Ue(null,null,function*(){if(u)try{yield l(u.id,t,L.role),m(null),yield c()}catch(g){console.error("Error updating user:",g)}}),As=()=>{m(null),H({first_name:"",last_name:"",email:"",role:"",permissions:{}})},Te=()=>{b(!0),S({first_name:"",last_name:"",email:"",role:"",permissions:{}})},un=()=>{b(!1),S({first_name:"",last_name:"",email:"",role:"",permissions:{}})},mn=()=>Ue(null,null,function*(){if(!D.first_name||!D.last_name||!D.email||!D.role){alert("Please fill in all required fields");return}try{const g=yield st.checkTierLimits(t);if(!g.canAdd){alert(`You've reached the user limit for your ${g.tier} tier (${g.currentCount}/${g.limit}). Please upgrade your plan to add more users.`);return}const I={first_name:D.first_name,last_name:D.last_name,facility_id:t,role:D.role,permissions:D.permissions},{data:R,error:q}=yield st.sendInvitation(D.email,I);if(q){console.error("Invitation error:",q),alert(`Failed to send invitation: ${q instanceof Error?q.message:String(q)}`);return}const ve=yield st.createInvitation({email:D.email,facility_id:t,invited_by:(r==null?void 0:r.id)||"",role:D.role,permissions:D.permissions});alert(`Invitation sent successfully to ${D.email}! They will receive an email to complete their registration.`),b(!1),yield c()}catch(g){console.error("Error adding user:",g),alert("An error occurred while sending the invitation. Please try again.")}}),hn=g=>{const I=se(g);S(ee(X({},D),{role:g,permissions:I}))},xt=(g,I)=>{const R=ee(X({},D.permissions),{[g]:I}),q=ge(R);S(ee(X({},D),{role:q||"custom",permissions:R}))},gn=()=>{p(!0),k(null),V({name:"",description:"",permissions:{}})},xn=g=>{k(g),V({name:g.role_name||"",description:g.description||"",permissions:g.permissions||{}})},pn=()=>{k(null),V({name:"",description:"",permissions:{}})},fn=()=>Ue(null,null,function*(){if(!A.name.trim()){alert("Please enter a role name");return}try{E&&E.id?yield ts.updateRole(E.id,{name:A.name,description:A.description,permissions:A.permissions,facility_id:t,created_by:(r==null?void 0:r.id)||""}):yield ts.createRole({name:A.name,description:A.description,permissions:A.permissions,facility_id:t,created_by:(r==null?void 0:r.id)||""}),alert(`Role ${E?"updated":"created"} successfully!`),p(!1),yield c()}catch(g){console.error("Error saving role:",g),alert(`Failed to ${E?"update":"create"} role: ${g instanceof Error?g.message:"Unknown error"}`)}}),bn=g=>Ue(null,null,function*(){if(window.confirm(`Are you sure you want to delete the role "${g.role_name}"? This action cannot be undone.`))try{yield ts.deleteRole(g.id),alert("Role deleted successfully!"),yield c()}catch(I){console.error("Error deleting role:",I),alert(`Failed to delete role: ${I instanceof Error?I.message:"Unknown error"}`)}}),yn=()=>{p(!1),k(null),V({name:"",description:"",permissions:{}})},pt=(g,I)=>{V(ee(X({},A),{permissions:ee(X({},A.permissions),{[g]:I})}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsxs("button",{onClick:c,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(y,{path:$t,size:.8,className:"mr-2"}),"Refresh"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(y,{path:Dt,size:1,className:"text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.length})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(y,{path:Dt,size:1,className:"text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s.filter(g=>g.is_active!==!1).length})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-[#4ECDC4] bg-opacity-20 rounded-lg",children:e.jsx(y,{path:re,size:1,className:"text-[#4ECDC4]"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Plan Tier"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 capitalize",children:$?$.tier:"Loading..."}),e.jsx("p",{className:"text-xs text-gray-500",children:$?`${$.currentCount}/${$.limit===999999?"∞":$.limit} users`:"Loading..."})]})]})})]}),$&&(()=>{const g=$.currentCount/$.limit*100;return g>=80&&g<100?e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(y,{path:re,size:1,className:"text-yellow-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Approaching Tier Limit"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["You're using ",$.currentCount," users on your ",$.tier," tier. Consider upgrading to add more team members."]})]})]})}):g>=100?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(y,{path:re,size:1,className:"text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Tier Limit Reached"}),e.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["You've reached the maximum number of users (",$.limit,") for your ",$.tier," tier. Upgrade your plan to add more team members."]})]})]})}):null})(),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Team Directory"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:g=>d(g.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsxs("button",{onClick:Te,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(y,{path:ye,size:.8,className:"mr-2"}),"Add User"]}),e.jsxs("button",{onClick:gn,className:"flex items-center px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3BB5B0] transition-colors",children:[e.jsx(y,{path:re,size:.8,className:"mr-2"}),"Manage Roles"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(g=>{var I,R;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full overflow-hidden flex items-center justify-center",children:g.avatar_url?e.jsx("img",{src:g.avatar_url,alt:`${g.first_name} ${g.last_name}`,className:"h-10 w-10 object-cover rounded-full",onError:q=>{var ve,Pe;const ft=q.target;ft.style.display="none";const bt=ft.parentElement;if(bt){const Os=((ve=g.first_name)==null?void 0:ve[0])||"",vn=((Pe=g.last_name)==null?void 0:Pe[0])||"",jn=Os+vn||"?";bt.innerHTML=`
                                  <div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                                    <span class="text-sm font-medium text-blue-600">
                                      ${jn}
                                    </span>
                                  </div>
                                `}}}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:(((I=g.first_name)==null?void 0:I[0])||"")+(((R=g.last_name)==null?void 0:R[0])||"")||"?"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.first_name||g.last_name?`${g.first_name||""} ${g.last_name||""}`.trim():g.email||"Unknown User"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",g.id.slice(0,8),"..."]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g.role==="admin"?"bg-red-100 text-red-800":g.role==="manager"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:g.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${g.is_active===!1?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:g.is_active===!1?"Inactive":"Active"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>O(g),className:"text-blue-600 hover:text-blue-900 p-1 rounded hover:bg-blue-50",title:"Edit user",children:e.jsx(y,{path:ke,size:.8})}),e.jsx("button",{onClick:()=>z(g),className:"text-red-600 hover:text-red-900 p-1 rounded hover:bg-red-50",title:"Delete user",children:e.jsx(y,{path:Rt,size:.8})})]})})]},g.id)})})]})}),C.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No users found matching your search."})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-hide flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6",children:["Edit User: ",u.first_name," ",u.last_name]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",value:L.first_name,onChange:g=>H(ee(X({},L),{first_name:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",value:L.last_name,onChange:g=>H(ee(X({},L),{last_name:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:L.email,onChange:g=>H(ee(X({},L),{email:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"👤 User Role"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{id:"administrator",name:"👑 Administrator",desc:"Full system access"},{id:"manager",name:"👨‍💼 Manager",desc:"Department management"},{id:"technician",name:"🔧 Technician",desc:"Task execution"},{id:"viewer",name:"👀 Viewer",desc:"Read-only access"},{id:"trainer",name:"📚 Trainer",desc:"Content management"},{id:"custom",name:"➕ Custom",desc:"Manual permissions"}].map(g=>e.jsxs("button",{onClick:()=>T(g.id),className:`p-3 rounded-lg border text-left transition-colors ${L.role===g.id?"border-teal-500 bg-teal-50 text-teal-700":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:g.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:g.desc})]},g.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"🔐 Permissions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📊 Dashboard Access"}),e.jsx("div",{className:"space-y-2",children:[{id:"view_dashboard",label:"View Dashboard",desc:"Access main dashboard"},{id:"view_analytics",label:"View Analytics",desc:"Access reports and analytics"},{id:"export_data",label:"Export Data",desc:"Download reports and data"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=L.permissions)==null?void 0:I[g.id])||!1,onChange:q=>F(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=L.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"👥 User Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"manage_users",label:"Manage Users",desc:"Add, edit, remove users"},{id:"assign_roles",label:"Assign Roles",desc:"Change user roles and permissions"},{id:"view_user_activity",label:"View User Activity",desc:"Monitor user actions"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=L.permissions)==null?void 0:I[g.id])||!1,onChange:q=>F(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=L.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"⚙️ System Settings"}),e.jsx("div",{className:"space-y-2",children:[{id:"system_settings",label:"System Settings",desc:"Modify system configuration"},{id:"facility_settings",label:"Facility Settings",desc:"Manage facility preferences"},{id:"security_settings",label:"Security Settings",desc:"Configure security policies"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=L.permissions)==null?void 0:I[g.id])||!1,onChange:q=>F(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=L.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📋 Task Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"create_tasks",label:"Create Tasks",desc:"Create new tasks and assignments"},{id:"edit_tasks",label:"Edit Tasks",desc:"Modify existing tasks"},{id:"delete_tasks",label:"Delete Tasks",desc:"Remove tasks and assignments"},{id:"assign_tasks",label:"Assign Tasks",desc:"Assign tasks to team members"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=L.permissions)==null?void 0:I[g.id])||!1,onChange:q=>F(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=L.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 pt-4 border-t bg-white sticky bottom-0 z-10",children:[e.jsx("button",{onClick:As,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 bg-white",children:"Cancel"}),e.jsx("button",{onClick:ie,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3BB5B0] border border-[#4ECDC4]",children:"Save Changes"})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-hide flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Add New User"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",value:D.first_name,onChange:g=>S(ee(X({},D),{first_name:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter first name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",value:D.last_name,onChange:g=>S(ee(X({},D),{last_name:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter last name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:D.email,onChange:g=>S(ee(X({},D),{email:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter email address"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"👤 User Role"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{id:"administrator",name:"👑 Administrator",desc:"Full system access"},{id:"manager",name:"👨‍💼 Manager",desc:"Department management"},{id:"technician",name:"🔧 Technician",desc:"Task execution"},{id:"viewer",name:"👀 Viewer",desc:"Read-only access"},{id:"trainer",name:"📚 Trainer",desc:"Content management"},{id:"custom",name:"➕ Custom",desc:"Manual permissions"}].map(g=>e.jsxs("button",{onClick:()=>hn(g.id),className:`p-3 rounded-lg border text-left transition-colors ${D.role===g.id?"border-teal-500 bg-teal-50 text-teal-700":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:g.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:g.desc})]},g.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"🔐 Permissions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📊 Dashboard Access"}),e.jsx("div",{className:"space-y-2",children:[{id:"view_dashboard",label:"View Dashboard",desc:"Access main dashboard"},{id:"view_analytics",label:"View Analytics",desc:"Access reports and analytics"},{id:"export_data",label:"Export Data",desc:"Download reports and data"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=D.permissions)==null?void 0:I[g.id])||!1,onChange:q=>xt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=D.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"👥 User Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"manage_users",label:"Manage Users",desc:"Add, edit, remove users"},{id:"assign_roles",label:"Assign Roles",desc:"Change user roles and permissions"},{id:"view_user_activity",label:"View User Activity",desc:"Monitor user actions"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=D.permissions)==null?void 0:I[g.id])||!1,onChange:q=>xt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=D.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"⚙️ System Settings"}),e.jsx("div",{className:"space-y-2",children:[{id:"system_settings",label:"System Settings",desc:"Modify system configuration"},{id:"facility_settings",label:"Facility Settings",desc:"Manage facility preferences"},{id:"security_settings",label:"Security Settings",desc:"Configure security policies"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=D.permissions)==null?void 0:I[g.id])||!1,onChange:q=>xt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=D.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📋 Task Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"create_tasks",label:"Create Tasks",desc:"Create new tasks and assignments"},{id:"edit_tasks",label:"Edit Tasks",desc:"Modify existing tasks"},{id:"delete_tasks",label:"Delete Tasks",desc:"Remove tasks and assignments"},{id:"assign_tasks",label:"Assign Tasks",desc:"Assign tasks to team members"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=D.permissions)==null?void 0:I[g.id])||!1,onChange:q=>xt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=D.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 pt-4 border-t bg-white sticky bottom-0 z-10",children:[e.jsx("button",{onClick:un,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 bg-white",children:"Cancel"}),e.jsx("button",{onClick:mn,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3BB5B0] border border-[#4ECDC4]",children:"Add User"})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 overflow-y-auto scrollbar-hide flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:E?`Edit Role: ${E.role_name}`:"Role Management"}),e.jsxs("button",{onClick:pn,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3BB5B0] flex items-center gap-2",children:[e.jsx(y,{path:ye,size:.8}),"Create New Role"]})]}),!E&&e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"📋 Current Roles"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"administrator",role_name:"👑 Administrator",description:"Full system access",isDefault:!0,facility_id:t},{id:"manager",role_name:"👨‍💼 Manager",description:"Department management",isDefault:!0,facility_id:t},{id:"technician",role_name:"🔧 Technician",description:"Task execution",isDefault:!0,facility_id:t},{id:"viewer",role_name:"👀 Viewer",description:"Read-only access",isDefault:!0,facility_id:t},{id:"trainer",role_name:"📚 Trainer",description:"Content management",isDefault:!0,facility_id:t},{id:"custom",role_name:"➕ Custom",description:"Manual permissions",isDefault:!1,facility_id:t}].map(g=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-sm",children:g.role_name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g.description}),g.isDefault&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Default"})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:()=>xn(g),className:"p-1 text-gray-500 hover:text-gray-700",title:"Edit Role",children:e.jsx(y,{path:ke,size:.8})}),!g.isDefault&&e.jsx("button",{onClick:()=>bn(g),className:"p-1 text-red-500 hover:text-red-700",title:"Delete Role",children:e.jsx(y,{path:Rt,size:.8})})]})]})},g.id))})]}),E&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Name *"}),e.jsx("input",{type:"text",value:A.name,onChange:g=>V(ee(X({},A),{name:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter role name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:A.description,onChange:g=>V(ee(X({},A),{description:g.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter role description"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-semibold mb-4",children:"🔐 Role Permissions"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📊 Dashboard Access"}),e.jsx("div",{className:"space-y-2",children:[{id:"view_dashboard",label:"View Dashboard",desc:"Access main dashboard"},{id:"view_analytics",label:"View Analytics",desc:"Access reports and analytics"},{id:"export_data",label:"Export Data",desc:"Download reports and data"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=A.permissions)==null?void 0:I[g.id])||!1,onChange:q=>pt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=A.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"👥 User Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"manage_users",label:"Manage Users",desc:"Add, edit, remove users"},{id:"assign_roles",label:"Assign Roles",desc:"Change user roles and permissions"},{id:"view_user_activity",label:"View User Activity",desc:"Monitor user actions"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=A.permissions)==null?void 0:I[g.id])||!1,onChange:q=>pt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=A.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"⚙️ System Settings"}),e.jsx("div",{className:"space-y-2",children:[{id:"system_settings",label:"System Settings",desc:"Modify system configuration"},{id:"facility_settings",label:"Facility Settings",desc:"Manage facility preferences"},{id:"security_settings",label:"Security Settings",desc:"Configure security policies"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=A.permissions)==null?void 0:I[g.id])||!1,onChange:q=>pt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=A.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"📋 Task Management"}),e.jsx("div",{className:"space-y-2",children:[{id:"create_tasks",label:"Create Tasks",desc:"Create new tasks and assignments"},{id:"edit_tasks",label:"Edit Tasks",desc:"Modify existing tasks"},{id:"delete_tasks",label:"Delete Tasks",desc:"Remove tasks and assignments"},{id:"assign_tasks",label:"Assign Tasks",desc:"Assign tasks to team members"}].map(g=>{var I,R;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:g.label}),e.jsx("div",{className:"text-xs text-gray-500",children:g.desc})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((I=A.permissions)==null?void 0:I[g.id])||!1,onChange:q=>pt(g.id,q.target.checked),className:"sr-only peer"}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${(R=A.permissions)!=null&&R[g.id]?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`})]})]},g.id)})})]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 pt-4 border-t bg-white sticky bottom-0 z-10",children:[e.jsx("button",{onClick:yn,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 bg-white",children:E?"Back to Roles":"Close"}),E&&e.jsx("button",{onClick:fn,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3BB5B0] border border-[#4ECDC4]",children:E.id?"Update Role":"Create Role"})]})]})}),_&&v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Remove Team Member"}),e.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone."})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Are you sure you want to remove ",e.jsxs("strong",{children:[v.first_name," ",v.last_name]})," from your facility? They will lose access to all facility data and will need to be re-invited to regain access."]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:W,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:"Cancel"}),e.jsx("button",{onClick:B,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Remove User"})]})]})})]})}const $l=({user:r,mode:t})=>{var s,a;return e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{id:"firstName",type:"text",placeholder:"Enter first name",defaultValue:((s=r==null?void 0:r.full_name)==null?void 0:s.split(" ")[0])||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{id:"lastName",type:"text",placeholder:"Enter last name",defaultValue:((a=r==null?void 0:r.full_name)==null?void 0:a.split(" ").slice(1).join(" "))||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{id:"email",type:"email",placeholder:"user@clinic.com",defaultValue:(r==null?void 0:r.email)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),t==="add"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"An invitation email will be sent to this address"})]})]})]})},Ll=({user:r})=>{const[t,s]=x.useState(!1),[a,n]=x.useState("");return e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Role & Permissions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{id:"newRoleInput",type:"text",placeholder:"Enter new role name",value:a,onChange:l=>n(l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{a.trim()&&(n(""),s(!1))},className:"px-3 py-1 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-xs",children:"Add Role"}),e.jsx("button",{onClick:()=>{n(""),s(!1)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Cancel"})]})]}):e.jsxs("select",{id:"userRole",defaultValue:(r==null?void 0:r.role)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"Select a role"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Technician",children:"Technician"}),e.jsx("option",{value:"Nurse",children:"Nurse"}),e.jsx("option",{value:"add-new",children:"+ Add New Role"})]}),!t&&e.jsx("button",{onClick:()=>s(!0),className:"text-xs text-[#4ECDC4] hover:text-[#38b2ac] mt-1",children:"+ Add New Role"})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Module Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{name:"Inventory Management",key:"inventory"},{name:"Sterilization",key:"sterilization"},{name:"Environmental Cleaning",key:"cleaning"},{name:"Knowledge Hub",key:"knowledge"},{name:"Settings",key:"settings"},{name:"Reports",key:"reports"}].map(l=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:(r==null?void 0:r.role)==="Admin",className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-sm text-gray-700",children:l.name})]},l.key))})]})]})},Ml=()=>{const[r,t]=x.useState(!1),[s,a]=x.useState("");return e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Department Assignment"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"userDepartment",className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),r?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{id:"newDepartmentInput",type:"text",placeholder:"Enter new department name",value:s,onChange:n=>a(n.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{s.trim()&&(a(""),t(!1))},className:"px-3 py-1 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-xs",children:"Add Department"}),e.jsx("button",{onClick:()=>{a(""),t(!1)},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-xs",children:"Cancel"})]})]}):e.jsxs("select",{id:"userDepartment",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"Select department"}),e.jsx("option",{value:"Sterilization",children:"Sterilization"}),e.jsx("option",{value:"Environmental Cleaning",children:"Environmental Cleaning"}),e.jsx("option",{value:"Inventory",children:"Inventory"}),e.jsx("option",{value:"General",children:"General"}),e.jsx("option",{value:"add-new",children:"+ Add New Department"})]}),!r&&e.jsx("button",{onClick:()=>t(!0),className:"text-xs text-[#4ECDC4] hover:text-[#38b2ac] mt-1",children:"+ Add New Department"})]})})]})},Fl=()=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Security Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Force Password Change"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Require user to change password on next login"})]}),e.jsx("button",{className:"px-3 py-1 bg-orange-100 text-orange-700 rounded-md hover:bg-orange-200 transition-colors text-xs",children:"Force Change"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Session Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"View and manage active sessions"})]}),e.jsx("button",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors text-xs",children:"View Sessions"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Access Logs"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Monitor login attempts and system access"})]}),e.jsx("button",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors text-xs",children:"View Logs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"IP Restrictions"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure allowed IP ranges for this user"})]}),e.jsx("button",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-md hover:bg-green-200 transition-colors text-xs",children:"Manage IPs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Device Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Approve and manage mobile devices"})]}),e.jsx("button",{className:"px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 transition-colors text-xs",children:"Manage Devices"})]})]})]}),zl=({user:r})=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Login Security"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Failed Login Attempts"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Account lockout after multiple failed attempts"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"1",max:"10",defaultValue:"5",className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-xs text-gray-500",children:"attempts"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Lockout Duration"}),e.jsx("p",{className:"text-xs text-gray-500",children:"How long to lock account after failed attempts"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"number",min:"5",max:"1440",defaultValue:"30",className:"w-16 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("span",{className:"text-xs text-gray-500",children:"minutes"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Session Timeout"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Auto-logout after inactivity"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",selected:!0,children:"30 minutes"}),e.jsx("option",{value:"60",children:"1 hour"}),e.jsx("option",{value:"240",children:"4 hours"}),e.jsx("option",{value:"480",children:"8 hours"})]})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-medium text-gray-700 mb-3",children:"Audit & Compliance"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Activity Monitoring"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Track user actions and system changes"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"activity-monitoring",defaultChecked:!0,className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"activity-monitoring",className:"text-xs text-gray-700",children:"Enabled"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Data Export Logs"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Log all data export activities"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"export-logs",defaultChecked:!0,className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"export-logs",className:"text-xs text-gray-700",children:"Enabled"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Sensitive Data Access"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Require additional verification for sensitive data"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"sensitive-data",defaultChecked:(r==null?void 0:r.role)==="Admin",className:"rounded border-gray-300 text-[#4ECDC4] focus:ring-[#4ECDC4]"}),e.jsx("label",{htmlFor:"sensitive-data",className:"text-xs text-gray-700",children:"Enabled"})]})]})]})]})]}),ql=({isOpen:r,onClose:t,user:s,mode:a,onSave:n})=>r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a==="add"?"Add New User":`Edit: ${(s==null?void 0:s.full_name)||"Unknown User"}`}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(y,{path:$e,size:1.2})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($l,{user:s,mode:a}),e.jsx(Ll,{user:s,mode:a}),e.jsx(Ml,{user:s,mode:a}),e.jsx(Fl,{}),e.jsx(zl,{user:s,mode:a})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{n({}),t()},className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:a==="add"?"Add User":"Save Changes"})]})]})}):null,Ul=({showDeleteModal:r,selectedUser:t,onCloseDeleteModal:s,onConfirmDelete:a})=>e.jsx(e.Fragment,{children:r&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"bg-red-100 rounded-lg p-2 mr-3",children:e.jsx(y,{path:Rt,size:1.5,className:"text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete User"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Are you sure you want to delete this user? This action cannot be undone."}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-red-600",children:t==null?void 0:t.name.split(" ").map(n=>n[0]).join("")})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.email}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded-full text-xs font-medium ${(t==null?void 0:t.role)==="Admin"?"bg-red-100 text-red-800":(t==null?void 0:t.role)==="Technician"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t==null?void 0:t.role}),e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded-full text-xs font-medium ${(t==null?void 0:t.status)==="Active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t==null?void 0:t.status})]})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700",children:"Delete User"})]})]})})});var Vl=Object.defineProperty,cr=Object.getOwnPropertySymbols,Bl=Object.prototype.hasOwnProperty,Gl=Object.prototype.propertyIsEnumerable,dr=(r,t,s)=>t in r?Vl(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ur=(r,t)=>{for(var s in t||(t={}))Bl.call(t,s)&&dr(r,s,t[s]);if(cr)for(var s of cr(t))Gl.call(t,s)&&dr(r,s,t[s]);return r},Ve=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class Hl{constructor(){this.sessionStartTime=Date.now(),this.lastActivityTime=Date.now(),this.inactivityTimer=null,this.sessionTimer=null,this.warningTimer=null,this.isRememberMe=!1,this.config={sessionTimeout:480,inactiveTimeout:30,rememberMeDuration:7},this.loadConfig(),this.setupActivityListeners(),this.startTimers()}loadConfig(){const t=localStorage.getItem("cliniio_session_timeout"),s=localStorage.getItem("cliniio_inactive_timeout"),a=localStorage.getItem("cliniio_remember_me_duration");t&&(this.config.sessionTimeout=parseInt(t)),s&&(this.config.inactiveTimeout=parseInt(s)),a&&(this.config.rememberMeDuration=parseInt(a)),this.isRememberMe=localStorage.getItem("cliniio_remember_me")==="true",this.isRememberMe&&(this.config.sessionTimeout=this.config.rememberMeDuration*24*60)}setupActivityListeners(){["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach(s=>{document.addEventListener(s,()=>this.updateActivity(),{passive:!0})}),document.addEventListener("visibilitychange",()=>{document.hidden?this.pauseTimers():this.resumeTimers()})}updateActivity(){this.lastActivityTime=Date.now(),this.resetInactivityTimer()}startTimers(){this.startSessionTimer(),this.startInactivityTimer()}startSessionTimer(){this.sessionTimer&&clearTimeout(this.sessionTimer);const t=this.config.sessionTimeout*60*1e3,s=Date.now()-this.sessionStartTime,a=Math.max(0,t-s),n=Math.max(0,a-300*1e3);n>0&&(this.warningTimer=setTimeout(()=>{this.showSessionWarning(a)},n)),this.sessionTimer=setTimeout(()=>{this.handleSessionExpired()},a)}startInactivityTimer(){this.inactivityTimer&&clearTimeout(this.inactivityTimer);const t=this.config.inactiveTimeout*60*1e3;this.inactivityTimer=setTimeout(()=>{this.handleInactivityTimeout()},t)}resetInactivityTimer(){this.inactivityTimer&&clearTimeout(this.inactivityTimer),this.startInactivityTimer()}pauseTimers(){this.sessionTimer&&clearTimeout(this.sessionTimer),this.inactivityTimer&&clearTimeout(this.inactivityTimer),this.warningTimer&&clearTimeout(this.warningTimer)}resumeTimers(){this.startTimers()}showSessionWarning(t){var s,a;const n=Math.ceil(t/6e4),l=document.createElement("div");l.id="session-warning",l.className="fixed top-4 right-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4 shadow-lg z-50 max-w-sm",l.innerHTML=`
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3">
          <h3 class="text-sm font-medium text-yellow-800">Session Expiring Soon</h3>
          <div class="mt-2 text-sm text-yellow-700">
            <p>Your session will expire in ${n} minute${n!==1?"s":""}.</p>
          </div>
          <div class="mt-4 flex space-x-3">
            <button id="extend-session" class="bg-yellow-50 px-2 py-1 text-xs font-medium text-yellow-800 rounded-md border border-yellow-200 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500">
              Extend Session
            </button>
            <button id="dismiss-warning" class="bg-yellow-50 px-2 py-1 text-xs font-medium text-yellow-800 rounded-md border border-yellow-200 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500">
              Dismiss
            </button>
          </div>
        </div>
      </div>
    `,document.body.appendChild(l),(s=document.getElementById("extend-session"))==null||s.addEventListener("click",()=>{this.extendSession(),l.remove()}),(a=document.getElementById("dismiss-warning"))==null||a.addEventListener("click",()=>{l.remove()}),setTimeout(()=>{l.parentNode&&l.remove()},3e4)}extendSession(){return Ve(this,null,function*(){try{const{data:t,error:s}=yield P.auth.refreshSession();if(s){console.error("Error extending session:",s);return}t.session&&(this.sessionStartTime=Date.now(),this.startTimers(),this.showMessage("Session extended successfully!","success"))}catch(t){console.error("Error extending session:",t),this.showMessage("Failed to extend session. Please log in again.","error")}})}handleSessionExpired(){return Ve(this,null,function*(){console.log("🚨 SESSION EXPIRED - redirecting to login"),this.showMessage("Your session has expired. Please log in again.","error"),setTimeout(()=>Ve(this,null,function*(){yield this.logout()}),2e3)})}handleInactivityTimeout(){return Ve(this,null,function*(){this.showMessage("You have been inactive for too long. Logging out...","warning"),setTimeout(()=>Ve(this,null,function*(){yield this.logout()}),2e3)})}showMessage(t,s){const a={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800"},n=document.createElement("div");n.className=`fixed top-4 right-4 ${a[s]} border rounded-lg p-4 shadow-lg z-50 max-w-sm`,n.innerHTML=`
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <svg class="h-5 w-5 ${s==="success"?"text-green-400":s==="error"?"text-red-400":"text-yellow-400"}" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
          </svg>
        </div>
        <div class="ml-3">
          <p class="text-sm font-medium">${t}</p>
        </div>
      </div>
    `,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}logout(){return Ve(this,null,function*(){try{yield P.auth.signOut(),window.location.href="/login"}catch(t){console.error("Error during logout:",t),window.location.href="/login"}})}updateConfig(t){this.config=ur(ur({},this.config),t),this.startTimers()}setRememberMe(t){this.isRememberMe=t,localStorage.setItem("cliniio_remember_me",t.toString()),t?this.config.sessionTimeout=this.config.rememberMeDuration*24*60:this.config.sessionTimeout=480,this.startTimers()}getSessionInfo(){const t=Date.now(),s=t-this.sessionStartTime,a=Math.max(0,this.config.sessionTimeout*60*1e3-s),n=t-this.lastActivityTime,l=Math.max(0,this.config.inactiveTimeout*60*1e3-n);return{sessionStartTime:this.sessionStartTime,lastActivityTime:this.lastActivityTime,remainingTime:a,inactiveTimeRemaining:l}}destroy(){this.sessionTimer&&clearTimeout(this.sessionTimer),this.inactivityTimer&&clearTimeout(this.inactivityTimer),this.warningTimer&&clearTimeout(this.warningTimer),["mousedown","mousemove","keypress","scroll","touchstart","click"].forEach(s=>{document.removeEventListener(s,()=>this.updateActivity())})}}const Ot=new Hl,Yl=({variant:r="compact",className:t=""})=>{const[s,a]=x.useState(Ot.getSessionInfo()),[n,l]=x.useState(!1);x.useEffect(()=>{const d=setInterval(()=>{a(Ot.getSessionInfo())},3e4);return()=>clearInterval(d)},[]);const o=d=>{const u=Math.floor(d/6e4),m=Math.floor(u/60);return m>0?`${m}h ${u%60}m`:`${u}m`},c=d=>d<300*1e3?"text-red-600":d<900*1e3?"text-yellow-600":"text-green-600",i=d=>d<300*1e3?e.jsx(si,{className:"h-4 w-4"}):e.jsx(ri,{className:"h-4 w-4"});return r==="compact"?e.jsxs("div",{className:`flex items-center space-x-2 ${t}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[i(s.remainingTime),e.jsx("span",{className:`text-sm font-medium ${c(s.remainingTime)}`,children:o(s.remainingTime)})]}),e.jsx("button",{onClick:()=>l(!n),className:"text-xs text-gray-500 hover:text-gray-700 underline",children:n?"Hide":"Details"})]}):e.jsxs("div",{className:`bg-white rounded-lg border border-gray-200 p-4 ${t}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Session Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i(s.remainingTime),e.jsxs("span",{className:`text-sm font-medium ${c(s.remainingTime)}`,children:[o(s.remainingTime)," remaining"]})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Session started:"}),e.jsx("span",{children:new Date(s.sessionStartTime).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Last activity:"}),e.jsx("span",{children:new Date(s.lastActivityTime).toLocaleTimeString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Inactive timeout:"}),e.jsx("span",{children:o(s.inactiveTimeRemaining)})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsx("button",{onClick:()=>Ot.extendSession(),className:"w-full px-3 py-2 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Extend Session"})})]})};var Wl=Object.defineProperty,Kl=Object.defineProperties,Ql=Object.getOwnPropertyDescriptors,mr=Object.getOwnPropertySymbols,Zl=Object.prototype.hasOwnProperty,Jl=Object.prototype.propertyIsEnumerable,hr=(r,t,s)=>t in r?Wl(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Xl=(r,t)=>{for(var s in t||(t={}))Zl.call(t,s)&&hr(r,s,t[s]);if(mr)for(var s of mr(t))Jl.call(t,s)&&hr(r,s,t[s]);return r},eo=(r,t)=>Kl(r,Ql(t)),gr=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const to=()=>{const{currentUser:r}=Fe(),[t,s]=x.useState({sessionTimeout:480,inactiveTimeout:30,rememberMeDuration:7,requireReauthForSensitive:!0,twoFactorEnabled:!1}),[a,n]=x.useState(!1),[l,o]=x.useState(!1),[c,i]=x.useState(null),d=x.useCallback(()=>gr(null,null,function*(){var f,b;if(r){n(!0);try{const{data:h,error:p}=yield P.from("user_security_settings").select("*").eq("user_id",r.id).single();p&&p.code!=="PGRST116"?console.error("Error loading security settings:",p):h&&s({sessionTimeout:h.session_timeout||480,inactiveTimeout:h.inactive_timeout||30,rememberMeDuration:h.remember_me_duration||7,requireReauthForSensitive:(f=h.require_reauth_for_sensitive)!=null?f:!0,twoFactorEnabled:(b=h.two_factor_enabled)!=null?b:!1})}catch(h){console.error("Error loading security settings:",h)}finally{n(!1)}}}),[r]);x.useEffect(()=>{d()},[d]);const u=()=>gr(null,null,function*(){if(r){o(!0),i(null);try{const{error:f}=yield P.from("user_security_settings").upsert({user_id:r.id,session_timeout:t.sessionTimeout,inactive_timeout:t.inactiveTimeout,remember_me_duration:t.rememberMeDuration,require_reauth_for_sensitive:t.requireReauthForSensitive,two_factor_enabled:t.twoFactorEnabled,updated_at:new Date().toISOString()});if(f)throw f;i({type:"success",text:"Security settings saved successfully!"}),localStorage.setItem("cliniio_session_timeout",t.sessionTimeout.toString()),localStorage.setItem("cliniio_inactive_timeout",t.inactiveTimeout.toString()),localStorage.setItem("cliniio_remember_me_duration",t.rememberMeDuration.toString()),Ot.updateConfig({sessionTimeout:t.sessionTimeout,inactiveTimeout:t.inactiveTimeout,rememberMeDuration:t.rememberMeDuration})}catch(f){console.error("Error saving security settings:",f),i({type:"error",text:"Failed to save security settings. Please try again."})}finally{o(!1)}}}),m=(f,b)=>{s(h=>eo(Xl({},h),{[f]:b}))};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(f=>e.jsx("div",{className:"h-16 bg-gray-200 rounded"},f))})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Security & Sessions"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Configure how long you stay logged in and security preferences for your account."})]}),c&&e.jsx("div",{className:`p-4 rounded-lg ${c.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:c.text}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Session Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"session-timeout",className:"block text-sm font-medium text-gray-700 mb-2",children:"Maximum Session Duration"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"session-timeout",type:"number",min:"60",max:"1440",value:t.sessionTimeout,onChange:f=>m("sessionTimeout",parseInt(f.target.value)||480),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"minutes (1-24 hours)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long you stay logged in before being automatically logged out"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inactive-timeout",className:"block text-sm font-medium text-gray-700 mb-2",children:"Inactive Timeout"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"inactive-timeout",type:"number",min:"5",max:"120",value:t.inactiveTimeout,onChange:f=>m("inactiveTimeout",parseInt(f.target.value)||30),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"minutes (5-120 minutes)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long of inactivity before automatic logout"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"remember-me-duration",className:"block text-sm font-medium text-gray-700 mb-2",children:"Remember Me Duration"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{id:"remember-me-duration",type:"number",min:"1",max:"30",value:t.rememberMeDuration,onChange:f=>m("rememberMeDuration",parseInt(f.target.value)||7),className:"w-20 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"days (1-30 days)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'How long to stay logged in when using "Remember Me"'})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Security Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"require-reauth-toggle",className:"text-sm font-medium text-gray-700",children:"Require Re-authentication for Sensitive Actions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ask for password confirmation before changing critical settings"})]}),e.jsx("button",{id:"require-reauth-toggle",onClick:()=>m("requireReauthForSensitive",!t.requireReauthForSensitive),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${t.requireReauthForSensitive?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.requireReauthForSensitive?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"two-factor-toggle",className:"text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Add an extra layer of security to your account (coming soon)"})]}),e.jsx("button",{id:"two-factor-toggle",disabled:!0,className:"relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 cursor-not-allowed",children:e.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white translate-x-1"})})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-4",children:"Current Session"}),e.jsx("div",{className:"text-sm text-blue-800 space-y-2",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Logged in as:"})," ",r==null?void 0:r.email]})}),e.jsx("div",{className:"mt-4",children:e.jsx(Yl,{variant:"detailed"})})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:u,disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Saving...":"Save Settings"})})]})};var Ts=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function so(){return Ts(this,null,function*(){const{data:r,error:t}=yield P.from("audit_flags").select("*").eq("resolved",!1).order("created_at",{ascending:!1});if(t)throw t;return r!=null?r:[]})}function ro(r,t,s=!0){return Ts(this,null,function*(){let a=P.from("audit_flags").select("*").order("created_at",{ascending:!1});s||(a=a.eq("resolved",!1));const{data:n,error:l}=yield a;if(l)throw l;return n!=null?n:[]})}function ao(){return Ts(this,null,function*(){const{data:r,error:t}=yield P.from("activity_feed").select("id, module, activity_type, activity_description, created_at").order("created_at",{ascending:!1}).limit(50);if(t)throw t;return r!=null?r:[]})}const no=({children:r,className:t=""})=>e.jsx("div",{className:`rounded-lg border bg-card text-card-foreground shadow-sm ${t}`,children:r});var wt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function io(){const[r,t]=x.useState([]),[s,a]=x.useState([]),[n,l]=x.useState(!0),[o,c]=x.useState(null),[i,d]=x.useState(null),[u,m]=x.useState(!1),[f,b]=x.useState(!1),[h,p]=x.useState([]),[_,w]=x.useState(new Set);function v(){return wt(this,null,function*(){l(!0);try{const[S,L]=yield Promise.all([so(),ao()]);t(S),a(L)}catch(S){console.error("Failed to load audit dashboard:",S)}finally{l(!1)}})}function j(){return wt(this,null,function*(){try{const S=yield ro();p(S)}catch(S){console.error("Failed to load historical compliance data:",S)}})}x.useEffect(()=>{v()},[]);const E=S=>{c(S)},k=()=>{c(null)},A=S=>{const L=new Set(_);L.has(S)?L.delete(S):L.add(S),w(L)},V=S=>{switch(S){case"high":return e.jsx(yt,{className:"w-4 h-4 text-red-500"});case"medium":return e.jsx(yt,{className:"w-4 h-4 text-orange-500"});case"low":return e.jsx(yt,{className:"w-4 h-4 text-yellow-500"});default:return e.jsx(yt,{className:"w-4 h-4 text-gray-500"})}},$=S=>{switch(S){case"high":return"bg-red-500 text-white";case"medium":return"bg-orange-500 text-white";case"low":return"bg-yellow-500 text-white";default:return"bg-gray-500 text-white"}},G=S=>wt(null,null,function*(){d(S);try{const{data:{user:L}}=yield P.auth.getUser(),{error:H}=yield P.from("audit_flags").update({resolved:!0}).eq("id",S);if(H){console.error("Failed to resolve audit flag:",H),alert("Failed to resolve compliance issue: "+H.message);return}console.log("Successfully updated audit flag in database");const{error:C}=yield P.from("audit_logs").insert({id:crypto.randomUUID(),module:"compliance",table_name:"audit_flags",action:"compliance_issue_resolved",record_id:S,user_id:"00000000-0000-0000-0000-000000000000",facility_id:"550e8400-e29b-41d4-a716-446655440000",metadata:{resolution_timestamp:new Date().toISOString(),resolved_by:"system",resolution_type:"manual_resolution"},created_at:new Date().toISOString()});C&&console.error("Failed to create audit log:",C),console.log("Refreshing data..."),yield v();const O=r.filter(T=>T.id!==S);t(O),console.log("Data refreshed, current flags count:",O.length),(o==null?void 0:o.id)===S&&c(null),console.log("Compliance issue resolved successfully:",S),setTimeout(()=>{console.log("Dispatching complianceIssueResolved event"),window.dispatchEvent(new CustomEvent("complianceIssueResolved",{detail:{flagId:S,resolvedCount:O.length}}))},500)}catch(L){console.error("Error resolving compliance issue:",L)}finally{d(null)}}),D=()=>wt(null,null,function*(){m(!0);try{const{data:{user:S}}=yield P.auth.getUser(),L={generated_at:new Date().toISOString(),generated_by:(S==null?void 0:S.email)||"system",facility_id:"550e8400-e29b-41d4-a716-446655440000",active_issues:r.filter(T=>!T.resolved),resolved_issues:r.filter(T=>T.resolved),total_issues:r.length,severity_breakdown:{high:r.filter(T=>T.severity==="high"&&!T.resolved).length,medium:r.filter(T=>T.severity==="medium"&&!T.resolved).length,low:r.filter(T=>T.severity==="low"&&!T.resolved).length}};yield P.from("audit_logs").insert({id:crypto.randomUUID(),module:"compliance",table_name:"audit_flags",action:"compliance_report_exported",record_id:null,user_id:(S==null?void 0:S.id)||"system",facility_id:"550e8400-e29b-41d4-a716-446655440000",metadata:{export_timestamp:new Date().toISOString(),exported_by:(S==null?void 0:S.email)||"system",report_summary:L},created_at:new Date().toISOString()});const H=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),C=URL.createObjectURL(H),O=document.createElement("a");O.href=C,O.download=`compliance-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(C)}catch(S){console.error("Error exporting compliance report:",S)}finally{m(!1)}});return e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Audit & Compliance Dashboard"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{b(!f),f||j()},className:`px-4 py-2 rounded transition-colors ${f?"bg-purple-500 text-white hover:bg-purple-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:f?"Hide Historical":"View Historical"}),e.jsxs("button",{onClick:D,disabled:u||r.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[e.jsx(ni,{className:"w-4 h-4"}),u?"Exporting...":"Export Report"]})]})]}),n?e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"animate-spin w-4 h-4"})," Loading…"]}):e.jsx(e.Fragment,{children:e.jsxs(no,{className:"p-4",children:[e.jsxs("h2",{className:"text-lg font-medium mb-2",children:["🚨 Active Compliance Issues (",r.length,")"]}),r.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎉"}),e.jsx("p",{className:"text-muted text-lg",children:"No active compliance issues!"}),e.jsx("p",{className:"text-muted text-sm mt-2",children:"All systems are operating within compliance standards."})]}):e.jsx("div",{className:"space-y-4",children:r.map(S=>{const L=_.has(S.id);return e.jsxs("div",{className:"border rounded-lg hover:shadow-md transition-all",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>A(S.id),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[L?e.jsx(ii,{className:"w-4 h-4 text-gray-500"}):e.jsx(li,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${S.severity==="high"?"bg-red-100 text-red-800 border border-red-200":S.severity==="medium"?"bg-orange-100 text-orange-800 border border-orange-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`,children:[S.severity.toUpperCase()," SEVERITY"]}),S.compliance_standard&&e.jsx("span",{className:"text-sm bg-[#4ECDC4] text-white px-3 py-1 rounded font-medium",children:S.compliance_standard})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:H=>{H.stopPropagation(),E(S)},className:"px-3 py-1 bg-[#4ECDC4] text-white text-sm rounded hover:bg-[#3BB5AD] transition-colors",children:"View Details"}),e.jsxs("button",{onClick:H=>{H.stopPropagation(),G(S.id)},disabled:i===S.id,className:"px-3 py-1 bg-gray-600 text-white text-sm rounded hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center gap-1",children:[i===S.id?e.jsx(Wt,{className:"w-3 h-3 animate-spin"}):e.jsx(Fs,{className:"w-3 h-3"}),i===S.id?"Resolving...":"Resolve"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("p",{className:"text-gray-900 font-medium",children:S.description})})]}),L&&e.jsx("div",{className:"px-4 pb-4 border-t bg-gray-50/50",children:e.jsxs("div",{className:"pt-4 space-y-4",children:[S.compliance_standard&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2",children:"Compliance Requirement"}),e.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Standard:"}),e.jsx("p",{className:"text-gray-800 font-semibold",children:S.compliance_standard})]}),S.regulation_reference&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Reference:"}),e.jsx("p",{className:"text-gray-800",children:S.regulation_reference})]})]}),S.requirement_description&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Requirement:"}),e.jsx("p",{className:"text-blue-700 mt-1",children:S.requirement_description})]})]})]}),S.corrective_action&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:"Required Actions"}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg",children:e.jsx("div",{className:"text-green-800 whitespace-pre-line text-sm",children:S.corrective_action})})]}),(S.responsible_party||S.due_date)&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-purple-900 mb-2",children:"Assignment & Timeline"}),e.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[S.responsible_party&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Responsible:"}),e.jsx("p",{className:"text-purple-700 font-semibold",children:S.responsible_party})]}),S.due_date&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Due Date:"}),e.jsx("p",{className:"text-purple-700 font-semibold",children:new Date(S.due_date).toLocaleDateString()})]})]})})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["📋 System: ",S.related_table.replace("_"," ")]}),S.related_id&&e.jsxs("span",{children:["🔗 Record: ",S.related_id.slice(0,8),"..."]}),e.jsxs("span",{children:["📅 Detected: ",new Date(S.created_at).toLocaleDateString()]})]})})]})})]},S.id)})})]})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto scrollbar-hide",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[V(o.severity),e.jsx("h2",{className:"text-xl font-semibold",children:"Compliance Issue Details"})]}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(oi,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${$(o.severity)}`,children:[o.severity.toUpperCase()," SEVERITY"]}),e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-sm font-medium ${o.resolved?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:o.resolved?"RESOLVED":"ACTIVE"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Issue Description"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:o.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(zs,{className:"w-4 h-4 text-blue-600"}),e.jsx("h4",{className:"font-medium text-blue-900",children:"Related Table"})]}),e.jsx("p",{className:"text-blue-700",children:o.related_table})]}),o.related_id&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(zs,{className:"w-4 h-4 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:"Record ID"})]}),e.jsx("p",{className:"text-green-700 font-mono text-sm",children:o.related_id})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ci,{className:"w-4 h-4 text-gray-600"}),e.jsx("h4",{className:"font-medium text-gray-900",children:"Timeline"})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(o.created_at).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Age:"})," ",Math.floor((Date.now()-new Date(o.created_at).getTime())/(1e3*60*60*24))," days"]})]})]}),o.compliance_standard&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Compliance Requirements"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Standard:"}),e.jsx("span",{className:"text-blue-700 ml-2",children:o.compliance_standard})]}),o.regulation_reference&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Reference:"}),e.jsx("span",{className:"text-blue-700 ml-2",children:o.regulation_reference})]}),o.requirement_description&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Requirement:"}),e.jsx("p",{className:"text-blue-700 mt-1",children:o.requirement_description})]})]})]}),o.corrective_action&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Required Corrective Actions"}),e.jsx("div",{className:"text-sm text-green-800 whitespace-pre-line",children:o.corrective_action})]}),(o.responsible_party||o.due_date)&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:"Assignment & Timeline"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.responsible_party&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Responsible Party:"}),e.jsx("p",{className:"text-purple-700",children:o.responsible_party})]}),o.due_date&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-purple-800",children:"Due Date:"}),e.jsx("p",{className:"text-purple-700",children:new Date(o.due_date).toLocaleDateString()})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:[e.jsx("button",{onClick:k,className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded transition-colors",children:"Close"}),e.jsxs("button",{onClick:()=>G(o.id),disabled:i===o.id,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[i===o.id?e.jsx(Wt,{className:"w-4 h-4 animate-spin"}):e.jsx(Fs,{className:"w-4 h-4"}),i===o.id?"Resolving...":"Mark as Resolved"]})]})]})})})]})}var lo=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const oo=({initialTab:r,complianceFlagCount:t=0})=>{const[s]=x.useState([]),[a,n]=x.useState(!1),[l,o]=x.useState(!1),[c,i]=x.useState(!1),[d,u]=x.useState(null),[m,f]=x.useState(r==="audit"?"audit":r==="security"?"security":r==="office-hours"?"office-hours":"users"),[b,h]=x.useState(0);(()=>{const j=s.filter($=>$.status==="Active").length,E=[{min:0,max:5,name:"0-5 Users"},{min:6,max:15,name:"6-15 Users"},{min:16,max:21,name:"16-21 Users"},{min:22,max:1/0,name:"21+ Users"}],k=E.find($=>j>=$.min&&j<=$.max),A=E.find($=>$.min>j);if(!k||!A)return null;const V=A.min-j;return{currentTier:k,nextTier:A,usersToNextTier:V,activeUserCount:j}})(),x.useEffect(()=>{function j(){return lo(this,null,function*(){try{const{count:E,error:k}=yield P.from("audit_flags").select("*",{count:"exact",head:!0}).eq("resolved",!1);!k&&typeof E=="number"&&h(E)}catch(E){console.error("Failed to fetch audit flag count:",E)}})}j()},[]);const _=()=>{n(!1),o(!1),i(!1),u(null)},w=j=>{console.log("Saving user:",j),_()},v=()=>{console.log("Deleting user:",d),_()};return e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"System Administration"}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>f("users"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="users"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"User Management"}),e.jsx("button",{onClick:()=>f("office-hours"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="office-hours"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Office Hours"}),e.jsx("button",{onClick:()=>f("security"),className:`py-2 px-1 border-b-2 font-medium text-sm ${m==="security"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Security & Sessions"}),e.jsx("button",{onClick:()=>f("audit"),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${m==="audit"?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} ${t>0?"bg-red-50 text-red-700 border-red-300":""}`,children:e.jsx("span",{children:"Audit & Compliance"})})]})})}),m==="users"&&e.jsx(e.Fragment,{children:e.jsx(Rl,{})}),m==="office-hours"&&e.jsx("div",{children:e.jsx(_l,{})}),m==="security"&&e.jsx("div",{children:e.jsx(to,{})}),m==="audit"&&e.jsx("div",{children:e.jsx(io,{})}),e.jsx(ql,{isOpen:a||l,onClose:_,onSave:w,user:d,mode:l?"edit":"add"}),e.jsx(Ul,{showDeleteModal:c,selectedUser:d,onCloseDeleteModal:()=>i(!1),onConfirmDelete:v})]})},co=()=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Billing & Subscription Settings"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Plan"}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"text-base font-semibold text-blue-900",children:"Professional Plan"}),e.jsx("p",{className:"text-xs text-blue-700",children:"$299/month • 50 users • Full features"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Next billing: Jan 15, 2024"})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:"Active"})})]})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Payment Methods"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-5 bg-blue-600 rounded mr-2 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"VISA"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"•••• •••• •••• 4242"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Expires 12/25"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"inline-block bg-green-100 text-green-800 text-xs px-1 py-0.5 rounded-full",children:"Default"}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-xs",children:"Edit"})]})]}),e.jsx("button",{className:"w-full p-2 border-2 border-dashed border-gray-300 rounded-md text-gray-500 hover:border-gray-400 hover:text-gray-700 transition-colors text-xs",children:"+ Add Payment Method"})]})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Billing Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"company-name",className:"block text-xs font-medium text-gray-600 mb-1",children:"Company Name"}),e.jsx("input",{id:"company-name",type:"text",defaultValue:"Medical Center Inc.",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tax-id",className:"block text-xs font-medium text-gray-600 mb-1",children:"Tax ID"}),e.jsx("input",{id:"tax-id",type:"text",defaultValue:"12-3456789",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-email",className:"block text-xs font-medium text-gray-600 mb-1",children:"Billing Email"}),e.jsx("input",{id:"billing-email",type:"email",defaultValue:"billing@medicalcenter.com",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-phone",className:"block text-xs font-medium text-gray-600 mb-1",children:"Phone"}),e.jsx("input",{id:"billing-phone",type:"tel",defaultValue:"+1 (555) 123-4567",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-city",className:"block text-xs font-medium text-gray-600 mb-1",children:"City"}),e.jsx("input",{id:"billing-city",type:"text",defaultValue:"New York",className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billing-state-zip",className:"block text-xs font-medium text-gray-600 mb-1",children:"State/ZIP"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{id:"billing-state",type:"text",defaultValue:"NY",className:"w-1/2 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"}),e.jsx("input",{id:"billing-zip",type:"text",defaultValue:"10001",className:"w-1/2 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Invoice Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Frequency"}),e.jsxs("select",{className:"px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{children:"Monthly"}),e.jsx("option",{children:"Quarterly"}),e.jsx("option",{children:"Annually"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Auto-pay"}),e.jsx("input",{type:"checkbox",id:"auto-pay",className:"rounded",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 rounded-md",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Reminders"}),e.jsx("input",{type:"checkbox",id:"payment-reminders",className:"rounded",defaultChecked:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Usage & Limits"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Users"}),e.jsx("span",{className:"text-xs text-gray-600",children:"35/50"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full",style:{width:"70%"}})})]}),e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Storage"}),e.jsx("span",{className:"text-xs text-gray-600",children:"2.1/10 GB"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-600 h-1.5 rounded-full",style:{width:"21%"}})})]}),e.jsxs("div",{className:"p-2 border border-gray-200 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"API Calls"}),e.jsx("span",{className:"text-xs text-gray-600",children:"45K/100K"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-yellow-600 h-1.5 rounded-full",style:{width:"45%"}})})]})]})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Plan Management"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{className:"p-2 border border-blue-300 bg-blue-50 text-blue-700 rounded-md hover:bg-blue-100 transition-colors text-xs",children:"Upgrade"}),e.jsx("button",{className:"p-2 border border-gray-300 bg-gray-50 text-gray-700 rounded-md hover:bg-gray-100 transition-colors text-xs",children:"Downgrade"}),e.jsx("button",{className:"p-2 border border-red-300 bg-red-50 text-red-700 rounded-md hover:bg-red-100 transition-colors text-xs",children:"Cancel"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors text-sm",children:"Save Changes"})})]});class uo{constructor(t){this.facilityId=t}createDefaultSettings(){return{aiEnabled:!0,computerVision:{toolConditionAssessment:!0,barcodeQualityDetection:!0,toolTypeRecognition:!0,cleaningValidation:!0,damageDetection:!0,wearAnalysis:!0,imageRecognition:!0,qualityAssessment:!0},predictiveAnalytics:{cycleOptimization:!0,failurePrediction:!0,efficiencyOptimization:!0,resourcePlanning:!0,maintenancePrediction:!0,qualityPrediction:!0,demandForecasting:!0,costOptimization:!0,seasonalAnalysis:!0},smartWorkflow:{intelligentWorkflowSelection:!0,automatedProblemDetection:!0,smartPhaseTransitions:!0,batchOptimization:!0,toolGrouping:!0,cycleScheduling:!0,smartCategorization:!0,autoClassification:!0,smartFormFilling:!0},qualityAssurance:{biologicalIndicatorAnalysis:!0,complianceMonitoring:!0,auditTrailEnhancement:!0,riskAssessment:!0,qualityMetrics:!0,regulatoryCompliance:!0,smartValidation:!0,errorPrevention:!0},realTimeMonitoring:{anomalyDetection:!0,predictiveMaintenance:!0,qualityDriftDetection:!0,smartNotifications:!0,performanceMonitoring:!0,alertManagement:!0,statusUpdates:!0,emergencyAlerts:!0},analytics:{dataCollection:!0,realTimeUpdates:!0,historicalDataRetention:!0,exportCapabilities:!0,dashboardCustomization:!0,performanceMetrics:!0,efficiencyTracking:!0,costAnalysis:!0},intelligence:{riskAssessment:!0,alertSystem:!0,escalationRules:!0,aiRecommendations:!0,optimizationTips:!0,predictiveInsights:!0,trendAnalysis:!0,forecasting:!0},performance:{accuracyTracking:!0,responseTimeMonitoring:!0,errorRateTracking:!0,qualityMetrics:!0,benchmarkComparison:!0,performanceAlerts:!0,optimizationSuggestions:!0,modelHealthMonitoring:!0},privacy:{dataAnonymization:!0,thirdPartyPermissions:!0,complianceMonitoring:!0,auditTrail:!0,dataRetention:!0,encryption:!0,accessControl:!0,privacyCompliance:!0},integration:{externalServices:!0,apiRateLimiting:!0,webhookEndpoints:!0,dataSharing:!0,healthMonitoring:!0,syncScheduling:!0,backupSystems:!0,crossPlatformSync:!0},userExperience:{aiSuggestions:!0,learningPaths:!0,personalization:!0,accessibility:!0,languagePreferences:!0,notificationPreferences:!0,interfaceCustomization:!0,helpSystem:!0},environmental:{predictiveCleaning:!1,smartScheduling:!1,contaminationPrediction:!1,resourceOptimization:!1,efficiencyAnalytics:!1,smartRoomManagement:!1,automaticPriorityAssignment:!1,riskAssessment:!1,trendAnalysis:!1,predictiveMaintenance:!1,supplyOptimization:!1,staffScheduling:!1,costOptimization:!1,inventoryPrediction:!1,workloadBalancing:!1,qualityAssurance:!1,complianceMonitoring:!1,auditTrailEnhancement:!1,performanceTracking:!1,automatedReporting:!1,realTimeMonitoring:!1,anomalyDetection:!1,smartNotifications:!1,statusUpdates:!1,emergencyAlerts:!1},learning:{personalizedRecommendations:!1,skillGapAnalysis:!1,learningPathOptimization:!1,performancePrediction:!1,adaptiveDifficulty:!1,learningAnalytics:!1,behaviorTracking:!1,progressPrediction:!1,engagementMetrics:!1,retentionAnalysis:!1,learningEfficiency:!1,contentOptimization:!1,assessmentIntelligence:!1,certificationTracking:!1,competencyMapping:!1,learningInsights:!1},aiConfig:{aiConfidenceThreshold:.8,aiDataRetentionDays:365,realTimeProcessingEnabled:!0,batchProcessingEnabled:!0,dataSharingEnabled:!1,localAIProcessingEnabled:!0,encryptedDataTransmission:!0,aiModelTraining:!1},apiKeys:{},facilityId:this.facilityId,aiVersion:"1.0.0",updated_at:new Date().toISOString()}}mergeSettings(t,s,a,n,l){var o,c,i,d,u,m,f,b,h,p,_,w,v,j,E,k,A,V,$,G,D,S;return s&&(t.computerVision.toolConditionAssessment=(o=s.tool_condition_assessment)!=null?o:t.computerVision.toolConditionAssessment,t.computerVision.barcodeQualityDetection=(c=s.barcode_quality_detection)!=null?c:t.computerVision.barcodeQualityDetection,t.computerVision.toolTypeRecognition=(i=s.tool_type_recognition)!=null?i:t.computerVision.toolTypeRecognition,t.predictiveAnalytics.cycleOptimization=(d=s.cycle_optimization)!=null?d:t.predictiveAnalytics.cycleOptimization,t.predictiveAnalytics.failurePrediction=(u=s.failure_prediction)!=null?u:t.predictiveAnalytics.failurePrediction,t.aiConfig.aiConfidenceThreshold=(m=s.ai_confidence_threshold)!=null?m:t.aiConfig.aiConfidenceThreshold,t.aiConfig.aiDataRetentionDays=(f=s.ai_data_retention_days)!=null?f:t.aiConfig.aiDataRetentionDays),a&&(t.computerVision.imageRecognition=(b=a.image_recognition_enabled)!=null?b:t.computerVision.imageRecognition,t.computerVision.qualityAssessment=(h=a.quality_assessment_enabled)!=null?h:t.computerVision.qualityAssessment,t.predictiveAnalytics.demandForecasting=(p=a.demand_forecasting_enabled)!=null?p:t.predictiveAnalytics.demandForecasting,t.predictiveAnalytics.costOptimization=(_=a.cost_optimization_enabled)!=null?_:t.predictiveAnalytics.costOptimization,t.smartWorkflow.smartCategorization=(w=a.smart_categorization_enabled)!=null?w:t.smartWorkflow.smartCategorization),n&&(t.environmental.predictiveCleaning=(v=n.predictive_cleaning_enabled)!=null?v:t.environmental.predictiveCleaning,t.environmental.smartScheduling=(j=n.smart_scheduling)!=null?j:t.environmental.smartScheduling,t.environmental.contaminationPrediction=(E=n.contamination_prediction)!=null?E:t.environmental.contaminationPrediction,t.environmental.resourceOptimization=(k=n.resource_optimization)!=null?k:t.environmental.resourceOptimization,t.environmental.efficiencyAnalytics=(A=n.efficiency_analytics)!=null?A:t.environmental.efficiencyAnalytics),l&&(t.learning.personalizedRecommendations=(V=l.personalized_recommendations)!=null?V:t.learning.personalizedRecommendations,t.learning.skillGapAnalysis=($=l.skill_gap_analysis)!=null?$:t.learning.skillGapAnalysis,t.learning.learningPathOptimization=(G=l.learning_path_optimization)!=null?G:t.learning.learningPathOptimization,t.learning.performancePrediction=(D=l.performance_prediction)!=null?D:t.learning.performancePrediction,t.learning.adaptiveDifficulty=(S=l.adaptive_difficulty)!=null?S:t.learning.adaptiveDifficulty),t}extractSterilizationSettings(t){var s,a,n,l,o,c,i;return{tool_condition_assessment:(s=t.computerVision)==null?void 0:s.toolConditionAssessment,barcode_quality_detection:(a=t.computerVision)==null?void 0:a.barcodeQualityDetection,tool_type_recognition:(n=t.computerVision)==null?void 0:n.toolTypeRecognition,cycle_optimization:(l=t.predictiveAnalytics)==null?void 0:l.cycleOptimization,failure_prediction:(o=t.predictiveAnalytics)==null?void 0:o.failurePrediction,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractInventorySettings(t){var s,a,n,l,o,c,i;return{image_recognition_enabled:(s=t.computerVision)==null?void 0:s.imageRecognition,quality_assessment_enabled:(a=t.computerVision)==null?void 0:a.qualityAssessment,demand_forecasting_enabled:(n=t.predictiveAnalytics)==null?void 0:n.demandForecasting,cost_optimization_enabled:(l=t.predictiveAnalytics)==null?void 0:l.costOptimization,smart_categorization_enabled:(o=t.smartWorkflow)==null?void 0:o.smartCategorization,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractEnvironmentalSettings(t){var s,a,n,l,o,c,i;return{predictive_cleaning_enabled:(s=t.environmental)==null?void 0:s.predictiveCleaning,smart_scheduling:(a=t.environmental)==null?void 0:a.smartScheduling,contamination_prediction:(n=t.environmental)==null?void 0:n.contaminationPrediction,resource_optimization:(l=t.environmental)==null?void 0:l.resourceOptimization,efficiency_analytics:(o=t.environmental)==null?void 0:o.efficiencyAnalytics,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractLearningSettings(t){var s,a,n,l,o,c,i;return{personalized_recommendations:(s=t.learning)==null?void 0:s.personalizedRecommendations,skill_gap_analysis:(a=t.learning)==null?void 0:a.skillGapAnalysis,learning_path_optimization:(n=t.learning)==null?void 0:n.learningPathOptimization,performance_prediction:(l=t.learning)==null?void 0:l.performancePrediction,adaptive_difficulty:(o=t.learning)==null?void 0:o.adaptiveDifficulty,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}}var St=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class mo{constructor(t){this.facilityId=t,this.sterilizationAI=new Vt(t),this.inventoryAI=new qa(t),this.environmentalAI=new Sn(t),this.learningAI=new En(t)}loadUnifiedSettings(){return St(this,null,function*(){try{const[t,s,a,n]=yield Promise.all([this.sterilizationAI.loadSettings(),this.inventoryAI.loadSettings(),this.environmentalAI.loadSettings(),this.learningAI.loadSettings()]),l=this.createDefaultSettings();return this.mergeSettings(l,t||void 0,s||void 0,a||void 0,n||void 0)}catch(t){return console.error("Error loading unified AI settings:",t),this.createDefaultSettings()}})}saveUnifiedSettings(t){return St(this,null,function*(){try{const s=this.extractSterilizationSettings(t),a=this.extractInventorySettings(t),n=this.extractEnvironmentalSettings(t),l=this.extractLearningSettings(t),[o,c,i,d]=yield Promise.all([this.sterilizationAI.saveSettings({facility_id:this.facilityId,ai_enabled:!0,ai_version:"1.0",computer_vision_enabled:!!s.tool_condition_assessment||!1,tool_condition_assessment:!!s.tool_condition_assessment||!1,barcode_quality_detection:!!s.barcode_quality_detection||!1,tool_type_recognition:!!s.tool_type_recognition||!1,cleaning_validation:!1,predictive_analytics_enabled:!!s.failure_prediction||!1,cycle_optimization:!!s.cycle_optimization||!1,failure_prediction:!!s.failure_prediction||!1,efficiency_optimization:!1,resource_planning:!1,smart_workflow_enabled:!1,ai_confidence_threshold:Number(s.ai_confidence_threshold)||.8,ai_data_retention_days:Number(s.ai_data_retention_days)||90}),this.inventoryAI.saveSettings(a),this.environmentalAI.saveSettings(n),this.learningAI.saveSettings(l)]);return o&&c&&i&&d}catch(s){return console.error("Error saving unified AI settings:",s),!1}})}applySettings(t){return St(this,null,function*(){try{return yield this.sterilizationAI.initialize(),yield this.environmentalAI.initialize(),yield this.learningAI.initialize(),this.applyFeatureFlags(t),!0}catch(s){return console.error("Error applying AI settings:",s),!1}})}getServiceStatus(){return St(this,null,function*(){try{const[t,s,a]=yield Promise.all([this.sterilizationAI.initialize(),this.environmentalAI.initialize(),this.learningAI.initialize()]);return{sterilization:t,inventory:!1,environmental:s,learning:a}}catch(t){return console.error("Error getting AI service status:",t),{sterilization:!1,inventory:!1,environmental:!1,learning:!1}}})}createDefaultSettings(){return{aiEnabled:!0,computerVision:{toolConditionAssessment:!0,barcodeQualityDetection:!0,toolTypeRecognition:!0,cleaningValidation:!0,damageDetection:!0,wearAnalysis:!0,imageRecognition:!0,qualityAssessment:!0},predictiveAnalytics:{cycleOptimization:!0,failurePrediction:!0,efficiencyOptimization:!0,resourcePlanning:!0,maintenancePrediction:!0,qualityPrediction:!0,demandForecasting:!0,costOptimization:!0,seasonalAnalysis:!0},smartWorkflow:{intelligentWorkflowSelection:!0,automatedProblemDetection:!0,smartPhaseTransitions:!0,batchOptimization:!0,toolGrouping:!0,cycleScheduling:!0,smartCategorization:!0,autoClassification:!0,smartFormFilling:!0},qualityAssurance:{biologicalIndicatorAnalysis:!0,complianceMonitoring:!0,auditTrailEnhancement:!0,riskAssessment:!0,qualityMetrics:!0,regulatoryCompliance:!0,smartValidation:!0,errorPrevention:!0},realTimeMonitoring:{anomalyDetection:!0,predictiveMaintenance:!0,qualityDriftDetection:!0,smartNotifications:!0,performanceMonitoring:!0,alertManagement:!0,statusUpdates:!0,emergencyAlerts:!0},analytics:{dataCollection:!0,realTimeUpdates:!0,historicalDataRetention:!0,exportCapabilities:!0,dashboardCustomization:!0,performanceMetrics:!0,efficiencyTracking:!0,costAnalysis:!0},intelligence:{riskAssessment:!0,alertSystem:!0,escalationRules:!0,aiRecommendations:!0,optimizationTips:!0,predictiveInsights:!0,trendAnalysis:!0,forecasting:!0},performance:{accuracyTracking:!0,responseTimeMonitoring:!0,errorRateTracking:!0,qualityMetrics:!0,benchmarkComparison:!0,performanceAlerts:!0,optimizationSuggestions:!0,modelHealthMonitoring:!0},privacy:{dataAnonymization:!0,thirdPartyPermissions:!0,complianceMonitoring:!0,auditTrail:!0,dataRetention:!0,encryption:!0,accessControl:!0,privacyCompliance:!0},integration:{externalServices:!0,apiRateLimiting:!0,webhookEndpoints:!0,dataSharing:!0,healthMonitoring:!0,syncScheduling:!0,backupSystems:!0,crossPlatformSync:!0},userExperience:{aiSuggestions:!0,learningPaths:!0,personalization:!0,accessibility:!0,languagePreferences:!0,notificationPreferences:!0,interfaceCustomization:!0,helpSystem:!0},environmental:{predictiveCleaning:!1,smartScheduling:!1,contaminationPrediction:!1,resourceOptimization:!1,efficiencyAnalytics:!1,smartRoomManagement:!1,automaticPriorityAssignment:!1,riskAssessment:!1,trendAnalysis:!1,predictiveMaintenance:!1,supplyOptimization:!1,staffScheduling:!1,costOptimization:!1,inventoryPrediction:!1,workloadBalancing:!1,qualityAssurance:!1,complianceMonitoring:!1,auditTrailEnhancement:!1,performanceTracking:!1,automatedReporting:!1,realTimeMonitoring:!1,anomalyDetection:!1,smartNotifications:!1,statusUpdates:!1,emergencyAlerts:!1},learning:{personalizedRecommendations:!1,skillGapAnalysis:!1,learningPathOptimization:!1,performancePrediction:!1,adaptiveDifficulty:!1,learningAnalytics:!1,behaviorTracking:!1,progressPrediction:!1,engagementMetrics:!1,retentionAnalysis:!1,learningEfficiency:!1,contentOptimization:!1,assessmentIntelligence:!1,certificationTracking:!1,competencyMapping:!1,learningInsights:!1},aiConfig:{aiConfidenceThreshold:.8,aiDataRetentionDays:365,realTimeProcessingEnabled:!0,batchProcessingEnabled:!0,dataSharingEnabled:!1,localAIProcessingEnabled:!0,encryptedDataTransmission:!0,aiModelTraining:!1},apiKeys:{},facilityId:this.facilityId,aiVersion:"1.0.0",updated_at:new Date().toISOString()}}mergeSettings(t,s,a,n,l){var o,c,i,d,u,m,f,b,h,p,_,w,v,j,E,k,A,V,$,G,D,S;return s&&(t.computerVision.toolConditionAssessment=(o=!!s.tool_condition_assessment)!=null?o:t.computerVision.toolConditionAssessment,t.computerVision.barcodeQualityDetection=(c=!!s.barcode_quality_detection)!=null?c:t.computerVision.barcodeQualityDetection,t.computerVision.toolTypeRecognition=(i=!!s.tool_type_recognition)!=null?i:t.computerVision.toolTypeRecognition,t.predictiveAnalytics.cycleOptimization=(d=!!s.cycle_optimization)!=null?d:t.predictiveAnalytics.cycleOptimization,t.predictiveAnalytics.failurePrediction=(u=!!s.failure_prediction)!=null?u:t.predictiveAnalytics.failurePrediction,t.aiConfig.aiConfidenceThreshold=(m=Number(s.ai_confidence_threshold))!=null?m:t.aiConfig.aiConfidenceThreshold,t.aiConfig.aiDataRetentionDays=(f=Number(s.ai_data_retention_days))!=null?f:t.aiConfig.aiDataRetentionDays),a&&(t.computerVision.imageRecognition=(b=!!a.image_recognition_enabled)!=null?b:t.computerVision.imageRecognition,t.computerVision.qualityAssessment=(h=!!a.quality_assessment_enabled)!=null?h:t.computerVision.qualityAssessment,t.predictiveAnalytics.demandForecasting=(p=!!a.demand_forecasting_enabled)!=null?p:t.predictiveAnalytics.demandForecasting,t.predictiveAnalytics.costOptimization=(_=!!a.cost_optimization_enabled)!=null?_:t.predictiveAnalytics.costOptimization,t.smartWorkflow.smartCategorization=(w=!!a.smart_categorization_enabled)!=null?w:t.smartWorkflow.smartCategorization),n&&(t.environmental.predictiveCleaning=(v=!!n.predictive_cleaning_enabled)!=null?v:t.environmental.predictiveCleaning,t.environmental.smartScheduling=(j=!!n.smart_scheduling)!=null?j:t.environmental.smartScheduling,t.environmental.contaminationPrediction=(E=!!n.contamination_prediction)!=null?E:t.environmental.contaminationPrediction,t.environmental.resourceOptimization=(k=!!n.resource_optimization)!=null?k:t.environmental.resourceOptimization,t.environmental.efficiencyAnalytics=(A=!!n.efficiency_analytics)!=null?A:t.environmental.efficiencyAnalytics),l&&(t.learning.personalizedRecommendations=(V=!!l.personalized_recommendations)!=null?V:t.learning.personalizedRecommendations,t.learning.skillGapAnalysis=($=!!l.skill_gap_analysis)!=null?$:t.learning.skillGapAnalysis,t.learning.learningPathOptimization=(G=!!l.learning_path_optimization)!=null?G:t.learning.learningPathOptimization,t.learning.performancePrediction=(D=!!l.performance_prediction)!=null?D:t.learning.performancePrediction,t.learning.adaptiveDifficulty=(S=!!l.adaptive_difficulty)!=null?S:t.learning.adaptiveDifficulty),t}extractSterilizationSettings(t){var s,a,n,l,o,c,i;return{tool_condition_assessment:(s=t.computerVision)==null?void 0:s.toolConditionAssessment,barcode_quality_detection:(a=t.computerVision)==null?void 0:a.barcodeQualityDetection,tool_type_recognition:(n=t.computerVision)==null?void 0:n.toolTypeRecognition,cycle_optimization:(l=t.predictiveAnalytics)==null?void 0:l.cycleOptimization,failure_prediction:(o=t.predictiveAnalytics)==null?void 0:o.failurePrediction,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractInventorySettings(t){var s,a,n,l,o,c,i;return{image_recognition_enabled:(s=t.computerVision)==null?void 0:s.imageRecognition,quality_assessment_enabled:(a=t.computerVision)==null?void 0:a.qualityAssessment,demand_forecasting_enabled:(n=t.predictiveAnalytics)==null?void 0:n.demandForecasting,cost_optimization_enabled:(l=t.predictiveAnalytics)==null?void 0:l.costOptimization,smart_categorization_enabled:(o=t.smartWorkflow)==null?void 0:o.smartCategorization,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractEnvironmentalSettings(t){var s,a,n,l,o,c,i;return{predictive_cleaning_enabled:(s=t.environmental)==null?void 0:s.predictiveCleaning,smart_scheduling:(a=t.environmental)==null?void 0:a.smartScheduling,contamination_prediction:(n=t.environmental)==null?void 0:n.contaminationPrediction,resource_optimization:(l=t.environmental)==null?void 0:l.resourceOptimization,efficiency_analytics:(o=t.environmental)==null?void 0:o.efficiencyAnalytics,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}extractLearningSettings(t){var s,a,n,l,o,c,i;return{personalized_recommendations:(s=t.learning)==null?void 0:s.personalizedRecommendations,skill_gap_analysis:(a=t.learning)==null?void 0:a.skillGapAnalysis,learning_path_optimization:(n=t.learning)==null?void 0:n.learningPathOptimization,performance_prediction:(l=t.learning)==null?void 0:l.performancePrediction,adaptive_difficulty:(o=t.learning)==null?void 0:o.adaptiveDifficulty,ai_confidence_threshold:(c=t.aiConfig)==null?void 0:c.aiConfidenceThreshold,ai_data_retention_days:(i=t.aiConfig)==null?void 0:i.aiDataRetentionDays}}applyFeatureFlags(t){console.log("Applying AI feature flags:",t)}}class ho{constructor(t){this.facilityId=t}isFeatureEnabled(t,s){return t.aiEnabled?this.getNestedValue(t,s)===!0:!1}validateApiKeys(t){const s=[];return t.openaiApiKey&&!this.isValidApiKey(t.openaiApiKey)&&s.push("Invalid OpenAI API key format"),t.googleVisionApiKey&&!this.isValidApiKey(t.googleVisionApiKey)&&s.push("Invalid Google Vision API key format"),t.azureComputerVisionKey&&!this.isValidApiKey(t.azureComputerVisionKey)&&s.push("Invalid Azure Computer Vision API key format"),{isValid:s.length===0,errors:s}}encryptApiKeys(t){return{openaiApiKey:t.openaiApiKey?this.encryptKey(t.openaiApiKey):void 0,googleVisionApiKey:t.googleVisionApiKey?this.encryptKey(t.googleVisionApiKey):void 0,azureComputerVisionKey:t.azureComputerVisionKey?this.encryptKey(t.azureComputerVisionKey):void 0}}decryptApiKeys(t){return{openaiApiKey:t.openaiApiKey?this.decryptKey(t.openaiApiKey):void 0,googleVisionApiKey:t.googleVisionApiKey?this.decryptKey(t.googleVisionApiKey):void 0,azureComputerVisionKey:t.azureComputerVisionKey?this.decryptKey(t.azureComputerVisionKey):void 0}}getRequiredApiKeys(t){const s=[];return(t.computerVision.toolConditionAssessment||t.computerVision.barcodeQualityDetection||t.computerVision.toolTypeRecognition||t.computerVision.imageRecognition||t.computerVision.qualityAssessment)&&s.push("googleVisionApiKey","azureComputerVisionKey"),(t.predictiveAnalytics.failurePrediction||t.predictiveAnalytics.cycleOptimization||t.predictiveAnalytics.demandForecasting)&&s.push("openaiApiKey"),(t.environmental.predictiveCleaning||t.environmental.contaminationPrediction||t.environmental.resourceOptimization)&&s.push("openaiApiKey"),(t.learning.personalizedRecommendations||t.learning.skillGapAnalysis||t.learning.learningPathOptimization)&&s.push("openaiApiKey"),[...new Set(s)]}hasRequiredApiKeys(t){const s=this.getRequiredApiKeys(t),a=Object.keys(t.apiKeys).filter(n=>t.apiKeys[n]);return s.every(n=>a.some(l=>l===n))}isValidApiKey(t){return t&&t.length>10&&!t.includes(" ")}encryptKey(t){return`encrypted_${t}`}decryptKey(t){return t.replace("encrypted_","")}getNestedValue(t,s){return s.split(".").reduce((a,n)=>a==null?void 0:a[n],t)}}var go=Object.defineProperty,xr=Object.getOwnPropertySymbols,xo=Object.prototype.hasOwnProperty,po=Object.prototype.propertyIsEnumerable,pr=(r,t,s)=>t in r?go(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Et=(r,t)=>{for(var s in t||(t={}))xo.call(t,s)&&pr(r,s,t[s]);if(xr)for(var s of xr(t))po.call(t,s)&&pr(r,s,t[s]);return r};class fo{constructor(t){this.facilityId=t}applyFeatureFlags(t){console.log("Applying AI feature flags:",t)}toggleFeature(t,s,a){const n=Et({},t);return this.setNestedValue(n,s,a),n}toggleMultipleFeatures(t,s){const a=Et({},t);return Object.entries(s).forEach(([n,l])=>{this.setNestedValue(a,n,l)}),a}enableCategory(t,s){const a=Et({},t);if(typeof a[s]=="object"&&a[s]!==null){const n=a[s];Object.keys(n).forEach(l=>{n[l]=!0})}return a}disableCategory(t,s){const a=Et({},t);if(typeof a[s]=="object"&&a[s]!==null){const n=a[s];Object.keys(n).forEach(l=>{n[l]=!1})}return a}getFeatureStatus(t,s){return this.getNestedValue(t,s)===!0}getCategoryStatus(t,s){if(typeof t[s]!="object"||t[s]===null)return{enabled:0,total:0,percentage:0};const a=t[s],n=Object.values(a),l=n.filter(Boolean).length,o=n.length;return{enabled:l,total:o,percentage:o>0?Math.round(l/o*100):0}}getDisabledFeatures(t){const s=[];return Object.entries(t.computerVision).forEach(([a,n])=>{n||s.push(`computerVision.${a}`)}),Object.entries(t.predictiveAnalytics).forEach(([a,n])=>{n||s.push(`predictiveAnalytics.${a}`)}),Object.entries(t.smartWorkflow).forEach(([a,n])=>{n||s.push(`smartWorkflow.${a}`)}),Object.entries(t.qualityAssurance).forEach(([a,n])=>{n||s.push(`qualityAssurance.${a}`)}),Object.entries(t.realTimeMonitoring).forEach(([a,n])=>{n||s.push(`realTimeMonitoring.${a}`)}),Object.entries(t.analytics).forEach(([a,n])=>{n||s.push(`analytics.${a}`)}),Object.entries(t.intelligence).forEach(([a,n])=>{n||s.push(`intelligence.${a}`)}),Object.entries(t.performance).forEach(([a,n])=>{n||s.push(`performance.${a}`)}),Object.entries(t.privacy).forEach(([a,n])=>{n||s.push(`privacy.${a}`)}),Object.entries(t.integration).forEach(([a,n])=>{n||s.push(`integration.${a}`)}),Object.entries(t.userExperience).forEach(([a,n])=>{n||s.push(`userExperience.${a}`)}),Object.entries(t.environmental).forEach(([a,n])=>{n||s.push(`environmental.${a}`)}),Object.entries(t.learning).forEach(([a,n])=>{n||s.push(`learning.${a}`)}),s}getEnabledFeatures(t){const s=[];return Object.entries(t.computerVision).forEach(([a,n])=>{n&&s.push(`computerVision.${a}`)}),Object.entries(t.predictiveAnalytics).forEach(([a,n])=>{n&&s.push(`predictiveAnalytics.${a}`)}),Object.entries(t.smartWorkflow).forEach(([a,n])=>{n&&s.push(`smartWorkflow.${a}`)}),Object.entries(t.qualityAssurance).forEach(([a,n])=>{n&&s.push(`qualityAssurance.${a}`)}),Object.entries(t.realTimeMonitoring).forEach(([a,n])=>{n&&s.push(`realTimeMonitoring.${a}`)}),Object.entries(t.analytics).forEach(([a,n])=>{n&&s.push(`analytics.${a}`)}),Object.entries(t.intelligence).forEach(([a,n])=>{n&&s.push(`intelligence.${a}`)}),Object.entries(t.performance).forEach(([a,n])=>{n&&s.push(`performance.${a}`)}),Object.entries(t.privacy).forEach(([a,n])=>{n&&s.push(`privacy.${a}`)}),Object.entries(t.integration).forEach(([a,n])=>{n&&s.push(`integration.${a}`)}),Object.entries(t.userExperience).forEach(([a,n])=>{n&&s.push(`userExperience.${a}`)}),Object.entries(t.environmental).forEach(([a,n])=>{n&&s.push(`environmental.${a}`)}),Object.entries(t.learning).forEach(([a,n])=>{n&&s.push(`learning.${a}`)}),s}getNestedValue(t,s){return s.split(".").reduce((a,n)=>a==null?void 0:a[n],t)}setNestedValue(t,s,a){const n=s.split("."),l=n.pop(),o=n.reduce((c,i)=>(i in c||(c[i]={}),c[i]),t);o[l]=a}}var bo=Object.defineProperty,fr=Object.getOwnPropertySymbols,yo=Object.prototype.hasOwnProperty,vo=Object.prototype.propertyIsEnumerable,br=(r,t,s)=>t in r?bo(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ss=(r,t)=>{for(var s in t||(t={}))yo.call(t,s)&&br(r,s,t[s]);if(fr)for(var s of fr(t))vo.call(t,s)&&br(r,s,t[s]);return r};class jo{constructor(t){this.facilityId=t}optimizePerformanceSettings(t){const s=ss({},t);return s.aiConfig.aiConfidenceThreshold=this.calculateOptimalConfidenceThreshold(t),s.aiConfig.aiDataRetentionDays=this.calculateOptimalDataRetention(t),s.aiConfig.realTimeProcessingEnabled=this.shouldEnableRealTimeProcessing(t),s.aiConfig.batchProcessingEnabled=this.shouldEnableBatchProcessing(t),s.aiConfig.dataSharingEnabled=this.shouldEnableDataSharing(t),s.aiConfig.localAIProcessingEnabled=this.shouldEnableLocalProcessing(t),s.aiConfig.encryptedDataTransmission=this.shouldEnableEncryption(t),s.aiConfig.aiModelTraining=this.shouldEnableModelTraining(t),s}getPerformanceRecommendations(t){const s=[];return t.aiConfig.aiConfidenceThreshold<.7&&s.push({recommendations:["Consider increasing AI confidence threshold to 0.8 or higher for better accuracy"],priority:"medium"}),t.aiConfig.aiDataRetentionDays>365&&s.push({recommendations:["Consider reducing data retention period to improve performance and reduce storage costs"],priority:"low"}),!t.aiConfig.realTimeProcessingEnabled&&!t.aiConfig.batchProcessingEnabled&&s.push({recommendations:["Enable at least one processing mode (real-time or batch) for AI functionality"],priority:"high"}),t.aiConfig.encryptedDataTransmission||s.push({recommendations:["Enable encrypted data transmission for better security"],priority:"high"}),!t.aiConfig.localAIProcessingEnabled&&t.privacy.dataAnonymization&&s.push({recommendations:["Consider enabling local AI processing for better privacy compliance"],priority:"medium"}),s}validatePerformanceSettings(t){const s=[],a=[];return(t.aiConfig.aiConfidenceThreshold<.1||t.aiConfig.aiConfidenceThreshold>1)&&s.push("AI confidence threshold must be between 0.1 and 1.0"),(t.aiConfig.aiDataRetentionDays<1||t.aiConfig.aiDataRetentionDays>2555)&&s.push("AI data retention days must be between 1 and 2555 (7 years)"),!t.aiConfig.realTimeProcessingEnabled&&!t.aiConfig.batchProcessingEnabled&&s.push("At least one processing mode must be enabled"),!t.aiConfig.encryptedDataTransmission&&t.privacy.dataAnonymization&&a.push("Consider enabling encrypted data transmission when using data anonymization"),!t.aiConfig.localAIProcessingEnabled&&t.privacy.privacyCompliance&&a.push("Consider enabling local AI processing for better privacy compliance"),{isValid:s.length===0,errors:s,warnings:a}}getPerformanceMetricsConfig(t){return{accuracyTracking:t.performance.accuracyTracking,responseTimeMonitoring:t.performance.responseTimeMonitoring,errorRateTracking:t.performance.errorRateTracking,qualityMetrics:t.performance.qualityMetrics,benchmarkComparison:t.performance.benchmarkComparison,performanceAlerts:t.performance.performanceAlerts,optimizationSuggestions:t.performance.optimizationSuggestions,modelHealthMonitoring:t.performance.modelHealthMonitoring}}updatePerformanceMetrics(t,s){const a=ss({},t);return Object.entries(s).forEach(([n,l])=>{l!==void 0&&(a.performance[n]=l)}),a}getPerformanceConfig(t){return{aiConfidenceThreshold:t.aiConfig.aiConfidenceThreshold,aiDataRetentionDays:t.aiConfig.aiDataRetentionDays,realTimeProcessingEnabled:t.aiConfig.realTimeProcessingEnabled,batchProcessingEnabled:t.aiConfig.batchProcessingEnabled,dataSharingEnabled:t.aiConfig.dataSharingEnabled,localAIProcessingEnabled:t.aiConfig.localAIProcessingEnabled,encryptedDataTransmission:t.aiConfig.encryptedDataTransmission,aiModelTraining:t.aiConfig.aiModelTraining}}updatePerformanceConfig(t,s){const a=ss({},t);return Object.entries(s).forEach(([n,l])=>{l!==void 0&&(a.aiConfig[n]=l)}),a}calculateOptimalConfidenceThreshold(t){let s=.8;return t.predictiveAnalytics.failurePrediction&&(s=Math.max(s,.9)),t.qualityAssurance.complianceMonitoring&&(s=Math.max(s,.85)),t.realTimeMonitoring.emergencyAlerts&&(s=Math.max(s,.95)),Math.min(s,.99)}calculateOptimalDataRetention(t){let s=365;return t.privacy.complianceMonitoring&&(s=Math.max(s,2555)),t.qualityAssurance.regulatoryCompliance&&(s=Math.max(s,1825)),t.performance.optimizationSuggestions&&(s=Math.min(s,180)),s}shouldEnableRealTimeProcessing(t){return t.realTimeMonitoring.anomalyDetection||t.realTimeMonitoring.emergencyAlerts||t.realTimeMonitoring.smartNotifications||t.analytics.realTimeUpdates}shouldEnableBatchProcessing(t){return t.predictiveAnalytics.demandForecasting||t.predictiveAnalytics.seasonalAnalysis||t.analytics.historicalDataRetention||t.performance.benchmarkComparison}shouldEnableDataSharing(t){return t.privacy.thirdPartyPermissions&&!t.privacy.dataAnonymization}shouldEnableLocalProcessing(t){return t.privacy.dataAnonymization||t.privacy.privacyCompliance||t.privacy.accessControl}shouldEnableEncryption(t){return t.privacy.encryption||t.privacy.privacyCompliance||t.privacy.accessControl}shouldEnableModelTraining(t){return t.analytics.dataCollection&&(t.predictiveAnalytics.failurePrediction||t.predictiveAnalytics.cycleOptimization||t.learning.personalizedRecommendations)}}var we=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class No{constructor(t){this.facilityId=t}saveToUnifiedTable(t){return we(this,null,function*(){var s;try{const{data:a,error:n}=yield P.from("ai_settings").upsert({facility_id:this.facilityId,module:"general",settings:t,updated_at:new Date().toISOString()},{onConflict:"facility_id,module"});return n?(console.error("Error saving to unified table:",n),!1):(!n&&a&&(yield Tn({facilityId:this.facilityId,userId:"system",module:"general",action:"UPDATE",details:(s=a[0])!=null?s:{}})),!0)}catch(a){return console.error("Error saving to unified table:",a),!1}})}loadFromUnifiedTable(){return we(this,null,function*(){try{const{data:t,error:s}=yield P.from("ai_settings").select("settings").eq("facility_id",this.facilityId).eq("module","general").single();return s?(s.code==="PGRST116"||console.error("Error loading from unified table:",s),null):t==null?void 0:t.settings}catch(t){return console.error("Error loading from unified table:",t),null}})}deleteFromUnifiedTable(){return we(this,null,function*(){try{const{error:t}=yield P.from("ai_settings").delete().eq("facility_id",this.facilityId).eq("module","general");return t?(console.error("Error deleting from unified table:",t),!1):!0}catch(t){return console.error("Error deleting from unified table:",t),!1}})}settingsExist(){return we(this,null,function*(){try{const{data:t,error:s}=yield P.from("ai_settings").select("facility_id").eq("facility_id",this.facilityId).eq("module","general").single();return s?(s.code==="PGRST116"||console.error("Error checking if settings exist:",s),!1):!!t}catch(t){return console.error("Error checking if settings exist:",t),!1}})}getSettingsMetadata(){return we(this,null,function*(){try{const{data:t,error:s}=yield P.from("ai_settings").select("updated_at, ai_version, created_at").eq("facility_id",this.facilityId).eq("module","general").single();return s?(s.code==="PGRST116"||console.error("Error getting settings metadata:",s),null):{updated_at:(t==null?void 0:t.updated_at)||null,ai_version:(t==null?void 0:t.ai_version)||null,created_at:(t==null?void 0:t.created_at)||null}}catch(t){return console.error("Error getting settings metadata:",t),null}})}backupSettings(t){return we(this,null,function*(){try{const{error:s}=yield P.from("ai_settings_backup").insert({facility_id:this.facilityId,module:"general",settings:t,backup_date:new Date().toISOString(),ai_version:t.aiVersion});return s?(console.error("Error backing up settings:",s),!1):!0}catch(s){return console.error("Error backing up settings:",s),!1}})}restoreSettings(t){return we(this,null,function*(){try{let s=P.from("ai_settings_backup").select("settings").eq("facility_id",this.facilityId).eq("module","general").order("backup_date",{ascending:!1});t&&(s=s.eq("backup_date",t));const{data:a,error:n}=yield s.limit(1).single();return n?(n.code==="PGRST116"||console.error("Error restoring settings:",n),null):a==null?void 0:a.settings}catch(s){return console.error("Error restoring settings:",s),null}})}getAvailableBackups(){return we(this,null,function*(){try{const{data:t,error:s}=yield P.from("ai_settings_backup").select("backup_date, ai_version").eq("facility_id",this.facilityId).eq("module","general").order("backup_date",{ascending:!1});return s?(console.error("Error getting available backups:",s),[]):t||[]}catch(t){return console.error("Error getting available backups:",t),[]}})}exportSettingsToJson(t){return JSON.stringify(t,null,2)}importSettingsFromJson(t){try{const s=JSON.parse(t);if(!s.aiEnabled||!s.facilityId||!s.aiConfig)throw new Error("Invalid settings format");return s}catch(s){return console.error("Error importing settings from JSON:",s),null}}validateSettingsStructure(t){const s=[];if(typeof t!="object"||t===null)return s.push("Settings must be an object"),{isValid:!1,errors:s};const a=t;if(["aiEnabled","computerVision","predictiveAnalytics","smartWorkflow","qualityAssurance","realTimeMonitoring","analytics","intelligence","performance","privacy","integration","userExperience","environmental","learning","aiConfig","apiKeys","facilityId","aiVersion","updated_at"].forEach(l=>{l in a||s.push(`Missing required property: ${l}`)}),a.computerVision&&typeof a.computerVision!="object"&&s.push("computerVision must be an object"),a.predictiveAnalytics&&typeof a.predictiveAnalytics!="object"&&s.push("predictiveAnalytics must be an object"),a.aiConfig&&typeof a.aiConfig!="object"&&s.push("aiConfig must be an object"),a.aiConfig&&typeof a.aiConfig=="object"){const l=a.aiConfig;typeof l.aiConfidenceThreshold!="number"&&s.push("aiConfig.aiConfidenceThreshold must be a number"),typeof l.aiDataRetentionDays!="number"&&s.push("aiConfig.aiDataRetentionDays must be a number")}return{isValid:s.length===0,errors:s}}}var Tt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class _o{constructor(t){this.facilityId=t,this.configProvider=new uo(t),this.modelProvider=new mo(t),this.apiKeyProvider=new ho(t),this.toggleProvider=new fo(t),this.performanceProvider=new jo(t),this.persistenceProvider=new No(t)}loadUnifiedSettings(){return Tt(this,null,function*(){return this.modelProvider.loadUnifiedSettings()})}saveUnifiedSettings(t){return Tt(this,null,function*(){const s=yield this.modelProvider.saveUnifiedSettings(t),a=yield this.persistenceProvider.saveToUnifiedTable(t);return s&&a})}applySettings(t){return Tt(this,null,function*(){return this.modelProvider.applySettings(t)})}isFeatureEnabled(t,s){return this.apiKeyProvider.isFeatureEnabled(t,s)}getServiceStatus(){return Tt(this,null,function*(){return this.modelProvider.getServiceStatus()})}}const Co=()=>{const{getCurrentFacilityId:r}=Qe(),t=r();if(!t)throw new Error("Facility ID not available");return x.useMemo(()=>new _o(t),[t])},N={HEADER:{TITLE:"AI and Analytics Settings",SUBTITLE:"Configure AI features, analytics, and intelligence settings"},BUTTONS:{RESET:"Reset",SAVE:"Save Settings",SAVING:"Saving..."},MESSAGES:{LOADING:"Loading AI settings...",FACILITY_NOT_AVAILABLE:"Facility not available. Please select a facility first.",FAILED_TO_LOAD:"Failed to load AI settings. Please try refreshing the page.",SAVE_SUCCESS:"AI settings saved and applied successfully!",SAVE_ERROR:"Failed to save AI settings",RESET_SUCCESS:"Settings reset to defaults",RESET_ERROR:"Failed to reset settings"},SECTIONS:{AI_SERVICE_STATUS:"AI Service Status",ENABLE_AI_FEATURES:"Enable AI Features",AI_FEATURES:"AI Features",TOKEN_USAGE_DASHBOARD:"AI Usage Dashboard",THROTTLING_CONTROLS:"Throttling Controls",ANALYTICS_CONFIGURATION:"Analytics Configuration",INTELLIGENCE_SETTINGS:"Intelligence Settings",PERFORMANCE_MONITORING:"Performance Monitoring",DATA_PRIVACY_SECURITY:"Data Privacy & Security",INTEGRATION_SETTINGS:"Integration Settings",USER_EXPERIENCE:"User Experience"},FORM_GROUPS:{COMPUTER_VISION:"Computer Vision",PREDICTIVE_ANALYTICS:"Predictive Analytics",SMART_WORKFLOW:"Smart Workflow",DATA_COLLECTION:"Data Collection",REPORTING_EXPORT:"Reporting & Export",RISK_ALERTS:"Risk & Alerts",AI_INSIGHTS:"AI Insights",QUALITY_METRICS:"Quality Metrics",OPTIMIZATION:"Optimization",PRIVACY_CONTROLS:"Privacy Controls",SECURITY_FEATURES:"Security Features",EXTERNAL_SERVICES:"External Services",SYSTEM_HEALTH:"System Health",AI_ASSISTANCE:"AI Assistance",INTERFACE_HELP:"Interface & Help"},TOGGLE_LABELS:{TOOL_CONDITION_ASSESSMENT:"Tool Condition Assessment",BARCODE_QUALITY_DETECTION:"Barcode Quality Detection",DAMAGE_DETECTION:"Damage Detection",CYCLE_OPTIMIZATION:"Cycle Optimization",FAILURE_PREDICTION:"Failure Prediction",EFFICIENCY_OPTIMIZATION:"Efficiency Optimization",INTELLIGENT_WORKFLOW_SELECTION:"Intelligent Workflow Selection",AUTOMATED_PROBLEM_DETECTION:"Automated Problem Detection",DATA_COLLECTION:"Data Collection",REAL_TIME_UPDATES:"Real-time Updates",HISTORICAL_DATA_RETENTION:"Historical Data Retention",EXPORT_CAPABILITIES:"Export Capabilities",DASHBOARD_CUSTOMIZATION:"Dashboard Customization",RISK_ASSESSMENT:"Risk Assessment",ALERT_SYSTEM:"Alert System",ESCALATION_RULES:"Escalation Rules",AI_RECOMMENDATIONS:"AI Recommendations",OPTIMIZATION_TIPS:"Optimization Tips",ACCURACY_TRACKING:"Accuracy Tracking",RESPONSE_TIME_MONITORING:"Response Time Monitoring",ERROR_RATE_TRACKING:"Error Rate Tracking",PERFORMANCE_ALERTS:"Performance Alerts",MODEL_HEALTH_MONITORING:"Model Health Monitoring",DATA_ANONYMIZATION:"Data Anonymization",THIRD_PARTY_PERMISSIONS:"Third-party Permissions",COMPLIANCE_MONITORING:"Compliance Monitoring",ENCRYPTION:"Encryption",ACCESS_CONTROL:"Access Control",EXTERNAL_SERVICES:"External Services",API_RATE_LIMITING:"API Rate Limiting",WEBHOOK_ENDPOINTS:"Webhook Endpoints",HEALTH_MONITORING:"Health Monitoring",SYNC_SCHEDULING:"Sync Scheduling",AI_SUGGESTIONS:"AI Suggestions",LEARNING_PATHS:"Learning Paths",PERSONALIZATION:"Personalization",ACCESSIBILITY_FEATURES:"Accessibility Features",SMART_HELP_SYSTEM:"Smart Help System"},DESCRIPTIONS:{MASTER_AI_TOGGLE:"Master toggle for all AI-powered features across the system",TOOL_CONDITION_ASSESSMENT:"AI-powered tool wear and condition analysis",BARCODE_QUALITY_DETECTION:"Automatic barcode readability assessment",DAMAGE_DETECTION:"AI detection of tool damage and defects",CYCLE_OPTIMIZATION:"AI-powered sterilization cycle optimization",FAILURE_PREDICTION:"Predictive maintenance and failure alerts",EFFICIENCY_OPTIMIZATION:"AI-driven workflow efficiency improvements",INTELLIGENT_WORKFLOW_SELECTION:"AI-powered workflow recommendations",AUTOMATED_PROBLEM_DETECTION:"AI detection of workflow issues",DATA_COLLECTION:"Enable comprehensive data collection",REAL_TIME_UPDATES:"Live analytics and dashboard updates",HISTORICAL_DATA_RETENTION:"Long-term data storage and analysis",EXPORT_CAPABILITIES:"PDF, CSV, and Excel export options",DASHBOARD_CUSTOMIZATION:"Customizable analytics dashboards",RISK_ASSESSMENT:"AI-powered risk analysis and scoring",ALERT_SYSTEM:"Smart notification and alert system",ESCALATION_RULES:"Automatic alert escalation based on priority",AI_RECOMMENDATIONS:"Intelligent recommendations and suggestions",OPTIMIZATION_TIPS:"AI-generated optimization suggestions",ACCURACY_TRACKING:"Monitor AI prediction accuracy",RESPONSE_TIME_MONITORING:"Track AI response times and performance",ERROR_RATE_TRACKING:"Monitor and track error rates",PERFORMANCE_ALERTS:"Alerts for performance issues",MODEL_HEALTH_MONITORING:"AI model performance and health tracking",DATA_ANONYMIZATION:"Automatically anonymize sensitive data",THIRD_PARTY_PERMISSIONS:"Control third-party AI service access",COMPLIANCE_MONITORING:"Monitor regulatory compliance",ENCRYPTION:"End-to-end data encryption",ACCESS_CONTROL:"Role-based access control for AI features",EXTERNAL_SERVICES:"Connect to external AI and analytics services",API_RATE_LIMITING:"Control API usage and rate limits",WEBHOOK_ENDPOINTS:"Enable webhook notifications and integrations",HEALTH_MONITORING:"Monitor integration system health",SYNC_SCHEDULING:"Automated data synchronization",AI_SUGGESTIONS:"Contextual AI-powered suggestions",LEARNING_PATHS:"Personalized AI learning recommendations",PERSONALIZATION:"AI-driven interface personalization",ACCESSIBILITY_FEATURES:"AI-powered accessibility enhancements",SMART_HELP_SYSTEM:"AI-powered contextual help and guidance"},STATUS:{ACTIVE:"Available",INACTIVE:"In Use"}},yr={MESSAGE_DISPLAY:5e3,RESET_MESSAGE_DISPLAY:3e3},U=({id:r,checked:t,onChange:s,label:a,description:n,disabled:l=!1})=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a}),n&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]}),e.jsxs("label",{htmlFor:r,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{id:r,type:"checkbox",className:"sr-only peer",checked:t,onChange:o=>s(o.target.checked),disabled:l}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"} ${l?"opacity-50 cursor-not-allowed":"cursor-pointer"}`}),e.jsx("span",{className:"sr-only",children:a})]})]}),ae=({title:r,children:t})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 border-b border-gray-200 pb-2",children:r}),e.jsx("div",{className:"space-y-4",children:t})]}),wo=({settings:r,updateMasterAI:t,updateComputerVision:s,updatePredictiveAnalytics:a,updateSmartWorkflow:n})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:N.SECTIONS.ENABLE_AI_FEATURES}),e.jsx("p",{className:"text-sm text-gray-500",children:N.DESCRIPTIONS.MASTER_AI_TOGGLE})]}),e.jsx(U,{id:"aiEnabled",checked:r.aiEnabled,onChange:t,label:""})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Fn,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.AI_FEATURES})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.COMPUTER_VISION,children:[e.jsx(U,{id:"toolConditionAssessment",checked:r.computerVision.toolConditionAssessment,onChange:l=>s("toolConditionAssessment",l),label:N.TOGGLE_LABELS.TOOL_CONDITION_ASSESSMENT,description:N.DESCRIPTIONS.TOOL_CONDITION_ASSESSMENT,disabled:!r.aiEnabled}),e.jsx(U,{id:"barcodeQualityDetection",checked:r.computerVision.barcodeQualityDetection,onChange:l=>s("barcodeQualityDetection",l),label:N.TOGGLE_LABELS.BARCODE_QUALITY_DETECTION,description:N.DESCRIPTIONS.BARCODE_QUALITY_DETECTION,disabled:!r.aiEnabled}),e.jsx(U,{id:"damageDetection",checked:r.computerVision.damageDetection,onChange:l=>s("damageDetection",l),label:N.TOGGLE_LABELS.DAMAGE_DETECTION,description:N.DESCRIPTIONS.DAMAGE_DETECTION,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.PREDICTIVE_ANALYTICS,children:[e.jsx(U,{id:"cycleOptimization",checked:r.predictiveAnalytics.cycleOptimization,onChange:l=>a("cycleOptimization",l),label:N.TOGGLE_LABELS.CYCLE_OPTIMIZATION,description:N.DESCRIPTIONS.CYCLE_OPTIMIZATION,disabled:!r.aiEnabled}),e.jsx(U,{id:"failurePrediction",checked:r.predictiveAnalytics.failurePrediction,onChange:l=>a("failurePrediction",l),label:N.TOGGLE_LABELS.FAILURE_PREDICTION,description:N.DESCRIPTIONS.FAILURE_PREDICTION,disabled:!r.aiEnabled}),e.jsx(U,{id:"efficiencyOptimization",checked:r.predictiveAnalytics.efficiencyOptimization,onChange:l=>a("efficiencyOptimization",l),label:N.TOGGLE_LABELS.EFFICIENCY_OPTIMIZATION,description:N.DESCRIPTIONS.EFFICIENCY_OPTIMIZATION,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.SMART_WORKFLOW,children:[e.jsx(U,{id:"intelligentWorkflowSelection",checked:r.smartWorkflow.intelligentWorkflowSelection,onChange:l=>n("intelligentWorkflowSelection",l),label:N.TOGGLE_LABELS.INTELLIGENT_WORKFLOW_SELECTION,description:N.DESCRIPTIONS.INTELLIGENT_WORKFLOW_SELECTION,disabled:!r.aiEnabled}),e.jsx(U,{id:"automatedProblemDetection",checked:r.smartWorkflow.automatedProblemDetection,onChange:l=>n("automatedProblemDetection",l),label:N.TOGGLE_LABELS.AUTOMATED_PROBLEM_DETECTION,description:N.DESCRIPTIONS.AUTOMATED_PROBLEM_DETECTION,disabled:!r.aiEnabled})]})]})]})})]}),So=({settings:r,updateAnalytics:t})=>e.jsxs(ae,{title:N.FORM_GROUPS.REPORTING_EXPORT,children:[e.jsx(U,{id:"exportCapabilities",checked:r.analytics.exportCapabilities,onChange:s=>t("exportCapabilities",s),label:N.TOGGLE_LABELS.EXPORT_CAPABILITIES,description:N.DESCRIPTIONS.EXPORT_CAPABILITIES,disabled:!r.aiEnabled}),e.jsx(U,{id:"dashboardCustomization",checked:r.analytics.dashboardCustomization,onChange:s=>t("dashboardCustomization",s),label:N.TOGGLE_LABELS.DASHBOARD_CUSTOMIZATION,description:N.DESCRIPTIONS.DASHBOARD_CUSTOMIZATION,disabled:!r.aiEnabled})]}),Eo=({settings:r,updateAnalytics:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Ke,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.ANALYTICS_CONFIGURATION})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.DATA_COLLECTION,children:[e.jsx(U,{id:"dataCollection",checked:r.analytics.dataCollection,onChange:s=>t("dataCollection",s),label:N.TOGGLE_LABELS.DATA_COLLECTION,description:N.DESCRIPTIONS.DATA_COLLECTION,disabled:!r.aiEnabled}),e.jsx(U,{id:"realTimeUpdates",checked:r.analytics.realTimeUpdates,onChange:s=>t("realTimeUpdates",s),label:N.TOGGLE_LABELS.REAL_TIME_UPDATES,description:N.DESCRIPTIONS.REAL_TIME_UPDATES,disabled:!r.aiEnabled}),e.jsx(U,{id:"historicalDataRetention",checked:r.analytics.historicalDataRetention,onChange:s=>t("historicalDataRetention",s),label:N.TOGGLE_LABELS.HISTORICAL_DATA_RETENTION,description:N.DESCRIPTIONS.HISTORICAL_DATA_RETENTION,disabled:!r.aiEnabled})]}),e.jsx(So,{settings:r,updateAnalytics:t})]})]}),To=({settings:r,updatePerformance:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Va,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.PERFORMANCE_MONITORING})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.QUALITY_METRICS,children:[e.jsx(U,{id:"accuracyTracking",checked:r.performance.accuracyTracking,onChange:s=>t("accuracyTracking",s),label:N.TOGGLE_LABELS.ACCURACY_TRACKING,description:N.DESCRIPTIONS.ACCURACY_TRACKING,disabled:!r.aiEnabled}),e.jsx(U,{id:"responseTimeMonitoring",checked:r.performance.responseTimeMonitoring,onChange:s=>t("responseTimeMonitoring",s),label:N.TOGGLE_LABELS.RESPONSE_TIME_MONITORING,description:N.DESCRIPTIONS.RESPONSE_TIME_MONITORING,disabled:!r.aiEnabled}),e.jsx(U,{id:"errorRateTracking",checked:r.performance.errorRateTracking,onChange:s=>t("errorRateTracking",s),label:N.TOGGLE_LABELS.ERROR_RATE_TRACKING,description:N.DESCRIPTIONS.ERROR_RATE_TRACKING,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.OPTIMIZATION,children:[e.jsx(U,{id:"performanceAlerts",checked:r.performance.performanceAlerts,onChange:s=>t("performanceAlerts",s),label:N.TOGGLE_LABELS.PERFORMANCE_ALERTS,description:N.DESCRIPTIONS.PERFORMANCE_ALERTS,disabled:!r.aiEnabled}),e.jsx(U,{id:"modelHealthMonitoring",checked:r.performance.modelHealthMonitoring,onChange:s=>t("modelHealthMonitoring",s),label:N.TOGGLE_LABELS.MODEL_HEALTH_MONITORING,description:N.DESCRIPTIONS.MODEL_HEALTH_MONITORING,disabled:!r.aiEnabled})]})]})]}),Po=({settings:r,updatePrivacy:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Ss,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.DATA_PRIVACY_SECURITY})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.PRIVACY_CONTROLS,children:[e.jsx(U,{id:"dataAnonymization",checked:r.privacy.dataAnonymization,onChange:s=>t("dataAnonymization",s),label:N.TOGGLE_LABELS.DATA_ANONYMIZATION,description:N.DESCRIPTIONS.DATA_ANONYMIZATION,disabled:!r.aiEnabled}),e.jsx(U,{id:"thirdPartyPermissions",checked:r.privacy.thirdPartyPermissions,onChange:s=>t("thirdPartyPermissions",s),label:N.TOGGLE_LABELS.THIRD_PARTY_PERMISSIONS,description:N.DESCRIPTIONS.THIRD_PARTY_PERMISSIONS,disabled:!r.aiEnabled}),e.jsx(U,{id:"complianceMonitoring",checked:r.privacy.complianceMonitoring,onChange:s=>t("complianceMonitoring",s),label:N.TOGGLE_LABELS.COMPLIANCE_MONITORING,description:N.DESCRIPTIONS.COMPLIANCE_MONITORING,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.SECURITY_FEATURES,children:[e.jsx(U,{id:"encryption",checked:r.privacy.encryption,onChange:s=>t("encryption",s),label:N.TOGGLE_LABELS.ENCRYPTION,description:N.DESCRIPTIONS.ENCRYPTION,disabled:!r.aiEnabled}),e.jsx(U,{id:"accessControl",checked:r.privacy.accessControl,onChange:s=>t("accessControl",s),label:N.TOGGLE_LABELS.ACCESS_CONTROL,description:N.DESCRIPTIONS.ACCESS_CONTROL,disabled:!r.aiEnabled})]})]})]}),Io=({settings:r,updateIntegration:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:zn,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.INTEGRATION_SETTINGS})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.EXTERNAL_SERVICES,children:[e.jsx(U,{id:"externalServices",checked:r.integration.externalServices,onChange:s=>t("externalServices",s),label:N.TOGGLE_LABELS.EXTERNAL_SERVICES,description:N.DESCRIPTIONS.EXTERNAL_SERVICES,disabled:!r.aiEnabled}),e.jsx(U,{id:"apiRateLimiting",checked:r.integration.apiRateLimiting,onChange:s=>t("apiRateLimiting",s),label:N.TOGGLE_LABELS.API_RATE_LIMITING,description:N.DESCRIPTIONS.API_RATE_LIMITING,disabled:!r.aiEnabled}),e.jsx(U,{id:"webhookEndpoints",checked:r.integration.webhookEndpoints,onChange:s=>t("webhookEndpoints",s),label:N.TOGGLE_LABELS.WEBHOOK_ENDPOINTS,description:N.DESCRIPTIONS.WEBHOOK_ENDPOINTS,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.SYSTEM_HEALTH,children:[e.jsx(U,{id:"healthMonitoring",checked:r.integration.healthMonitoring,onChange:s=>t("healthMonitoring",s),label:N.TOGGLE_LABELS.HEALTH_MONITORING,description:N.DESCRIPTIONS.HEALTH_MONITORING,disabled:!r.aiEnabled}),e.jsx(U,{id:"syncScheduling",checked:r.integration.syncScheduling,onChange:s=>t("syncScheduling",s),label:N.TOGGLE_LABELS.SYNC_SCHEDULING,description:N.DESCRIPTIONS.SYNC_SCHEDULING,disabled:!r.aiEnabled})]})]})]}),Ao=({serviceStatus:r})=>e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-3",children:N.SECTIONS.AI_SERVICE_STATUS}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(r).map(([t,s])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:s?Le:te,size:1,className:s?"text-green-600":"text-red-500"}),e.jsx("span",{className:"text-sm capitalize",children:t}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${s?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s?N.STATUS.ACTIVE:N.STATUS.INACTIVE})]},t))})]}),Oo=({settings:r,updateUserExperience:t})=>e.jsxs(ae,{title:N.FORM_GROUPS.INTERFACE_HELP,children:[e.jsx(U,{id:"accessibility",checked:r.userExperience.accessibility,onChange:s=>t("accessibility",s),label:N.TOGGLE_LABELS.ACCESSIBILITY_FEATURES,description:N.DESCRIPTIONS.ACCESSIBILITY_FEATURES,disabled:!r.aiEnabled}),e.jsx(U,{id:"helpSystem",checked:r.userExperience.helpSystem,onChange:s=>t("helpSystem",s),label:N.TOGGLE_LABELS.SMART_HELP_SYSTEM,description:N.DESCRIPTIONS.SMART_HELP_SYSTEM,disabled:!r.aiEnabled})]}),Do=({settings:r,updateUserExperience:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Ua,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.USER_EXPERIENCE})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.AI_ASSISTANCE,children:[e.jsx(U,{id:"aiSuggestions",checked:r.userExperience.aiSuggestions,onChange:s=>t("aiSuggestions",s),label:N.TOGGLE_LABELS.AI_SUGGESTIONS,description:N.DESCRIPTIONS.AI_SUGGESTIONS,disabled:!r.aiEnabled}),e.jsx(U,{id:"learningPaths",checked:r.userExperience.learningPaths,onChange:s=>t("learningPaths",s),label:N.TOGGLE_LABELS.LEARNING_PATHS,description:N.DESCRIPTIONS.LEARNING_PATHS,disabled:!r.aiEnabled}),e.jsx(U,{id:"personalization",checked:r.userExperience.personalization,onChange:s=>t("personalization",s),label:N.TOGGLE_LABELS.PERSONALIZATION,description:N.DESCRIPTIONS.PERSONALIZATION,disabled:!r.aiEnabled})]}),e.jsx(Oo,{settings:r,updateUserExperience:t})]})]}),tn=()=>{const{currentUser:r}=Fe(),t=()=>{var l;if(!r)return!1;const o=(l=r.role)==null?void 0:l.toLowerCase();return["administrator","admin","👑 administrator","system_admin","super_admin"].includes(o)},s=()=>t(),a=()=>!!r,n=()=>t();return{isAdmin:t(),canManageThrottling:s(),canViewUsage:a(),canConfigureAI:n(),userRole:(r==null?void 0:r.role)||"Unknown"}};var ko=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Ro=({facilityId:r})=>{const[t,s]=x.useState(null),[a,n]=x.useState(!0),[l,o]=x.useState(null),[c,i]=x.useState(!1),[d,u]=x.useState(!1),m=za.getInstance(),{canViewUsage:f}=tn();x.useEffect(()=>{const p=()=>ko(null,null,function*(){try{n(!0);const w=m.getUsageData();s(w)}catch(w){o("Failed to load usage data"),console.error("Error fetching token usage:",w)}finally{n(!1)}});p();const _=setInterval(p,3e4);return()=>clearInterval(_)},[r,m]);const b=p=>p>=90?"text-red-600 bg-red-50 border-red-200":p>=75?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-green-600 bg-green-50 border-green-200",h=p=>p>=90?te:p>=75?Ls:Le;return f?a?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})]})}):l||!t?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{path:te,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:l||"No usage data available"})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(y,{path:Ke,size:1.2,className:"text-[#4ECDC4]"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"AI Usage Dashboard"})]}),e.jsxs("div",{className:`p-4 rounded-lg border mb-6 ${b(t.budget.percentage)}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:h(t.budget.percentage),size:1,className:t.budget.percentage>=75?"text-current":"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Monthly Usage Status"}),e.jsxs("p",{className:"text-sm opacity-75",children:[t.currentMonth.tokens.toLocaleString()," tokens used this month"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:[t.budget.percentage.toFixed(1),"%"]}),e.jsxs("div",{className:"text-sm opacity-75",children:[Math.max(0,t.budget.limit-t.currentMonth.tokens).toLocaleString()," tokens remaining"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${t.budget.percentage>=90?"bg-red-500":t.budget.percentage>=75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(t.budget.percentage,100)}%`}})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Tokens"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.currentMonth.tokens.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"This month"})]}),e.jsx(y,{path:Ke,size:1.5,className:"text-gray-400"})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"API Requests"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.currentMonth.requests.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"This month"})]}),e.jsx(y,{path:Ls,size:1.5,className:"text-gray-400"})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Tokens/Request"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.currentMonth.requests>0?Math.round(t.currentMonth.tokens/t.currentMonth.requests).toLocaleString():"0"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Efficiency metric"})]}),e.jsx(y,{path:Ke,size:1.5,className:"text-gray-400"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>i(!c),className:"flex items-center justify-between w-full p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Usage by Feature"}),e.jsx(y,{path:c?ot:ct,size:1,className:"text-gray-500"})]}),c&&e.jsx("div",{className:"mt-3 space-y-3",children:t.featureBreakdown.map((p,_)=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:p.feature}),e.jsxs("span",{className:"text-sm text-gray-600",children:[p.tokens.toLocaleString()," tokens (",p.percentage.toFixed(1),"%)"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-[#4ECDC4] h-2 rounded-full transition-all duration-300",style:{width:`${p.percentage}%`}})})]})},_))})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>u(!d),className:"flex items-center justify-between w-full p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Daily Usage Trend"}),e.jsx(y,{path:d?ot:ct,size:1,className:"text-gray-500"})]}),d&&e.jsx("div",{className:"mt-3 bg-gray-50 rounded-lg p-4",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:t.dailyUsage.map((p,_)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:new Date(p.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.tokens.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-600",children:[p.requests," requests"]})]})]},_))})})]})]}):e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{path:te,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Access denied. You need to be logged in to view AI usage data."})]})})};var $o=Object.defineProperty,Lo=Object.defineProperties,Mo=Object.getOwnPropertyDescriptors,vr=Object.getOwnPropertySymbols,Fo=Object.prototype.hasOwnProperty,zo=Object.prototype.propertyIsEnumerable,jr=(r,t,s)=>t in r?$o(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Ae=(r,t)=>{for(var s in t||(t={}))Fo.call(t,s)&&jr(r,s,t[s]);if(vr)for(var s of vr(t))zo.call(t,s)&&jr(r,s,t[s]);return r},Oe=(r,t)=>Lo(r,Mo(t));const qo=({settings:r,onUpdateSettings:t,currentUsage:s})=>{const[a,n]=x.useState(!1),[l,o]=x.useState(r),{canManageThrottling:c,userRole:i}=tn(),d=()=>{t(l),n(!1)},u=()=>{o(r),n(!1)},m=(b,h)=>{const p=b/h*100;return p>=90?"text-red-600":p>=75?"text-yellow-600":"text-green-600"},f=(b,h)=>{const p=b/h*100;return p>=90?te:p>=75?te:Le};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:Va,size:1.2,className:"text-[#4ECDC4]"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Throttling Controls"}),!c&&e.jsx(y,{path:Ss,size:.8,className:"text-gray-400",title:"Admin Only"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${r.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:r.enabled?"Enabled":"Disabled"})]}),c?e.jsx("button",{onClick:()=>n(!a),className:"px-4 py-2 text-sm font-medium text-[#4ECDC4] hover:text-[#3db8b0] transition-colors",children:a?"Cancel":"Configure"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Admin access required"}),e.jsxs("div",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded",children:["Role: ",i," | Admin: ",c?"Yes":"No"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Requests/Minute"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.requestsThisMinute,r.requestsPerMinute)}`,children:s.requestsThisMinute}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",r.requestsPerMinute]})]}),e.jsx(y,{path:f(s.requestsThisMinute,r.requestsPerMinute),size:1.5,className:m(s.requestsThisMinute,r.requestsPerMinute)})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Requests/Hour"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.requestsThisHour,r.requestsPerHour)}`,children:s.requestsThisHour}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",r.requestsPerHour]})]}),e.jsx(y,{path:f(s.requestsThisHour,r.requestsPerHour),size:1.5,className:m(s.requestsThisHour,r.requestsPerHour)})]})}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Monthly Tokens"}),e.jsx("p",{className:`text-2xl font-bold ${m(s.monthlyTokens,s.monthlyTokenLimit)}`,children:s.monthlyTokens.toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-500",children:["of ",s.monthlyTokenLimit.toLocaleString()]})]}),e.jsx(y,{path:f(s.monthlyTokens,s.monthlyTokenLimit),size:1.5,className:m(s.monthlyTokens,s.monthlyTokenLimit)})]})})]}),a&&c&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Throttling Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requests Per Minute"}),e.jsx("input",{type:"number",value:l.requestsPerMinute,onChange:b=>o(h=>Oe(Ae({},h),{requestsPerMinute:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requests Per Hour"}),e.jsx("input",{type:"number",value:l.requestsPerHour,onChange:b=>o(h=>Oe(Ae({},h),{requestsPerHour:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"10000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Burst Limit"}),e.jsx("input",{type:"number",value:l.burstLimit,onChange:b=>o(h=>Oe(Ae({},h),{burstLimit:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"1",max:"100"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Token Limit"}),e.jsx("input",{type:"number",value:l.monthlyTokenLimit,onChange:b=>o(h=>Oe(Ae({},h),{monthlyTokenLimit:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"10000",max:"10000000",step:"1000"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: 500,000 - 1,000,000 tokens/month"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Warning Threshold (%)"}),e.jsx("input",{type:"number",value:l.warningThreshold,onChange:b=>o(h=>Oe(Ae({},h),{warningThreshold:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"50",max:"95"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Critical Threshold (%)"}),e.jsx("input",{type:"number",value:l.criticalThreshold,onChange:b=>o(h=>Oe(Ae({},h),{criticalThreshold:parseInt(b.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-transparent",min:"75",max:"100"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancel"}),e.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-white bg-[#4ECDC4] hover:bg-[#3db8b0] rounded-md transition-colors",children:"Save Changes"})]})]}),c&&e.jsx("div",{className:"mt-6 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Enable/Disable Throttling"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.enabled,onChange:b=>t(Oe(Ae({},r),{enabled:b.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#4ECDC4]"})]})]})})]})},Uo=({isSaving:r,onResetToDefaults:t,onSaveSettings:s})=>e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{path:Ze,size:1.5,className:"text-[#4ECDC4]"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-800",children:N.HEADER.TITLE}),e.jsx("p",{className:"text-sm text-gray-600",children:N.HEADER.SUBTITLE})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(y,{path:$t,size:1}),N.BUTTONS.RESET]}),e.jsxs("button",{onClick:s,disabled:r,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-[#4ECDC4] hover:bg-[#3db8b0] rounded-lg disabled:opacity-50",children:[e.jsx(y,{path:r?$t:ht,size:1,className:r?"animate-spin":""}),r?N.BUTTONS.SAVING:N.BUTTONS.SAVE]})]})]}),Vo=({settings:r,updateIntelligence:t})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(y,{path:Ze,size:1,className:"text-[#4ECDC4]"}),e.jsx("h5",{className:"text-lg font-medium text-gray-800",children:N.SECTIONS.INTELLIGENCE_SETTINGS})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ae,{title:N.FORM_GROUPS.RISK_ALERTS,children:[e.jsx(U,{id:"riskAssessment",checked:r.intelligence.riskAssessment,onChange:s=>t("riskAssessment",s),label:N.TOGGLE_LABELS.RISK_ASSESSMENT,description:N.DESCRIPTIONS.RISK_ASSESSMENT,disabled:!r.aiEnabled}),e.jsx(U,{id:"alertSystem",checked:r.intelligence.alertSystem,onChange:s=>t("alertSystem",s),label:N.TOGGLE_LABELS.ALERT_SYSTEM,description:N.DESCRIPTIONS.ALERT_SYSTEM,disabled:!r.aiEnabled}),e.jsx(U,{id:"escalationRules",checked:r.intelligence.escalationRules,onChange:s=>t("escalationRules",s),label:N.TOGGLE_LABELS.ESCALATION_RULES,description:N.DESCRIPTIONS.ESCALATION_RULES,disabled:!r.aiEnabled})]}),e.jsxs(ae,{title:N.FORM_GROUPS.AI_INSIGHTS,children:[e.jsx(U,{id:"aiRecommendations",checked:r.intelligence.aiRecommendations,onChange:s=>t("aiRecommendations",s),label:N.TOGGLE_LABELS.AI_RECOMMENDATIONS,description:N.DESCRIPTIONS.AI_RECOMMENDATIONS,disabled:!r.aiEnabled}),e.jsx(U,{id:"optimizationTips",checked:r.intelligence.optimizationTips,onChange:s=>t("optimizationTips",s),label:N.TOGGLE_LABELS.OPTIMIZATION_TIPS,description:N.DESCRIPTIONS.OPTIMIZATION_TIPS,disabled:!r.aiEnabled})]})]})]});var Bo=Object.defineProperty,Go=Object.defineProperties,Ho=Object.getOwnPropertyDescriptors,Nr=Object.getOwnPropertySymbols,Yo=Object.prototype.hasOwnProperty,Wo=Object.prototype.propertyIsEnumerable,_r=(r,t,s)=>t in r?Bo(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Z=(r,t)=>{for(var s in t||(t={}))Yo.call(t,s)&&_r(r,s,t[s]);if(Nr)for(var s of Nr(t))Wo.call(t,s)&&_r(r,s,t[s]);return r},J=(r,t)=>Go(r,Ho(t)),Pt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Ko=()=>{const{getCurrentFacilityId:r}=Qe(),t=r(),s=Za(),a=Co(),[n,l]=x.useState(null),[o,c]=x.useState(!1),[i,d]=x.useState(!1),[u,m]=x.useState(null),[f,b]=x.useState(null),[h,p]=x.useState("overview"),_=x.useCallback(()=>Pt(null,null,function*(){if(a){c(!0);try{const C=yield a.loadUnifiedSettings();l(C)}catch(C){console.error("Failed to load AI settings:",C),m({type:"error",text:N.MESSAGES.SAVE_ERROR})}finally{c(!1)}}}),[a]),w=x.useCallback(()=>Pt(null,null,function*(){if(a)try{const C=yield a.getServiceStatus();b(C)}catch(C){console.error("Failed to load service status:",C)}}),[a]);x.useEffect(()=>{a&&(_(),w())},[a,_,w]);const v=()=>Pt(null,null,function*(){if(!(!a||!n)){d(!0);try{(yield a.saveUnifiedSettings(n))?(yield a.applySettings(n),m({type:"success",text:N.MESSAGES.SAVE_SUCCESS}),setTimeout(()=>m(null),yr.MESSAGE_DISPLAY),yield w()):m({type:"error",text:N.MESSAGES.SAVE_ERROR})}catch(C){console.error("Failed to save AI settings:",C),m({type:"error",text:N.MESSAGES.SAVE_ERROR})}finally{d(!1)}}}),j=()=>Pt(null,null,function*(){if(a)try{const C=yield a.loadUnifiedSettings();l(C),m({type:"success",text:N.MESSAGES.RESET_SUCCESS}),setTimeout(()=>m(null),yr.RESET_MESSAGE_DISPLAY)}catch(C){console.error("Failed to reset settings:",C),m({type:"error",text:N.MESSAGES.RESET_ERROR})}}),E=(C,O)=>{n&&l(T=>T?J(Z({},T),{computerVision:J(Z({},T.computerVision),{[C]:O})}):null)},k=(C,O)=>{n&&l(T=>T?J(Z({},T),{predictiveAnalytics:J(Z({},T.predictiveAnalytics),{[C]:O})}):null)},A=(C,O)=>{n&&l(T=>T?J(Z({},T),{smartWorkflow:J(Z({},T.smartWorkflow),{[C]:O})}):null)},V=(C,O)=>{n&&l(T=>T?J(Z({},T),{analytics:J(Z({},T.analytics),{[C]:O})}):null)},$=(C,O)=>{n&&l(T=>T?J(Z({},T),{intelligence:J(Z({},T.intelligence),{[C]:O})}):null)},G=(C,O)=>{n&&l(T=>T?J(Z({},T),{performance:J(Z({},T.performance),{[C]:O})}):null)},D=(C,O)=>{n&&l(T=>T?J(Z({},T),{privacy:J(Z({},T.privacy),{[C]:O})}):null)},S=(C,O)=>{n&&l(T=>T?J(Z({},T),{integration:J(Z({},T.integration),{[C]:O})}):null)},L=(C,O)=>{n&&l(T=>T?J(Z({},T),{userExperience:J(Z({},T.userExperience),{[C]:O})}):null)},H=C=>{n&&l(O=>O?J(Z({},O),{aiEnabled:C}):null)};return t?o?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#4ECDC4] mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:N.MESSAGES.LOADING})]}):n?e.jsxs("div",{className:"space-y-6",children:[s.hasIssues&&e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${s.isExceeded?"bg-red-50 border-red-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{path:s.isExceeded?te:te,size:1.2,className:`mr-3 ${s.isExceeded?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${s.isExceeded?"text-red-800":"text-yellow-800"}`,children:s.isExceeded?"AI Usage Limit Exceeded":"AI Usage Warning"}),e.jsx("p",{className:`text-sm ${s.isExceeded?"text-red-700":"text-yellow-700"}`,children:s.isExceeded?`You've used ${s.usedTokens.toLocaleString()} tokens (${Math.round(s.usagePercentage)}%) of your ${s.limitTokens.toLocaleString()} token limit.`:`You've used ${s.usedTokens.toLocaleString()} tokens (${Math.round(s.usagePercentage)}%) of your ${s.limitTokens.toLocaleString()} token limit. Consider adjusting throttling settings.`})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[{id:"overview",name:"Overview",icon:"📊"},{id:"usage",name:"Usage & Limits",icon:"📈"},{id:"features",name:"AI Features",icon:"⚙️"},{id:"settings",name:"Settings",icon:"🔧"}].map(C=>e.jsxs("button",{onClick:()=>p(C.id),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${h===C.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:C.icon}),C.name]},C.id))})}),e.jsxs("div",{className:"p-6",children:[h==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Uo,{isSaving:i,onResetToDefaults:j,onSaveSettings:v}),f&&e.jsx(Ao,{serviceStatus:f})]}),h==="usage"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ro,{facilityId:t}),e.jsx(qo,{settings:{enabled:!0,requestsPerMinute:60,requestsPerHour:1e3,burstLimit:10,monthlyTokenLimit:1e6,warningThreshold:75,criticalThreshold:90},onUpdateSettings:C=>{console.log("Updating throttling settings:",C)},currentUsage:{requestsThisMinute:15,requestsThisHour:120,monthlyTokens:125e3,monthlyTokenLimit:1e6}})]}),h==="features"&&e.jsx(wo,{settings:n,updateMasterAI:H,updateComputerVision:E,updatePredictiveAnalytics:k,updateSmartWorkflow:A}),h==="settings"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Eo,{settings:n,updateAnalytics:V}),e.jsx(Vo,{settings:n,updateIntelligence:$}),e.jsx(To,{settings:n,updatePerformance:G}),e.jsx(Po,{settings:n,updatePrivacy:D}),e.jsx(Io,{settings:n,updateIntegration:S}),e.jsx(Do,{settings:n,updateUserExperience:L})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{path:te,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:N.MESSAGES.FAILED_TO_LOAD})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(y,{path:te,size:2,className:"text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:N.MESSAGES.FACILITY_NOT_AVAILABLE})]})},Ee={AI_VERSION:"1.0.0",AI_CONFIDENCE_THRESHOLD:.85,AI_DATA_RETENTION_DAYS:90,ENCRYPTED_DATA_TRANSMISSION:!0},rs={COMPUTER_VISION:[{key:"tool_condition_assessment",label:"Tool Condition Assessment",desc:"AI-powered visual inspection of tool wear and damage"},{key:"barcode_quality_detection",label:"Barcode Quality Detection",desc:"Automated barcode readability assessment"},{key:"tool_type_recognition",label:"Tool Type Recognition",desc:"Automatic tool identification from images"},{key:"cleaning_validation",label:"Cleaning Validation",desc:"Visual verification of cleaning effectiveness"}],PREDICTIVE_ANALYTICS:[{key:"cycle_optimization",label:"Cycle Optimization",desc:"AI-driven sterilization cycle parameter optimization"},{key:"failure_prediction",label:"Failure Prediction",desc:"Predictive maintenance and equipment failure alerts"},{key:"efficiency_optimization",label:"Efficiency Optimization",desc:"Process efficiency analysis and recommendations"},{key:"resource_planning",label:"Resource Planning",desc:"Intelligent resource allocation and scheduling"}],SMART_WORKFLOW:[{key:"intelligent_workflow_selection",label:"Intelligent Workflow Selection",desc:"AI-powered workflow recommendation based on tool type and condition"},{key:"automated_problem_detection",label:"Automated Problem Detection",desc:"Real-time issue identification and alerting"},{key:"smart_phase_transitions",label:"Smart Phase Transitions",desc:"Intelligent sterilization phase management"},{key:"batch_optimization",label:"Batch Optimization",desc:"Optimal tool grouping and batch processing"}]},Qo=[{value:"unwrapped",label:"Unwrapped (3 min, 132°C)"},{value:"pouches",label:"Pouches (5 min, 132°C)"},{value:"packs",label:"Packs (30 min, 121°C)"},{value:"handpieces",label:"Handpieces (6 min, 132°C)"},{value:"custom",label:"Custom"}],Zo=[{value:3,label:"3 months"},{value:6,label:"6 months"},{value:12,label:"1 year (recommended)"},{value:18,label:"18 months"},{value:24,label:"2 years"}],Jo=[{value:30,label:"30 days"},{value:60,label:"60 days"},{value:90,label:"90 days (recommended)"},{value:180,label:"180 days"},{value:365,label:"1 year"}],Se={TEMPERATURE:{min:100,max:150},PRESSURE:{min:10,max:30},STERILIZE_TIME:{min:1,max:60},DRY_TIME:{min:10,max:60}},as={min:.5,max:1,step:.05},Cr=3e3;var Ps=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Xo=r=>Ps(null,null,function*(){try{return yield new Vt(r).loadSettings()}catch(t){return console.error("Failed to load AI settings:",t),null}}),wr=(r,t)=>Ps(null,null,function*(){try{return yield new Vt(r).saveSettings(t)}catch(s){return console.error("Failed to save AI settings:",s),!1}}),ec=r=>Ps(null,null,function*(){try{const t={facility_id:r,ai_enabled:!1,ai_version:Ee.AI_VERSION,computer_vision_enabled:!1,tool_condition_assessment:!1,barcode_quality_detection:!1,tool_type_recognition:!1,cleaning_validation:!1,predictive_analytics_enabled:!1,cycle_optimization:!1,failure_prediction:!1,efficiency_optimization:!1,resource_planning:!1,smart_workflow_enabled:!1,intelligent_workflow_selection:!1,automated_problem_detection:!1,smart_phase_transitions:!1,batch_optimization:!1,quality_assurance_enabled:!1,biological_indicator_analysis:!1,compliance_monitoring:!1,audit_trail_enhancement:!1,risk_assessment:!1,scanner_intelligence_enabled:!1,multi_format_barcode_support:!1,tool_history_integration:!1,smart_validation:!1,error_prevention:!1,real_time_monitoring_enabled:!1,anomaly_detection:!1,predictive_maintenance:!1,quality_drift_detection:!1,smart_notifications:!1,ai_confidence_threshold:Ee.AI_CONFIDENCE_THRESHOLD,ai_data_retention_days:Ee.AI_DATA_RETENTION_DAYS,real_time_processing_enabled:!1,batch_processing_enabled:!1,data_sharing_enabled:!1,local_ai_processing_enabled:!1,encrypted_data_transmission:Ee.ENCRYPTED_DATA_TRANSMISSION,ai_model_training:!1,auto_optimization_enabled:!1,performance_monitoring:!1,resource_optimization:!1,openai_api_key_encrypted:"",google_vision_api_key_encrypted:"",azure_computer_vision_key_encrypted:""};return yield new Vt(r).saveSettings(t)}catch(t){return console.error("Failed to reset AI settings:",t),!1}}),ns=r=>({facility_id:r,ai_enabled:!1,ai_version:Ee.AI_VERSION,computer_vision_enabled:!1,tool_condition_assessment:!1,barcode_quality_detection:!1,tool_type_recognition:!1,cleaning_validation:!1,predictive_analytics_enabled:!1,cycle_optimization:!1,failure_prediction:!1,efficiency_optimization:!1,resource_planning:!1,smart_workflow_enabled:!1,intelligent_workflow_selection:!1,automated_problem_detection:!1,smart_phase_transitions:!1,batch_optimization:!1,quality_assurance_enabled:!1,biological_indicator_analysis:!1,compliance_monitoring:!1,audit_trail_enhancement:!1,risk_assessment:!1,scanner_intelligence_enabled:!1,multi_format_barcode_support:!1,tool_history_integration:!1,smart_validation:!1,error_prevention:!1,real_time_monitoring_enabled:!1,anomaly_detection:!1,predictive_maintenance:!1,quality_drift_detection:!1,smart_notifications:!1,ai_confidence_threshold:Ee.AI_CONFIDENCE_THRESHOLD,ai_data_retention_days:Ee.AI_DATA_RETENTION_DAYS,real_time_processing_enabled:!1,batch_processing_enabled:!1,data_sharing_enabled:!1,local_ai_processing_enabled:!1,encrypted_data_transmission:Ee.ENCRYPTED_DATA_TRANSMISSION,ai_model_training:!1,auto_optimization_enabled:!1,performance_monitoring:!1,resource_optimization:!1,openai_api_key_encrypted:"",google_vision_api_key_encrypted:"",azure_computer_vision_key_encrypted:""}),Be=(r,t,s,a)=>{console.log("Setting changed:",{setting:r,oldValue:t,newValue:s,facilityId:a,timestamp:new Date().toISOString()})},tc=(r,t)=>{console.log("Save attempt:",{facilityId:t,timestamp:new Date().toISOString(),settingsCount:Object.keys(r).length,aiEnabled:r.ai_enabled})},is=(r,t,s)=>{console.log("Save result:",{success:r,facilityId:t,timestamp:new Date().toISOString(),error:s||null})},sc=r=>{console.log("Reset attempt:",{facilityId:r,timestamp:new Date().toISOString()})},ls=(r,t,s)=>{console.log("Reset result:",{success:r,facilityId:t,timestamp:new Date().toISOString(),error:s||null})},rc=(r,t,s)=>{console.log("AI feature toggle:",{feature:r,enabled:t,facilityId:s,timestamp:new Date().toISOString()})},Ge=(r,t,s)=>{console.log("Cycle settings change:",{cycleType:r,changes:t,facilityId:s,timestamp:new Date().toISOString()})},Sr=(r,t,s)=>{console.log("Enforcement toggle:",{type:r,enabled:t,facilityId:s,timestamp:new Date().toISOString()})},Er=(r,t,s)=>{console.log("Receipt settings change:",{setting:r,value:t,facilityId:s,timestamp:new Date().toISOString()})},ac=()=>{const{enforceCi:r,enforceBi:t,_allowOverrides:s,updateComplianceSettings:a,fetchComplianceSettings:n}=Cs(),[l,o]=x.useState(!1),[c,i]=x.useState(!1),{getCurrentFacilityId:d}=Qe();return x.useEffect(()=>{const u=d();u&&n(u)},[d,n]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Sterilization Enforcement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"enforceBI",className:"text-sm font-medium",children:"Biological Indicator Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable daily BI test requirements and compliance tracking"})]}),e.jsx("button",{onClick:()=>{const u=d();u&&(Sr("BI",!t,u),a(u,{enforceBi:!t}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${t?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t?"translate-x-6":"translate-x-1"}`})})]}),t&&e.jsxs("div",{className:"ml-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"BI tests are being enforced"})]}),e.jsxs("button",{onClick:()=>o(!l),className:"text-xs text-blue-600 hover:text-blue-800",children:[l?"Hide":"Show"," BI test history"]}),l&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-md text-xs text-gray-600",children:[e.jsx("p",{children:"• Last BI test: 2024-01-15 (PASS)"}),e.jsx("p",{children:"• Next required: 2024-01-16"}),e.jsx("p",{children:"• Tests passed this month: 15"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Chemical Indicator (CI) Management"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Configure how CI indicators are handled during autoclave cycles."}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-xs text-blue-800",children:[e.jsx("strong",{children:"ON:"})," Users must confirm CI strip usage (Y/N selection in workflow)",e.jsx("br",{}),e.jsx("strong",{children:"OFF:"})," Users get a warning but can proceed without CI confirmation"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:"enforceCI",className:"font-medium",children:"Require CI Confirmation"}),e.jsx("button",{id:"enforceCI",onClick:()=>{const u=d();u&&(Sr("CI",!r,u),a(u,{enforceCi:!r}))},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${r?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]})]})]})};var nc=Object.defineProperty,Mt=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,rn=Object.prototype.propertyIsEnumerable,Tr=(r,t,s)=>t in r?nc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ic=(r,t)=>{for(var s in t||(t={}))sn.call(t,s)&&Tr(r,s,t[s]);if(Mt)for(var s of Mt(t))rn.call(t,s)&&Tr(r,s,t[s]);return r},lc=(r,t)=>{var s={};for(var a in r)sn.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&Mt)for(var a of Mt(r))t.indexOf(a)<0&&rn.call(r,a)&&(s[a]=r[a]);return s};const Pr=r=>{var t=r,{className:s=""}=t,a=lc(t,["className"]);return e.jsx("input",ic({className:`flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${s}`},a))};var oc=Object.defineProperty,cc=Object.defineProperties,dc=Object.getOwnPropertyDescriptors,Ft=Object.getOwnPropertySymbols,an=Object.prototype.hasOwnProperty,nn=Object.prototype.propertyIsEnumerable,Ir=(r,t,s)=>t in r?oc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,uc=(r,t)=>{for(var s in t||(t={}))an.call(t,s)&&Ir(r,s,t[s]);if(Ft)for(var s of Ft(t))nn.call(t,s)&&Ir(r,s,t[s]);return r},mc=(r,t)=>cc(r,dc(t)),hc=(r,t)=>{var s={};for(var a in r)an.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&Ft)for(var a of Ft(r))t.indexOf(a)<0&&nn.call(r,a)&&(s[a]=r[a]);return s};const rt=r=>{var t=r,{children:s,className:a=""}=t,n=hc(t,["children","className"]);return e.jsx("label",mc(uc({className:`text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ${a}`},n),{children:s}))};var gc=Object.defineProperty,zt=Object.getOwnPropertySymbols,ln=Object.prototype.hasOwnProperty,on=Object.prototype.propertyIsEnumerable,Ar=(r,t,s)=>t in r?gc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,xc=(r,t)=>{for(var s in t||(t={}))ln.call(t,s)&&Ar(r,s,t[s]);if(zt)for(var s of zt(t))on.call(t,s)&&Ar(r,s,t[s]);return r},pc=(r,t)=>{var s={};for(var a in r)ln.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&zt)for(var a of zt(r))t.indexOf(a)<0&&on.call(r,a)&&(s[a]=r[a]);return s};const Or=r=>{var t=r,{className:s="",onCheckedChange:a,onChange:n}=t,l=pc(t,["className","onCheckedChange","onChange"]);const o=c=>{a&&a(c.target.checked),n&&n(c)};return e.jsx("input",xc({type:"checkbox",className:`h-4 w-4 text-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 border-gray-300 rounded transition-colors duration-200 ${s}`,onChange:o},l))},fc=({checked:r,onCheckedChange:t,className:s="",disabled:a=!1})=>{const n=()=>{a||t(!r)};return e.jsx("button",{type:"button",role:"switch","aria-checked":r,disabled:a,onClick:n,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${r?"bg-blue-600":"bg-gray-200"} ${a?"opacity-50 cursor-not-allowed":"cursor-pointer"} ${s}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})})};var Dr=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const bc=()=>{const{currentUser:r}=Fe(),[t,s]=x.useState(!0),[a,n]=x.useState(null),[l,o]=x.useState(["pouch","wrap","container","tray"]),[c,i]=x.useState(["small","medium","large","extra-large"]),[d,u]=x.useState(!1),[m,f]=x.useState("PKG-"),[b,h]=x.useState(25);x.useEffect(()=>{Dr(null,null,function*(){try{if(!r)return;const{data:j,error:E}=yield P.from("facility_settings").select("packaging_settings").eq("facility_id",r.facility_id).single();if(E&&console.warn("No existing packaging settings found"),j!=null&&j.packaging_settings){const k=j.packaging_settings;o(A=>k.packageTypes||A),i(A=>k.packageSizes||A),u(!!k.requireReceiptUpload),f(A=>k.batchPrefix||A),h(A=>k.maxToolsPerBatch||A)}n(r.facility_id)}catch(j){console.error("Error loading packaging settings:",j)}finally{s(!1)}})},[r]);const p=()=>Dr(null,null,function*(){if(!a)return;s(!0);const v={packageTypes:l,packageSizes:c,requireReceiptUpload:d,batchPrefix:m,maxToolsPerBatch:b},{error:j}=yield P.from("facility_settings").update({packaging_settings:v}).eq("facility_id",a);j&&console.error("Error saving packaging settings:",j),s(!1)}),_=v=>{o(j=>j.includes(v)?j.filter(E=>E!==v):[...j,v])},w=v=>{i(j=>j.includes(v)?j.filter(E=>E!==v):[...j,v])};return t?e.jsx("p",{className:"text-sm text-gray-500",children:"Loading packaging settings..."}):e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"📦 Packaging Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(rt,{className:"font-medium",children:"Available Package Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:["pouch","wrap","container","tray"].map(v=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(Or,{checked:l.includes(v),onCheckedChange:()=>_(v)}),e.jsx("span",{className:"capitalize",children:v})]},v))})]}),e.jsxs("div",{children:[e.jsx(rt,{className:"font-medium",children:"Available Package Sizes"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2",children:["small","medium","large","extra-large"].map(v=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(Or,{checked:c.includes(v),onCheckedChange:()=>w(v)}),e.jsx("span",{className:"capitalize",children:v})]},v))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(rt,{className:"font-medium",children:"Require Receipt Upload"}),e.jsx(fc,{checked:d,onCheckedChange:u})]}),e.jsxs("div",{children:[e.jsx(rt,{className:"font-medium",children:"Batch Code Prefix"}),e.jsx(Pr,{value:m,onChange:v=>f(v.target.value),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(rt,{className:"font-medium",children:"Max Tools per Batch"}),e.jsx(Pr,{type:"number",value:b,onChange:v=>h(parseInt(v.target.value,10)),className:"mt-1"})]}),e.jsx("button",{onClick:p,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Save Settings"})]})]})},yc=()=>{const{cycleSettings:r,defaultCycleType:t,allowCustomCycles:s,setDefaultCycleType:a,setAllowCustomCycles:n,updateCycleSettings:l,resetCycleSettings:o}=Cs(),[c,i]=x.useState(null),{getCurrentFacilityId:d}=Qe();return e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Autoclave Cycle Customization"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultCycle",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Cycle Type"}),e.jsx("select",{id:"defaultCycle",value:t,onChange:u=>{const m=d();m&&Ge("defaultCycleType",{cycleType:u.target.value},m),a(u.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:Qo.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This cycle type will be selected by default for new sterilization runs"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"allowCustomCycles",className:"text-sm font-medium",children:"Allow Custom Cycle Parameters"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable users to modify temperature, pressure, and timing for special cases"})]}),e.jsx("button",{id:"allowCustomCycles",onClick:()=>{const u=d();u&&Ge("allowCustomCycles",{enabled:!s},u),n(!s)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${s?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${s?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Cycle Presets"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(r).map(([u,m])=>{const f=m;return e.jsxs("div",{className:"border border-gray-200 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h5",{className:"text-sm font-medium",children:f.name}),u==="custom"&&s&&e.jsx("button",{onClick:()=>i(c===u?null:u),className:"text-xs text-blue-600 hover:text-blue-800",children:c===u?"Save":"Edit"})]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Temperature: ",f.temperature,"°C"]}),e.jsxs("p",{children:["Pressure: ",f.pressure," PSI"]}),e.jsxs("p",{children:["Sterilize Time: ",f.sterilizeTime," min"]}),e.jsxs("p",{children:["Dry Time: ",f.dryTime," min"]}),e.jsxs("p",{children:["Total Time: ",f.totalTime," min"]})]}),u==="custom"&&s&&c===u&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customTemperature",className:"text-xs text-gray-500",children:"Temperature (°C)"}),e.jsx("input",{id:"customTemperature",type:"number",value:f.temperature,onChange:b=>{const h=d();h&&Ge("custom",{temperature:Number(b.target.value)},h),l("custom",{temperature:Number(b.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:Se.TEMPERATURE.min,max:Se.TEMPERATURE.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customPressure",className:"text-xs text-gray-500",children:"Pressure (PSI)"}),e.jsx("input",{id:"customPressure",type:"number",value:f.pressure,onChange:b=>{const h=d();h&&Ge("custom",{pressure:Number(b.target.value)},h),l("custom",{pressure:Number(b.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:Se.PRESSURE.min,max:Se.PRESSURE.max})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customSterilizeTime",className:"text-xs text-gray-500",children:"Sterilize (min)"}),e.jsx("input",{id:"customSterilizeTime",type:"number",value:f.sterilizeTime,onChange:b=>{const h=d();h&&Ge("custom",{sterilizeTime:Number(b.target.value)},h),l("custom",{sterilizeTime:Number(b.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:Se.STERILIZE_TIME.min,max:Se.STERILIZE_TIME.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"customDryTime",className:"text-xs text-gray-500",children:"Dry (min)"}),e.jsx("input",{id:"customDryTime",type:"number",value:f.dryTime,onChange:b=>{const h=d();h&&Ge("custom",{dryTime:Number(b.target.value)},h),l("custom",{dryTime:Number(b.target.value)})},className:"w-full px-2 py-1 text-xs border border-gray-300 rounded",min:Se.DRY_TIME.min,max:Se.DRY_TIME.max})]})]})]})]},u)})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:o,className:"px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:"Reset to Defaults"})})]})]})},vc=()=>{const{autoclaveReceiptSettings:r,setAutoclaveHasPrinter:t,setReceiptRetentionMonths:s}=Cs(),{getCurrentFacilityId:a}=Qe();return e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Autoclave Receipt Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"autoclaveHasPrinter",className:"text-sm font-medium",children:"Autoclave Has Printer"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable receipt upload functionality for autoclave cycles"})]}),e.jsx("button",{id:"autoclaveHasPrinter",onClick:()=>{const n=a();n&&Er("autoclaveHasPrinter",!r.autoclaveHasPrinter,n),t(!r.autoclaveHasPrinter)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 ${r.autoclaveHasPrinter?"bg-[#4ECDC4]":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.autoclaveHasPrinter?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"retentionPeriod",className:"block text-sm font-medium text-gray-700 mb-2",children:"Receipt Retention Period"}),e.jsx("select",{id:"retentionPeriod",value:r.receiptRetentionMonths,onChange:n=>{const l=a();l&&Er("receiptRetentionMonths",Number(n.target.value),l),s(Number(n.target.value))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4]",children:Zo.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Receipts will be automatically deleted after this period"})]}),r.autoclaveHasPrinter&&e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-md",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Receipt Management Active"}),e.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[e.jsx("p",{children:"• Users can upload autoclave receipts via camera or file"}),e.jsx("p",{children:"• Receipts are linked to sterilization batch codes"}),e.jsxs("p",{children:["• Automatic cleanup after"," ",r.receiptRetentionMonths," months"]}),e.jsx("p",{children:"• Available for audit and compliance review"})]})]})]})]})};var jc=Object.defineProperty,Nc=Object.defineProperties,_c=Object.getOwnPropertyDescriptors,kr=Object.getOwnPropertySymbols,Cc=Object.prototype.hasOwnProperty,wc=Object.prototype.propertyIsEnumerable,Rr=(r,t,s)=>t in r?jc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Sc=(r,t)=>{for(var s in t||(t={}))Cc.call(t,s)&&Rr(r,s,t[s]);if(kr)for(var s of kr(t))wc.call(t,s)&&Rr(r,s,t[s]);return r},Ec=(r,t)=>Nc(r,_c(t)),os=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Tc=()=>{const{getCurrentFacilityId:r}=Qe(),[t,s]=x.useState(()=>{const u=r();return ns(u||"")}),[a,n]=x.useState(null),[l,o]=x.useState(!1),c=(u,m)=>{const f=r();f&&rc(u,m,f),s(b=>Ec(Sc({},b),{[u]:m}))},i=()=>os(null,null,function*(){try{o(!0);const u=r();if(!u){n({type:"error",text:"User facility not found"});return}tc(t,u),(yield wr(u,t))?(is(!0,u),n({type:"success",text:"AI settings saved successfully!"}),setTimeout(()=>n(null),Cr)):(is(!1,u,"Save operation failed"),n({type:"error",text:"Failed to save AI settings"}))}catch(u){is(!1,r()||"",u instanceof Error?u.message:"Unknown error"),n({type:"error",text:"Failed to save AI settings"})}finally{o(!1)}}),d=()=>os(null,null,function*(){try{o(!0);const u=r();if(!u){n({type:"error",text:"User facility not found"});return}sc(u);const m=ns(u);s(m),(yield ec(u))?(ls(!0,u),n({type:"success",text:"AI settings reset to defaults"}),setTimeout(()=>n(null),Cr)):(ls(!1,u,"Reset operation failed"),n({type:"error",text:"Failed to reset AI settings"}))}catch(u){ls(!1,r()||"",u instanceof Error?u.message:"Unknown error"),n({type:"error",text:"Failed to reset AI settings"})}finally{o(!1)}});return x.useEffect(()=>{os(null,null,function*(){const m=r();if(m)try{const f=yield Xo(m);if(f)s(f);else{const b=ns(m);s(b),yield wr(m,b)}}catch(f){console.error("Failed to load AI settings:",f)}})},[r]),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"AI-Powered Sterilization Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure intelligent automation and machine learning capabilities"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:"px-3 py-2 text-sm text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:"Reset"}),e.jsxs("button",{onClick:i,disabled:l,className:"px-4 py-2 text-sm bg-[#4ECDC4] text-white rounded-md hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] disabled:opacity-50",children:[e.jsx(y,{path:ht,size:.8,className:"inline mr-1"}),"Save AI Settings"]})]})]}),a&&e.jsx("div",{className:`p-4 rounded-lg border mb-6 ${a.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:a.type==="success"?Le:te,size:1,className:"text-current"}),a.text]})}),e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Ze,size:1.5,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-800",children:"Master AI Control"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Enable or disable all AI features globally"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiEnabledToggle",className:"text-sm font-medium text-purple-800",children:"Enable AI Features"}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Master switch for all sterilization AI capabilities"})]}),e.jsx("button",{id:"aiEnabledToggle",onClick:()=>{const u=r();u&&Be("ai_enabled",t.ai_enabled,!t.ai_enabled,u),c("ai_enabled",!t.ai_enabled)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 ${t.ai_enabled?"bg-purple-600":"bg-gray-200"}`,"aria-label":`${t.ai_enabled?"Disable":"Enable"} AI Features`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.ai_enabled?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(y,{path:re,size:1.2,className:"text-blue-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Computer Vision"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rs.COMPUTER_VISION.map(({key:u,label:m,desc:f})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${u}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f})]}),e.jsx("button",{id:`${u}Toggle`,onClick:()=>{const b=r();b&&Be(u,t[u],!t[u],b),c(u,!t[u])},disabled:!t.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 ${t[u]?"bg-blue-600":"bg-gray-200"} ${t.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${t[u]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t[u]?"translate-x-5":"translate-x-1"}`})})]},u))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(y,{path:Es,size:1.2,className:"text-green-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Predictive Analytics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rs.PREDICTIVE_ANALYTICS.map(({key:u,label:m,desc:f})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${u}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f})]}),e.jsx("button",{id:`${u}Toggle`,onClick:()=>{const b=r();b&&Be(u,t[u],!t[u],b),c(u,!t[u])},disabled:!t.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-1 ${t[u]?"bg-green-600":"bg-gray-200"} ${t.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${t[u]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t[u]?"translate-x-5":"translate-x-1"}`})})]},u))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(y,{path:re,size:1.2,className:"text-orange-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"Smart Workflow Automation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:rs.SMART_WORKFLOW.map(({key:u,label:m,desc:f})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${u}Toggle`,className:"text-sm font-medium text-gray-700",children:m}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f})]}),e.jsx("button",{id:`${u}Toggle`,onClick:()=>{const b=r();b&&Be(u,t[u],!t[u],b),c(u,!t[u])},disabled:!t.ai_enabled,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-1 ${t[u]?"bg-orange-600":"bg-gray-200"} ${t.ai_enabled?"":"opacity-50 cursor-not-allowed"}`,"aria-label":`${t[u]?"Disable":"Enable"} ${m}`,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${t[u]?"translate-x-5":"translate-x-1"}`})})]},u))})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(y,{path:Me,size:1.2,className:"text-purple-600"}),e.jsx("h4",{className:"font-medium text-gray-800",children:"AI Configuration"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiConfidenceThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Confidence Threshold"}),e.jsx("input",{id:"aiConfidenceThreshold",type:"range",min:as.min,max:as.max,step:as.step,value:t.ai_confidence_threshold||.8,onChange:u=>{const m=r();m&&Be("ai_confidence_threshold",t.ai_confidence_threshold,parseFloat(u.target.value),m),c("ai_confidence_threshold",parseFloat(u.target.value))},disabled:!t.ai_enabled,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"50%"}),e.jsxs("span",{children:[Math.round(t.ai_confidence_threshold*100),"%"]}),e.jsx("span",{children:"100%"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiDataRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (Days)"}),e.jsx("select",{id:"aiDataRetentionDays",value:t.ai_data_retention_days||365,onChange:u=>{const m=r();m&&Be("ai_data_retention_days",t.ai_data_retention_days,parseInt(u.target.value),m),c("ai_data_retention_days",parseInt(u.target.value))},disabled:!t.ai_enabled,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:border-[#4ECDC4] disabled:opacity-50",children:Jo.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))})]})]})})]})]})]})};function Pc(){return e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx(ac,{}),e.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:e.jsx(bc,{})}),e.jsx(yc,{}),e.jsx(vc,{}),e.jsx(Tc,{})]})}const $r=({onLaunchBuilder:r})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Content Builder"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Launch Content Builder"}),e.jsxs("button",{onClick:r,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4] transition-colors",children:[e.jsx(y,{path:ye,size:1,className:"mr-2"}),"Launch Builder"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable content creation"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"enable-content-creation",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Enable content creation"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-save drafts"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-save-drafts",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Auto-save drafts"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Recent Activity"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Course published"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Sterilization Safety Protocols"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"2h ago"})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Draft saved"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Inventory Management Guide"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"1d ago"})]})]})]})]}),Ic=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Publishing Workflow"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Require approval before publishing"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"require-approval",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Require approval before publishing"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-publish to Library"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-publish-library",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"}),e.jsx("span",{className:"sr-only",children:"Auto-publish to Library"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Notify reviewers on submission"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"notify-reviewers",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Notify reviewers on submission"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Approval Roles"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Content Manager"}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"Primary"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Department Head"}),e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Secondary"})]})]})]})]}),Ac=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Content Workflow"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable draft review workflow"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"enable-draft-review",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Enable draft review workflow"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-save drafts every 5 minutes"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-save-drafts-5min",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Auto-save drafts every 5 minutes"})]})]})]})]})}),Oc=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"AI Content Suggestions"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Enable AI suggestions"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"enable-ai-suggestions",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Enable AI suggestions"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Suggest based on content gaps"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"suggest-content-gaps",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Suggest based on content gaps"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Analyze user search patterns"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"analyze-search-patterns",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Analyze user search patterns"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"AI Configuration"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confidence-threshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Suggestion Confidence Threshold"}),e.jsxs("select",{id:"confidence-threshold",defaultValue:"0.8",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"0.7",children:"70% - Balanced"}),e.jsx("option",{value:"0.8",children:"80% - Recommended"}),e.jsx("option",{value:"0.9",children:"90% - High Quality"})]})]})})]})]}),Dc=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Media Upload Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max file size per upload"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"50 MB"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Auto-compress images"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"auto-compress-images",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Auto-compress images"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Generate thumbnails"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:"generate-thumbnails",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-[#4ECDC4] peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all after:translate-x-full"}),e.jsx("span",{className:"sr-only",children:"Generate thumbnails"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Supported File Types"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-2",children:"Images"}),e.jsx("p",{className:"text-xs text-green-700",children:"JPEG, PNG, GIF, WebP, HEIC"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2",children:"Videos"}),e.jsx("p",{className:"text-xs text-blue-700",children:"MP4, WebM, MOV, AVI"})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-purple-800 mb-2",children:"Audio"}),e.jsx("p",{className:"text-xs text-purple-700",children:"MP3, WAV, AAC, OGG"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"Documents"}),e.jsx("p",{className:"text-xs text-gray-700",children:"PDF, Word, PowerPoint, Excel"})]})]})]})]}),kc=()=>{const r=Cn(),[t,s]=x.useState("builder"),a=()=>{r("/content-builder")},n=[{id:"builder",label:"Content Builder",icon:ke},{id:"publishing",label:"Publishing",icon:qn},{id:"workflow",label:"Workflow",icon:ke},{id:"ai",label:"AI Suggestions",icon:lt},{id:"media",label:"Media Settings",icon:Un}],l=()=>{switch(t){case"builder":return e.jsx($r,{onLaunchBuilder:a});case"publishing":return e.jsx(Ic,{});case"workflow":return e.jsx(Ac,{});case"ai":return e.jsx(Oc,{});case"media":return e.jsx(Dc,{});default:return e.jsx($r,{onLaunchBuilder:a})}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:n.map(o=>e.jsxs("button",{onClick:()=>s(o.id),className:`${t===o.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(y,{path:o.icon,size:1,className:"mr-2"}),o.label]},o.id))})}),e.jsx("div",{className:"py-4",children:l()})]})})},Y=({id:r,checked:t,onChange:s,label:a,description:n})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-gray-700",children:a}),n&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n})]}),e.jsxs("label",{htmlFor:r,className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",id:r,className:"sr-only peer",checked:t,onChange:l=>s(l.target.checked)}),e.jsx("div",{className:`w-11 h-6 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#4ECDC4]/20 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all ${t?"bg-[#4ECDC4] after:translate-x-full":"bg-gray-200"}`}),e.jsx("span",{className:"sr-only",children:a})]})]}),he=({title:r,children:t})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:r}),e.jsx("div",{className:"space-y-3",children:t})]});var Rc=Object.defineProperty,$c=Object.defineProperties,Lc=Object.getOwnPropertyDescriptors,Lr=Object.getOwnPropertySymbols,Mc=Object.prototype.hasOwnProperty,Fc=Object.prototype.propertyIsEnumerable,Mr=(r,t,s)=>t in r?Rc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,zc=(r,t)=>{for(var s in t||(t={}))Mc.call(t,s)&&Mr(r,s,t[s]);if(Lr)for(var s of Lr(t))Fc.call(t,s)&&Mr(r,s,t[s]);return r},qc=(r,t)=>$c(r,Lc(t));const Uc=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(qc(zc({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:re,size:1.5,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-800",children:"General Learning Settings"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Basic configuration for learning and training modules"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(he,{title:"Core Features",children:[e.jsx(Y,{id:"enable-learning-paths",checked:r.enableLearningPaths,onChange:a=>s("enableLearningPaths",a),label:"Enable Learning Paths"}),e.jsx(Y,{id:"enable-certifications",checked:r.enableCertifications,onChange:a=>s("enableCertifications",a),label:"Enable Certifications"}),e.jsx(Y,{id:"enable-progress-tracking",checked:r.enableProgressTracking,onChange:a=>s("enableProgressTracking",a),label:"Enable Progress Tracking"}),e.jsx(Y,{id:"enable-social-learning",checked:r.enableSocialLearning,onChange:a=>s("enableSocialLearning",a),label:"Enable Social Learning"})]}),e.jsxs(he,{title:"Content Management",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"default-content-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Content Type"}),e.jsxs("select",{id:"default-content-type",value:r.defaultContentType,onChange:a=>s("defaultContentType",a.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"course",children:"Course"}),e.jsx("option",{value:"procedure",children:"Procedure"}),e.jsx("option",{value:"policy",children:"Policy"}),e.jsx("option",{value:"learning_pathway",children:"Learning Pathway"})]})]}),e.jsx(Y,{id:"enable-content-rating",checked:r.enableContentRating,onChange:a=>s("enableContentRating",a),label:"Enable Content Rating"}),e.jsx(Y,{id:"require-content-approval",checked:r.requireContentApproval,onChange:a=>s("requireContentApproval",a),label:"Require Content Approval"})]})]})]})})};var Vc=Object.defineProperty,Bc=Object.defineProperties,Gc=Object.getOwnPropertyDescriptors,Fr=Object.getOwnPropertySymbols,Hc=Object.prototype.hasOwnProperty,Yc=Object.prototype.propertyIsEnumerable,zr=(r,t,s)=>t in r?Vc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Wc=(r,t)=>{for(var s in t||(t={}))Hc.call(t,s)&&zr(r,s,t[s]);if(Fr)for(var s of Fr(t))Yc.call(t,s)&&zr(r,s,t[s]);return r},Kc=(r,t)=>Bc(r,Gc(t));const Qc=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(Kc(Wc({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Ze,size:1.5,className:"text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-purple-800",children:"AI Learning Features"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Configure AI-powered learning capabilities"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(he,{title:"AI Learning Features",children:[e.jsx(Y,{id:"personalized-recommendations",checked:r.personalizedRecommendations,onChange:a=>s("personalizedRecommendations",a),label:"Personalized Recommendations"}),e.jsx(Y,{id:"skill-gap-analysis",checked:r.skillGapAnalysis,onChange:a=>s("skillGapAnalysis",a),label:"Skill Gap Analysis"}),e.jsx(Y,{id:"learning-path-optimization",checked:r.learningPathOptimization,onChange:a=>s("learningPathOptimization",a),label:"Learning Path Optimization"}),e.jsx(Y,{id:"adaptive-difficulty",checked:r.adaptiveDifficulty,onChange:a=>s("adaptiveDifficulty",a),label:"Adaptive Difficulty"})]}),e.jsxs(he,{title:"AI Configuration",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ai-confidence-threshold",className:"block text-sm font-medium text-gray-700 mb-1",children:"AI Confidence Threshold"}),e.jsx("input",{id:"ai-confidence-threshold",type:"range",min:"0.1",max:"1",step:"0.1",value:r.aiConfidenceThreshold,onChange:a=>s("aiConfidenceThreshold",parseFloat(a.target.value)),className:"w-full"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(r.aiConfidenceThreshold*100),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recommendation-limit",className:"block text-sm font-medium text-gray-700 mb-1",children:"Recommendation Limit"}),e.jsx("input",{id:"recommendation-limit",type:"number",min:"1",max:"20",value:r.recommendationLimit,onChange:a=>s("recommendationLimit",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"data-retention-days",className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Retention (Days)"}),e.jsx("input",{id:"data-retention-days",type:"number",min:"30",max:"1095",value:r.dataRetentionDays,onChange:a=>s("dataRetentionDays",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]})]})]})]})})};var Zc=Object.defineProperty,Jc=Object.defineProperties,Xc=Object.getOwnPropertyDescriptors,qr=Object.getOwnPropertySymbols,ed=Object.prototype.hasOwnProperty,td=Object.prototype.propertyIsEnumerable,Ur=(r,t,s)=>t in r?Zc(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,sd=(r,t)=>{for(var s in t||(t={}))ed.call(t,s)&&Ur(r,s,t[s]);if(qr)for(var s of qr(t))td.call(t,s)&&Ur(r,s,t[s]);return r},rd=(r,t)=>Jc(r,Xc(t));const ad=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(rd(sd({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Ba,size:1.5,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Certification Management"}),e.jsx("p",{className:"text-sm text-green-700",children:"Configure certification and compliance tracking"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(he,{title:"Certification Features",children:[e.jsx(Y,{id:"enable-auto-certification",checked:r.enableAutoCertification,onChange:a=>s("enableAutoCertification",a),label:"Enable Auto-Certification"}),e.jsx(Y,{id:"require-re-certification",checked:r.requireReCertification,onChange:a=>s("requireReCertification",a),label:"Require Re-Certification"}),e.jsx(Y,{id:"enable-certification-templates",checked:r.enableCertificationTemplates,onChange:a=>s("enableCertificationTemplates",a),label:"Enable Certification Templates"})]}),e.jsxs(he,{title:"Assessment Settings",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"passing-score-threshold",className:"block text-sm font-medium text-gray-700 mb-1",children:"Passing Score Threshold"}),e.jsx("input",{id:"passing-score-threshold",type:"number",min:"50",max:"100",value:r.passingScoreThreshold,onChange:a=>s("passingScoreThreshold",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-assessment-attempts",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Assessment Attempts"}),e.jsx("input",{id:"max-assessment-attempts",type:"number",min:"1",max:"10",value:r.maxAssessmentAttempts,onChange:a=>s("maxAssessmentAttempts",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"certification-expiry-days",className:"block text-sm font-medium text-gray-700 mb-1",children:"Certification Expiry (Days)"}),e.jsx("input",{id:"certification-expiry-days",type:"number",min:"30",max:"1095",value:r.certificationExpiryDays,onChange:a=>s("certificationExpiryDays",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-[#4ECDC4] focus:ring-[#4ECDC4]"})]})]})]})]})})};var nd=Object.defineProperty,id=Object.defineProperties,ld=Object.getOwnPropertyDescriptors,Vr=Object.getOwnPropertySymbols,od=Object.prototype.hasOwnProperty,cd=Object.prototype.propertyIsEnumerable,Br=(r,t,s)=>t in r?nd(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,dd=(r,t)=>{for(var s in t||(t={}))od.call(t,s)&&Br(r,s,t[s]);if(Vr)for(var s of Vr(t))cd.call(t,s)&&Br(r,s,t[s]);return r},ud=(r,t)=>id(r,ld(t));const md=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(ud(dd({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:dt,size:1.5,className:"text-orange-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-orange-800",children:"Learning Path Configuration"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Configure learning paths and progress tracking"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(he,{title:"Path Features",children:[e.jsx(Y,{id:"enable-custom-paths",checked:r.enableCustomPaths,onChange:a=>s("enableCustomPaths",a),label:"Enable Custom Learning Paths"}),e.jsx(Y,{id:"enable-prerequisites",checked:r.enablePrerequisites,onChange:a=>s("enablePrerequisites",a),label:"Enable Prerequisites"}),e.jsx(Y,{id:"enable-branching",checked:r.enableBranching,onChange:a=>s("enableBranching",a),label:"Enable Branching Paths"}),e.jsx(Y,{id:"adaptive-path-generation",checked:r.adaptivePathGeneration,onChange:a=>s("adaptivePathGeneration",a),label:"AI Adaptive Path Generation"})]}),e.jsxs(he,{title:"Progress & Gamification",children:[e.jsx(Y,{id:"enable-milestones",checked:r.enableMilestones,onChange:a=>s("enableMilestones",a),label:"Enable Learning Milestones"}),e.jsx(Y,{id:"enable-progress-gamification",checked:r.enableProgressGamification,onChange:a=>s("enableProgressGamification",a),label:"Enable Progress Gamification"}),e.jsx(Y,{id:"enable-learning-streaks",checked:r.enableLearningStreaks,onChange:a=>s("enableLearningStreaks",a),label:"Enable Learning Streaks"}),e.jsx(Y,{id:"enable-achievement-badges",checked:r.enableAchievementBadges,onChange:a=>s("enableAchievementBadges",a),label:"Enable Achievement Badges"})]})]})]})})};var hd=Object.defineProperty,gd=Object.defineProperties,xd=Object.getOwnPropertyDescriptors,Gr=Object.getOwnPropertySymbols,pd=Object.prototype.hasOwnProperty,fd=Object.prototype.propertyIsEnumerable,Hr=(r,t,s)=>t in r?hd(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,bd=(r,t)=>{for(var s in t||(t={}))pd.call(t,s)&&Hr(r,s,t[s]);if(Gr)for(var s of Gr(t))fd.call(t,s)&&Hr(r,s,t[s]);return r},yd=(r,t)=>gd(r,xd(t));const vd=({aiSettings:r,onAiSettingsChange:t})=>{const s=(a,n)=>{t(yd(bd({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Me,size:1.5,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Advanced Configuration"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Advanced settings for power users"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(he,{title:"Data & Privacy",children:[e.jsx(Y,{id:"data-sharing-enabled",checked:r.dataSharingEnabled,onChange:a=>s("dataSharingEnabled",a),label:"Enable Data Sharing for AI Training"}),e.jsx(Y,{id:"local-ai-processing-enabled",checked:r.localAIProcessingEnabled,onChange:a=>s("localAIProcessingEnabled",a),label:"Local AI Processing"}),e.jsx(Y,{id:"encrypted-data-transmission",checked:r.encryptedDataTransmission,onChange:a=>s("encryptedDataTransmission",a),label:"Encrypted Data Transmission"})]}),e.jsx(he,{title:"System Information",children:e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"AI Model Version:"})," ",r.modelVersion]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Data Retention:"})," ",r.dataRetentionDays," days"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Confidence Threshold:"})," ",Math.round(r.aiConfidenceThreshold*100),"%"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Recommendation Limit:"})," ",r.recommendationLimit," items"]})]})})]})]})})},jd=()=>{const[r,t]=x.useState({aiEnabled:!0,personalizedRecommendations:!0,skillGapAnalysis:!0,learningPathOptimization:!0,performancePrediction:!0,adaptiveDifficulty:!0,learningAnalyticsEnabled:!0,behaviorTracking:!0,progressPrediction:!0,engagementMetrics:!0,retentionAnalysis:!0,aiConfidenceThreshold:.8,recommendationLimit:5,dataRetentionDays:365,modelVersion:"v1.0",dataSharingEnabled:!1,localAIProcessingEnabled:!0,encryptedDataTransmission:!0,aiModelTraining:!1}),[s,a]=x.useState({enableLearningPaths:!0,enableCertifications:!0,enableProgressTracking:!0,enableSocialLearning:!1,defaultContentType:"course",enableContentRating:!0,enableComments:!0,requireContentApproval:!0,showLearningRecommendations:!0,enableLearningReminders:!0,adaptiveInterface:!0,mobileLearningEnabled:!0}),[n,l]=x.useState({enableAutoCertification:!0,certificationExpiryDays:365,requireReCertification:!0,enableCertificationTemplates:!0,complianceTrackingEnabled:!0,regulatoryUpdatesEnabled:!0,auditTrailEnabled:!0,complianceReportingEnabled:!0,enableAssessments:!0,passingScoreThreshold:80,maxAssessmentAttempts:3,enableRetakes:!0}),[o,c]=x.useState({enableCustomPaths:!0,enablePrerequisites:!0,enableBranching:!0,adaptivePathGeneration:!0,enableMilestones:!0,enableProgressGamification:!0,enableLearningStreaks:!0,enableAchievementBadges:!0,estimatedCompletionTracking:!0,enableStudyScheduling:!0,optimalStudyTimeRecommendations:!0,enableLearningReminders:!0});return{aiSettings:r,setAiSettings:t,generalSettings:s,setGeneralSettings:a,certificationSettings:n,setCertificationSettings:l,learningPathSettings:o,setLearningPathSettings:c}};var Nd=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const _d=()=>{const[r,t]=x.useState("general"),[s,a]=x.useState(!1),[n,l]=x.useState(null),{aiSettings:o,setAiSettings:c,generalSettings:i,setGeneralSettings:d,certificationSettings:u,setCertificationSettings:m,learningPathSettings:f,setLearningPathSettings:b}=jd(),h=[{id:"general",label:"General Settings",icon:re},{id:"ai",label:"AI & Analytics",icon:Ze},{id:"certifications",label:"Certifications",icon:Ba},{id:"learning-paths",label:"Learning Paths",icon:dt},{id:"advanced",label:"Advanced",icon:Me}],p=()=>Nd(null,null,function*(){try{a(!0),l(null),l({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>l(null),3e3)}catch(w){console.error(w),l({type:"error",text:"Failed to save settings. Please try again."})}finally{a(!1)}}),_=()=>{switch(r){case"general":return e.jsx(Uc,{settings:i,onSettingsChange:d});case"ai":return e.jsx(Qc,{settings:o,onSettingsChange:c});case"certifications":return e.jsx(ad,{settings:u,onSettingsChange:m});case"learning-paths":return e.jsx(md,{settings:f,onSettingsChange:b});case"advanced":return e.jsx(vd,{aiSettings:o,onAiSettingsChange:c});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Learning & Training Settings"}),e.jsx("p",{className:"text-gray-600",children:"Configure AI-powered learning features and training modules"})]}),e.jsxs("button",{onClick:p,disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-[#4ECDC4] hover:bg-[#3db8b0] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#4ECDC4] disabled:opacity-50",children:[e.jsx(y,{path:ht,size:1,className:"mr-2"}),s?"Saving...":"Save Settings"]})]}),n&&e.jsx("div",{className:`rounded-md p-4 ${n.type==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{path:n.type==="success"?Le:te,size:1.2,className:`mr-2 ${n.type==="success"?"text-green-400":"text-red-400"}`}),n.text]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:h.map(w=>e.jsxs("button",{onClick:()=>t(w.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${r===w.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(y,{path:w.icon,size:1}),e.jsx("span",{children:w.label})]},w.id))})}),e.jsx("div",{className:"tab-content-area",children:_()})]})};var Cd=Object.defineProperty,wd=Object.defineProperties,Sd=Object.getOwnPropertyDescriptors,Yr=Object.getOwnPropertySymbols,Ed=Object.prototype.hasOwnProperty,Td=Object.prototype.propertyIsEnumerable,Wr=(r,t,s)=>t in r?Cd(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Pd=(r,t)=>{for(var s in t||(t={}))Ed.call(t,s)&&Wr(r,s,t[s]);if(Yr)for(var s of Yr(t))Td.call(t,s)&&Wr(r,s,t[s]);return r},Id=(r,t)=>wd(r,Sd(t));const Ad={id:"dental",name:"Dental Practice",description:"Statuses optimized for dental offices and clinics",category:"Specialty Care",statuses:[{name:"Pre-Procedure Ready",color:"#16a34a",icon:"check-circle",description:"Dental chair prepared, instruments sterilized, ready for patient",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Post-Procedure Cleaning",color:"#dc2626",icon:"broom",description:"Biohazard cleanup required after dental procedure",requiresVerification:!0,autoTransition:!1,alertLevel:"high"},{name:"Sterilization Cycle",color:"#ca8a04",icon:"progress-clock",description:"Instruments currently in autoclave sterilization cycle",requiresVerification:!1,autoTransition:!0,transitionTo:"Pre-Procedure Ready",alertLevel:"medium"},{name:"Patient in Chair",color:"#3b82f6",icon:"account",description:"Patient currently in dental chair, room occupied",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"X-Ray Room Ready",color:"#8b5cf6",icon:"radiology-box",description:"X-ray room prepared and ready for imaging",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Equipment Maintenance",color:"#ea580c",icon:"wrench",description:"Dental equipment under maintenance or repair",requiresVerification:!1,autoTransition:!1,alertLevel:"medium"}]},Od={id:"primary_care",name:"Primary Care",description:"Statuses for general practice and family medicine",category:"General Practice",statuses:[{name:"Patient Exam Room",color:"#3b82f6",icon:"account",description:"Patient currently in exam room for consultation",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Waiting for Labs",color:"#ca8a04",icon:"progress-clock",description:"Room waiting for lab results or test completion",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Vaccination Ready",color:"#16a34a",icon:"needle",description:"Vaccination station prepared and ready",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Chronic Care Visit",color:"#8b5cf6",icon:"account-clock",description:"Extended visit for chronic condition management",requiresVerification:!1,autoTransition:!1,alertLevel:"medium"},{name:"Wellness Check",color:"#059669",icon:"heart-pulse",description:"Routine physical examination in progress",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Follow-up Visit",color:"#3b82f6",icon:"calendar-check",description:"Follow-up appointment for previous condition",requiresVerification:!1,autoTransition:!1,alertLevel:"low"}]},Dd={id:"private_surgery",name:"Private Surgery",description:"Statuses for surgical centers and operating rooms",category:"Surgical",statuses:[{name:"Pre-Op Ready",color:"#16a34a",icon:"check-circle",description:"Pre-operative room prepared for patient",requiresVerification:!0,autoTransition:!1,alertLevel:"medium"},{name:"Surgery in Progress",color:"#dc2626",icon:"scissors-cutting",description:"Active surgery currently in progress",requiresVerification:!1,autoTransition:!1,alertLevel:"critical"},{name:"Post-Op Recovery",color:"#3b82f6",icon:"bed",description:"Post-operative recovery room occupied",requiresVerification:!1,autoTransition:!1,alertLevel:"high"},{name:"Sterile Instruments",color:"#8b5cf6",icon:"package-variant",description:"Surgical instruments sterilized and ready",requiresVerification:!0,autoTransition:!1,alertLevel:"medium"},{name:"Anesthesia Ready",color:"#ca8a04",icon:"gas-cylinder",description:"Anesthesia equipment prepared and ready",requiresVerification:!0,autoTransition:!1,alertLevel:"high"},{name:"Surgical Suite Clean",color:"#16a34a",icon:"broom",description:"Surgical suite cleaned and sanitized post-procedure",requiresVerification:!0,autoTransition:!1,alertLevel:"medium"}]},kd={id:"emergency_room",name:"Emergency Room",description:"Statuses for emergency departments and urgent care",category:"Emergency",statuses:[{name:"Trauma Bay Ready",color:"#16a34a",icon:"ambulance",description:"Trauma bay prepared for emergency patient",requiresVerification:!1,autoTransition:!1,alertLevel:"critical"},{name:"Code Blue",color:"#dc2626",icon:"alert-circle",description:"Cardiac arrest or medical emergency in progress",requiresVerification:!1,autoTransition:!1,alertLevel:"critical"},{name:"Isolation Room",color:"#ea580c",icon:"shield-lock",description:"Isolation room for infectious disease patients",requiresVerification:!0,autoTransition:!1,alertLevel:"high"},{name:"Waiting for Specialist",color:"#ca8a04",icon:"account-clock",description:"Patient waiting for specialist consultation",requiresVerification:!1,autoTransition:!1,alertLevel:"medium"},{name:"Discharge Pending",color:"#8b5cf6",icon:"exit-to-app",description:"Patient ready for discharge, paperwork pending",requiresVerification:!1,autoTransition:!1,alertLevel:"low"}]},Rd={id:"laboratory",name:"Laboratory",description:"Statuses for medical laboratories and testing facilities",category:"Diagnostic",statuses:[{name:"Sample Processing",color:"#ca8a04",icon:"test-tube",description:"Laboratory samples currently being processed",requiresVerification:!1,autoTransition:!1,alertLevel:"medium"},{name:"Equipment Calibration",color:"#ea580c",icon:"wrench",description:"Laboratory equipment under calibration",requiresVerification:!1,autoTransition:!1,alertLevel:"medium"},{name:"Quality Control",color:"#8b5cf6",icon:"clipboard-check",description:"Quality control testing in progress",requiresVerification:!0,autoTransition:!1,alertLevel:"high"},{name:"Results Ready",color:"#16a34a",icon:"file-document",description:"Test results completed and ready for review",requiresVerification:!1,autoTransition:!1,alertLevel:"low"},{name:"Hazardous Materials",color:"#dc2626",icon:"biohazard",description:"Hazardous materials handling in progress",requiresVerification:!0,autoTransition:!1,alertLevel:"critical"}]},cn=[Ad,Od,Dd,kd,Rd];function qt(r){return cn.find(t=>t.id===r)}function Kr(r){return r.statuses.map(t=>Id(Pd({},t),{id:t.name.toLowerCase().replace(/\s+/g,"_"),isDefault:!1,isCore:!1,isPublished:!1}))}function $d(r,t){const s=[];for(const a of r.statuses)for(const n of t){if(a.name.toLowerCase()===n.name.toLowerCase()){s.push({bundleStatus:a.name,existingStatus:n.name,similarity:1});continue}const l=a.name.toLowerCase().split(/\s+/),o=n.name.toLowerCase().split(/\s+/),c=l.filter(i=>o.includes(i));if(c.length>0){const i=c.length/Math.max(l.length,o.length);i>=.5&&s.push({bundleStatus:a.name,existingStatus:n.name,similarity:i})}}return s.sort((a,n)=>n.similarity-a.similarity)}const Ld=({rooms:r,onEditRoom:t,onDeleteRoom:s,onToggleActive:a})=>e.jsx("div",{className:"space-y-2",children:r.map(n=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:n.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.department," • ",n.floor]}),n.barcode&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Barcode: ",n.barcode]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>a(n.id,n.isActive),className:`px-3 py-1 text-sm rounded-md transition-colors ${n.isActive?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"}`,children:n.isActive?"Active":"Inactive"}),e.jsx("button",{onClick:()=>t(n),className:"p-1 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:e.jsx(y,{path:ke,size:.8})}),e.jsx("button",{onClick:()=>s(n.id),className:"p-1 text-red-600 hover:bg-red-50 rounded-md transition-colors",children:e.jsx(y,{path:ut,size:.8})})]})]},n.id))}),Md=()=>{const r=["OR001","ICU101","SUP001","ER001","LAB001","RAD001","PHY001","ADM001"];return r[Math.floor(Math.random()*r.length)]||"OR001"};var Fd=Object.defineProperty,zd=Object.defineProperties,qd=Object.getOwnPropertyDescriptors,Qr=Object.getOwnPropertySymbols,Ud=Object.prototype.hasOwnProperty,Vd=Object.prototype.propertyIsEnumerable,Zr=(r,t,s)=>t in r?Fd(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,fe=(r,t)=>{for(var s in t||(t={}))Ud.call(t,s)&&Zr(r,s,t[s]);if(Qr)for(var s of Qr(t))Vd.call(t,s)&&Zr(r,s,t[s]);return r},be=(r,t)=>zd(r,qd(t));const Bd=({isOpen:r,onClose:t,room:s,mode:a,onSave:n})=>{const[l,o]=x.useState({name:"",department:"",floor:"",barcode:"",gpsCoordinates:null}),{getCurrentLocation:c,latitude:i,longitude:d,accuracy:u,isLoading:m}=Pn(),f=["Surgery","Intensive Care","Emergency","Logistics","Administration","Laboratory"];x.useEffect(()=>{setTimeout(s&&a==="edit"?()=>{o({name:s.name||"",department:s.department||"",floor:s.floor||"",barcode:s.barcode||"",gpsCoordinates:s.gpsCoordinates||null})}:()=>{o({name:"",department:"",floor:"",barcode:"",gpsCoordinates:null})},0)},[s,a,r]),x.useEffect(()=>{i&&d&&setTimeout(()=>{o(h=>be(fe({},h),{gpsCoordinates:{latitude:i,longitude:d,accuracy:u||0,lastUpdated:new Date().toISOString()}}))},0)},[i,d,u]);const b=()=>{if(l.name&&l.department&&l.floor){const h=be(fe({},l),{gpsCoordinates:l.gpsCoordinates?be(fe({},l.gpsCoordinates),{lastUpdated:new Date().toISOString()}):void 0});n(h),t()}};return r?e.jsxs("div",{className:"mb-4 p-3 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"text-md font-medium mb-3",children:a==="add"?"Add New Room":"Edit Room"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"room-name",className:"block text-xs font-medium text-gray-700 mb-1",children:"Room Name"}),e.jsx("input",{id:"room-name",type:"text",value:l.name,onChange:h=>o(be(fe({},l),{name:h.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Operating Room 1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"room-barcode",className:"block text-xs font-medium text-gray-700 mb-1",children:"Barcode"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{id:"room-barcode",type:"text",value:l.barcode,onChange:h=>o(be(fe({},l),{barcode:h.target.value})),className:"flex-1 px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., OR001"}),e.jsxs("button",{type:"button",onClick:()=>o(be(fe({},l),{barcode:Md()})),className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors flex items-center gap-1 text-xs",title:"Generate random barcode",children:[e.jsx(y,{path:vs,size:.6}),e.jsx("span",{children:"Gen"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"room-department",className:"block text-xs font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{id:"room-department",value:l.department,onChange:h=>o(be(fe({},l),{department:h.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Department"}),f.map(h=>e.jsx("option",{value:h,children:h},h))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"room-floor",className:"block text-xs font-medium text-gray-700 mb-1",children:"Floor"}),e.jsx("input",{id:"room-floor",type:"text",value:l.floor,onChange:h=>o(be(fe({},l),{floor:h.target.value})),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 2nd Floor"})]})]}),e.jsxs("div",{className:"mt-4 p-3 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-blue-800 flex items-center",children:[e.jsx(y,{path:Ms,size:.8,className:"mr-1"}),"GPS Coordinates (Optional)"]}),e.jsxs("button",{type:"button",onClick:c,disabled:m,className:"flex items-center px-3 py-1 bg-blue-600 text-white text-xs rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(y,{path:Ms,size:.6,className:"mr-1"}),m?"Getting Location...":"Get Current Location"]})]}),l.gpsCoordinates?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("div",{className:"font-medium",children:"Current GPS Coordinates:"}),e.jsx("div",{className:"font-mono text-xs",children:In(l.gpsCoordinates)}),l.gpsCoordinates.accuracy&&e.jsxs("div",{className:"text-xs text-blue-600",children:["Accuracy: ±",Math.round(l.gpsCoordinates.accuracy),"m"]})]}),e.jsx("button",{type:"button",onClick:()=>o(h=>be(fe({},h),{gpsCoordinates:null})),className:"text-xs text-red-600 hover:text-red-800",children:"Remove GPS Coordinates"})]}):e.jsx("div",{className:"text-sm text-blue-600",children:`No GPS coordinates set. Click "Get Current Location" to capture the room's GPS coordinates. This will enable smart location detection for inventory items.`})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:b,className:"flex items-center px-3 py-1 bg-[#4ECDC4] text-white text-sm rounded-md hover:bg-[#38b2ac] transition-colors",children:[e.jsx(y,{path:a==="add"?ye:mt,size:.8,className:"mr-1"}),a==="add"?"Add Room":"Update Room"]}),e.jsxs("button",{onClick:t,className:"flex items-center px-3 py-1 bg-gray-500 text-white text-sm rounded-md hover:bg-gray-600 transition-colors",children:[e.jsx(y,{path:$e,size:.8,className:"mr-1"}),"Cancel"]})]})]}):null},Gd=({coreStatuses:r,customStatuses:t,onEditStatus:s,onDeleteStatus:a,onTogglePublishStatus:n,statusCountInfo:l})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Core Status Types (Required)"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:r.map(o=>e.jsxs("div",{className:"p-2 rounded-lg border bg-white border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 rounded-full mr-1",style:{backgroundColor:o.color}}),e.jsx("span",{className:"font-medium text-xs",children:o.name}),e.jsx(y,{path:Ss,size:.4,className:"text-gray-300 ml-1",title:"Core status - always available"})]}),e.jsx("span",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded",children:"Core"})]}),e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:o.description})]},o.id))}),e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Custom Status Types (Optional)"}),e.jsxs("div",{className:"relative ml-2 tooltip-container",children:[e.jsx("div",{className:"w-4 h-4 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-bold cursor-help",children:"i"}),e.jsxs("div",{className:"tooltip-content",children:[e.jsx("div",{className:"mb-1 font-medium",children:"💡 Data Integrity Protection"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:"• Similar statuses (≥90% match) are blocked"}),e.jsx("div",{children:"• Very similar statuses (≥80% match) show warnings"}),e.jsx("div",{children:"• Smart suggestions help you choose better names"}),e.jsx("div",{children:"• All statuses start as drafts for testing"})]}),e.jsx("div",{className:"tooltip-arrow"})]})]})]}),l&&e.jsxs("div",{className:"text-xs text-gray-500",children:[l.custom,"/",l.maxCustom," custom statuses"]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Custom statuses start as drafts. Click the eye icon to publish them and make them visible in the cleaning workflow."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-4",children:t.map(o=>e.jsxs("div",{className:`p-3 rounded-lg border ${o.isPublished?"bg-purple-100 border-purple-300":"bg-gray-100 border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full mr-2",style:{backgroundColor:o.color}}),e.jsx("span",{className:"font-medium text-sm",children:o.name}),e.jsx("span",{className:`ml-2 px-1 py-0.5 text-xs rounded ${o.isPublished?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:o.isPublished?"Published":"Draft"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>s(o),className:"p-1 text-purple-600 hover:bg-purple-100 rounded",title:"Edit status",children:e.jsx(y,{path:ke,size:.6})}),e.jsx("button",{onClick:()=>n(o.id,!o.isPublished),className:`p-1 rounded ${o.isPublished?"text-orange-600 hover:bg-orange-100":"text-green-600 hover:bg-green-100"}`,title:o.isPublished?"Unpublish status":"Publish status",children:e.jsx(y,{path:o.isPublished?js:Ns,size:.6})}),e.jsx("button",{onClick:()=>a(o.id),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete status",children:e.jsx(y,{path:ut,size:.6})})]})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:o.description}),e.jsxs("div",{className:"text-xs text-purple-600",children:[o.requiresVerification&&e.jsx("span",{className:"mr-2",children:"✓ Verification"}),o.autoTransition&&e.jsx("span",{className:"mr-2",children:"✓ Auto Transition"}),o.alertLevel&&o.alertLevel!=="low"&&e.jsxs("span",{className:"mr-2",children:["⚠ ",o.alertLevel]})]})]},o.id))})]}),Hd=({customStatuses:r,onLoadBundle:t,onReplaceWithBundle:s})=>{var a;const[n,l]=x.useState(""),[o,c]=x.useState(!1),[i,d]=x.useState([]),u=h=>{l(h);const p=qt(h);if(p){const _=$d(p,r);d(_),c(!0)}},m=()=>{t(n),l(""),c(!1),d([])},f=()=>{s(n),l(""),c(!1),d([])},b=()=>{l(""),c(!1),d([])};return e.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-green-800 mb-2",children:"🚀 Quick Setup: Pre-configured Status Bundles"}),e.jsx("p",{className:"text-xs text-green-700 mb-3",children:"Select a bundle to quickly add relevant statuses for your healthcare specialty. All statuses start as drafts."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 mb-3",children:cn.map(h=>e.jsxs("button",{onClick:()=>u(h.id),className:`p-2 text-left rounded border transition-colors ${n===h.id?"bg-green-100 border-green-400 text-green-800":"bg-white border-green-200 hover:bg-green-50 text-green-700"}`,children:[e.jsx("div",{className:"font-medium text-xs",children:h.name}),e.jsx("div",{className:"text-xs opacity-75",children:h.description}),e.jsxs("div",{className:"text-xs opacity-60",children:[h.statuses.length," statuses"]})]},h.id))}),o&&n&&e.jsxs("div",{className:"mt-3 p-3 bg-white border border-green-300 rounded",children:[e.jsxs("h6",{className:"text-sm font-medium text-green-800 mb-2",children:["Bundle Preview: ",(a=qt(n))==null?void 0:a.name]}),i.length>0&&e.jsxs("div",{className:"mb-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:[e.jsxs("p",{className:"text-xs text-yellow-800 mb-1",children:["⚠️ Found ",i.length," similar statuses:"]}),e.jsx("ul",{className:"text-xs text-yellow-700 space-y-1",children:i.slice(0,3).map((h,p)=>e.jsxs("li",{children:['• "',h.bundleStatus,'" similar to "',h.existingStatus,'"']},p))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:m,className:"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:"Add New Statuses Only"}),e.jsx("button",{onClick:f,className:"px-3 py-1 text-xs bg-orange-600 text-white rounded hover:bg-orange-700",children:"Replace All Custom Statuses"}),e.jsx("button",{onClick:b,className:"px-3 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cancel"})]})]})]})};var Yd=Object.defineProperty,Wd=Object.defineProperties,Kd=Object.getOwnPropertyDescriptors,Jr=Object.getOwnPropertySymbols,Qd=Object.prototype.hasOwnProperty,Zd=Object.prototype.propertyIsEnumerable,Xr=(r,t,s)=>t in r?Yd(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Jd=(r,t)=>{for(var s in t||(t={}))Qd.call(t,s)&&Xr(r,s,t[s]);if(Jr)for(var s of Jr(t))Zd.call(t,s)&&Xr(r,s,t[s]);return r},Xd=(r,t)=>Wd(r,Kd(t)),eu=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const ea=[{name:"check-circle",label:"Check Circle",path:"mdiCheckCircle"},{name:"exclamation-triangle",label:"Warning",path:"mdiExclamationTriangle"},{name:"pause-circle",label:"Pause",path:"mdiPauseCircle"},{name:"clock",label:"Clock",path:"mdiClock"},{name:"shield",label:"Shield",path:"mdiShield"},{name:"wrench",label:"Wrench",path:"mdiWrench"},{name:"heart",label:"Heart",path:"mdiHeart"},{name:"star",label:"Star",path:"mdiStar"},{name:"flag",label:"Flag",path:"mdiFlag"},{name:"home",label:"Home",path:"mdiHome"}],tu=[{name:"Green",value:"#16a34a",bgClass:"bg-green-100",textClass:"text-green-600"},{name:"Red",value:"#dc2626",bgClass:"bg-red-100",textClass:"text-red-600"},{name:"Yellow",value:"#ca8a04",bgClass:"bg-yellow-100",textClass:"text-yellow-600"},{name:"Blue",value:"#3b82f6",bgClass:"bg-blue-100",textClass:"text-blue-600"},{name:"Purple",value:"#9333ea",bgClass:"bg-purple-100",textClass:"text-purple-600"},{name:"Orange",value:"#ea580c",bgClass:"bg-orange-100",textClass:"text-orange-600"},{name:"Gray",value:"#6b7280",bgClass:"bg-gray-100",textClass:"text-gray-600"},{name:"Pink",value:"#ec4899",bgClass:"bg-pink-100",textClass:"text-pink-600"}],su=({isOpen:r,onClose:t,onSave:s,existingStatuses:a})=>{var n;const[l,o]=x.useState({name:"",description:"",icon:"check-circle",color:"#16a34a"}),[c,i]=x.useState(!1),[d,u]=x.useState([]),m=(h,p)=>{o(_=>Xd(Jd({},_),{[h]:p})),u([])},f=()=>{const h=[];return l.name.trim()||h.push("Status name is required"),l.name.trim().split(/\s+/).length>1&&h.push("Status name must be 1 word only"),l.name.trim().length<2&&h.push("Status name must be at least 2 characters"),l.name.trim().length>20&&h.push("Status name must be less than 20 characters"),a.map(w=>w.name.toLowerCase()).includes(l.name.toLowerCase())&&h.push("A status with this name already exists"),/^[a-zA-Z0-9]+$/.test(l.name.trim())||h.push("Status name can only contain letters and numbers"),u(h),h.length===0},b=()=>eu(null,null,function*(){if(f()){i(!0);try{yield s({name:l.name.trim(),description:l.description.trim()||`${l.name.trim()} status`,icon:l.icon,color:l.color,isDefault:!1,isCore:!1,isPublished:!0,category:"custom",requiresVerification:!1,autoTransition:!1,alertLevel:"low"}),o({name:"",description:"",icon:"check-circle",color:"#16a34a"}),t()}catch(h){console.error("Error saving status:",h),u(["Failed to save status. Please try again."])}finally{i(!1)}}});return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Custom Status"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(y,{path:$e,size:1.2})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Name *"}),e.jsx("input",{type:"text",value:l.name,onChange:h=>m("name",h.target.value),placeholder:"e.g., Clean, Dirty, Maintenance",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",maxLength:20}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"One word only, letters and numbers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),e.jsx("textarea",{value:l.description,onChange:h=>m("description",h.target.value),placeholder:"Brief description of this status",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:ea.map(h=>e.jsx("button",{onClick:()=>m("icon",h.name),className:`p-2 rounded-md border-2 transition-colors ${l.icon===h.name?"border-[#4ECDC4] bg-[#4ECDC4]/10":"border-gray-200 hover:border-gray-300"}`,title:h.label,children:e.jsx(y,{path:h.path,size:1,className:l.icon===h.name?"text-[#4ECDC4]":"text-gray-600"})},h.name))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Color"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:tu.map(h=>e.jsx("button",{onClick:()=>m("color",h.value),className:`p-3 rounded-md border-2 transition-colors ${l.color===h.value?"border-gray-400":"border-gray-200 hover:border-gray-300"}`,title:h.name,children:e.jsx("div",{className:`w-full h-6 rounded ${h.bgClass} flex items-center justify-center`,children:e.jsx(y,{path:mt,size:.8,className:h.textClass})})},h.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview"}),e.jsx("div",{className:"p-3 border border-gray-200 rounded-md bg-gray-50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:`${l.color}20`},children:e.jsx(y,{path:((n=ea.find(h=>h.name===l.icon))==null?void 0:n.path)||"mdiCheckCircle",size:.8,color:l.color})}),e.jsx("span",{className:"font-medium text-gray-800",children:l.name||"Status Name"})]})})]}),d.length>0&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("ul",{className:"text-sm text-red-600 space-y-1",children:d.map((h,p)=>e.jsxs("li",{children:["• ",h]},p))})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:b,disabled:c||!l.name.trim(),className:`px-4 py-2 rounded-md transition-colors ${c||!l.name.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-[#4ECDC4] text-white hover:bg-[#3db8b0]"}`,children:c?"Creating...":"Create Status"})]})]})]})}):null};var ru=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const au=()=>{const{rooms:r,addRoom:t,updateRoom:s,deleteRoom:a}=An(),{getCoreStatusTypes:n,getCustomStatusTypes:l,addStatusType:o,deleteStatusType:c,publishStatusType:i,unpublishStatusType:d,getStatusCountInfo:u,canAddCustomStatus:m}=On(),f=n(),b=l(),[h,p]=x.useState(!1),[_,w]=x.useState(null),[v,j]=x.useState(!1),[E,k]=x.useState(!1),[A,V]=x.useState(!1),$=z=>{t({name:z.name||"",department:z.department||"",floor:z.floor||"",barcode:z.barcode||"",isActive:!0}),p(!1)},G=z=>{_&&(s(_.id,z),w(null))},D=z=>{w(z)},S=()=>{p(!1),w(null)},L=(z,B)=>{s(z,{isActive:!B})},H=z=>{a(z)},C=()=>{},O=z=>{c(z)},T=(z,B)=>{B?i(z):d(z)},F=z=>ru(null,null,function*(){try{yield o(z),V(!1)}catch(B){throw console.error("Error creating status:",B),B}}),se=z=>{const B=qt(z);if(!B)return;const W=Kr(B),ie=b.map(Te=>Te.name.toLowerCase());W.filter(Te=>!ie.includes(Te.name.toLowerCase())).forEach(Te=>{o(Te)})},ge=z=>{const B=qt(z);if(!B)return;b.forEach(ie=>{c(ie.id)}),Kr(B).forEach(ie=>{o(ie)})};return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>j(!v),className:"flex items-center text-xl font-semibold text-gray-800 hover:text-gray-600 transition-colors",children:[e.jsx(y,{path:v?ot:ct,size:1.2,className:"mr-2"}),"Room Management",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",r.filter(z=>z.isActive).length," active)"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>k(!E),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:[e.jsx(y,{path:re,size:1,className:"mr-2"}),"Status Types"]}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:[e.jsx(y,{path:ye,size:1,className:"mr-2"}),"Add Room"]})]})]}),E&&e.jsxs("div",{className:"mb-6 p-4 border border-purple-200 rounded-lg bg-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-purple-800",children:"Custom Status Types"}),e.jsx("div",{className:"text-sm text-purple-600 mt-1",children:(()=>{const z=u();return`${z.custom}/${z.maxCustom} custom statuses used (${z.total}/8 total)`})()})]}),e.jsxs("button",{onClick:()=>V(!0),disabled:!m(),className:`flex items-center px-3 py-1 rounded-md transition-colors text-sm ${m()?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:m()?"Add a new custom status":"Maximum of 4 custom statuses reached",children:[e.jsx(y,{path:ye,size:.8,className:"mr-1"}),"Add Custom Status"]})]}),e.jsx(Hd,{customStatuses:b,onLoadBundle:se,onReplaceWithBundle:ge}),e.jsx(Gd,{coreStatuses:f,customStatuses:b,onEditStatus:C,onDeleteStatus:O,onTogglePublishStatus:T,statusCountInfo:u()})]}),e.jsx(Bd,{isOpen:h||!!_,onClose:S,room:_,mode:h?"add":"edit",onSave:h?$:G}),v&&e.jsx(Ld,{rooms:r,onEditRoom:D,onDeleteRoom:H,onToggleActive:L}),e.jsx(su,{isOpen:A,onClose:()=>V(!1),onSave:F,existingStatuses:[...f,...b]})]})},nu={title:"",category:"setup",autoSchedule:!1,scheduleFrequency:"weekly",scheduleDay:"monday",scheduleTime:"09:00",schedulePriority:"medium",schedulePoints:50,scheduleDuration:30,triggerRoomStatus:!1,triggerStaffSchedule:!1,triggerAdminDecision:!1};var iu=Object.defineProperty,lu=Object.defineProperties,ou=Object.getOwnPropertyDescriptors,ta=Object.getOwnPropertySymbols,cu=Object.prototype.hasOwnProperty,du=Object.prototype.propertyIsEnumerable,sa=(r,t,s)=>t in r?iu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,uu=(r,t)=>{for(var s in t||(t={}))cu.call(t,s)&&sa(r,s,t[s]);if(ta)for(var s of ta(t))du.call(t,s)&&sa(r,s,t[s]);return r},mu=(r,t)=>lu(r,ou(t)),ra=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const hu=(r,t)=>{const[s,a]=x.useState(nu),[n,l]=x.useState(!1),[o,c]=x.useState(!1),[i,d]=x.useState([]);x.useEffect(()=>{r?a({title:r.title,category:r.category,autoSchedule:r.autoSchedule||!1,scheduleFrequency:r.scheduleFrequency||"weekly",scheduleDay:r.scheduleDay||"monday",scheduleTime:r.scheduleTime||"09:00",schedulePriority:r.schedulePriority||"medium",schedulePoints:r.schedulePoints||50,scheduleDuration:r.scheduleDuration||30,triggerRoomStatus:r.triggerRoomStatus||!1,triggerStaffSchedule:r.triggerStaffSchedule||!1,triggerAdminDecision:r.triggerAdminDecision||!1}):t&&a({title:"",category:"setup",autoSchedule:!1,scheduleFrequency:"weekly",scheduleDay:"monday",scheduleTime:"09:00",schedulePriority:"medium",schedulePoints:50,scheduleDuration:30,triggerRoomStatus:!1,triggerStaffSchedule:!1,triggerAdminDecision:!1})},[r,t]);const u=()=>ra(null,null,function*(){c(!0);try{try{const h=yield ws.askAI(`Generate 8 checklist title suggestions for the ${s.category} category. Each title should be descriptive and follow healthcare facility naming conventions.`,`Category: ${s.category}`),p=f(h);d(p),l(!0)}catch(h){console.warn("AI service failed, using fallback suggestions:",h);const p=yield b(s.category);d(p),l(!0)}}catch(h){console.error("Error generating AI suggestions:",h);const p=yield b(s.category);d(p),l(!0)}finally{c(!1)}}),m=h=>{a(p=>mu(uu({},p),{title:h})),l(!1)},f=h=>{try{const p=h.match(/\[[\s\S]*\]/);if(p){const v=JSON.parse(p[0]);if(Array.isArray(v))return v.map(j=>typeof j=="string"?j:j.title||j.name||j.suggestion||"Untitled Checklist")}const _=h.split(`
`).filter(v=>v.trim()),w=[];for(const v of _)if(v.match(/^\d+\./)){const j=v.replace(/^\d+\.\s*/,"").trim();j&&w.push(j)}else v.trim()&&!v.toLowerCase().includes("category")&&!v.toLowerCase().includes("suggestions")&&w.push(v.trim());return w.length>0?w:["AI-generated checklist","Custom checklist","Professional checklist"]}catch(p){return console.error("Error parsing AI response:",p),["AI-generated checklist","Custom checklist","Professional checklist"]}},b=h=>ra(null,null,function*(){return yield new Promise(_=>setTimeout(_,1e3)),{setup:["Treatment Room Setup Checklist","Surgical Suite Preparation","Examination Room Setup","Emergency Room Preparation","Laboratory Setup Protocol","Radiology Room Setup","Pharmacy Setup Checklist","Reception Area Setup"],patient:["Patient Room Cleaning Protocol","Isolation Room Procedures","Post-Procedure Room Cleanup","Patient Equipment Sanitization","Bedside Supply Restocking","Patient Safety Equipment Check","Infection Control Protocol","Patient Comfort Items Setup"],weekly:["Weekly Deep Cleaning Protocol","Equipment Maintenance Schedule","Supply Inventory Audit","Safety Equipment Inspection","Emergency Equipment Check","Compliance Documentation Review","Staff Training Verification","Quality Assurance Audit"],public:["Waiting Room Maintenance","Lobby Cleaning Protocol","Restroom Sanitization","Common Area Disinfection","Public Equipment Cleaning","Visitor Area Maintenance","Cafeteria Cleaning Protocol","Parking Area Maintenance"],deep:["Post-Contamination Deep Clean","Equipment Sterilization Protocol","Ventilation System Cleaning","Structural Disinfection","Biohazard Cleanup Protocol","Emergency Response Cleanup","Infection Outbreak Response","Facility-Wide Sanitization"]}[h]||[]});return{checklistFormData:s,showAIChecklistSuggestions:n,isGeneratingSuggestions:o,aiChecklistSuggestions:i,setChecklistFormData:a,setShowAIChecklistSuggestions:l,generateAIChecklistSuggestions:u,applyAIChecklistSuggestion:m}},gu=[{id:"setup",title:"Setup/Take Down",icon:Ga,color:"#FF6B6B"},{id:"patient",title:"Per Patient",icon:Ha,color:"#4ECDC4"},{id:"weekly",title:"Weekly",icon:Ya,color:"#45B7D1"},{id:"public",title:"Public Spaces",icon:Wa,color:"#96CEB4"},{id:"deep",title:"Deep Clean",icon:it,color:"#FF9F1C"}];var xu=Object.defineProperty,pu=Object.defineProperties,fu=Object.getOwnPropertyDescriptors,aa=Object.getOwnPropertySymbols,bu=Object.prototype.hasOwnProperty,yu=Object.prototype.propertyIsEnumerable,na=(r,t,s)=>t in r?xu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ia=(r,t)=>{for(var s in t||(t={}))bu.call(t,s)&&na(r,s,t[s]);if(aa)for(var s of aa(t))yu.call(t,s)&&na(r,s,t[s]);return r},la=(r,t)=>pu(r,fu(t));const vu=({checklistFormData:r,setChecklistFormData:t,showAIChecklistSuggestions:s,isGeneratingSuggestions:a,aiChecklistSuggestions:n,onGenerateAISuggestions:l,onApplyAISuggestion:o,onCloseAISuggestions:c})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checklist-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Checklist Title"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{id:"checklist-title",type:"text",value:r.title,onChange:i=>t(la(ia({},r),{title:i.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",placeholder:"e.g., Treatment Room Setup"}),e.jsxs("button",{onClick:l,disabled:a,className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 transition-colors",title:"Get AI suggestions for checklist titles",children:[e.jsx(y,{path:Vn,size:.8,className:"mr-1"}),a?"...":"AI"]})]}),s&&e.jsxs("div",{className:"mt-3 p-3 border border-purple-200 rounded-lg bg-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h5",{className:"text-sm font-medium text-purple-800 flex items-center",children:[e.jsx(y,{path:lt,size:.8,className:"mr-1"}),"AI Suggestions"]}),e.jsx("button",{onClick:c,className:"text-purple-600 hover:text-purple-800",children:e.jsx(y,{path:$e,size:.8})})]}),e.jsx("div",{className:"space-y-2",children:n.map((i,d)=>e.jsx("button",{onClick:()=>o(i),className:"w-full text-left p-2 text-sm text-purple-700 hover:bg-purple-100 rounded-md transition-colors",children:i},d))})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checklist-category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("select",{id:"checklist-category",value:r.category,onChange:i=>t(la(ia({},r),{category:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:gu.map(i=>e.jsx("option",{value:i.id,children:i.title},i.id))})]})]});var ju=Object.defineProperty,Nu=Object.defineProperties,_u=Object.getOwnPropertyDescriptors,oa=Object.getOwnPropertySymbols,Cu=Object.prototype.hasOwnProperty,wu=Object.prototype.propertyIsEnumerable,ca=(r,t,s)=>t in r?ju(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ue=(r,t)=>{for(var s in t||(t={}))Cu.call(t,s)&&ca(r,s,t[s]);if(oa)for(var s of oa(t))wu.call(t,s)&&ca(r,s,t[s]);return r},me=(r,t)=>Nu(r,_u(t));const Su=({checklistFormData:r,setChecklistFormData:t})=>e.jsxs("div",{className:"mt-6 p-4 border border-blue-200 rounded-lg bg-blue-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-md font-medium text-blue-800 flex items-center",children:[e.jsx(y,{path:Lt,size:1,className:"mr-2"}),"Scheduling Configuration"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.autoSchedule||!1,onChange:s=>t(me(ue({},r),{autoSchedule:s.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-blue-700",children:"Enable Auto-Scheduling"})]})]}),r.autoSchedule&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-frequency",className:"block text-sm font-medium text-blue-700 mb-1",children:"Frequency"}),e.jsxs("select",{id:"schedule-frequency",value:r.scheduleFrequency||"weekly",onChange:s=>t(me(ue({},r),{scheduleFrequency:s.target.value})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"per_patient",children:"Per Patient"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"bi_weekly",children:"Bi-Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"custom",children:"Custom"})]})]}),(r.scheduleFrequency==="weekly"||r.scheduleFrequency==="bi_weekly"||r.scheduleFrequency==="monthly")&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-day",className:"block text-sm font-medium text-blue-700 mb-1",children:"Schedule Day"}),e.jsxs("select",{id:"schedule-day",value:r.scheduleDay||"monday",onChange:s=>t(me(ue({},r),{scheduleDay:s.target.value})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"}),e.jsx("option",{value:"saturday",children:"Saturday"}),e.jsx("option",{value:"sunday",children:"Sunday"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-time",className:"block text-sm font-medium text-blue-700 mb-1",children:"Schedule Time"}),e.jsx("input",{id:"schedule-time",type:"time",value:r.scheduleTime||"09:00",onChange:s=>t(me(ue({},r),{scheduleTime:s.target.value})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-priority",className:"block text-sm font-medium text-blue-700 mb-1",children:"Priority"}),e.jsxs("select",{id:"schedule-priority",value:r.schedulePriority||"medium",onChange:s=>t(me(ue({},r),{schedulePriority:s.target.value})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-points",className:"block text-sm font-medium text-blue-700 mb-1",children:"Points"}),e.jsx("input",{id:"schedule-points",type:"number",value:r.schedulePoints||50,onChange:s=>t(me(ue({},r),{schedulePoints:parseInt(s.target.value)})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"schedule-duration",className:"block text-sm font-medium text-blue-700 mb-1",children:"Duration (minutes)"}),e.jsx("input",{id:"schedule-duration",type:"number",value:r.scheduleDuration||30,onChange:s=>t(me(ue({},r),{scheduleDuration:parseInt(s.target.value)})),className:"w-full px-3 py-2 border border-blue-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-700 mb-2",children:"Trigger Conditions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.triggerRoomStatus||!1,onChange:s=>t(me(ue({},r),{triggerRoomStatus:s.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-blue-700",children:"Trigger on room status change"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.triggerStaffSchedule||!1,onChange:s=>t(me(ue({},r),{triggerStaffSchedule:s.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-blue-700",children:"Trigger based on staff availability"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.triggerAdminDecision||!1,onChange:s=>t(me(ue({},r),{triggerAdminDecision:s.target.checked})),className:"mr-2"}),e.jsx("span",{className:"text-sm text-blue-700",children:"Require admin approval"})]})]})]})]})]}),Eu=({selectedChecklist:r,onSaveDraft:t,onPublish:s,isValid:a=!0})=>e.jsxs("div",{className:"flex justify-end mt-4 space-x-3",children:[e.jsxs("button",{onClick:t,disabled:!a,className:`flex items-center px-6 py-2 rounded-lg font-semibold text-lg ${a?"bg-gray-500 text-white hover:bg-gray-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(y,{path:mt,size:1,className:"mr-2"}),"Save Draft"]}),r&&e.jsxs("button",{onClick:s,disabled:!a,className:`flex items-center px-6 py-2 rounded-lg font-semibold text-lg ${a?"bg-[#4ECDC4] text-white hover:bg-[#3db8b0]":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(y,{path:mt,size:1,className:"mr-2"}),"Publish"]})]}),Tu=({selectedChecklist:r,isAddingChecklist:t,onSaveDraft:s,onPublish:a})=>{const{checklistFormData:n,showAIChecklistSuggestions:l,isGeneratingSuggestions:o,aiChecklistSuggestions:c,setChecklistFormData:i,setShowAIChecklistSuggestions:d,generateAIChecklistSuggestions:u,applyAIChecklistSuggestion:m}=hu(r,t),f=()=>{n.title&&n.category&&s(n)},b=()=>{n.title&&n.category&&(s(n),a())},h=n.title.trim()!==""&&n.category!==null;return e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Checklist Details"}),e.jsx(vu,{checklistFormData:n,setChecklistFormData:i,showAIChecklistSuggestions:l,isGeneratingSuggestions:o,aiChecklistSuggestions:c,onGenerateAISuggestions:u,onApplyAISuggestion:m,onCloseAISuggestions:()=>d(!1)}),e.jsx(Su,{checklistFormData:n,setChecklistFormData:i}),e.jsx(Eu,{selectedChecklist:r,onSaveDraft:f,onPublish:b,isValid:h})]})},Pu=[{id:"setup",title:"Setup/Take Down",icon:Ga,color:"#FF6B6B"},{id:"patient",title:"Per Patient",icon:Ha,color:"#4ECDC4"},{id:"weekly",title:"Weekly",icon:Ya,color:"#45B7D1"},{id:"public",title:"Public Spaces",icon:Wa,color:"#96CEB4"},{id:"deep",title:"Deep Clean",icon:it,color:"#FF9F1C"}],Iu=({checklists:r,onEditChecklist:t,onDeleteChecklist:s})=>{const[a,n]=x.useState(new Set(["setup"])),l=o=>{n(c=>{const i=new Set(c);return i.has(o)?i.delete(o):i.add(o),i})};return e.jsx("div",{className:"space-y-6",children:Pu.map(o=>{const c=r.filter(m=>m.category===o.id),i=c.filter(m=>m.status==="published"),d=c.filter(m=>m.status==="draft"),u=a.has(o.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("button",{onClick:()=>l(o.id),className:"flex items-center w-full text-left hover:bg-gray-50 p-2 -m-2 rounded-md transition-colors",children:[e.jsx(y,{path:o.icon,size:1.2,color:o.color,className:"mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:o.title}),e.jsxs("span",{className:"ml-2 px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:[i.length," published, ",d.length," ","draft"]}),e.jsx(y,{path:u?ot:ct,size:1,className:"ml-auto text-gray-400"})]}),u&&e.jsx(e.Fragment,{children:c.length===0?e.jsx("p",{className:"text-gray-500 text-sm italic mt-4",children:"No checklists created yet."}):e.jsxs("div",{className:"space-y-3 mt-4",children:[i.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Published Checklists"}),i.map(m=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:m.title}),e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[m.items.length," item",m.items.length!==1?"s":""]}),e.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${m.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:m.status==="published"?"Published":"Draft"}),m.autoSchedule&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full flex items-center",children:[e.jsx(y,{path:Lt,size:.7,className:"mr-1"}),"Auto-Scheduled"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>t(m),className:"px-3 py-1 text-sm text-[#4ECDC4] hover:bg-[#4ECDC4] hover:text-white rounded-md transition-colors",children:"Edit & Manage"}),e.jsx("button",{onClick:()=>s(m.id),className:"p-1 text-red-600 hover:bg-red-50 rounded-md transition-colors",children:e.jsx(y,{path:ut,size:.8})})]})]})},m.id))]}),d.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Draft Checklists"}),d.map(m=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:m.title}),e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[m.items.length," item",m.items.length!==1?"s":""]}),e.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${m.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:m.status==="published"?"Published":"Draft"}),m.autoSchedule&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full flex items-center",children:[e.jsx(y,{path:Lt,size:.7,className:"mr-1"}),"Auto-Scheduled"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>t(m),className:"px-3 py-1 text-sm text-[#4ECDC4] hover:bg-[#4ECDC4] hover:text-white rounded-md transition-colors",children:"Edit & Manage"}),e.jsx("button",{onClick:()=>s(m.id),className:"p-1 text-red-600 hover:bg-red-50 rounded-md transition-colors",children:e.jsx(y,{path:ut,size:.8})})]})]})},m.id))]})]})})]},o.id)})})},Au=r=>{const t=r.data&&typeof r.data=="object"&&r.data!==null?r.data.expiration:null;if(!t&&!r.expiryDate)return null;const s=new Date(String(t||r.expiryDate||"")),a=new Date,n=new Date;return n.setDate(a.getDate()+30),s<a?{status:"expired",color:"text-red-600",bgColor:"bg-red-50"}:s<=n?{status:"expiring-soon",color:"text-orange-600",bgColor:"bg-orange-50"}:{status:"valid",color:"text-green-600",bgColor:"bg-green-50"}},Ou=r=>new Date(r).toLocaleDateString(),cs=(r,t)=>({searchQuery:r.trim()||void 0,category:t.category||void 0,manufacturer:t.manufacturer||void 0,supplier:t.supplier||void 0,reorder_point:t.reorder_point?parseInt(t.reorder_point):void 0,expiryDate:t.expiryDate||void 0,sortBy:t.sortBy,sortDirection:t.sortDirection}),da=()=>({category:"",location:"",status:"",manufacturer:"",supplier:"",reorder_point:"",expiryDate:"",sortBy:"name",sortDirection:"asc"});var le=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const ds=()=>le(null,null,function*(){return yield Ut.getCurrentFacilityId()}),us=(r,t=0)=>typeof r=="number"&&!isNaN(r)?r:t,ua=(r,t="Unknown")=>typeof r=="string"&&r.trim()!==""?r:t,ms=r=>r instanceof Error?r.message:typeof r=="string"?r:"An unknown error occurred";class He{static getItemsFromSupabase(t,s){return le(this,null,function*(){try{const a=s||(yield ds()),n=Ht(a),l=Ie.getFilterSummary(t);if(!Ie.validateFilters(t))throw new Error("Invalid filter parameters");const o=yield Ie.applyFiltersToTable(n,"inventory_items",t),{data:c,error:i,count:d}=yield o.eq("facility_id",a).order("created_at",{ascending:!1});if(i)throw console.error("Error fetching items from Supabase:",i),i;return{data:(c==null?void 0:c.map(m=>di.transformFromSupabase(m)))||[],error:null,count:d||0}}catch(a){throw console.error("Failed to fetch items from Supabase:",a),a}})}static getItemByIdFromSupabase(t){return le(this,null,function*(){try{return yield Ds.getItemById(t)}catch(s){return console.error("Error fetching item by ID:",s),null}})}static createItemInSupabase(t){return le(this,null,function*(){try{const{createItem:s}=yield Yt(()=>import("./main-RuFFPtZZ.js").then(n=>n.a0),__vite__mapDeps([0,1,2,3,4,5,6,7]));return yield s(t)}catch(s){throw console.error("Error creating item:",s),new Error(`Failed to create item: ${ms(s)}`)}})}static updateItemInSupabase(t,s){return le(this,null,function*(){try{const{updateItem:a}=yield Yt(()=>import("./main-RuFFPtZZ.js").then(l=>l.a0),__vite__mapDeps([0,1,2,3,4,5,6,7]));return yield a(t,s)}catch(a){throw console.error("Error updating item:",a),new Error(`Failed to update item: ${ms(a)}`)}})}static deleteItemFromSupabase(t){return le(this,null,function*(){try{const{deleteItem:s}=yield Yt(()=>import("./main-RuFFPtZZ.js").then(a=>a.a0),__vite__mapDeps([0,1,2,3,4,5,6,7]));yield s(t)}catch(s){throw new Error(`Failed to delete item: ${ms(s)}`)}})}static getCategories(t){return le(this,null,function*(){try{const s=t||(yield ds()),a=Ht(s),l=yield(yield Ie.applyFiltersToCategories(a,"inventory_items")).eq("facility_id",s);if(!l)throw console.error("❌ Error fetching categories"),new Error("Failed to fetch categories");return Ie.extractUniqueValues(l.data,"category").sort()}catch(s){return console.error("Error fetching categories:",s),[]}})}static getCategoriesFromSupabase(){return le(this,null,function*(){return this.getCategories()})}static getLocations(t){return le(this,null,function*(){try{const s=t||(yield ds()),a=Ht(s),l=yield(yield Ie.applyFiltersToLocations(a,"inventory_items")).eq("facility_id",s);if(!l)throw console.error("❌ Error fetching locations"),new Error("Failed to fetch locations");return Ie.extractUniqueValues(l.data,"location").sort()}catch(s){return console.error("Error fetching locations:",s),[]}})}static getLocationsFromSupabase(){return le(this,null,function*(){return this.getLocations()})}static getInventoryStatsFromSupabase(){return le(this,null,function*(){try{const t=yield Ds.getItems(),s=t.length,a=t.filter(o=>o.status==="active").length,n=t.reduce((o,c)=>o+us(c.unit_cost),0),l={};return t.forEach(o=>{const c=ua(o.category);l[c]=(l[c]||0)+1}),{totalItems:s,activeItems:a,totalValue:n,categories:l}}catch(t){return console.error("Error fetching inventory stats:",t),{totalItems:0,activeItems:0,totalValue:0,categories:{}}}})}static calculateTotalValue(t){try{return t.reduce((a,n)=>{const l=us(n.unit_cost),o=us(n.quantity,1);return a+l*o},0)}catch(s){return console.error("Error calculating total value:",s),0}}static getCategoryBreakdown(t){try{const s={};return t.forEach(a=>{const n=ua(a.category);s[n]=(s[n]||0)+1}),s}catch(s){return console.error("Error calculating category breakdown:",s),{}}}}var Du=Object.defineProperty,ku=Object.defineProperties,Ru=Object.getOwnPropertyDescriptors,ma=Object.getOwnPropertySymbols,$u=Object.prototype.hasOwnProperty,Lu=Object.prototype.propertyIsEnumerable,ha=(r,t,s)=>t in r?Du(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ga=(r,t)=>{for(var s in t||(t={}))$u.call(t,s)&&ha(r,s,t[s]);if(ma)for(var s of ma(t))Lu.call(t,s)&&ha(r,s,t[s]);return r},Mu=(r,t)=>ku(r,Ru(t)),Ye=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});class Fu{searchInventoryItems(t){return Ye(this,null,function*(){try{const s=Mu(ga(ga({search:t.searchQuery,category:t.category},t.manufacturer&&{search:`${t.searchQuery||""} ${t.manufacturer}`.trim()}),t.supplier&&{search:`${t.searchQuery||""} ${t.supplier}`.trim()}),{minQuantity:t.reorder_point}),a=yield He.getItemsFromSupabase(s);if(a.error)return console.error("Error fetching inventory items:",a.error),[];let n=a.data||[];if(t.manufacturer&&!t.searchQuery&&(n=n.filter(l=>(l.data&&typeof l.data=="object"&&l.data!==null?l.data.manufacturer:null)===t.manufacturer)),t.supplier&&!t.searchQuery&&(n=n.filter(l=>(l.data&&typeof l.data=="object"&&l.data!==null?l.data.supplier:null)===t.supplier)),t.expiryDate){const l=new Date,o=new Date;o.setDate(l.getDate()+30),n=n.filter(c=>{const i=c.data&&typeof c.data=="object"&&c.data!==null?c.data.expiration:null;if(!i&&!c.expiration_date)return!1;const d=new Date(String(i||c.expiration_date||""));switch(t.expiryDate){case"expired":return d<l;case"expiring-soon":return d>=l&&d<=o;case"valid":return d>o;default:return!0}})}return t.sortBy&&n.sort((l,o)=>{let c,i;switch(t.sortBy){case"name":c=l.name||"",i=o.name||"";break;case"category":c=l.category||"",i=o.category||"";break;case"quantity":c=l.quantity||0,i=o.quantity||0;break;case"expiration":{const d=l.data&&typeof l.data=="object"&&l.data!==null?l.data.expiration:null,u=o.data&&typeof o.data=="object"&&o.data!==null?o.data.expiration:null;c=new Date(String(d||l.expiration_date||"")),i=new Date(String(u||o.expiration_date||""));break}case"unit_cost":c=l.unit_cost||0,i=o.unit_cost||0;break;default:return 0}return t.sortDirection==="desc"?c>i?-1:c<i?1:0:c<i?-1:c>i?1:0}),n}catch(s){return console.error("Error in searchInventoryItems:",s),[]}})}getCategories(){return Ye(this,null,function*(){try{const t=yield He.getItemsFromSupabase();return t.error?(console.error("Error fetching categories:",t.error),[]):Array.from(new Set((t.data||[]).map(a=>a.category).filter(a=>!!a))).sort()}catch(t){return console.error("Error in getCategories:",t),[]}})}getManufacturers(){return Ye(this,null,function*(){try{const t=yield He.getItemsFromSupabase();return t.error?(console.error("Error fetching manufacturers:",t.error),[]):Array.from(new Set((t.data||[]).map(a=>a.data&&typeof a.data=="object"&&a.data!==null?a.data.manufacturer:null).filter(a=>!!a))).sort()}catch(t){return console.error("Error in getManufacturers:",t),[]}})}getSuppliers(){return Ye(this,null,function*(){try{const t=yield He.getItemsFromSupabase();return t.error?(console.error("Error fetching suppliers:",t.error),[]):Array.from(new Set((t.data||[]).map(a=>a.data&&typeof a.data=="object"&&a.data!==null?a.data.supplier:null).filter(a=>!!a))).sort()}catch(t){return console.error("Error in getSuppliers:",t),[]}})}getLocations(){return Ye(this,null,function*(){try{const t=yield He.getItemsFromSupabase();return t.error?(console.error("Error fetching locations:",t.error),[]):Array.from(new Set((t.data||[]).map(a=>a.location).filter(a=>!!a))).sort()}catch(t){return console.error("Error in getLocations:",t),[]}})}getStatuses(){return Ye(this,null,function*(){try{const t=yield He.getItemsFromSupabase();return t.error?(console.error("Error fetching statuses:",t.error),[]):Array.from(new Set((t.data||[]).map(a=>a.status).filter(a=>!!a))).sort()}catch(t){return console.error("Error in getStatuses:",t),[]}})}}const De=new Fu;var hs=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const zu=()=>{const[r,t]=x.useState([]),[s,a]=x.useState(!1),[n,l]=x.useState(null),[o,c]=x.useState([]),[i,d]=x.useState([]),[u,m]=x.useState([]),[f,b]=x.useState([]),[h,p]=x.useState([]);x.useEffect(()=>{hs(null,null,function*(){try{const[j,E,k,A,V]=yield Promise.all([De.getCategories(),De.getLocations(),De.getStatuses(),De.getManufacturers(),De.getSuppliers()]);c(j),d(E),m(k),b(A),p(V)}catch(j){l(j instanceof Error?j.message:"Failed to load filter options")}})},[]);const _=x.useCallback(v=>hs(null,null,function*(){a(!0),l(null);try{const j=yield De.searchInventoryItems(v);t(j)}catch(j){l(j instanceof Error?j.message:"Failed to search inventory")}finally{a(!1)}}),[]),w=x.useCallback(()=>hs(null,null,function*(){a(!0),l(null);try{const v=yield De.searchInventoryItems({});t(v)}catch(v){l(v instanceof Error?v.message:"Failed to clear search")}finally{a(!1)}}),[]);return{inventoryItems:r,isLoading:s,error:n,categories:o,locations:i,statuses:u,manufacturers:f,suppliers:h,searchInventory:_,clearSearch:w}},qu=({isOpen:r,selectedItems:t=[],onSelectItems:s,onClose:a})=>{const{inventoryItems:n,isLoading:l,error:o,categories:c,locations:i,statuses:d,searchInventory:u,clearSearch:m}=zu(),[f,b]=x.useState(""),[h,p]=x.useState(!1),[_,w]=x.useState(da()),[v,j]=x.useState(t);return x.useEffect(()=>{if(!r)return;const $=setTimeout(()=>{if(f.trim()||Object.values(_).some(G=>G!=="")){const G=cs(f,_);u(G)}},300);return()=>clearTimeout($)},[f,_,r,u]),x.useEffect(()=>{if(r){m(),j(t);const $=cs(f,_);u($)}},[r,t,m,u,f,_]),x.useEffect(()=>{j(t)},[t]),{searchQuery:f,showFilters:h,filters:_,localSelectedItems:v,inventoryItems:n,isLoading:l,error:o,categories:c,locations:i,statuses:d,setSearchQuery:b,setShowFilters:p,setFilters:w,handleClearFilters:()=>{w(da()),b(""),m().then(()=>{setTimeout(()=>{u({})},100)})},handleItemToggle:$=>{const G=v.some(D=>D.id===$.id);j(G?D=>D.filter(S=>S.id!==$.id):D=>[...D,$])},handleConfirmSelection:()=>{s(v),a()},handleSearch:()=>{const $=cs(f,_);u($)}}},Uu=({onClose:r})=>e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Search Inventory Items"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Select items for your checklist with advanced filtering"})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(y,{path:$e,size:1.5})})]}),Vu=({searchQuery:r,onSearchChange:t,onSearch:s})=>{const a=n=>{n.key==="Enter"&&s()};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{path:Bn,size:1,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search items...",value:r,onChange:n=>t(n.target.value),onKeyPress:a,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]"})]}),e.jsx("button",{onClick:s,className:"w-full mt-2 px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3db8b0] transition-colors",children:"Search"})]})};var Bu=Object.defineProperty,Gu=Object.defineProperties,Hu=Object.getOwnPropertyDescriptors,xa=Object.getOwnPropertySymbols,Yu=Object.prototype.hasOwnProperty,Wu=Object.prototype.propertyIsEnumerable,pa=(r,t,s)=>t in r?Bu(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Ku=(r,t)=>{for(var s in t||(t={}))Yu.call(t,s)&&pa(r,s,t[s]);if(xa)for(var s of xa(t))Wu.call(t,s)&&pa(r,s,t[s]);return r},Qu=(r,t)=>Gu(r,Hu(t));const Zu=({filters:r,onFiltersChange:t,onClearFilters:s,categories:a,showFilters:n,onToggleFilters:l})=>{const o=(c,i)=>{t(Qu(Ku({},r),{[c]:i}))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("button",{onClick:l,className:"flex items-center space-x-2 text-gray-700 hover:text-gray-900",children:[e.jsx(y,{path:Gn,size:1}),e.jsx("span",{children:"Filters"}),e.jsx(y,{path:Hn,size:1,className:`transform transition-transform ${n?"rotate-180":""}`})]})}),e.jsx(Nn,{children:n&&e.jsxs(_s.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{id:"category-filter",value:r.category,onChange:c=>o("category",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"All Categories"}),a.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"min-quantity-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Quantity"}),e.jsx("input",{id:"min-quantity-filter",type:"number",value:r.reorder_point,onChange:c=>o("reorder_point",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-quantity-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Quantity"}),e.jsx("input",{id:"max-quantity-filter",type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",placeholder:"∞"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"expiry-status-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Status"}),e.jsxs("select",{id:"expiry-status-filter",value:r.expiryDate,onChange:c=>o("expiryDate",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"",children:"All Items"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"expiring-soon",children:"Expiring Soon (30 days)"}),e.jsx("option",{value:"valid",children:"Valid"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-by-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{id:"sort-by-filter",value:r.sortBy,onChange:c=>o("sortBy",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"category",children:"Category"}),e.jsx("option",{value:"quantity",children:"Quantity"}),e.jsx("option",{value:"expiration",children:"Expiration"}),e.jsx("option",{value:"unit_cost",children:"Unit Cost"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort-direction-filter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Direction"}),e.jsxs("select",{id:"sort-direction-filter",value:r.sortDirection,onChange:c=>o("sortDirection",c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:[e.jsx("option",{value:"asc",children:"Ascending"}),e.jsx("option",{value:"desc",children:"Descending"})]})]})]}),e.jsx("button",{onClick:s,className:"w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Clear Filters"})]})})]})},Ju=({selectedItems:r})=>e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Selected Items"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.length," item",r.length!==1?"s":""," ","selected"]}),r.length>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[r.slice(0,3).map(t=>e.jsx("div",{className:"text-xs text-gray-600 truncate",children:t.name},t.id)),r.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.length-3," more"]})]})]}),Xu=({item:r,isSelected:t,onToggle:s})=>{const a=Au(r),n=l=>{var o;return(o=r.data)==null?void 0:o[l]};return e.jsx(_s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`border rounded-lg p-4 cursor-pointer transition-all ${t?"border-[#4ECDC4] bg-[#4ECDC4]/5":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,onClick:()=>s(r),children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.name}),t&&e.jsx("span",{className:"px-2 py-1 text-xs bg-[#4ECDC4] text-white rounded-full",children:"Selected"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{path:gt,size:.8}),e.jsx("span",{children:r.category})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{path:Ka,size:.8}),e.jsx("span",{children:r.location})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"font-medium",children:"Quantity:"}),e.jsxs("span",{children:[r.quantity||0," ",String(n("unit")||"units")]})]})]}),e.jsxs("div",{className:"space-y-1",children:[n("manufacturer")?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{path:Yn,size:.8}),e.jsx("span",{children:String(n("manufacturer"))})]}):null,n("supplier")?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{path:Wn,size:.8}),e.jsx("span",{children:String(n("supplier"))})]}):null,n("expiration")||r.expiryDate?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(y,{path:Lt,size:.8}),e.jsxs("span",{children:["Expires:"," ",Ou(String(n("expiration")||r.expiryDate||""))]})]}):null]})]}),a&&e.jsxs("div",{className:`mt-2 inline-block px-2 py-1 text-xs rounded-full ${a.bgColor} ${a.color}`,children:[a.status==="expired"&&"Expired",a.status==="expiring-soon"&&"Expiring Soon",a.status==="valid"&&"Valid"]})]})})})},em=({inventoryItems:r,selectedItems:t,onItemToggle:s,isLoading:a,error:n})=>e.jsxs("div",{className:"w-2/3 p-6 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Search Results"}),e.jsx("p",{className:"text-sm text-gray-600",children:a?"Searching...":`${r.length} items found`})]})}),n&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-500 mb-4",children:[e.jsx(y,{path:te,size:1}),e.jsx("span",{children:n})]}),a&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{path:Kn,size:1,className:"animate-spin text-[#4ECDC4]"}),e.jsx("span",{className:"text-gray-600",children:"Searching inventory..."})]})}),!a&&!n&&e.jsx("div",{className:"space-y-3",children:r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{path:gt,size:3,className:"mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No items found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria."})]}):r.map(l=>{const o=t.some(c=>c.id===l.id);return e.jsx(Xu,{item:l,isSelected:o,onToggle:s},l.id)})})]}),tm=({isOpen:r,onClose:t,onSelectItems:s,selectedItems:a=[]})=>{const{searchQuery:n,showFilters:l,filters:o,localSelectedItems:c,inventoryItems:i,isLoading:d,error:u,categories:m,locations:f,statuses:b,setSearchQuery:h,setShowFilters:p,setFilters:_,handleClearFilters:w,handleItemToggle:v,handleConfirmSelection:j,handleSearch:E}=qu({isOpen:r,selectedItems:a,onSelectItems:s,onClose:t});return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(_s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsx(Uu,{onClose:t}),e.jsxs("div",{className:"flex h-[calc(90vh-140px)]",children:[e.jsxs("div",{className:"w-1/3 border-r border-gray-200 p-6 overflow-y-auto",children:[e.jsx(Vu,{searchQuery:n,onSearchChange:h,onSearch:E}),e.jsx(Zu,{filters:o,onFiltersChange:_,onClearFilters:w,categories:m,locations:f,statuses:b,showFilters:l,onToggleFilters:()=>p(!l)}),e.jsx(Ju,{selectedItems:c})]}),e.jsx(em,{inventoryItems:i,selectedItems:c,onItemToggle:v,isLoading:d,error:u})]}),e.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200",children:e.jsxs("button",{onClick:j,disabled:c.length===0,className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-lg hover:bg-[#3db8b0] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:["Confirm Selection (",c.length,")"]})})]})}):null};var sm=Object.defineProperty,rm=Object.defineProperties,am=Object.getOwnPropertyDescriptors,fa=Object.getOwnPropertySymbols,nm=Object.prototype.hasOwnProperty,im=Object.prototype.propertyIsEnumerable,ba=(r,t,s)=>t in r?sm(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,at=(r,t)=>{for(var s in t||(t={}))nm.call(t,s)&&ba(r,s,t[s]);if(fa)for(var s of fa(t))im.call(t,s)&&ba(r,s,t[s]);return r},nt=(r,t)=>rm(r,am(t)),ya=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const lm=({selectedChecklist:r,onAddItem:t,onUpdateItem:s,onDeleteItem:a,onGenerateAIItemSuggestions:n,showAIItemSuggestions:l,isGeneratingSuggestions:o,aiItemSuggestions:c,onApplyAIItemSuggestion:i,onCloseAISuggestions:d,showSuccessMessage:u})=>{const[m,f]=x.useState(!1),[b,h]=x.useState([]),[p,_]=x.useState(!1),[w,v]=x.useState(null),[j,E]=x.useState({title:"",instructions:"",inventoryItemIds:[],sdsId:""}),[k,A]=x.useState(!1),V=()=>{j.title&&j.instructions&&r&&(t({title:j.title,instructions:j.instructions,requiredInventory:b.map(C=>({id:C.id,name:C.name||"",required:1,available:C.quantity||0,used:0,unit:"unit"})),sdsId:j.sdsId||void 0}),E({title:"",instructions:"",inventoryItemIds:[],sdsId:""}),h([]),_(!1))},$=C=>{j.title&&j.instructions&&r&&(s(C,{title:j.title,instructions:j.instructions,requiredInventory:b.map(O=>({id:O.id,name:O.name||"",required:1,available:O.quantity||0,used:0,unit:"unit"})),sdsId:j.sdsId||void 0}),E({title:"",instructions:"",inventoryItemIds:[],sdsId:""}),h([]),v(null))},G=C=>{var O;v(C.id),E({title:C.title,instructions:C.instructions,inventoryItemIds:((O=C.requiredInventory)==null?void 0:O.map(F=>F.id))||[],sdsId:C.sdsId||""});const T=(C.requiredInventory||[]).map(F=>({id:F.id,facility_id:null,name:F.name,quantity:F.available,data:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),reorder_point:null,expiration_date:null,unit_cost:null,category:null,status:null,location:null,supplier:null,cost:null,vendor:null,warranty:null,maintenance_schedule:null,next_due:null,service_provider:null,assigned_to:null,notes:null,tool_id:null,supply_id:null,equipment_id:null,hardware_id:null,p2_status:null,serial_number:null,manufacturer:null,image_url:null,tags:null,favorite:null,tracked:null,barcode:null,sku:null,description:null,current_phase:null,is_active:null,unit:null,expiration:null,purchase_date:null,last_serviced:null,last_updated:null}));h(T)},D=C=>{h(C)},S=(C,O)=>ya(null,null,function*(){if(C.trim()){A(!0);try{try{const T=yield ws.askAI(`Generate detailed instructions for checklist item "${C}" in the ${O||(r==null?void 0:r.category)} category. Provide step-by-step instructions that are clear and actionable.`,`Category: ${O||(r==null?void 0:r.category)}, Title: ${C}`);E(F=>nt(at({},F),{instructions:T}))}catch(T){console.warn("AI service failed, using fallback description:",T);const F=yield H(C,O||(r==null?void 0:r.category));E(se=>nt(at({},se),{instructions:F}))}}catch(T){console.error("Error generating AI description:",T),E(F=>nt(at({},F),{instructions:`Complete ${C.toLowerCase()} following established procedures and safety protocols.`}))}finally{A(!1)}}}),L=C=>{if(E(O=>nt(at({},O),{title:C})),C.length>=5&&!j.instructions){const O=setTimeout(()=>{S(C)},1e3);return()=>clearTimeout(O)}return()=>{}},H=(C,O)=>ya(null,null,function*(){return yield new Promise(F=>setTimeout(F,800)),{setup:`Perform ${C.toLowerCase()} according to facility protocols. Ensure all equipment is properly prepared and safety measures are in place.`,patient:`Complete ${C.toLowerCase()} with patient safety as the priority. Follow infection control protocols and maintain patient privacy.`,weekly:`Conduct thorough ${C.toLowerCase()} as part of weekly maintenance schedule. Document all activities and report any issues.`,public:`Execute ${C.toLowerCase()} in public areas following facility standards. Maintain professional appearance and ensure accessibility.`,deep:`Perform intensive ${C.toLowerCase()} using specialized equipment and procedures. Follow all safety protocols and containment measures.`}[O]||`Complete ${C.toLowerCase()} following established procedures and safety protocols.`});return e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-md font-medium",children:"Checklist Items"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:n,disabled:o,className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:bg-gray-400 transition-colors",title:"Get AI suggestions for checklist items",children:[e.jsx(y,{path:Qn,size:.8,className:"mr-1"}),o?"Generating...":"AI Suggestions"]}),e.jsxs("button",{onClick:()=>{_(!0),v(null),E({title:"",instructions:"",inventoryItemIds:[],sdsId:""}),h([])},className:"flex items-center px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:[e.jsx(y,{path:ye,size:1,className:"mr-2"}),"Add Item"]})]})]}),l&&e.jsxs("div",{className:"mb-4 p-4 border border-purple-200 rounded-lg bg-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-purple-800 flex items-center",children:[e.jsx(y,{path:lt,size:.8,className:"mr-1"}),"AI Item Suggestions"]}),e.jsx("button",{onClick:d,className:"text-purple-600 hover:text-purple-800",children:e.jsx(y,{path:$e,size:.8})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:c.map((C,O)=>e.jsxs("div",{className:"border border-purple-200 rounded-lg p-3 bg-white",children:[e.jsx("h6",{className:"font-medium text-purple-800 mb-1",children:C.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:C.instructions}),C.suggestedInventory.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Suggested: "}),e.jsx("span",{className:"text-xs text-purple-600",children:C.suggestedInventory.join(", ")})]}),e.jsx("button",{onClick:()=>i(C),className:"w-full px-3 py-1 text-sm bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Use This Item"})]},O))})]}),u&&e.jsx("div",{className:"mb-4 p-3 border border-green-200 rounded-lg bg-green-50",children:e.jsxs("div",{className:"flex items-center text-green-800",children:[e.jsx(y,{path:mt,size:.8,className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:u})]})}),e.jsxs("div",{className:"space-y-3 mb-4",children:[r.items.map(C=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-800",children:C.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C.instructions}),C.requiredInventory&&C.requiredInventory.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Required: "}),C.requiredInventory.map(O=>O.name).join(", ")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-3",children:[e.jsx("button",{onClick:()=>G(C),className:"p-1 text-blue-600 hover:bg-blue-50 rounded-md transition-colors",children:e.jsx(y,{path:ke,size:.8})}),e.jsx("button",{onClick:()=>a(C.id),className:"p-1 text-red-600 hover:bg-red-50 rounded-md transition-colors",children:e.jsx(y,{path:ut,size:.8})})]})]})},C.id)),r.items.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:'No items added yet. Click "Add Item" to get started.'})]}),p&&e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white",children:[e.jsx("h5",{className:"font-medium mb-3",children:w?"Edit Item":"Add New Item"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"item-title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Title"}),e.jsx("input",{id:"item-title",type:"text",value:j.title,onChange:C=>L(C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",placeholder:"e.g., Clean and sanitize surfaces"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center",children:["Instructions",k&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600 flex items-center",children:[e.jsx(y,{path:lt,size:.6,className:"mr-1 animate-pulse"}),"AI generating..."]})]}),j.title&&!k&&e.jsxs("button",{type:"button",onClick:()=>S(j.title),className:"text-xs text-blue-600 hover:text-blue-800 flex items-center",title:"Generate AI description",children:[e.jsx(y,{path:lt,size:.6,className:"mr-1"}),"AI Generate"]})]}),e.jsx("textarea",{value:j.instructions,onChange:C=>E(nt(at({},j),{instructions:C.target.value})),className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] ${k?"bg-blue-50 border-blue-200":""}`,rows:3,placeholder:k?"AI is generating instructions...":"Detailed instructions for this task...",disabled:k})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"inventory-select",className:"block text-sm font-medium text-gray-700 mb-1",children:"Required Inventory"}),e.jsx("button",{id:"inventory-select",onClick:()=>f(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-left focus:outline-none focus:ring-2 focus:ring-[#4ECDC4]",children:b.length>0?`${b.length} item(s) selected`:"Click to select required inventory items"}),b.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:b.map(C=>e.jsxs("div",{className:"text-sm text-gray-600",children:["• ",C.name]},C.id))})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{_(!1),v(null),E({title:"",instructions:"",inventoryItemIds:[],sdsId:""}),h([])},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),e.jsx("button",{onClick:()=>w?$(w):V(),className:"px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac]",children:w?"Update Item":"Add Item"})]})]})]}),e.jsx(tm,{isOpen:m,onClose:()=>f(!1),onSelectItems:D,selectedItems:b})]})};var om=Object.defineProperty,cm=Object.defineProperties,dm=Object.getOwnPropertyDescriptors,va=Object.getOwnPropertySymbols,um=Object.prototype.hasOwnProperty,mm=Object.prototype.propertyIsEnumerable,ja=(r,t,s)=>t in r?om(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,hm=(r,t)=>{for(var s in t||(t={}))um.call(t,s)&&ja(r,s,t[s]);if(va)for(var s of va(t))mm.call(t,s)&&ja(r,s,t[s]);return r},gm=(r,t)=>cm(r,dm(t)),Na=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const xm=()=>{const{checklists:r,updateChecklist:t,deleteChecklist:s,publishChecklist:a,addItemToChecklist:n,updateChecklistItem:l,deleteChecklistItem:o}=ks(),[c,i]=x.useState(!1),[d,u]=x.useState(null),[m,f]=x.useState(!1),b=T=>{if(d)t(d.id,T);else{const{addChecklist:F}=ks.getState();F(gm(hm({},T),{title:T.title||"New Checklist",items:[],status:"draft"}))}u(null),i(!1)},h=()=>{d&&(a(d.id),u(null))},p=T=>{u(T)},_=()=>{i(!1),u(null)},w=T=>{if(d){n(d.id,T);const F=r.find(se=>se.id===d.id);F&&u(F)}},v=(T,F)=>{d&&l(d.id,T,F)},j=T=>{d&&o(d.id,T)},[E,k]=x.useState(!1),[A,V]=x.useState(!1),[$,G]=x.useState([]),[D,S]=x.useState(null),L=()=>Na(null,null,function*(){if(d){V(!0);try{try{const T=yield ws.askAI(`Generate 5-7 detailed checklist items for "${d.title}" in the ${d.category} category. Each item should include title, detailed instructions, and suggested inventory requirements.`,`Category: ${d.category}, Title: ${d.title}`),F=C(T);G(F),k(!0)}catch(T){console.warn("AI service failed, using fallback suggestions:",T);const F=yield O(d.category);G(F),k(!0)}}catch(T){console.error("Error generating AI item suggestions:",T);const F=yield O(d.category);G(F),k(!0)}finally{V(!1)}}}),H=T=>{if(!d)return;n(d.id,{title:T.title,instructions:T.instructions,requiredInventory:[],sdsId:void 0});const F=r.find(se=>se.id===d.id);F&&u(F),k(!1),S(`✅ Added "${T.title}" to checklist`),setTimeout(()=>S(null),3e3)},C=T=>{try{const F=T.match(/\[[\s\S]*\]/);if(F){const B=JSON.parse(F[0]);if(Array.isArray(B))return B.map(W=>{var ie;return{title:W.title||W.name||"Untitled Item",instructions:W.instructions||((ie=W.data)==null?void 0:ie.description)||W.steps||"No instructions provided",suggestedInventory:Array.isArray(W.suggestedInventory)?W.suggestedInventory:Array.isArray(W.inventory)?W.inventory:Array.isArray(W.requirements)?W.requirements:[]}})}const se=T.split(`
`).filter(B=>B.trim()),ge=[];let z=null;for(const B of se)if(B.match(/^\d+\./))z&&ge.push(z),z={title:B.replace(/^\d+\.\s*/,"").trim(),instructions:"",suggestedInventory:[]};else if(z&&B.trim())if(B.toLowerCase().includes("inventory")||B.toLowerCase().includes("supplies")){const W=B.match(/[^:]+:\s*(.+)/);W&&(z.suggestedInventory=W[1].split(",").map(ie=>ie.trim()))}else z.instructions+=(z.instructions?" ":"")+B.trim();return z&&ge.push(z),ge.length>0?ge:[{title:"AI-generated item",instructions:T.substring(0,200)+"...",suggestedInventory:[]}]}catch(F){return console.error("Error parsing AI response:",F),[{title:"AI-generated item",instructions:T.substring(0,200)+"...",suggestedInventory:[]}]}},O=T=>Na(null,null,function*(){return yield new Promise(se=>setTimeout(se,1500)),[{title:"Surface Disinfection",instructions:"Use EPA-approved disinfectant wipes. Clean all high-touch surfaces including door handles, light switches, and equipment controls. Allow 3-5 minutes contact time for proper disinfection.",suggestedInventory:["Disinfectant Wipes","Nitrile Gloves","Safety Goggles"]},{title:"Equipment Sanitization",instructions:"Clean all medical equipment with appropriate cleaning agents. Pay special attention to patient contact surfaces. Verify equipment is operational after cleaning.",suggestedInventory:["Equipment Cleaning Solution","Microfiber Cloths","Alcohol Wipes"]},{title:"Supply Restocking",instructions:"Check all supply levels and restock as needed. Verify expiration dates on all items. Ensure emergency supplies are readily accessible.",suggestedInventory:["Various Medical Supplies","Storage Containers","Labeling Materials"]},{title:"Safety Equipment Check",instructions:"Verify all safety equipment is present and functional. Test emergency systems and alarms. Check fire extinguishers and emergency exits.",suggestedInventory:["Safety Equipment","Testing Tools","Documentation Forms"]},{title:"Quality Control Verification",instructions:"Perform final quality control check. Verify all cleaning standards have been met. Document completion and any issues found.",suggestedInventory:["Quality Control Checklist","Documentation Forms","Camera for Documentation"]}]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>f(!m),className:"flex items-center text-xl font-semibold text-gray-800 hover:text-gray-600 transition-colors",children:[e.jsx(y,{path:m?ot:ct,size:1.2,className:"mr-2"}),"Checklist Management",e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",r.length," total)"]})]}),e.jsxs("button",{onClick:()=>{i(!0),u(null)},className:"flex items-center px-4 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#38b2ac] transition-colors",children:[e.jsx(y,{path:ye,size:1,className:"mr-2"}),"Add Checklist"]})]}),m&&e.jsx(Iu,{checklists:r,onEditChecklist:p,onDeleteChecklist:s})]}),(d||c)&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto scrollbar-hide",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:c?"Add New Checklist":`Edit: ${d==null?void 0:d.title}`}),e.jsx("button",{onClick:_,className:"p-1 text-gray-500 hover:text-gray-700",children:e.jsx(y,{path:$e,size:1.2})})]}),e.jsx(Tu,{selectedChecklist:d,isAddingChecklist:c,onCancel:_,onSaveDraft:b,onPublish:h}),d&&e.jsx(lm,{selectedChecklist:d,onAddItem:w,onUpdateItem:v,onDeleteItem:j,onGenerateAIItemSuggestions:L,showAIItemSuggestions:E,isGeneratingSuggestions:A,aiItemSuggestions:$,onApplyAIItemSuggestion:H,onCloseAISuggestions:()=>k(!1),showSuccessMessage:D})]})})]})},pm={aiEnabled:!1,predictiveCleaningEnabled:!1,smartScheduling:!1,contaminationPrediction:!1,resourceOptimization:!1,efficiencyAnalytics:!1,smartRoomManagementEnabled:!1,automaticPriorityAssignment:!1,riskAssessment:!1,trendAnalysis:!1,predictiveMaintenance:!1,supplyOptimizationEnabled:!1,staffScheduling:!1,costOptimization:!1,inventoryPrediction:!1,workloadBalancing:!1,qualityAssuranceEnabled:!1,complianceMonitoring:!1,auditTrailEnhancement:!1,performanceTracking:!1,automatedReporting:!1,realTimeMonitoringEnabled:!1,anomalyDetection:!1,smartNotifications:!1,statusUpdates:!1,emergencyAlerts:!1,aiConfidenceThreshold:.85,aiDataRetentionDays:90,realTimeProcessingEnabled:!1,batchProcessingEnabled:!1,dataSharingEnabled:!1,localAIProcessingEnabled:!1,encryptedDataTransmission:!0,aiModelTraining:!1},fm={defaultCleaningDuration:45,qualityScoreThreshold:8,contaminationLevels:["low","medium","high","critical"],cleaningTypes:["routine","deep","emergency","post_procedure"],autoSchedulingEnabled:!1,bufferTimeMinutes:15,maxConcurrentCleanings:3,weekendCleaningEnabled:!0,complianceTrackingEnabled:!0,auditLogRetentionDays:365,regulatoryReportingEnabled:!1,certificationTracking:!1},bm={emailNotificationsEnabled:!0,dailySummaryEnabled:!0,urgentAlertsEnabled:!0,completionNotificationsEnabled:!1,inAppNotificationsEnabled:!0,pushNotificationsEnabled:!1,soundEnabled:!0,adminNotificationsEnabled:!0,staffNotificationsEnabled:!1,supervisorNotificationsEnabled:!0},M={defaultCleaningDuration:{min:15,max:180},qualityScoreThreshold:{min:1,max:10},bufferTimeMinutes:{min:0,max:60},maxConcurrentCleanings:{min:1,max:10},auditLogRetentionDays:{min:30,max:2555},aiConfidenceThreshold:{min:.1,max:1,step:.05},aiDataRetentionDays:{min:30,max:1095}},ym=[{id:"general",label:"General",icon:re},{id:"ai",label:"AI & Analytics",icon:Ke},{id:"protocols",label:"Cleaning Protocols",icon:dt},{id:"rooms",label:"Room Management",icon:kt},{id:"checklists",label:"Checklists",icon:dt},{id:"notifications",label:"Notifications",icon:Qa},{id:"compliance",label:"Compliance",icon:kt},{id:"advanced",label:"Advanced",icon:Me}],_a={email:[{key:"emailNotificationsEnabled",label:"Enable Email Notifications"},{key:"dailySummaryEnabled",label:"Daily Summary Reports"},{key:"urgentAlertsEnabled",label:"Urgent Alerts"},{key:"completionNotificationsEnabled",label:"Task Completion Notifications"}],inApp:[{key:"inAppNotificationsEnabled",label:"Enable In-App Notifications"},{key:"pushNotificationsEnabled",label:"Push Notifications"},{key:"soundEnabled",label:"Sound Alerts"}]},vm=3e3,jm=r=>{const t=[];return(r.aiConfidenceThreshold<M.aiConfidenceThreshold.min||r.aiConfidenceThreshold>M.aiConfidenceThreshold.max)&&t.push(`AI confidence threshold must be between ${M.aiConfidenceThreshold.min} and ${M.aiConfidenceThreshold.max}`),(r.aiDataRetentionDays<M.aiDataRetentionDays.min||r.aiDataRetentionDays>M.aiDataRetentionDays.max)&&t.push(`AI data retention days must be between ${M.aiDataRetentionDays.min} and ${M.aiDataRetentionDays.max}`),t},Nm=r=>{const t=[];return(r.defaultCleaningDuration<M.defaultCleaningDuration.min||r.defaultCleaningDuration>M.defaultCleaningDuration.max)&&t.push(`Default cleaning duration must be between ${M.defaultCleaningDuration.min} and ${M.defaultCleaningDuration.max} minutes`),(r.qualityScoreThreshold<M.qualityScoreThreshold.min||r.qualityScoreThreshold>M.qualityScoreThreshold.max)&&t.push(`Quality score threshold must be between ${M.qualityScoreThreshold.min} and ${M.qualityScoreThreshold.max}`),(r.bufferTimeMinutes<M.bufferTimeMinutes.min||r.bufferTimeMinutes>M.bufferTimeMinutes.max)&&t.push(`Buffer time must be between ${M.bufferTimeMinutes.min} and ${M.bufferTimeMinutes.max} minutes`),(r.maxConcurrentCleanings<M.maxConcurrentCleanings.min||r.maxConcurrentCleanings>M.maxConcurrentCleanings.max)&&t.push(`Max concurrent cleanings must be between ${M.maxConcurrentCleanings.min} and ${M.maxConcurrentCleanings.max}`),(r.auditLogRetentionDays<M.auditLogRetentionDays.min||r.auditLogRetentionDays>M.auditLogRetentionDays.max)&&t.push(`Audit log retention days must be between ${M.auditLogRetentionDays.min} and ${M.auditLogRetentionDays.max}`),t},_m=r=>{const t=[];return!r.emailNotificationsEnabled&&!r.inAppNotificationsEnabled&&t.push("At least one notification method must be enabled"),t},Cm=(r,t,s)=>[...jm(r),...Nm(t),..._m(s)],wm=(r,t,s)=>{const a=Cm(r,t,s);return{isValid:a.length===0,errors:a}};var Sm=Object.defineProperty,Em=Object.defineProperties,Tm=Object.getOwnPropertyDescriptors,Ca=Object.getOwnPropertySymbols,Pm=Object.prototype.hasOwnProperty,Im=Object.prototype.propertyIsEnumerable,wa=(r,t,s)=>t in r?Sm(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,gs=(r,t)=>{for(var s in t||(t={}))Pm.call(t,s)&&wa(r,s,t[s]);if(Ca)for(var s of Ca(t))Im.call(t,s)&&wa(r,s,t[s]);return r},Am=(r,t)=>Em(r,Tm(t)),Bt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const dn={settings:"/api/environmental-cleaning/settings",aiSettings:"/api/environmental-cleaning/ai-settings",testSync:"/api/environmental-cleaning/test-sync",resetDefaults:"/api/environmental-cleaning/reset-defaults"},xs={timeout:3e4,retries:3,headers:{"Content-Type":"application/json"}},Is=(r,t,...s)=>Bt(null,[r,t,...s],function*(a,n,l=xs.retries){try{const o=new AbortController,c=setTimeout(()=>o.abort(),xs.timeout),i=yield fetch(a,Am(gs({},n),{signal:o.signal,headers:gs(gs({},xs.headers),n.headers)}));if(clearTimeout(c),!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return yield i.json()}catch(o){if(l>0&&o instanceof Error&&o.name==="AbortError")return Is(a,n,l-1);throw o}}),Om=r=>Bt(null,null,function*(){try{const t=yield Is(dn.settings,{method:"POST",body:JSON.stringify(r)});if(!t.success)throw new Error(t.error||"Failed to save settings")}catch(t){throw console.error("Error saving environmental cleaning settings:",t),new Error("Failed to save settings. Please try again.")}}),Dm=r=>Bt(null,null,function*(){try{const t=yield Is(dn.aiSettings,{method:"POST",body:JSON.stringify(r)});if(!t.success)throw new Error(t.error||"Failed to save AI settings")}catch(t){throw console.error("Error saving AI settings:",t),new Error("Failed to save AI settings. Please try again.")}}),km=(r,t,s)=>Bt(null,null,function*(){try{r.aiEnabled&&(yield Dm({aiSettings:r})),yield Om({protocols:t,notifications:s})}catch(a){throw console.error("Error saving all settings:",a),a}}),Rm=({protocolSettings:r,onProtocolSettingChange:t})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:re,size:1.5,className:"text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-blue-800",children:"General Settings"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Basic configuration for environmental cleaning"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultCleaningDuration",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Cleaning Duration (minutes)"}),e.jsx("input",{id:"defaultCleaningDuration",type:"number",value:r.defaultCleaningDuration,onChange:s=>t("defaultCleaningDuration",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:M.defaultCleaningDuration.min,max:M.defaultCleaningDuration.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"qualityScoreThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Score Threshold"}),e.jsx("input",{id:"qualityScoreThreshold",type:"number",value:r.qualityScoreThreshold,onChange:s=>t("qualityScoreThreshold",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:M.qualityScoreThreshold.min,max:M.qualityScoreThreshold.max})]})]})]})}),$m=()=>e.jsx("div",{children:"Test"}),Lm=({protocolSettings:r,onProtocolSettingChange:t})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:dt,size:1.5,className:"text-green-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800",children:"Cleaning Protocols"}),e.jsx("p",{className:"text-sm text-green-700",children:"Configure cleaning procedures and standards"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bufferTimeMinutes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Buffer Time (minutes)"}),e.jsx("input",{id:"bufferTimeMinutes",type:"number",value:r.bufferTimeMinutes,onChange:s=>t("bufferTimeMinutes",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:M.bufferTimeMinutes.min,max:M.bufferTimeMinutes.max})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxConcurrentCleanings",className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Concurrent Cleanings"}),e.jsx("input",{id:"maxConcurrentCleanings",type:"number",value:r.maxConcurrentCleanings,onChange:s=>t("maxConcurrentCleanings",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",min:M.maxConcurrentCleanings.min,max:M.maxConcurrentCleanings.max})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"autoSchedulingEnabled",className:"text-sm font-medium text-gray-700",children:"Auto Scheduling"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enable automatic cleaning schedule generation"})]}),e.jsx("button",{id:"autoSchedulingEnabled",onClick:()=>t("autoSchedulingEnabled",!r.autoSchedulingEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ${r.autoSchedulingEnabled?"bg-green-600":"bg-gray-200"}`,"aria-label":"Auto Scheduling",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.autoSchedulingEnabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weekendCleaningEnabled",className:"text-sm font-medium text-gray-700",children:"Weekend Cleaning"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Allow cleaning tasks on weekends"})]}),e.jsx("button",{id:"weekendCleaningEnabled",onClick:()=>t("weekendCleaningEnabled",!r.weekendCleaningEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 ${r.weekendCleaningEnabled?"bg-green-600":"bg-gray-200"}`,"aria-label":"Weekend Cleaning",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.weekendCleaningEnabled?"translate-x-6":"translate-x-1"}`})})]})]})]})}),Mm=({notificationSettings:r,onNotificationSettingChange:t})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Qa,size:1.5,className:"text-yellow-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-yellow-800",children:"Notification Settings"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Configure how and when you receive notifications"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-800 mb-3",children:"Email Notifications"}),e.jsx("div",{className:"space-y-3",children:_a.email.map(({key:s,label:a})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:s,className:"text-sm text-gray-700",children:a}),e.jsx("button",{id:s,onClick:()=>t(s,!r[s]),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-1 ${r[s]?"bg-yellow-600":"bg-gray-200"}`,"aria-label":a,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${r[s]?"translate-x-5":"translate-x-1"}`})})]},s))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-800 mb-3",children:"In-App Notifications"}),e.jsx("div",{className:"space-y-3",children:_a.inApp.map(({key:s,label:a})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{htmlFor:s,className:"text-sm text-gray-700",children:a}),e.jsx("button",{id:s,onClick:()=>t(s,!r[s]),className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-1 ${r[s]?"bg-yellow-600":"bg-gray-200"}`,"aria-label":a,children:e.jsx("span",{className:`inline-block h-3 w-3 transform rounded-full bg-white transition-transform ${r[s]?"translate-x-5":"translate-x-1"}`})})]},s))})]})]})]})}),Fm=({protocolSettings:r,onProtocolSettingChange:t})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:kt,size:1.5,className:"text-red-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Compliance & Audit"}),e.jsx("p",{className:"text-sm text-red-700",children:"Configure compliance tracking and reporting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"complianceTrackingEnabled",className:"text-sm font-medium text-gray-700",children:"Compliance Tracking"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Track regulatory compliance automatically"})]}),e.jsx("button",{id:"complianceTrackingEnabled",onClick:()=>t("complianceTrackingEnabled",!r.complianceTrackingEnabled),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 ${r.complianceTrackingEnabled?"bg-red-600":"bg-gray-200"}`,"aria-label":"Compliance Tracking",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r.complianceTrackingEnabled?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"auditLogRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Audit Log Retention (days)"}),e.jsx("input",{id:"auditLogRetentionDays",type:"number",value:r.auditLogRetentionDays,onChange:s=>t("auditLogRetentionDays",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",min:M.auditLogRetentionDays.min,max:M.auditLogRetentionDays.max})]})]})]})}),zm=({aiSettings:r,onAISettingChange:t})=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(y,{path:Me,size:1.5,className:"text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:"Advanced Settings"}),e.jsx("p",{className:"text-sm text-gray-700",children:"Advanced configuration and system settings"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiConfidenceThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Confidence Threshold"}),e.jsx("input",{id:"aiConfidenceThreshold",type:"number",value:r.aiConfidenceThreshold,onChange:s=>t("aiConfidenceThreshold",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500",min:M.aiConfidenceThreshold.min,max:M.aiConfidenceThreshold.max,step:M.aiConfidenceThreshold.step}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum confidence for AI predictions"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"aiDataRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (days)"}),e.jsx("input",{id:"aiDataRetentionDays",type:"number",value:r.aiDataRetentionDays,onChange:s=>t("aiDataRetentionDays",Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-500",min:M.aiDataRetentionDays.min,max:M.aiDataRetentionDays.max}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"How long to keep AI training data"})]})]})]})});var qm=Object.defineProperty,Um=Object.defineProperties,Vm=Object.getOwnPropertyDescriptors,Sa=Object.getOwnPropertySymbols,Bm=Object.prototype.hasOwnProperty,Gm=Object.prototype.propertyIsEnumerable,Ea=(r,t,s)=>t in r?qm(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ps=(r,t)=>{for(var s in t||(t={}))Bm.call(t,s)&&Ea(r,s,t[s]);if(Sa)for(var s of Sa(t))Gm.call(t,s)&&Ea(r,s,t[s]);return r},fs=(r,t)=>Um(r,Vm(t)),Hm=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Ym=()=>{const[r,t]=x.useState(pm),[s,a]=x.useState(fm),[n,l]=x.useState(bm),[o,c]=x.useState(null),[i,d]=x.useState(!1);return{aiSettings:r,protocolSettings:s,notificationSettings:n,message:o,isLoading:i,handleAISettingChange:(p,_)=>{t(w=>fs(ps({},w),{[p]:_}))},handleProtocolSettingChange:(p,_)=>{a(w=>fs(ps({},w),{[p]:_}))},handleNotificationSettingChange:(p,_)=>{l(w=>fs(ps({},w),{[p]:_}))},handleSaveSettings:()=>Hm(null,null,function*(){try{d(!0),c(null);const p=wm(r,s,n);if(!p.isValid){c({type:"error",text:p.errors[0]||"Validation failed"});return}yield km(r,s,n),c({type:"success",text:"Settings saved successfully!"}),setTimeout(()=>c(null),vm)}catch(p){console.error(p),c({type:"error",text:"Failed to save settings. Please try again."})}finally{d(!1)}}),clearMessage:()=>c(null)}},Wm=()=>{const[r,t]=x.useState("general"),{aiSettings:s,protocolSettings:a,notificationSettings:n,message:l,isLoading:o,handleAISettingChange:c,handleProtocolSettingChange:i,handleNotificationSettingChange:d,handleSaveSettings:u}=Ym(),m=()=>{switch(r){case"general":return e.jsx(Rm,{protocolSettings:a,onProtocolSettingChange:i});case"ai":return e.jsx($m,{});case"protocols":return e.jsx(Lm,{protocolSettings:a,onProtocolSettingChange:i});case"rooms":return e.jsx(au,{});case"checklists":return e.jsx(xm,{});case"notifications":return e.jsx(Mm,{notificationSettings:n,onNotificationSettingChange:d});case"compliance":return e.jsx(Fm,{protocolSettings:a,onProtocolSettingChange:i});case"advanced":return e.jsx(zm,{aiSettings:s,onAISettingChange:c});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"Environmental Cleaning Settings"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Configure comprehensive settings for environmental cleaning workflows, AI features, protocols, and compliance."})]}),l&&e.jsx("div",{className:`p-4 rounded-lg border ${l.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:l.type==="success"?Le:te,size:1,className:"text-current"}),l.text]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:ym.map(f=>e.jsxs("button",{onClick:()=>t(f.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center gap-2 ${r===f.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(y,{path:f.icon,size:1}),f.label||f.name]},f.id))})}),e.jsx("div",{className:"min-h-[400px]",children:m()}),e.jsx("div",{className:"flex justify-end pt-6 border-t",children:e.jsxs("button",{onClick:u,disabled:o,className:"px-6 py-2 bg-[#4ECDC4] text-white rounded-md hover:bg-[#45B7AF] focus:outline-none focus:ring-2 focus:ring-[#4ECDC4] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(y,{path:ht,size:1}),o?"Saving...":"Save Settings"]})})]})},Re=({title:r,children:t})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700",children:r}),e.jsx("div",{className:"space-y-3",children:t})]});var Km=Object.defineProperty,Qm=Object.defineProperties,Zm=Object.getOwnPropertyDescriptors,Ta=Object.getOwnPropertySymbols,Jm=Object.prototype.hasOwnProperty,Xm=Object.prototype.propertyIsEnumerable,Pa=(r,t,s)=>t in r?Km(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,eh=(r,t)=>{for(var s in t||(t={}))Jm.call(t,s)&&Pa(r,s,t[s]);if(Ta)for(var s of Ta(t))Xm.call(t,s)&&Pa(r,s,t[s]);return r},th=(r,t)=>Qm(r,Zm(t));const sh=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(th(eh({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(y,{path:re,size:1,className:"text-gray-600"}),"General Settings"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(Re,{title:"Core Features",children:[e.jsx(ne,{id:"autoCalculateTotals",checked:r.autoCalculateTotals,onChange:a=>s("autoCalculateTotals",a),label:"Auto-calculate totals"}),e.jsx(ne,{id:"requireApprovalForAdjustments",checked:r.requireApprovalForAdjustments,onChange:a=>s("requireApprovalForAdjustments",a),label:"Require approval for adjustments"}),e.jsx(ne,{id:"allowNegativeQuantities",checked:r.allowNegativeQuantities,onChange:a=>s("allowNegativeQuantities",a),label:"Allow negative quantities"})]}),e.jsxs(Re,{title:"System Features",children:[e.jsx(ne,{id:"enableRealTimeUpdates",checked:r.enableRealTimeUpdates,onChange:a=>s("enableRealTimeUpdates",a),label:"Enable real-time updates"}),e.jsx(ne,{id:"enableAuditTrails",checked:r.enableAuditTrails,onChange:a=>s("enableAuditTrails",a),label:"Enable audit trails"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"defaultTransactionType",className:"block text-sm font-medium text-gray-700 mb-2",children:"Default transaction type"}),e.jsxs("select",{id:"defaultTransactionType",value:r.defaultTransactionType,onChange:a=>s("defaultTransactionType",a.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"in",children:"In"}),e.jsx("option",{value:"out",children:"Out"}),e.jsx("option",{value:"adjustment",children:"Adjustment"})]})]})]})]})]})})};var rh=Object.defineProperty,ah=Object.defineProperties,nh=Object.getOwnPropertyDescriptors,Ia=Object.getOwnPropertySymbols,ih=Object.prototype.hasOwnProperty,lh=Object.prototype.propertyIsEnumerable,Aa=(r,t,s)=>t in r?rh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,oh=(r,t)=>{for(var s in t||(t={}))ih.call(t,s)&&Aa(r,s,t[s]);if(Ia)for(var s of Ia(t))lh.call(t,s)&&Aa(r,s,t[s]);return r},ch=(r,t)=>ah(r,nh(t));const dh=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(ch(oh({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(y,{path:gt,size:1,className:"text-gray-600"}),"Stock Management"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(Re,{title:"Stock Thresholds",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lowStockThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Low stock threshold"}),e.jsx("input",{id:"lowStockThreshold",type:"number",value:r.lowStockThreshold,onChange:a=>s("lowStockThreshold",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"criticalStockThreshold",className:"block text-sm font-medium text-gray-700 mb-2",children:"Critical stock threshold"}),e.jsx("input",{id:"criticalStockThreshold",type:"number",value:r.criticalStockThreshold,onChange:a=>s("criticalStockThreshold",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"0"})]})]}),e.jsxs(Re,{title:"Reorder Settings",children:[e.jsx(ne,{id:"autoReorderEnabled",checked:r.autoReorderEnabled,onChange:a=>s("autoReorderEnabled",a),label:"Enable automatic reordering"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reorderBufferDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Reorder buffer (days)"}),e.jsx("input",{id:"reorderBufferDays",type:"number",value:r.reorderBufferDays,onChange:a=>s("reorderBufferDays",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"1",max:"30"})]})]})]})]})})};var uh=Object.defineProperty,mh=Object.defineProperties,hh=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,gh=Object.prototype.hasOwnProperty,xh=Object.prototype.propertyIsEnumerable,Da=(r,t,s)=>t in r?uh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,ph=(r,t)=>{for(var s in t||(t={}))gh.call(t,s)&&Da(r,s,t[s]);if(Oa)for(var s of Oa(t))xh.call(t,s)&&Da(r,s,t[s]);return r},fh=(r,t)=>mh(r,hh(t));const bh=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(fh(ph({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(y,{path:Me,size:1,className:"text-gray-600"}),"Categories & Organization"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(Re,{title:"Organization Features",children:[e.jsx(ne,{id:"enableSubcategories",checked:r.enableSubcategories,onChange:a=>s("enableSubcategories",a),label:"Enable subcategories"}),e.jsx(ne,{id:"enableCustomTags",checked:r.enableCustomTags,onChange:a=>s("enableCustomTags",a),label:"Enable custom tags"}),e.jsx(ne,{id:"requireCategoryAssignment",checked:r.requireCategoryAssignment,onChange:a=>s("requireCategoryAssignment",a),label:"Require category assignment"})]})})]})})};var yh=Object.defineProperty,vh=Object.defineProperties,jh=Object.getOwnPropertyDescriptors,ka=Object.getOwnPropertySymbols,Nh=Object.prototype.hasOwnProperty,_h=Object.prototype.propertyIsEnumerable,Ra=(r,t,s)=>t in r?yh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,Ch=(r,t)=>{for(var s in t||(t={}))Nh.call(t,s)&&Ra(r,s,t[s]);if(ka)for(var s of ka(t))_h.call(t,s)&&Ra(r,s,t[s]);return r},wh=(r,t)=>vh(r,jh(t));const Sh=({settings:r,onSettingsChange:t})=>{const s=(a,n)=>{t(wh(Ch({},r),{[a]:n}))};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h5",{className:"text-md font-medium text-gray-700 mb-4 flex items-center gap-2",children:[e.jsx(y,{path:Es,size:1,className:"text-gray-600"}),"Reporting & Analytics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(Re,{title:"Report Generation",children:[e.jsx(ne,{id:"autoGenerateReports",checked:r.autoGenerateReports,onChange:a=>s("autoGenerateReports",a),label:"Auto-generate reports"}),e.jsx(ne,{id:"includeSensitiveData",checked:r.includeSensitiveData,onChange:a=>s("includeSensitiveData",a),label:"Include sensitive data"})]}),e.jsxs(Re,{title:"Report Configuration",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reportRetentionDays",className:"block text-sm font-medium text-gray-700 mb-2",children:"Report retention (days)"}),e.jsx("input",{id:"reportRetentionDays",type:"number",value:r.reportRetentionDays,onChange:a=>s("reportRetentionDays",parseInt(a.target.value)),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:"30",max:"1095"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reportFormat",className:"block text-sm font-medium text-gray-700 mb-2",children:"Report format"}),e.jsxs("select",{id:"reportFormat",value:r.reportFormat,onChange:a=>s("reportFormat",a.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"PDF",children:"PDF"}),e.jsx("option",{value:"Excel",children:"Excel"}),e.jsx("option",{value:"CSV",children:"CSV"})]})]})]})]})]})})},Eh=()=>e.jsx("div",{children:"Test"});var Gt=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function Th(r){return Gt(this,null,function*(){const{data:t,error:s}=yield P.from("locations").select("*").eq("facility_id",r).order("name",{ascending:!0});if(s)throw s;return t||[]})}function Ph(r,t,s,a,n){return Gt(this,null,function*(){const{data:l,error:o}=yield P.from("locations").insert([{facility_id:r,name:t,barcode:s,parent_id:a!=null?a:null,capacity:n!=null?n:0}]).select().single();if(o)throw o;return l})}function Ih(r,t){return Gt(this,null,function*(){const{data:s,error:a}=yield P.from("locations").update({status:t}).eq("id",r).select().single();if(a)throw a;return s})}function Ah(r){return Gt(this,null,function*(){const{error:t}=yield P.from("locations").delete().eq("id",r);if(t)throw t})}var It=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});function Oh(){const[r,t]=x.useState([]),[s,a]=x.useState(!0),[n,l]=x.useState(""),[o,c]=x.useState(""),[i,d]=x.useState(null),[u,m]=x.useState(null),[f,b]=x.useState(""),[h,p]=x.useState(!1),_=x.useCallback(()=>It(null,null,function*(){a(!0);try{const E=yield Th(f);t(E)}catch(E){console.error("Failed to fetch locations",E)}finally{a(!1)}}),[f]);function w(){return It(this,null,function*(){if(!n||!o)return alert("Name and barcode are required");p(!0);try{yield Ph(f,n,o,i!=null?i:void 0,u!=null?u:void 0),yield _(),l(""),c(""),m(null)}catch(E){alert("Failed to create location")}finally{p(!1)}})}function v(E){return It(this,null,function*(){if(confirm("Delete this location?"))try{yield Ah(E),t(k=>k.filter(A=>A.id!==E))}catch(k){alert("Failed to delete location")}})}function j(E,k){return It(this,null,function*(){try{yield Ih(E,k),yield _()}catch(A){alert("Failed to update status")}})}return x.useEffect(()=>{_()},[_]),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Location Management"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 space-y-2",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Add New Location"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("input",{className:"form-control",placeholder:"Location Name",value:n,onChange:E=>l(E.target.value)}),e.jsx("input",{className:"form-control",placeholder:"Barcode",value:o,onChange:E=>c(E.target.value)}),e.jsx("input",{className:"form-control",placeholder:"Capacity (optional)",type:"number",value:u!=null?u:"",onChange:E=>m(Number(E.target.value)||null)}),e.jsx(Rs,{onClick:w,disabled:h,children:h?"Adding...":"Add Location"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[e.jsx("h2",{className:"text-lg font-medium mb-2",children:"Existing Locations"}),s?e.jsx("p",{className:"flex items-center gap-2",children:"Loading…"}):r.length===0?e.jsx("p",{className:"text-muted",children:"No locations found."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Name"}),e.jsx("th",{className:"text-left p-2",children:"Barcode"}),e.jsx("th",{className:"text-left p-2",children:"Capacity"}),e.jsx("th",{className:"text-left p-2",children:"Status"}),e.jsx("th",{className:"text-left p-2",children:"Actions"})]})}),e.jsx("tbody",{children:r.map(E=>{var k;return e.jsxs("tr",{className:"border-b hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:E.name}),e.jsx("td",{className:"p-2 font-mono",children:E.barcode}),e.jsx("td",{className:"p-2",children:(k=E.capacity)!=null?k:"—"}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"form-select",value:E.status,onChange:A=>j(E.id,A.target.value),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"full",children:"Full"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})}),e.jsx("td",{className:"p-2",children:e.jsx(Rs,{variant:"danger",size:"sm",onClick:()=>v(E.id),children:"Delete"})})]},E.id)})})]})]})]})}var Dh=Object.defineProperty,kh=Object.defineProperties,Rh=Object.getOwnPropertyDescriptors,$a=Object.getOwnPropertySymbols,$h=Object.prototype.hasOwnProperty,Lh=Object.prototype.propertyIsEnumerable,La=(r,t,s)=>t in r?Dh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,At=(r,t)=>{for(var s in t||(t={}))$h.call(t,s)&&La(r,s,t[s]);if($a)for(var s of $a(t))Lh.call(t,s)&&La(r,s,t[s]);return r},bs=(r,t)=>kh(r,Rh(t)),We=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const Mh=()=>{const{currentUser:r}=Fe(),[t,s]=x.useState(null),[a,n]=x.useState(""),[l,o]=x.useState(!1),[c,i]=x.useState(null),[d,u]=x.useState({autoCalculateTotals:!0,requireApprovalForAdjustments:!0,allowNegativeQuantities:!1,requireReasonForAdjustments:!0,defaultTransactionType:"in",enableRealTimeUpdates:!0,enableAuditTrails:!0,lowStockThreshold:10,criticalStockThreshold:5,autoReorderEnabled:!1,reorderBufferDays:7,enableSubcategories:!0,enableCustomTags:!0,requireCategoryAssignment:!0,autoGenerateReports:!1,reportRetentionDays:365,includeSensitiveData:!1,reportFormat:"PDF",aiEnabled:!1,computerVisionEnabled:!1,smartCategorizationEnabled:!1,predictiveAnalyticsEnabled:!1,aiConfidenceThreshold:.8,autoCategorizationEnabled:!1,smartFormFillingEnabled:!1,maintenancePredictionsEnabled:!1,demandForecastingEnabled:!1,openaiApiKey:"",googleVisionApiKey:"",dataSharingEnabled:!1,localAIProcessingEnabled:!1,aiDataRetentionDays:90});x.useEffect(()=>{We(null,null,function*(){try{const j=yield Ut.getCurrentFacilityId(),E=new qa(j);i(E),m(E)}catch(j){console.error("Failed to initialize AI service:",j),n("Failed to initialize AI service")}})},[]);const m=v=>We(null,null,function*(){try{o(!0);let j=yield v.loadSettings();j||(yield v.initializeSettings(),j=yield v.loadSettings()),s(j)}catch(j){console.error("Error loading AI settings:",j),n("Error loading AI settings")}finally{o(!1)}}),f=(v,j)=>{t&&s(bs(At({},t),{[v]:j}))},b=()=>We(null,null,function*(){if(!(!c||!t))try{o(!0),(yield c.saveSettings(t))?(n("AI settings saved successfully"),setTimeout(()=>n(""),3e3)):n("Error saving AI settings")}catch(v){console.error("Error saving AI settings:",v),n("Error saving AI settings")}finally{o(!1)}}),h=()=>We(null,null,function*(){if(c)try{o(!0),yield c.initializeSettings(),yield m(c),n("AI settings reset to defaults"),setTimeout(()=>n(""),3e3)}catch(v){console.error("Error resetting AI settings:",v),n("Error resetting AI settings")}finally{o(!1)}}),p=x.useCallback(()=>We(null,null,function*(){if(r!=null&&r.id){o(!0);try{const v=localStorage.getItem("cliniio_ai_settings");if(v){const j=JSON.parse(v);u(E=>bs(At(At({},E),j),{openaiApiKey:j.openaiApiKey?"••••••••"+j.openaiApiKey.slice(-4):"",googleVisionApiKey:j.googleVisionApiKey?"••••••••"+j.googleVisionApiKey.slice(-4):""}))}}catch(v){console.error("Failed to load inventory settings:",v)}finally{o(!1)}}}),[r==null?void 0:r.id]);return x.useEffect(()=>{p()},[p]),{settings:d,setSettings:u,aiSettings:t,aiMessage:a,isLoading:l,handleInputChange:(v,j)=>{u(E=>bs(At({},E),{[v]:j}))},handleAISettingChange:f,handleAISettingsSave:b,handleAISettingsReset:h,saveSettings:()=>We(null,null,function*(){if(r!=null&&r.id)try{const v={aiEnabled:d.aiEnabled,computerVisionEnabled:d.computerVisionEnabled,smartCategorizationEnabled:d.smartCategorizationEnabled,predictiveAnalyticsEnabled:d.predictiveAnalyticsEnabled,aiConfidenceThreshold:d.aiConfidenceThreshold,autoCategorizationEnabled:d.autoCategorizationEnabled,smartFormFillingEnabled:d.smartFormFillingEnabled,maintenancePredictionsEnabled:d.maintenancePredictionsEnabled,demandForecastingEnabled:d.demandForecastingEnabled,dataSharingEnabled:d.dataSharingEnabled,localAIProcessingEnabled:d.localAIProcessingEnabled,aiDataRetentionDays:d.aiDataRetentionDays};localStorage.setItem("cliniio_ai_settings",JSON.stringify(v))}catch(v){console.error("Failed to save inventory settings:",v)}}),loadSettings:p}};var Fh=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const zh=()=>{const[r,t]=x.useState("general"),[s,a]=x.useState(!1),[n,l]=x.useState(null),{settings:o,setSettings:c,isLoading:i,saveSettings:d,loadSettings:u}=Mh(),m=[{id:"general",label:"General Settings",icon:re},{id:"stock",label:"Stock Management",icon:gt},{id:"categories",label:"Categories & Tags",icon:Me},{id:"locations",label:"Location Management",icon:Ka},{id:"reporting",label:"Reporting & Analytics",icon:Es},{id:"ai",label:"AI & Machine Learning",icon:Ze}],f=()=>Fh(null,null,function*(){try{a(!0),l(null),yield d(),l({type:"success",text:"Settings saved successfully"}),setTimeout(()=>l(null),3e3)}catch(h){console.error(h),l({type:"error",text:"Failed to save settings"})}finally{a(!1)}}),b=()=>{switch(r){case"general":return e.jsx(sh,{settings:o,onSettingsChange:c});case"stock":return e.jsx(dh,{settings:o,onSettingsChange:c});case"categories":return e.jsx(bh,{settings:o,onSettingsChange:c});case"locations":return e.jsx(Oh,{});case"reporting":return e.jsx(Sh,{settings:o,onSettingsChange:c});case"ai":return e.jsx(Eh,{});default:return null}};return i?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading inventory settings..."})]}):e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Inventory Management Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure inventory behavior, AI features, and system preferences"}),n&&e.jsx("div",{className:`p-4 rounded-lg border mb-6 ${n.type==="success"?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{path:n.type==="success"?Le:te,size:1,className:"text-current"}),n.text]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:m.map(h=>e.jsxs("button",{onClick:()=>t(h.id),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${r===h.id?"border-[#4ECDC4] text-[#4ECDC4]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(y,{path:h.icon,size:1}),e.jsx("span",{children:h.label})]},h.id))})})}),e.jsx("div",{className:"tab-content-area",children:b()}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsxs("button",{onClick:u,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500",children:[e.jsx(y,{path:$t,size:1,className:"inline mr-2"}),"Reset"]}),e.jsxs("button",{onClick:f,disabled:s,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:[e.jsx(y,{path:ht,size:1,className:"inline mr-2"}),s?"Saving...":"Save Settings"]})]})]})};var Ma=(r,t,s)=>new Promise((a,n)=>{var l=i=>{try{c(s.next(i))}catch(d){n(d)}},o=i=>{try{c(s.throw(i))}catch(d){n(d)}},c=i=>i.done?a(i.value):Promise.resolve(i.value).then(l,o);c((s=s.apply(r,t)).next())});const ys=[{id:"profile",label:"Profile & Account",icon:Dt,description:"Manage your admin account information and personal settings."},{id:"system",label:"System Administration",icon:re,description:"Manage users, roles, permissions, and system-wide settings."},{id:"content",label:"Content Management",icon:Zn,description:"Create, edit, and manage Knowledge Hub and Library content."},{id:"learning",label:"Learning & Training",icon:Jn,description:"Configure training modules, certifications, and learning paths."},{id:"cleaning",label:"Environmental Cleaning",icon:Xn,description:"Manage room cleaning schedules, protocols, and status."},{id:"inventory",label:"Inventory Management",icon:gt,description:"Oversee inventory, categories, stock levels, and procurement."},{id:"sterilization",label:"Sterilization",icon:ei,description:"Monitor sterilization cycles, equipment, and compliance."},{id:"system-config",label:"Billing",icon:ti,description:"Manage billing settings, payment methods, and subscription plans."},{id:"analytics",label:"AI and Analytics",icon:Ke,description:"Configure AI features, view system analytics, and generate intelligent reports."}],Fa={profile:{bg:"bg-blue-100",icon:"text-blue-700"},system:{bg:"bg-green-100",icon:"text-green-800"},content:{bg:"bg-purple-200",icon:"text-purple-900"},learning:{bg:"bg-yellow-200",icon:"text-yellow-900"},cleaning:{bg:"bg-teal-100",icon:"text-teal-700"},inventory:{bg:"bg-blue-100",icon:"text-blue-700"},sterilization:{bg:"bg-purple-200",icon:"text-purple-900"},"system-config":{bg:"bg-green-100",icon:"text-green-800"},analytics:{bg:"bg-yellow-200",icon:"text-yellow-900"}},Kh=()=>{const[r]=wn(),[t,s]=x.useState(null),[a,n]=x.useState(null),[l,o]=x.useState(0),[c,i]=x.useState(null),{currentUser:d}=Fe(),u=Za();x.useEffect(()=>{const b=r.get("section");b&&ys.some(h=>h.id===b)&&setTimeout(()=>s(b),0)},[r]),x.useEffect(()=>{function b(){return Ma(this,null,function*(){try{const{count:p,error:_}=yield P.from("audit_flags").select("*",{count:"exact",head:!0}).eq("resolved",!1);!_&&typeof p=="number"&&o(p)}catch(p){console.error("Failed to fetch compliance flags:",p)}})}b();const h=()=>{setTimeout(()=>{b()},300)};return window.addEventListener("complianceIssueResolved",h),()=>{window.removeEventListener("complianceIssueResolved",h)}},[]),x.useEffect(()=>{Ma(null,null,function*(){if(d!=null&&d.facility_id)try{const h=yield bi.getFacilitySettings(d.facility_id);h&&i(h)}catch(h){console.error("Error loading facility settings:",h)}})},[d==null?void 0:d.facility_id]);const m=b=>{try{n(null),s(h=>h===b?null:b)}catch(h){console.error("Error opening settings card:",h),n(h instanceof Error?h.message:"Failed to open settings")}},f=()=>{const b=[];for(let h=0;h<ys.length;h++){const p=ys[h];b.push(e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>m(p.id),className:`rounded-xl shadow p-6 border text-left transition-all duration-200 hover:shadow-md hover:scale-105 focus:outline-none w-full min-h-[180px] flex flex-col justify-between ${t===p.id?"ring-2 ring-[#4ECDC4]":""} ${p.id==="system"&&l>0||p.id==="analytics"&&u.hasIssues?"border-red-500 bg-red-100 shadow-red-200 shadow-lg":"bg-white border-gray-100"}`,type:"button",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`${Fa[p.id].bg} rounded-md p-2 mr-3`,children:e.jsx(y,{path:p.icon,size:1,className:Fa[p.id].icon})}),e.jsx("h3",{className:`text-base font-medium ${p.id==="system"&&l>0||p.id==="analytics"&&u.hasIssues?"text-red-800":"text-gray-700"}`,children:p.label})]}),p.id==="system"&&l>0&&e.jsx("div",{className:"bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold",children:"!"}),p.id==="analytics"&&u.hasIssues&&e.jsx("div",{className:"bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center font-bold",children:"!"})]}),e.jsx("p",{className:`text-sm mt-auto ${p.id==="system"&&l>0||p.id==="analytics"&&u.hasIssues?"text-red-600 font-medium":"text-gray-500"}`,children:p.id==="system"&&l>0?"⚠️ Compliance issues require attention":p.id==="analytics"&&u.hasIssues?`⚠️ AI usage ${u.isExceeded?"exceeded":"approaching"} limit (${Math.round(u.usagePercentage)}%)`:p.description})]})},p.id)),t===p.id&&b.push(e.jsxs("div",{className:"col-span-full bg-white border border-gray-200 rounded-xl shadow-lg p-6 animate-fade-in my-2",style:{gridColumn:"1 / -1"},children:[p.id==="profile"&&e.jsx(xe,{children:e.jsx(ul,{})}),p.id==="system"&&e.jsx(xe,{children:e.jsx(oo,{initialTab:r.get("tab"),complianceFlagCount:l})}),p.id==="system-config"&&e.jsx(xe,{children:e.jsx(co,{})}),p.id==="content"&&e.jsx(xe,{children:e.jsx(kc,{})}),p.id==="learning"&&e.jsx(xe,{children:e.jsx(_d,{})}),p.id==="cleaning"&&e.jsx(xe,{children:e.jsx(Wm,{})}),p.id==="inventory"&&e.jsx(xe,{children:e.jsx(zh,{})}),p.id==="sterilization"&&e.jsx(xe,{children:e.jsx(Pc,{})}),p.id==="analytics"&&e.jsx(xe,{children:e.jsx(Ko,{})})]},p.id+"-drawer"))}return b};return e.jsx(Dn,{hasComplianceIssues:l>0,hasAIUsageIssues:u.hasIssues,children:e.jsx("div",{className:"flex flex-col min-h-screen",children:e.jsxs("div",{className:"p-4 max-w-7xl w-full mx-auto flex-1 flex flex-col",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-[#5b5b5b] mb-1",children:"Admin Settings"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Configure system-wide settings, manage users, and control application features"})]}),a&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md",children:e.jsxs("p",{className:"text-red-600 text-sm",children:["Error: ",a]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex-1",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:f()})})]})})})};export{Kh as default};
