const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/login-BkZ1x_Cy.js","assets/js/utils-DSBVV_PW.js","assets/js/vendor-DoALFvsH.js","assets/js/data-73RVSc-N.js","assets/js/ui-DETUEJ2B.js"])))=>i.map(i=>d[i]);
import{_ as N}from"./login-BkZ1x_Cy.js";import"./utils-DSBVV_PW.js";import"./vendor-DoALFvsH.js";import"./data-73RVSc-N.js";import"./ui-DETUEJ2B.js";var _=(E,e,t)=>new Promise((o,i)=>{var s=R=>{try{I(t.next(R))}catch(c){i(c)}},n=R=>{try{I(t.throw(R))}catch(c){i(c)}},I=R=>R.done?o(R.value):Promise.resolve(R.value).then(s,n);I((t=t.apply(E,e)).next())});const r={AUTH_REQUIRED:"AUTH_REQUIRED",AUTH_EXPIRED:"AUTH_EXPIRED",AUTH_INVALID:"AUTH_INVALID",NETWORK_ERROR:"NETWORK_ERROR",TIMEOUT_ERROR:"TIMEOUT_ERROR",CONNECTION_ERROR:"CONNECTION_ERROR",DB_CONNECTION_ERROR:"DB_CONNECTION_ERROR",DB_QUERY_ERROR:"DB_QUERY_ERROR",DB_CONSTRAINT_ERROR:"DB_CONSTRAINT_ERROR",FILE_TOO_LARGE:"FILE_TOO_LARGE",FILE_TYPE_INVALID:"FILE_TYPE_INVALID",UPLOAD_FAILED:"UPLOAD_FAILED",VALIDATION_ERROR:"VALIDATION_ERROR",REQUIRED_FIELD_MISSING:"REQUIRED_FIELD_MISSING",INVALID_FORMAT:"INVALID_FORMAT",PERMISSION_DENIED:"PERMISSION_DENIED",INSUFFICIENT_PRIVILEGES:"INSUFFICIENT_PRIVILEGES",UNKNOWN_ERROR:"UNKNOWN_ERROR",OPERATION_FAILED:"OPERATION_FAILED"},l={[r.AUTH_REQUIRED]:"Please log in to continue",[r.AUTH_EXPIRED]:"Your session has expired. Please log in again",[r.AUTH_INVALID]:"Invalid authentication credentials",[r.NETWORK_ERROR]:"Network error. Please check your connection",[r.TIMEOUT_ERROR]:"Request timed out. Please try again",[r.CONNECTION_ERROR]:"Unable to connect to the server",[r.DB_CONNECTION_ERROR]:"Database connection error",[r.DB_QUERY_ERROR]:"Database query error",[r.DB_CONSTRAINT_ERROR]:"Data validation error",[r.FILE_TOO_LARGE]:"File is too large. Maximum size is 5MB",[r.FILE_TYPE_INVALID]:"Invalid file type. Please use JPG, PNG, or GIF",[r.UPLOAD_FAILED]:"File upload failed. Please try again",[r.VALIDATION_ERROR]:"Please check your input and try again",[r.REQUIRED_FIELD_MISSING]:"Required field is missing",[r.INVALID_FORMAT]:"Invalid format",[r.PERMISSION_DENIED]:"You do not have permission to perform this action",[r.INSUFFICIENT_PRIVILEGES]:"Insufficient privileges for this operation",[r.UNKNOWN_ERROR]:"An unexpected error occurred",[r.OPERATION_FAILED]:"Operation failed. Please try again"};class a{constructor(){this.errorLog=[],this.maxErrorLogSize=100}static getInstance(){return a.instance||(a.instance=new a),a.instance}createError(e,t,o,i){const s={code:r[e],message:t||l[e],details:o,timestamp:new Date,context:i};return this.logError(s),s}handleError(e,t={}){const{showNotification:o=!0,logToConsole:i=!0}=t;let s;return this.isAppError(e)?s=e:this.isSupabaseError(e)?typeof e=="object"&&e!==null&&"message"in e&&"details"in e?s=this.convertSupabaseError(e):s=this.createError("UNKNOWN_ERROR","Database error occurred"):this.isNetworkError(e)?s=this.createError("NETWORK_ERROR","Network error occurred"):s=this.createError("UNKNOWN_ERROR","An unexpected error occurred"),i&&console.error("Error handled:",s),o&&this.showErrorNotification(s),s}isRetryableError(e){return[r.NETWORK_ERROR,r.TIMEOUT_ERROR,r.CONNECTION_ERROR,r.DB_CONNECTION_ERROR].includes(e.code)}getUserFriendlyMessage(e){return e.message}getTechnicalDetails(e){return`${e.code}: ${e.message}${e.details?` - ${e.details}`:""}`}logError(e){this.errorLog.push(e),this.errorLog.length>this.maxErrorLogSize&&(this.errorLog=this.errorLog.slice(-this.maxErrorLogSize))}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}isAppError(e){return typeof e=="object"&&e!==null&&"code"in e&&"message"in e&&"timestamp"in e}isSupabaseError(e){return typeof e=="object"&&e!==null&&"message"in e&&"details"in e}convertSupabaseError(e){let t="UNKNOWN_ERROR",o=e.message||"Database error occurred";const i=e.details||"";return e.code==="PGRST116"?(t="AUTH_REQUIRED",o="Authentication required"):e.code==="PGRST301"?(t="PERMISSION_DENIED",o="Permission denied"):e.code==="23505"?(t="DB_CONSTRAINT_ERROR",o="Data already exists"):e.code==="23503"&&(t="DB_CONSTRAINT_ERROR",o="Referenced data not found"),this.createError(t,o,i)}isNetworkError(e){return e instanceof Error?["network error","fetch failed","connection refused","timeout","aborted"].some(o=>e.message.toLowerCase().includes(o)):!1}showErrorNotification(e){}retryOperation(e,t=3,o=100){return _(this,null,function*(){const{OptimizedRetryService:i}=yield N(()=>import("./login-BkZ1x_Cy.js").then(n=>n.ac),__vite__mapDeps([0,1,2,3,4])),s=yield i.executeWithRetry(e,{maxRetries:t,baseDelay:o,backoffStrategy:"linear",retryCondition:n=>this.isRetryableError(n)});if(!s.success)throw this.handleError(s.error,{showNotification:!1});return s.data})}safeExecute(e){return _(this,arguments,function*(t,o={}){try{return{success:!0,data:yield t()}}catch(i){return{success:!1,error:this.handleError(i,o)}}})}}const O=a.getInstance();function A(E,e,t,o){return O.createError(E,e,t,o)}function f(E,e){return O.handleError(E,e)}function L(E,e){return O.safeExecute(E,e)}export{r as ERROR_CODES,l as ERROR_MESSAGES,a as ErrorHandlingService,A as createError,O as errorHandlingService,f as handleError,L as safeExecute};
